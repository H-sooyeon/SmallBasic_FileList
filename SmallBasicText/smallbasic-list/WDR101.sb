'May 07 2009

GraphicsWindow.Clear()

Initialize() ' Set items that need to execute only once at game start up

SetTargetCursorP1()

GraphicsWindow.keydown=MoveTcurp1

While P1DoneHidingShips="No"

Endwhile

akey=""

GraphicsWindow.KeyDown=Wait4Spacebar

While akey<>"Space"

endwhile

'-----------------------------------------------------

LightBoardP2()  ' Shades Player One Board to gray -colors Player two board

SetTargetCursorP2()

GraphicsWindow.keydown=MoveTcurp2

While P2DoneHidingShips="No"

Endwhile

akey=""

GraphicsWindow.KeyDown=Wait4Spacebar

While akey<>"Space"

endwhile

'-----------------------------------------------------

'-----------------------------------------------------

'------------------------------------------------------

'Main Loop  ----------------------------------------

While GameOver="No"

  playernumber=1

  Player1()

  playernumber=2

  Player2()

EndWhile

'---------------------------------------------------------

'---------------------------------------------------------



'---------------------------------------------------------

Sub Player1

LightBoardP1()

GraphicsWindow.KeyDown=null

GraphicsWindow.brushcolor="red"

GraphicsWindow.pencolor="red"

 

PlayerOneMovingCursor="True"

setstartcur() ' draws cursor for initial scan location, player one and two

GraphicsWindow.keydown=Movecurp1

While PlayerOneMovingCursor="True"

Endwhile  'Player One done moving cursor

 

GraphicsWindow.keydown=Null   'make key presses inactive

GlobalScanP1()   ' Perform Global Scan for Player One

GraphicsWindow.PenColor="Green"

GraphicsWindow.BrushColor="Green" 

GraphicsWindow.DrawText(x1+80,20,"Press Spacebar to Continue") 

akey=""

GraphicsWindow.KeyDown=Wait4Spacebar 

While akey<>"Space" 

EndWhile 

GraphicsWindow.BrushColor="Black" 

GraphicsWindow.FillRectangle(x1+80,20,250,25)

GraphicsWindow.PenColor="Gray"

GraphicsWindow.BrushColor="Gray"

 

'Global Scan Player One Complete- Set Initial Location Target Curso

Fire="No"

FlagFire=0

SetTargetCursorP1()

GraphicsWindow.keydown=MoveTcurp1a

While FlagFire=0

EndWhile 

CheckHitP2() 

'DisplayP1Shots()

EndSub

 



Sub Player2

LightBoardP2()

GraphicsWindow.KeyDown=null

GraphicsWindow.brushcolor="red"

GraphicsWindow.pencolor="red"

 

PlayerTwoMovingCursor="True"

setstartcur() ' draws cursor for initial scan location, player one and two

GraphicsWindow.keydown=Movecurp2

While PlayerTwoMovingCursor="True"

Endwhile  'Player Two done moving cursor

 

GraphicsWindow.keydown=Null   'make key presses inactive

GlobalScanP2()   ' Perform Global Scan for Player Two

GraphicsWindow.PenColor="Green"

GraphicsWindow.BrushColor="Green" 

GraphicsWindow.DrawText(x3+80,20,"Press Spacebar to Continue") 

akey=""

GraphicsWindow.KeyDown=Wait4Spacebar 

While akey<>"Space" 

EndWhile

GraphicsWindow.BrushColor="Black" 

GraphicsWindow.FillRectangle(x3+80,20,250,25)

GraphicsWindow.PenColor="Gray"

GraphicsWindow.BrushColor="Gray"

 



'Global Scan Player Two Complete- Set Initial Location Target Curso

Fire="No"

FlagFire=0

SetTargetCursorP2()

GraphicsWindow.keydown=MoveTcurp2a

While FlagFire=0

EndWhile 

CheckHitP1() 

'DisplayP2Shots()

EndSub  

 



 



'  ____________________________________________________

Sub Initialize

GraphicsWindow.PenWidth=5

h=desktop.Height

w=desktop.Width

GraphicsWindow.title="Scanmaster"

GraphicsWindow.Height=h

GraphicsWindow.width=w-20

GraphicsWindow.BackgroundColor="black"

GraphicsWindow.left=0

GraphicsWindow.top=0

GraphicsWindow.pencolor="cyan"

GraphicsWindow.FontSize=16

x1=125

x2=500

XM=640

x3=780

x4=1155

y1=123

y2=492

ymax=599

Five=5

NumberofShips=6 

For I=1 to NumberofShips 

Array.SetValue("P1Dead",I,"No") 

Array.SetValue("P2Dead",I,"No") 

EndFor

P1DoneHidingShips="No"

P2DoneHidingShips="No"

GameOver="No"

NS1=1

NS2=1

' Global Scan Results Box ?“Upper Left Corner of Box, Player One

Gx1=140

Gy1=540

BoxSize=40

' start cursor point to show Global results P1

Q1x1=Gx1+BoxSize+10

Q1y1=Gy1+10

Q2x1=Gx1+BoxSize+10

Q2y1=Gy1+BoxSize+10

Q3x1=Gx1+10

Q3y1=Gy1+BoxSize+10

Q4x1=Gx1+10

Q4y1=Gy1+10

 

' Local Scan Results Box ?“Upper Left Corner of Box, Player One

LBoxSize=20

Lx1=424

Ly1=Gy1+Boxsize-LBoxsize

' Global Scan Results Box ?“Upper Left Corner of Box, Player Two

Gx2=140+655

Gy2=540

'  Local Scan Results Box ?“Upper Left Corner of Box, Player Two

Lx2=424+655

Ly2=Gy2+Boxsize-LBoxsize 

 



' start cursor point to show Global results P2

Q1x2=Gx2+BoxSize+10

Q1y2=Gy2+10

Q2x2=Gx2+BoxSize+10

Q2y2=Gy2+BoxSize+10

Q3x2=Gx2+10

Q3y2=Gy2+BoxSize+10

Q4x2=Gx2+10

Q4y2=Gy2+10

  

  

Scolor="Blue"  ' Color of Scan line - radar sweep arm

ScanInc=5 ' Step Size in radar sweep

 

gridcols=10 ' no of vertical columns in scan field

gridrows=10 ' no of horizontal rows in scan field

 

RowHeight=math.floor((y2-y1)/gridrows)

ColWidth=math.floor((x2-x1)/gridcols)

 

Radius1=math.floor(.75*RowHeight)

Radius2=math.floor(.75*ColWidth)

If Radius2<Radius1 Then

   Radius1=Radius2

EndIf

 

horizontalines() ' computes y pixel values for rows in scan field

verticalines() ' computes x pixel values for columns in scan field

LightBoardP1()

EndSub



Sub LightBoardP1

GraphicsWindow.BrushColor="black"

GraphicsWindow.FillRectangle(5,5,630,690)

GraphicsWindow.penwidth=2

GraphicsWindow.PenColor="blue"

GraphicsWindow.BrushColor="red"

OutlineP1() 'Draw Outline of Player 1 scan field

GraphicsWindow.DrawLine(XM-2,0,XM-2,799) ' Dividing line P1 to P2

ScanBoxOutlineP1() ' Draw Global and Local Scan Boxes P1

GraphicsWindow.pencolor="gray"

drawgridp1() ' draws horizontal and vertical lines in scan field for player one

GraphicsWindow.BrushColor="black"

GraphicsWindow.FillRectangle(650,5,600,690)

GraphicsWindow.PenColor="gray"

OutlineP2() 'Draw Outline of Player 2 scan field

ScanBoxOutlineP2()' Draw Global and Local Scan Boxes P2

drawgridp2() ' draws horizontal and vertical lines in scan field for player two

GraphicsWindow.DrawLine(XM+2,0,XM+2,799) ' Dividing line P1 to P2

DisplayP1Shots()

DisplayP2Shots()

EndSub

' ____________________________________________________________

 

Sub LightBoardP2

  GraphicsWindow.BrushColor="black"

GraphicsWindow.FillRectangle(5,5,630,690)

GraphicsWindow.penwidth=2

GraphicsWindow.PenColor="gray"

OutlineP1() 'Draw Outline of Player 1 scan field

GraphicsWindow.DrawLine(XM-2,0,XM-2,799) ' Dividing line P1 to P2

ScanBoxOutlineP1() ' Draw Global and Local Scan Boxes P1

drawgridp1() ' draws horizontal and vertical lines in scan field for player one

 

 GraphicsWindow.BrushColor="black"

GraphicsWindow.FillRectangle(650,5,600,690)

GraphicsWindow.PenColor="blue"

GraphicsWindow.BrushColor="red"

OutlineP2() 'Draw Outline of Player 2 scan field

ScanBoxOutlineP2()' Draw Global and Local Scan Boxes P2

GraphicsWindow.DrawLine(XM+2,0,XM+2,799) ' Dividing line P1 to P2

GraphicsWindow.pencolor="gray"

drawgridp2() ' draws horizontal and vertical lines in scan field for player two

DisplayP2Shots()

DisplayP1Shots()

EndSub

  

' ____________________________________________________________

Sub OutlineP1

'Player One outer limits of scan field

GraphicsWindow.PenWidth=4

GraphicsWindow.Drawrectangle(x1,y1,x2-x1,y2-y1)

GraphicsWindow.PenWidth=2

EndSub

 

Sub OutlineP2

'Player Two outer Limits of Scan Field

GraphicsWindow.PenWidth=4

GraphicsWindow.DrawRectangle(x3,y1,x4-x3,y2-y1)

GraphicsWindow.PenWidth=2

EndSub

Sub ScanBoxOutlineP1

'Player One Global Scan Box Outline 

 GraphicsWindow.FontSize=12

GraphicsWindow.PenWidth=2

GraphicsWindow.Drawrectangle(Gx1,Gy1,BoxSize,BoxSize)

GraphicsWindow.Drawrectangle(Gx1+Boxsize,Gy1,BoxSize,BoxSize)

GraphicsWindow.Drawrectangle(Gx1,Gy1+BoxSize, BoxSize,BoxSize)

GraphicsWindow.Drawrectangle(Gx1+BoxSize,Gy1+BoxSize, BoxSize,BoxSize)

Temp=Gy1+2*BoxSize+10

GraphicsWindow.DrawText(Gx1+5,Temp,"Global Scan")

' Player One Local Scan Box Outline

GraphicsWindow.Drawrectangle(Lx1,Ly1,LBoxSize,LBoxSize)

GraphicsWindow.Drawrectangle(Lx1+LBoxsize,Ly1,LBoxSize,LBoxSize)

GraphicsWindow.Drawrectangle(Lx1,Ly1+LBoxSize, LBoxSize,LBoxSize)

GraphicsWindow.Drawrectangle(Lx1+LBoxSize,Ly1+LBoxSize, LBoxSize,LBoxSize)

Temp=Ly1+2*LBoxsize+10

GraphicsWindow.DrawText(Lx1-10,Temp,"Local Scan")

GraphicsWindow.PenWidth=2

GraphicsWindow.FontSize=16

EndSub

 

'_____________________________________________________________

Sub ScanBoxOutlineP2

  'Player Two Global Scan result Box

GraphicsWindow.FontSize=12

GraphicsWindow.Drawrectangle(Gx2,Gy2,BoxSize,BoxSize)

GraphicsWindow.Drawrectangle(Gx2+Boxsize,Gy2,BoxSize,BoxSize)

GraphicsWindow.Drawrectangle(Gx2,Gy2+BoxSize, BoxSize,BoxSize)

GraphicsWindow.Drawrectangle(Gx2+BoxSize,Gy2+BoxSize, BoxSize,BoxSize)

GraphicsWindow.DrawText(Gx2,(Gy2+(2*BoxSize+10)),"GLOBAL SCAN")

'Player One Local Scan results box

GraphicsWindow.Drawrectangle(Lx2,Ly2,LBoxSize,LBoxSize)

GraphicsWindow.Drawrectangle(Lx2+LBoxsize,Ly2,LBoxSize,LBoxSize)

GraphicsWindow.Drawrectangle(Lx2,Ly2+LBoxSize, LBoxSize,LBoxSize)

GraphicsWindow.Drawrectangle(Lx2+LBoxSize,Ly2+LBoxSize, LBoxSize,LBoxSize)

GraphicsWindow.DrawText(Lx2-15,Ly2+2*LBoxsize+10,"LOCAL SCAN")

GraphicsWindow.FontSize=16

EndSub

 

'______________________________________________________________



 

Sub horizontalines  ' compute y pixel values for horizontal lines in scan field

  array.setvalue("P",0,y1)

  array.setvalue("P",gridrows,y2)

  For i=1 To (gridrows-1)

  deltay=(y2-y1)/gridrows

  array.SetValue("P",i,Math.floor(y1+i*deltay))

  'GraphicsWindow.DrawText(kz,i*20,array.GetValue("P",i))

  EndFor

  For i=1 to gridrows

  Ycenter=(array.getvalue("P",i-1)+ array.getvalue("P",i))/2

  Ycenter=math.ceiling(Ycenter)

  Array.setvalue("YCenterP1",i,YCenter)

  Array.setvalue("YCenterP2",i,Ycenter)

  EndFor

EndSub

 

'________________________________________________________________

 

Sub verticalines 'compute x pixel values for vertical lines in scan field

 array.setvalue("xp1",0,x1)

 array.setvalue("xp1",gridcols,x2)

 array.setvalue("xp2",0,x3)

 array.setvalue("xp2",gridcols,x4)

For i=1 To gridcols-1

  deltax=(x2-x1)/gridcols

  array.SetValue("xp1",i,math.Floor(x1+i*deltax))  ' player one vertical line pixel x values

  array.SetValue("xp2",i,math.Floor(x3+i*deltax))  ' player two vertical line pixel x values

  'GraphicsWindow.DrawText(kz+40,i*20,array.GetValue("xp1",i))

  EndFor

For i=1 to gridcols

  Xcenter=(array.getvalue("xp1",i-1)+array.getvalue("xp1",i))/2

  Xcenter=math.ceiling(Xcenter)

  Array.setvalue("XCenterP1",i,Xcenter)

  EndFor

 For i=1 to gridcols

  Xcenter=(array.getvalue("xp2",i-1)+array.getvalue("xp2",i))/2

  Xcenter=math.ceiling(XCenter)

  Array.setvalue("XCenterP2",i,Xcenter)

  EndFor

  endsub



 

'_________________________________________________________________

Sub drawgridp1

  For z=1 To gridrows-1

    temp1=Array.GetValue("P",z)

    GraphicsWindow.DrawLine(x1+3,temp1,x2-3,temp1)

  EndFor

  For z=1 To gridcols-1

    temp1=array.GetValue("xp1",z)

    GraphicsWindow.DrawLine(temp1,y1+3,temp1,y2-3)

  EndFor

EndSub

 

  '_________________________________________________________________

 

Sub drawgridp2

  For n=1 To gridrows-1

    GraphicsWindow.DrawLine(x3,array.GetValue("P",n),x4,array.GetValue("P",n))

  EndFor

  For n=1 To gridcols-1

    GraphicsWindow.DrawLine(Array.GetValue("xp2",n),y1+3,array.GetValue("xp2",n),y2-3)

  EndFor

  EndSub

 

'__________________________________________________________________

 

 

 

 

 

 

 

 

 

 

 



Sub Setstartcur

  GraphicsWindow.penColor="gray"

  GraphicsWindow.BrushColor="gray"

  drawgridp1()

  xcurp1=math.Ceiling(gridcols/2)

  ycurp1=math.Ceiling(gridrows/2)

  xcurp2=xcurp1

  ycurp2=ycurp1

  'player One

  If playernumber=1 then

  GraphicsWindow.PenColor="red"

  GraphicsWindow.BrushColor="red"

  endif

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp1",xcurp1)

  ypixel=array.GetValue("P",ycurp1)

  GraphicsWindow.DrawLine(x1+Five,ypixel,x2-Five,ypixel)

  GraphicsWindow.DrawLine(xpixel,y1+Five,xpixel,y2-Five)

  GraphicsWindow.FillEllipse(xpixel-6,ypixel-6,12,12)

  GraphicsWindow.penwidth=2

  GraphicsWindow.DrawText(90,ypixel-8,ycurp1)

  GraphicsWindow.DrawText(xpixel-4,y1-28,xcurp1)

  'player Two

  GraphicsWindow.penColor="gray"

  GraphicsWindow.BrushColor="gray"

  If playernumber=2 then

  GraphicsWindow.PenColor="red"

  GraphicsWindow.BrushColor="red"

  Endif

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp2",xcurp2)

  ypixel=array.GetValue("P",ycurp2)

  GraphicsWindow.DrawLine(x3+Five,ypixel,x4-Five,ypixel)

  GraphicsWindow.DrawLine(xpixel,y1+Five,xpixel,y2-Five)

  GraphicsWindow.FillEllipse(xpixel-6,ypixel-6,12,12)

  GraphicsWindow.penwidth=2

  GraphicsWindow.DrawText(90+x3-x1,ypixel-8,ycurp2)

  GraphicsWindow.DrawText(xpixel-4,y1-28,xcurp2)

  EndSub



'__________________________________________________________

Sub SetTargetCursorP1

  xtcurp1=math.Floor(gridcols/2)

  ytcurp1=math.Floor(gridrows/2)

   'player One

  GraphicsWindow.PenColor="Yellow"

  GraphicsWindow.BrushColor="Yellow"

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp1",xtcurp1)

  ypixel=array.GetValue("P",ytcurp1)

  GraphicsWindow.DrawRectangle(xpixel,ypixel,RowHeight,ColWidth)

 

EndSub

 

'_________________________________________________________

 

Sub SetTargetCursorP2

  xtcurp2=math.Floor(gridcols/2)

  ytcurp2=math.Floor(gridrows/2)

   'player Two

  GraphicsWindow.PenColor="Yellow"

  GraphicsWindow.BrushColor="Yellow"

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp2",xtcurp2)

  ypixel=array.GetValue("P",ytcurp2)

  GraphicsWindow.DrawRectangle(xpixel,ypixel,RowHeight,ColWidth)

EndSub



 

Sub MoveTcurP1

   key=GraphicsWindow.LastKey

   xoldTcurp1=xtcurp1

   yoldTcurp1=ytcurp1

  If (key = "Right") And (xtcurp1 < (gridcols-1))  Then

    xtcurp1 = xtcurp1 + 1

    EndIf

  If (key = "Left") And (xtcurp1 > 0)  Then

    xtcurp1 = xtcurp1 - 1

  EndIf

  If (key = "Up") And (ytcurp1 > 0)  Then

    ytcurp1 = ytcurp1 - 1

  EndIf

  If (key = "Down") And (ytcurp1 < (gridrows-1))  Then

    ytcurp1 = ytcurp1 + 1

  EndIf

  If (key = "Return") Then

        XCenter=array.getvalue("XCenterP1",xtcurp1+1)

        YCenter=array.getValue("YCenterP1",ytcurp1+1)

        GraphicsWindow.penwidth=2

        GraphicsWindow.BrushColor="green"

        GraphicsWindow.PenColor="green"

        GraphicsWindow.FillEllipse(XCenter-Radius1/2,YCenter-Radius1/2,Radius1,Radius1)

        Array.setvalue("P1ShipsCol",NS1,xtcurp1+1)

        '  Array P1ShipsCol holds Column Number where ship is located

        Array.setvalue("P1ShipsRow",NS1,ytcurp1+1)

        '  Array P1ShipsRow holds Row Number where ship is located

        NS1=NS1+1

 

  EndIf

  ' draw over old cursor location

  GraphicsWindow.PenColor="black"

  GraphicsWindow.BrushColor="black"

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp1",xoldTcurp1)

  ypixel=array.GetValue("P",yoldTcurp1)

  GraphicsWindow.DrawRectangle(xpixel,ypixel,RowHeight,ColWidth)

  If xoldTcurp1=0 or xoldTcurp1=(gridcols-1) Then

     Graphicswindow.Pencolor="Blue"

     OutlineP1()

   EndIf

  If yoldTcurp1=0 or yoldTcurP1=(gridrows-1) Then

    GraphicsWindow.PenColor="Blue"

   OutlineP1()

  EndIf

  GraphicsWindow.Penwidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp1()

  'draw new cursor location

  GraphicsWindow.PenColor="Yellow"

  GraphicsWindow.BrushColor="Yellow"

  If NS1 >NumberofShips and P1DoneHidingShips="No" Then

     GraphicsWindow.PenColor="Black"

     GraphicsWindow.BrushColor="Black"

   EndIf

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp1",xtcurp1)

  ypixel=array.GetValue("P",ytcurp1)

  GraphicsWindow.DrawRectangle(xpixel,ypixel,RowHeight,ColWidth)

  GraphicsWindow.PenColor="gray"

  GraphicsWindow.BrushColor="gray"

  If NS1>NumberofShips then

    P1DoneHidingShips="yes"

  Endif

EndSub



 

'__________________________________________________________

Sub MoveTcurP2

   key=GraphicsWindow.LastKey

   xoldTcurp2=xtcurp2

   yoldTcurp2=ytcurp2

  If (key = "Right") And (xtcurp2 < (gridcols-1))  Then

    xtcurp2 = xtcurp2 + 1

    EndIf

  If (key = "Left") And (xtcurp2 > 0)  Then

    xtcurp2 = xtcurp2 - 1

  EndIf

  If (key = "Up") And (ytcurp2 > 0)  Then

    ytcurp2 = ytcurp2 - 1

  EndIf

  If (key = "Down") And (ytcurp2 < (gridrows-1))  Then

    ytcurp2 = ytcurp2 + 1

  EndIf

  If (key = "Return") Then

        XCenter=array.getvalue("XCenterP2",xtcurp2+1)

        YCenter=array.getValue("YCenterP2",ytcurp2+1)

        GraphicsWindow.penwidth=2

        GraphicsWindow.BrushColor="green"

        GraphicsWindow.PenColor="green"

        GraphicsWindow.FillEllipse(XCenter-Radius1/2,YCenter-Radius1/2,Radius1,Radius1)

        Array.setvalue("P2ShipsCol",NS2,xtcurp2+1)

        '  Array P2ShipsCol holds Column Number where ship is located

        Array.setvalue("P2ShipsRow",NS2,ytcurp2+1)

        '  Array P2ShipsRow holds Row Number where ship is located

        NS2=NS2+1

 

  EndIf

  ' draw over old cursor location

  GraphicsWindow.PenColor="black"

  GraphicsWindow.BrushColor="black"

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp2",xoldTcurp2)

  ypixel=array.GetValue("P",yoldTcurp2)

  GraphicsWindow.DrawRectangle(xpixel,ypixel,RowHeight,ColWidth)

  If xoldTcurp2=0 or xoldTcurp2=(gridcols-1) Then

     Graphicswindow.Pencolor="Blue"

     OutlineP2()

   EndIf

  If yoldTcurp2=0 or yoldTcurP2=(gridrows-1) Then

    GraphicsWindow.PenColor="Blue"

   OutlineP2()

  EndIf

  GraphicsWindow.Penwidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

  'draw new cursor location

  GraphicsWindow.PenColor="Yellow"

  GraphicsWindow.BrushColor="Yellow"

  If NS2 >NumberofShips and P2DoneHidingShips="No" Then

     GraphicsWindow.PenColor="Black"

     GraphicsWindow.BrushColor="Black"

   EndIf

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp2",xtcurp2)

  ypixel=array.GetValue("P",ytcurp2)

  GraphicsWindow.DrawRectangle(xpixel,ypixel,RowHeight,ColWidth)

  GraphicsWindow.PenColor="gray"

  GraphicsWindow.BrushColor="gray"

  If NS2>NumberofShips then

    P2DoneHidingShips="yes"

  

  Endif

EndSub



 

Sub MovecurP1

   key=GraphicsWindow.LastKey

   xoldcurP1=xcurp1

   yoldcurP1=ycurp1

  If (key = "Right") And (xcurp1 < (gridcols-1))  Then

    xcurp1 = xcurp1 + 1

    EndIf

  If (key = "Left") And (xcurp1 > 1)  Then

    xcurp1 = xcurp1 - 1

  EndIf

  If (key = "Up") And (ycurp1 > 1)  Then

    ycurp1 = ycurp1 - 1

  EndIf

  If (key = "Down") And (ycurp1 < (gridrows-1))  Then

    ycurp1 = ycurp1 + 1

  EndIf

  If (key = "Return") Then

    PlayerOneMovingCursor="False"

  EndIf

  ' draw over old cursor location

  GraphicsWindow.PenColor="black"

  GraphicsWindow.BrushColor="black"

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp1",xoldcurp1)

  ypixel=array.GetValue("P",yoldcurp1)

  GraphicsWindow.DrawLine(x1+Five,ypixel,x2-Five,ypixel)

  GraphicsWindow.DrawLine(xpixel,y1+Five,xpixel,y2-Five)

  GraphicsWindow.FillEllipse(xpixel-7,ypixel-7,14,14)

  GraphicsWindow.FillRectangle(88,ypixel-12,25,25)

  GraphicsWindow.FillRectangle(xpixel-10,y1-29,30,25)

  ' GraphicsWindow.penwidth=4

  ' GraphicsWindow.DrawText(95,ypixel-8,ycurp1)

  ' GraphicsWindow.DrawText(xpixel-4,y1-20,xcurp1)

  'GraphicsWindow.penwidth=2

  GraphicsWindow.PenColor="gray"

  GraphicsWindow.DrawLine(x1,ypixel,x2,ypixel)

  GraphicsWindow.DrawLine(xpixel,y1,xpixel,y2)

  'drawgridp1()

  'draw new cursor location

  GraphicsWindow.PenColor="red"

  GraphicsWindow.BrushColor="red"

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp1",xcurp1)

  ypixel=array.GetValue("P",ycurp1)

  GraphicsWindow.DrawLine(x1+Five,ypixel,x2-Five,ypixel)

  GraphicsWindow.DrawLine(xpixel,y1+Five,xpixel,y2-Five)

  GraphicsWindow.FillEllipse(xpixel-6,ypixel-6,12,12)

  GraphicsWindow.penwidth=2

  GraphicsWindow.DrawText(90,ypixel-8,ycurp1)

  GraphicsWindow.DrawText(xpixel-4,y1-28,xcurp1)

 

EndSub

 

'___________________________________________________________

 

 



 

 Sub GlobalScanP1

 Quad1=0

 Quad2=0

 Quad3=0

 Quad4=0

 For I2=1 to NumberofShips

 xs2=array.GetValue("P2ShipsCol",I2)

 ys2=array.GetValue("P2ShipsRow",I2)

 If (xs2-xcurp1)>0 And (ycurp1-ys2)<0 Then

   Quad2=Quad2+1

 EndIf

 If (xs2-xcurp1)>0 And (ycurp1-ys2)>=0 Then

      Quad1=Quad1+1

 EndIf

 If (xs2-xcurp1)<=0 And (ycurp1-ys2)>=0 Then

   Quad4=Quad4+1

 EndIf

 If (xs2-xcurp1)<=0 And (ycurp1-ys2)<0 Then

     Quad3=Quad3+1

 EndIf

EndFor

 

  

  

 For sx=xpixel To x2-5 Step ScanInc

  GraphicsWindow.Penwidth=2

  GraphicsWindow.PenColor=Scolor

  sy=y1+5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenColor="gray"

  drawgridp1()

EndFor

DisplayP1Shots()

For sy=y1+5 To ypixel Step ScanInc

  GraphicsWindow.penwidth=2

  GraphicsWindow.PenColor=Scolor

  sx=x2-5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  GraphicsWindow.PenColor="gray"

  drawgridP1()

EndFor

DisplayP1Shots()

 

'_____________________________

For sx=xpixel To x2-5 Step ScanInc

  sy=y1+5

  GraphicsWindow.Pencolor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp1()

EndFor

DisplayP1Shots()

For sy=y1+5 To ypixel Step ScanInc

  sx=x2-5

  GraphicsWindow.PenColor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

EndFor

DisplayP1Shots()

GraphicsWindow.DrawText(Q1x1,Q1y1,Quad1)

 

For sy=ypixel To y2-5 Step ScanInc

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor=Scolor

  sx=x2-5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

EndFor

DisplayP1Shots()

For sx=x2-5 To xpixel Step -ScanInc

  GraphicsWindow.Penwidth=2

  GraphicsWindow.PenColor=Scolor

  sy=y2-5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

  EndFor

  DisplayP1Shots()

  

For sy=ypixel To y2-5 Step ScanInc

  sx=x2-5

  GraphicsWindow.PenColor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

EndFor

DisplayP1Shots()

 

For sx=x2-5 To xpixel Step -ScanInc

  sy=y2-5

  GraphicsWindow.Pencolor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

EndFor

DisplayP1Shots()

 

 GraphicsWindow.DrawText(Q2x1,Q2y1,Quad2)

 '-------------------------------------------------------------------

 For sx=xpixel To x1+5 Step -ScanInc

  GraphicsWindow.Penwidth=2

  GraphicsWindow.PenColor=Scolor

  sy=y2-5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

EndFor

DisplayP1Shots()

 

For sy=y2-5 To ypixel Step -ScanInc

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor=Scolor

  sx=x1+5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

EndFor

DisplayP1Shots()

 

For sx=xpixel To x1+5 Step -ScanInc

  sy=y2-5

  GraphicsWindow.Pencolor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

EndFor

DisplayP1Shots()

 

For sy=y2-5 To ypixel Step -ScanInc

  sx=x1+5

  GraphicsWindow.PenColor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

EndFor

DisplayP1Shots()

 

 GraphicsWindow.DrawText(Q3x1,Q3y1,Quad3)

 '---------------------------------------------------------------------

 For sy=ypixel To y1+5 Step -ScanInc

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor=Scolor

  sx=x1+5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

EndFor

DisplayP1Shots()

 

For sx=x1+5 To xpixel Step ScanInc

  GraphicsWindow.Penwidth=2

  GraphicsWindow.PenColor=Scolor

  sy=y1+5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

EndFor

DisplayP1Shots()

  

For sy=ypixel To y1+5 Step -ScanInc

  sx=x1+5

  GraphicsWindow.PenColor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

EndFor

DisplayP1Shots()

 

For sx=x1+5 To xpixel Step ScanInc

  sy=y1+5

  GraphicsWindow.Pencolor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP1()

  'GraphicsWindow.DrawLine(xpixel,sy,xpixel,ypixel)

EndFor

DisplayP1Shots()

 

GraphicsWindow.DrawText(Q4x1,Q4y1,Quad4) 

  

GraphicsWindow.BrushColor="red"

GraphicsWindow.PenColor="red"

GraphicsWindow.DrawLine(x1+Five,ypixel,x2-Five,ypixel)

GraphicsWindow.DrawLine(xpixel,y1+Five,xpixel,y2-Five)

GraphicsWindow.FillEllipse(xpixel-6,ypixel-6,12,12)

GraphicsWindow.PenColor="gray"

 Endsub

 



 

'________________________________________________________________

 

Sub MovecurP2

   key=GraphicsWindow.LastKey

   xoldcurP2=xcurp2

   yoldcurP2=ycurp2

  If (key = "Right") And (xcurp2 < (gridcols-1))  Then

    xcurp2 = xcurp2 + 1

    EndIf

  If (key = "Left") And (xcurp2 > 1)  Then

    xcurp2 = xcurp2 - 1

  EndIf

  If (key = "Up") And (ycurp2 > 1)  Then

    ycurp2 = ycurp2 - 1

  EndIf

  If (key = "Down") And (ycurp2 < (gridrows-1))  Then

    ycurp2 = ycurp2 + 1

  EndIf

  If (key = "Return") Then

    PlayerTwoMovingCursor="False"

  EndIf

  ' draw over old cursor location

  GraphicsWindow.PenColor="black"

  GraphicsWindow.BrushColor="black"

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp2",xoldcurp2)

  ypixel=array.GetValue("P",yoldcurp2)

  GraphicsWindow.DrawLine(x3+Five,ypixel,x4-Five,ypixel)

  GraphicsWindow.DrawLine(xpixel,y1+Five,xpixel,y2-Five)

  GraphicsWindow.FillEllipse(xpixel-7,ypixel-7,14,14)

  GraphicsWindow.FillRectangle(88+x3-x1,ypixel-12,25,25)

  GraphicsWindow.FillRectangle(xpixel-10,y1-29,30,25)

  ' GraphicsWindow.penwidth=4

  ' GraphicsWindow.DrawText(95,ypixel-8,ycurp1)

  ' GraphicsWindow.DrawText(xpixel-4,y1-20,xcurp1)

  'GraphicsWindow.penwidth=2

  GraphicsWindow.PenColor="gray"

  GraphicsWindow.DrawLine(x3,ypixel,x4,ypixel)

  GraphicsWindow.DrawLine(xpixel,y1,xpixel,y2)

  'drawgridp2()

  'draw new cursor location

  GraphicsWindow.PenColor="red"

  GraphicsWindow.BrushColor="red"

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp2",xcurp2)

  ypixel=array.GetValue("P",ycurp2)

  GraphicsWindow.DrawLine(x3+Five,ypixel,x4-Five,ypixel)

  GraphicsWindow.DrawLine(xpixel,y1+Five,xpixel,y2-Five)

  GraphicsWindow.FillEllipse(xpixel-6,ypixel-6,12,12)

  GraphicsWindow.penwidth=2

  GraphicsWindow.DrawText(90+x3-x1,ypixel-8,ycurp2)

  GraphicsWindow.DrawText(xpixel-4,y1-28,xcurp2) 

  

EndSub 

  

  

  

 

Sub GlobalScanP2 

 Quad1=0

 Quad2=0

 Quad3=0

 Quad4=0

 For I1=1 to NumberofShips

 xs1=array.GetValue("P1ShipsCol",I1)

 ys1=array.GetValue("P1ShipsRow",I1)

 If (xs1-xcurp2)>0 And (ycurp2-ys1)<0 Then

   Quad2=Quad2+1

 EndIf

 If (xs1-xcurp2)>0 And (ycurp2-ys1)>=0 Then

      Quad1=Quad1+1

 EndIf

 If (xs1-xcurp2)<=0 And (ycurp2-ys1)>=0 Then

   Quad4=Quad4+1

 EndIf

 If (xs1-xcurp2)<=0 And (ycurp2-ys1)<0 Then

     Quad3=Quad3+1

 EndIf

EndFor

   

 For sx=xpixel To x4-5 Step ScanInc

  GraphicsWindow.Penwidth=2

  GraphicsWindow.PenColor=Scolor

  sy=y1+5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

 

For sy=y1+5 To ypixel Step ScanInc

  GraphicsWindow.penwidth=2

  GraphicsWindow.PenColor=Scolor

  sx=x4-5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

 

'_____________________________

For sx=xpixel To x4-5 Step ScanInc

  sy=y1+5

  GraphicsWindow.Pencolor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

 

For sy=y1+5 To ypixel Step ScanInc

  sx=x4-5

  GraphicsWindow.PenColor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

GraphicsWindow.DrawText(Q1x2,Q1y2,Quad1)

 

For sy=ypixel To y2-5 Step ScanInc

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor=Scolor

  sx=x4-5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

 

For sx=x4-5 To xpixel Step -ScanInc

  GraphicsWindow.Penwidth=2

  GraphicsWindow.PenColor=Scolor

  sy=y2-5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

 



For sy=ypixel To y2-5 Step ScanInc

  sx=x4-5

  GraphicsWindow.PenColor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

 

For sx=x4-5 To xpixel Step -ScanInc

  sy=y2-5

  GraphicsWindow.Pencolor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

 

 GraphicsWindow.DrawText(Q2x2,Q2y2,Quad2)

 '-------------------------------------------------------------------

 For sx=xpixel To x3+5 Step -ScanInc

  GraphicsWindow.Penwidth=2

  GraphicsWindow.PenColor=Scolor

  sy=y2-5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

 

For sy=y2-5 To ypixel Step -ScanInc

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor=Scolor

  sx=x3+5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

 

For sx=xpixel To x3+5 Step -ScanInc

  sy=y2-5

  GraphicsWindow.Pencolor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

 

For sy=y2-5 To ypixel Step -ScanInc

  sx=x3+5

  GraphicsWindow.PenColor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

 GraphicsWindow.DrawText(Q3x2,Q3y2,Quad3)

 '---------------------------------------------------------------------

 For sy=ypixel To y1+5 Step -ScanInc

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor=Scolor

  sx=x3+5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

 

For sx=x3+5 To xpixel Step ScanInc

  GraphicsWindow.Penwidth=2

  GraphicsWindow.PenColor=Scolor

  sy=y1+5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

EndFor

DisplayP2Shots()

  

For sy=ypixel To y1+5 Step -ScanInc

  sx=x3+5

  GraphicsWindow.PenColor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP2()

EndFor

DisplayP2Shots()

 

For sx=x3+5 To xpixel Step ScanInc

  sy=y1+5

  GraphicsWindow.Pencolor="black"

  GraphicsWindow.PenWidth=5

  GraphicsWindow.DrawLine(sx,sy,xpixel,ypixel)

  GraphicsWindow.PenWidth=2

  GraphicsWindow.PenColor="gray"

  drawgridP2()

  GraphicsWindow.DrawLine(xpixel,sy,xpixel,ypixel)

EndFor

DisplayP2Shots()

GraphicsWindow.DrawText(Q4x2,Q4y2,Quad4)

GraphicsWindow.BrushColor="red"

GraphicsWindow.PenColor="red"

GraphicsWindow.DrawLine(x3+Five,ypixel,x4-Five,ypixel)

GraphicsWindow.DrawLine(xpixel,y1+Five,xpixel,y2-Five)

GraphicsWindow.FillEllipse(xpixel-6,ypixel-6,12,12)

GraphicsWindow.PenColor="gray"

EndSub 

  

 

'________________________________________________________________

Sub DisplayP1Shots

    For Shots=1 to NumberofShotsP1

        XC=array.getvalue("P1ShotHistoryCol",Shots)

        YC=array.getValue("P1ShotHistoryRow",Shots)

        XCPix=array.GetValue("xp1",XC-1)+.125*Colwidth

        YCPix=array.GetValue("P",YC-1)+.125*RowHeight

        GraphicsWindow.penwidth=2

        GraphicsWindow.BrushColor="gray"

        GraphicsWindow.PenColor="gray"

        GraphicsWindow.FillEllipse(XCPix,YCPix,Radius1,Radius1)

        EndFor

      GraphicsWindow.BrushColor="red"

      GraphicsWindow.PenColor="red"  

      For Shots=1 to NumberofShips

        D=array.GetValue("P2Dead",Shots)

        If D="Yes" Then 

        XC=array.getvalue("P2ShipsCol",Shots)

        YC=array.getValue("P2ShipsRow",Shots)

        XCPix=array.GetValue("xp1",XC-1)+.125*Colwidth

        YCPix=array.GetValue("P",YC-1)+.125*RowHeight

        GraphicsWindow.FillEllipse(XCPix,YCPix,Radius1,Radius1)

        EndIf

      EndFor

      GraphicsWindow.KeyDown=Null  

EndSub



Sub DisplayP2Shots

  For Shots=1 to NumberofShotsP2

        XC=array.getvalue("P2ShotHistoryCol",Shots)

        YC=array.getValue("P2ShotHistoryRow",Shots)

        XCPix=array.GetValue("xp2",XC-1)+.125*Colwidth

        YCPix=array.GetValue("P",YC-1)+.125*RowHeight

        GraphicsWindow.penwidth=2

        GraphicsWindow.BrushColor="gray"

        GraphicsWindow.PenColor="gray"

        GraphicsWindow.FillEllipse(XCPix,YCPix,Radius1,Radius1)

        EndFor

      GraphicsWindow.BrushColor="red"

      GraphicsWindow.PenColor="red"  

      For Shots=1 to NumberofShips

        D=array.GetValue("P1Dead",Shots)

        If D="Yes" Then 

        XC=array.getvalue("P1ShipsCol",Shots)

        YC=array.getValue("P1ShipsRow",Shots)

        XCPix=array.GetValue("xp2",XC-1)+.125*Colwidth

        YCPix=array.GetValue("P",YC-1)+.125*RowHeight

        GraphicsWindow.FillEllipse(XCPix,YCPix,Radius1,Radius1)

        EndIf

      EndFor

      GraphicsWindow.KeyDown=Null  

EndSub 

 



 

 



  Sub MoveTcurP1a

   key=GraphicsWindow.LastKey

   xoldTcurp1=xtcurp1

   yoldTcurp1=ytcurp1

  If (key = "Right") And (xtcurp1 < (gridcols-1))  Then

    xtcurp1 = xtcurp1 + 1

    EndIf

  If (key = "Left") And (xtcurp1 > 0)  Then

    xtcurp1 = xtcurp1 - 1

  EndIf

  If (key = "Up") And (ytcurp1 > 0)  Then

    ytcurp1 = ytcurp1 - 1

  EndIf

  If (key = "Down") And (ytcurp1 < (gridrows-1))  Then

    ytcurp1 = ytcurp1 + 1

  EndIf

  If (key = "Return") Then

      NumberofShotsP1= NumberofShotsP1+1

      Array.SetValue("P1ShotHistoryRow", NumberofShotsP1,ytcurp1+1)

      Array.SetValue("P1ShotHistoryCol", NumberofShotsP1,xtcurp1+1) 

      ColSelectedP2=xtcurp1+1

      RowSelectedP2=ytcurp1+1 

      Fire="Yes"

    EndIf

    

    

  ' draw over old cursor location

  GraphicsWindow.PenColor="black"

  GraphicsWindow.BrushColor="black"

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp1",xoldTcurp1)

  ypixel=array.GetValue("P",yoldTcurp1)

  GraphicsWindow.DrawRectangle(xpixel,ypixel,RowHeight,ColWidth)

  If xoldTcurp1=0 or xoldTcurp1=(gridcols-1) Then

     Graphicswindow.Pencolor="Blue"

     OutlineP1()

   EndIf

  If yoldTcurp1=0 or yoldTcurP1=(gridrows-1) Then

    GraphicsWindow.PenColor="Blue"

   OutlineP1()

  EndIf

  GraphicsWindow.Penwidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp1()

  'draw new cursor location

  GraphicsWindow.PenColor="Yellow"

  GraphicsWindow.BrushColor="Yellow"

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp1",xtcurp1)

  ypixel=array.GetValue("P",ytcurp1)

  GraphicsWindow.DrawRectangle(xpixel,ypixel,RowHeight,ColWidth)

  GraphicsWindow.PenColor="gray"

  GraphicsWindow.BrushColor="gray"

  If Fire="Yes" Then

  FlagFire=1

  EndIf

 EndSub    

  

 

Sub CheckHitP2 

     FlagHitP2=0

     For NOS =1 to NumberofShips 

     Row=Array.GetValue("P2ShipsRow",NOS)

     Col= Array.GetValue("P2ShipsCol",NOS) 

     Dead= Array.GetValue("P2Dead",NOS)

     If Col=ColSelectedP2 and Row=RowSelectedP2 and Dead="No" Then 

        Array.SetValue("P2Dead",NOS,"Yes") 

        P2DeadCount=P2DeadCount+1

        FlagHitP2=1

        EndIf

        EndFor

        If FlagHitP2=1 then

        CelebrateHitP2() 

        Else 

        NoHitP2() 

        EndIf

EndSub 

 

Sub CelebrateHitP2 

GraphicsWindow.PenColor="Red"

GraphicsWindow.BrushColor="red"  

GraphicsWindow.DrawText(x1,20,"Hit") 

GraphicsWindow.PenColor="Green"

GraphicsWindow.BrushColor="Green"

GraphicsWindow.DrawText(x1+50,20,"Press Spacebar to Continue") 

DisplayP1Shots()

akey="" 

GraphicsWindow.KeyDown=Wait4Spacebar 

While akey<>"Space" 

EndWhile 

GraphicsWindow.KeyDown=Null 

GraphicsWindow.BrushColor="Black" 

GraphicsWindow.FillRectangle(x1,20,200,20)

GraphicsWindow.PenColor="Gray"

GraphicsWindow.BrushColor="Gray"

 EndSub 

 

Sub NoHitP2 

GraphicsWindow.PenColor="Blue"

GraphicsWindow.BrushColor="Blue"  

GraphicsWindow.DrawText(x1,20,"Missed=>")

GraphicsWindow.PenColor="Green"

GraphicsWindow.BrushColor="Green" 

GraphicsWindow.DrawText(x1+80,20,"Press Spacebar to Continue") 

DisplayP1Shots()

akey=""

GraphicsWindow.KeyDown=Wait4Spacebar 

While akey<>"Space" 

EndWhile 

GraphicsWindow.KeyDown=Null 

GraphicsWindow.BrushColor="Black" 

GraphicsWindow.FillRectangle(x1,20,200,20)

GraphicsWindow.PenColor="Gray"

GraphicsWindow.BrushColor="Gray" 

EndSub 

 

'___________________________________________________

Sub MoveTcurP2a

   key=GraphicsWindow.LastKey

   xoldTcurp2=xtcurp2

   yoldTcurp2=ytcurp2

  If (key = "Right") And (xtcurp2 < (gridcols-1))  Then

    xtcurp2 = xtcurp2 + 1

    EndIf

  If (key = "Left") And (xtcurp2 > 0)  Then

    xtcurp2 = xtcurp2 - 1

  EndIf

  If (key = "Up") And (ytcurp2 > 0)  Then

    ytcurp2 = ytcurp2 - 1

  EndIf

  If (key = "Down") And (ytcurp2 < (gridrows-1))  Then

    ytcurp2 = ytcurp2 + 1

  EndIf

  If (key = "Return") Then

      NumberofShotsP2= NumberofShotsP2+1

      Array.SetValue("P2ShotHistoryRow", NumberofShotsP2,ytcurp2+1)

      Array.SetValue("P2ShotHistoryCol", NumberofShotsP2,xtcurp2+1) 

      ColSelected=xtcurp2+1

      RowSelected=ytcurp2+1 

      Fire="Yes"

    EndIf

    

    

  ' draw over old cursor location

  GraphicsWindow.PenColor="black"

  GraphicsWindow.BrushColor="black"

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp2",xoldTcurp2)

  ypixel=array.GetValue("P",yoldTcurp2)

  GraphicsWindow.DrawRectangle(xpixel,ypixel,RowHeight,ColWidth)

  If xoldTcurp2=0 or xoldTcurp2=(gridcols-1) Then

     Graphicswindow.Pencolor="Blue"

     OutlineP2()

   EndIf

  If yoldTcurp2=0 or yoldTcurP2=(gridrows-1) Then

    GraphicsWindow.PenColor="Blue"

   OutlineP2()

  EndIf

  GraphicsWindow.Penwidth=2

  GraphicsWindow.PenColor="gray"

  drawgridp2()

  'draw new cursor location

  GraphicsWindow.PenColor="Yellow"

  GraphicsWindow.BrushColor="Yellow"

  GraphicsWindow.penwidth=2

  xpixel=array.GetValue("xp2",xtcurp2)

  ypixel=array.GetValue("P",ytcurp2)

  GraphicsWindow.DrawRectangle(xpixel,ypixel,RowHeight,ColWidth)

  GraphicsWindow.PenColor="gray"

  GraphicsWindow.BrushColor="gray"

  If Fire="Yes" Then

  FlagFire=1

  EndIf

 EndSub    

 

 

Sub CheckHitP1 

     FlagHitP1=0

     For NOS=1 to NumberofShips 

     Row=Array.GetValue("P1ShipsRow",NOS)

     Col= Array.GetValue("P1ShipsCol",NOS) 

     Dead= Array.GetValue("P1Dead",NOS)

       If Col=ColSelected and Row=RowSelected and Dead="No" Then 

        Array.SetValue("P1Dead",NOS,"Yes") 

        P1DeadCount=P1DeadCount+1

        FlagHitP1=1

        EndIf

        EndFor

        If FlagHitP1=1 then

        CelebrateHitP1() 

        Else 

        NoHitP1() 

        EndIf

EndSub 

 

Sub CelebrateHitP1 

GraphicsWindow.PenColor="Red"

GraphicsWindow.BrushColor="Red"  

GraphicsWindow.DrawText(x3,20,"Hit") 

GraphicsWindow.PenColor="Green"

GraphicsWindow.BrushColor="Green"

GraphicsWindow.DrawText(x3+50,20,"Press Spacebar to Continue") 

DisplayP2Shots()

akey="" 

GraphicsWindow.KeyDown=Wait4Spacebar 

While akey<>"Space" 

EndWhile

GraphicsWindow.KeyDown=Null 

GraphicsWindow.BrushColor="Black" 

GraphicsWindow.FillRectangle(x3,20,200,20)

GraphicsWindow.PenColor="gray"

GraphicsWindow.BrushColor="gray" 

EndSub 

 

Sub NoHitP1 

GraphicsWindow.PenColor="Blue"

GraphicsWindow.BrushColor="Blue"  

GraphicsWindow.DrawText(x3,20,"Missed=>")

GraphicsWindow.PenColor="Green"

GraphicsWindow.BrushColor="Green" 

GraphicsWindow.DrawText(x3+80,20,"Press Spacebar to Continue") 

DisplayP2Shots()

akey=""

GraphicsWindow.KeyDown=Wait4Spacebar 

While akey<>"Space" 

EndWhile 

GraphicsWindow.KeyDown=Null 

GraphicsWindow.BrushColor="Black" 

GraphicsWindow.FillRectangle(x3,20,200,20)

GraphicsWindow.PenColor="Gray"

GraphicsWindow.BrushColor="gray" 

EndSub 

 

Sub Null

' Do nothing

Endsub

 

Sub Wait4SpaceBar

  akey=graphicswindow.LastKey

EndSub


