START:
config:
time = Clock.Time
dayofweek = Clock.WeekDay
date = Clock.Date
TextWindow.ForegroundColor = "red"

startup:
filepathl = "C:\Users\nihal_000\Desktop\My Programs\Small Basic\Projects\Files\OS Strawberry 1.3\"
filepaths = "C:\Users\nihal_000\Desktop\My Programs\Small Basic\Projects\Files\OS Strawberry 1.3"
TextWindow.Clear()
TextWindow.WriteLine("Welcome to the OS Strawberry 1.3!")
TextWindow.WriteLine("Many apps are available!")
Sound.PlayMusic("o5 g4 e4 f4 d4")
asdf01:
TextWindow.WriteLine("Press 'p' to proceed to the Logon Screen!")
lgon = TextWindow.Read()
'If lgon = "loghack" Then
'  Goto ifloggedon
'Else
'  Goto start02
'  EndIf
  start02:
  If lgon = "p" Then
    TextWindow.Clear()
    TextWindow.WriteLine("Loading...")
    Program.Delay(2500)
    TextWindow.Clear()
    dalogonscreen:
    TextWindow.WriteLine("Welcome to the Logon Screen!")
    TextWindow.WriteLine("Have an account? Y/N")
    accountq = TextWindow.Read()
    If accountq = "y" Or "Y" then
    TextWindow.WriteLine("Logon Here:")
    Goto accountcheck
    ElseIf accountq = "n" or "N" then
    Goto asdf02
    else
    Goto dalogonscreen
  EndIf
  
  TextWindow.WriteLine("Type your name to log on!")
  name = TextWindow.Read()
  Goto asdf02
Else 
  goto asdf01
EndIf
accountcheck:
TextWindow.WriteLine("Enter your username.")
tuser = TextWindow.Read()
tuserfilename =  filepathl + tuser
' The following line could be harmful and has been automatically commented.
' If File.ReadLine(tuserfilename, 1) = tuser then
  TextWindow.WriteLine("Enter your password.")
  tpass = TextWindow.Read()
' The following line could be harmful and has been automatically commented.
'   If File.ReadLine(tuserfilename, 2) = tpass then
  Goto ifloggedon
else
   TextWindow.WriteLine("Incorrect Password")
   Goto dalogonscreen
   EndIf
Else
  TextWindow.WriteLine("Invalid Username")
  Goto dalogonscreen
endif



  
  TextWindow.WriteLine("Enter your username")



asdf02:
CreateAccount()
Sub CreateAccount
  asdf19:
  TextWindow.WriteLine("Go to the Textwindow and log on!")
  TextWindow.WriteLine("Enter your username(make it complicated or it will be hacked)")
  crusername = TextWindow.Read()
' The following line could be harmful and has been automatically commented.
'   unhackname = File.ReadLine(filepathl + crusername, 1)
  If crusername = unhackname Then
    TextWindow.WriteLine("This account name is already taken. Please choose another one.")
    Goto asdf19
  EndIf
  
' The following line could be harmful and has been automatically commented.
'   File.CreateDirectory(filepaths)
  cruserfilename = filepathl + crusername
' The following line could be harmful and has been automatically commented.
'   File.WriteLine(cruserfilename, 1, crusername)
  TextWindow.WriteLine("Press 'p' when you are ready to set your password!(Not Changeable)")
If TextWindow.Read() = "p" Then
  TextWindow.WriteLine("Enter your password")
  pass = TextWindow.Read()
' The following line could be harmful and has been automatically commented.
'   File.WriteLine(cruserfilename, 2, pass)
  GraphicsWindow.Show()
  GraphicsWindow.ShowMessage("Your password has been set as "+ pass,"Alert")
  name = crusername
Else 
  Goto asdf19
EndIf
EndSub
GraphicsWindow.Hide()
TextWindow.Clear()
logon1:
TextWindow.WriteLine("Log on now " + name + ", to access all of the apps")
TextWindow.WriteLine("Enter your password")
temppass = TextWindow.Read()
If temppass = pass Then
  TextWindow.WriteLine("Welcome " + name + "! You have succesfully logged on!")
  Goto ifloggedon
Else
  TextWindow.WriteLine("Incorrect Passoword.")
  TextWindow.WriteLine("Try again or close the program and start again")
  Goto logon1
EndIf
TextWindow.WriteLine("Enter your username")
tempuser = TextWindow.Read()
If tempuser = crusername Then
  TextWindow.WriteLine("You must now enter your password")
  name = crusername
  Goto ztarthere
Else
  TextWindow.WriteLine("Incorrect Passoword.")
  TextWindow.WriteLine("Try again or close the program and start again")
  Goto logon1
EndIf
ztarthere:
TextWindow.WriteLine("Log on now, to access all of the apps")
TextWindow.WriteLine("Enter your password")
temppass = TextWindow.Read()
If temppass = pass Then
  TextWindow.WriteLine("Welcome " + name + "! You have succesfully logged on!")
  Goto ifloggedon
Else
  TextWindow.WriteLine("Incorrect Passoword.")
  TextWindow.WriteLine("Try again or close the program and start again")
  Goto logon1
EndIf

ifloggedon:
Sound.PlayMusic("o6 c16 e16 g16")
Sound.PlayMusic("o3 g4 g8 g4 a#4  g4 g8 g4 a#4  g4 g8 g4 a#4 c16 a#16 a16 g16 a8 a#8")
time = Clock.Time
name = tuser
TextWindow.ForegroundColor = "white"
Program.Delay(1200)
TextWindow.WriteLine("<Hit Enter>")
TextWindow.Clear()


TextWindow.WriteLine("The apps that are currently available are:")

appselect:
time = Clock.Time
GraphicsWindow.Clear()
GraphicsWindow.Hide()
TextWindow.WriteLine("Info(read when you first use)")
TextWindow.WriteLine("coin dude")
TextWindow.WriteLine("Pong")
TextWindow.WriteLine("Snake")
TextWindow.WriteLine("Memos")
TextWindow.WriteLine("Clock")
'TextWindow.WriteLine("RandomPics")
'TextWindow.WriteLine("Trifractals")
TextWindow.WriteLine("'clock' for Clock")
TextWindow.WriteLine("'pong' for Pong")
TextWindow.WriteLine("'snake' for Snake")
TextWindow.WriteLine("'plane' for Plane")
TextWindow.WriteLine("'memos' for Memos")
'TextWindow.WriteLine("'fract' for Trifractals")
'TextWindow.WriteLine("'pics' for RandomPics")
TextWindow.WriteLine("'info' for InfoManual")
TextWindow.WriteLine("'coinz' for CoinDude4000")
asdf05:
'here is appselect switch
sapp = TextWindow.Read()
If sapp="shutdown" Then
  Program.End()
EndIf
If sapp="restart" Then
  goto startup
EndIf
'If sapp = "clock" Then
'  Goto clock
'endif
'If sapp = "dictionary" Then
'Goto Dictionary
'endif

  If sapp="snake" Then
  Goto snake
EndIf
If sapp = "pong" Then
  Goto pong
  endif
  If sapp = "plane" Then
  Goto airplane
endif
If sapp = "portal" then
endif
If sapp = "memos" then
Goto memos
endif
If sapp = "fract" then
    Goto fractals 
  EndIf
'  If sapp = "info" then
'    Goto InfoManual 
'  EndIf
  If sapp = "pics" then
  Goto randompics
endif
If sapp = "coinz" Then
  Goto coindude
endif
Goto asdf05
clock:
time = Clock.Time
dayofweek = Clock.WeekDay
date = Clock.Date
TextWindow.WriteLine("Today is " + dayofweek + ", " + date)
TextWindow.WriteLine("The time is " + time)
Program.Delay(1600)
Goto appselect
memos:
TextWindow.Write("Welcome " + name)
TextWindow.WriteLine(" to the Memos 1.0 app!")
'filepathl = "C:\Users\nihal_000\Desktop\My Programs\Small Basic\Projects\Files\OS Strawberry 1.0\"
memofp = filepathl + name + "memos"
' The following line could be harmful and has been automatically commented.
' File.CreateDirectory(memofp)
TextWindow.WriteLine("Currently you may only have one memo at a time.")
' The following line could be harmful and has been automatically commented.
' cmemo1 = File.ReadLine(memofp + "\"+ name, 1)
' The following line could be harmful and has been automatically commented.
' mtime = File.ReadLine(memofp + "\"+ name, 2)
' The following line could be harmful and has been automatically commented.
' mdate = File.ReadLine(memofp + "\"+ name, 3)
  TextWindow.WriteLine("Your current memo is:")
  TextWindow.WriteLine(cmemo1 + " - " + mdate + " - " + mtime )
TextWindow.WriteLine("Enter your memo (Existing memos will be deleted) or type 'exit' to exit")
memotakeinputs:
chmemo = TextWindow.Read()
If chmemo = "exit" then
Goto appselect
else
  time = Clock.Time
  date = Clock.Date
' The following line could be harmful and has been automatically commented.
'   File.WriteLine(memofp + "\"+ name, 1, chmemo)
' The following line could be harmful and has been automatically commented.
'   File.WriteLine(memofp + "\"+ name, 2, time)
' The following line could be harmful and has been automatically commented.
'   File.WriteLine(memofp + "\"+ name, 3, date)
Goto memos
endif
Goto appselect
pong:
GraphicsWindow.Show()
GraphicsWindow.BackgroundColor = "DarkBlue"
paddle = Shapes.AddRectangle(120, 12)
ball = Shapes.AddEllipse(16, 16)
GraphicsWindow.MouseMove = OnMouseMove1
startover:
x = 0
y = 0
deltaX = 1
deltaY = 1
RunLoop:
x = x + deltaX
y = y + deltaY
gw = GraphicsWindow.Width
gh = GraphicsWindow.Height
If (x >= gw - 16 or x <= 0) Then
deltaX = -deltaX
EndIf
If (y <= 0) Then
deltaY = -deltaY
EndIf
padX = Shapes.GetLeft (paddle)
If (y = gh - 28 and x >= padX and x <= padX + 120) Then
deltaY = -deltaY
EndIf
Shapes.Move(ball, x, y)
Program.Delay(5)
If (y < gh) Then
Goto RunLoop
EndIf
GraphicsWindow.ShowMessage("You Lose", "Paddle")
Goto appselect
Sub OnMouseMove1
paddleX = GraphicsWindow.MouseX
Shapes.Move(paddle, paddleX - 60, GraphicsWindow.Height - 12)
EndSub
fractals:
GraphicsWindow.Show()
GraphicsWindow.BackgroundColor = "Black"
x = 100
y = 100
For i = 1 To 100000
  r = Math.GetRandomNumber(3)
  ux = 150
uy = 30
If (r = 1) then
ux = 30
uy = 1000
EndIf
If (r = 2) Then
ux = 1000
uy = 1000
EndIf
x = (x + ux) / 2
y = (y + uy) / 2
GraphicsWindow.SetPixel(x, y, "LightGreen")
EndFor
GraphicsWindow.TextInput = OnQdown
randompics:
GraphicsWindow.Show()
GraphicsWindow.BackgroundColor = "white"
GraphicsWindow.MouseDown = OnMouseDown3
GraphicsWindow.TextInput = OnQdown
Sub OnMouseDown3
pic = Flickr.GetRandomPicture("mountains, river")
GraphicsWindow.DrawResizedImage(pic, 0, 0, 640, 480)
EndSub
sub OnQdOWN
  GraphicsWindow.Hide()
  EndSub
  For i = 1 To 10
pic = Flickr.GetRandomPicture("mountains")
Desktop.SetWallPaper(pic)
Program.Delay(10000)
EndFor
InfoManual:
TextWindow.WriteLine("This is the info manual. Read all of the following")
TextWindow.WriteLine("before proceeding.")
Program.Delay(2000)
TextWindow.WriteLine("This section is about apps!(This section is also currently)")
TextWindow.WriteLine("(press Enter to continue)")
if TextWindow.Read() = "appselect" then
  Goto appselect
  Else
TextWindow.WriteLine("under repair")
TextWindow.WriteLine("To shut down the program, go to the apps menu and type")
TextWindow.WriteLine("shutdown")
TextWindow.WriteLine(name + "/SystemFiles/ProgramFiles/SBAppData")
Program.Delay(3000)
TextWindow.WriteLine("Access Denied until bugs in the file storage are fixed.")
Program.Delay(2500)
TextWindow.Clear()
Goto appselect

coindude:
TextWindow.ForegroundColor = "white"
startofgame:
a = 400
TextWindow.WriteLine("press 'e' to begin game")
start1:
If TextWindow.Read()= "e" Then
  TextWindow.WriteLine("To skip instructions, press 's'")
  If TextWindow.Read() = "s" Then
    Goto asdf2
    EndIf
  TextWindow.WriteLine("You start with 400 coins. Bet them to win more!")
Else
  Goto startofgame
EndIf
TextWindow.WriteLine("The game begins now!")
TextWindow.WriteLine("Type the number of coins that you want to bet.")
Goto asdf1
asdf2:
If a < 1 Then
  TextWindow.WriteLine("You're broke!!!")
  Goto ifbroke
EndIf
asdf3:
TextWindow.WriteLine("Type your bet. To superbet, press 's' Press 'q' to quit.")
whatbet = TextWindow.Read()
If whatbet="q" Then
  Goto appselect
  EndIf
g = a/22
If whatbet = "s" Then
    TextWindow.WriteLine("Type your superbet(more than " + g + ")")
    sb = TextWindow.ReadNumber()
  Else
    Goto nosuperbet
    If sb <= g Then
      TextWindow.WriteLine("That's not a superbet!")
      Goto asdf3 
    Else
      If (a - sb) < 0 Then
  TextWindow.WriteLine("You cheated!")
  Goto asdf2
Else
  If sb > g and (a - sb) > 0.1 then
    Goto superbet
  EndIf
  EndIf
EndIf
EndIf
superbet:
k = Math.GetRandomNumber(5)
  If k = 1 Then 
  a = (a*3) + 2*r
  Else
  EndIf
  If k = 2 Then 
  a = a + r*2.5
  Else
  a = (a*0.4) - r
EndIf
Goto writeA
nosuperbet:
asdf1:
r = TextWindow.ReadNumber()
If r = 0 then
  TextWindow.WriteLine("You cheated.")
  Goto asdf2
endif
If (a - r) < 0 Then
  TextWindow.WriteLine("You cheated.")
  Goto asdf2
    EndIf
j = Math.GetRandomNumber(2)
If k = 2 Then 
a = (a*0.8) - r
EndIf
If k = 1 Then 
  a = a + r*1.5
EndIf
EndIf
writeA:
TextWindow.ForegroundColor = "red"
TextWindow.WriteLine("You have " + a + " coins")
TextWindow.ForegroundColor = "white"
Goto asdf2
ifbroke:
TextWindow.WriteLine("Would you like to play again? Press 'e'!")
Goto start1
snake:
  Initialize()
TextWindow.Show()
GameState="Play"
StartGame()
While (GameState <> "")
  DoGameLoop()
EndWhile
GraphicsWindow.Hide()



Sub Initialize
  InitializeVariables()
  InitializeScreen()
EndSub

Sub InitializeVariables
  Array.SetValue("DeltaX","North",0)
  Array.SetValue("DeltaX","East",1)
  Array.SetValue("DeltaX","South",0)
  Array.SetValue("DeltaX","West",-1)
  Array.SetValue("DeltaY","North",-1)
  Array.SetValue("DeltaY","East",0)
  Array.SetValue("DeltaY","South",1)
  Array.SetValue("DeltaY","West",0)
  Array.SetValue("NorthFlag","North",1)
  Array.SetValue("NorthFlag","East",0)
  Array.SetValue("NorthFlag","South",0)
  Array.SetValue("NorthFlag","West",0)
  Array.SetValue("SouthFlag","North",0)
  Array.SetValue("SouthFlag","East",0)
  Array.SetValue("SouthFlag","South",1)
  Array.SetValue("SouthFlag","West",0)
  Array.SetValue("EastFlag","North",0)
  Array.SetValue("EastFlag","East",1)
  Array.SetValue("EastFlag","South",0)
  Array.SetValue("EastFlag","West",0)
  Array.SetValue("WestFlag","North",0)
  Array.SetValue("WestFlag","East",0)
  Array.SetValue("WestFlag","South",0)
  Array.SetValue("WestFlag","West",1)
  Array.SetValue("DirectionInput","N","North")
  Array.SetValue("DirectionInput","E","East")
  Array.SetValue("DirectionInput","S","South")
  Array.SetValue("DirectionInput","W","West")
  GameDelay = 100
  Score = 0
  HighScore = 0
  GameState = "TitleScreen"
  ScreenDirty = 1
' The following line could be harmful and has been automatically commented.
'   CurrentDirectory = Text.GetSubText(File.GetSettingsFilePath(),0,Text.GetLength(File.GetSettingsFilePath())-26)
EndSub

Sub InitializeScreen
  GraphicsWindow.Show()
  GraphicsWindow.Width = 640
  GraphicsWindow.Height = 480
  GraphicsWindow.KeyDown = HandleKeyPress
EndSub

Sub HandleTitleScreenKeyPress
  Key = GraphicsWindow.LastKey
  If (Key = "Escape") Then
    GameState=""
  Else
    If (Key="2") Then
      GameState = "Play"
      ScreenDirty = 1
    Else
      If (Key="1") Then
        GameState = "Instructions"
        ScreenDirty = 1
      EndIf
    EndIf
  EndIf
EndSub

Sub HandleInstructionsKeyPress
  Key = GraphicsWindow.LastKey
  If (Key = "Escape") Then
    GameState = "TitleScreen"
    ScreenDirty = 1
  EndIf
EndSub

Sub HandlePlayKeyPress
  Key = GraphicsWindow.LastKey
  If (Key = "Left") Then
    DirectionInput = DirectionInput + "W"
  Else
    If (Key = "Right") Then
      DirectionInput = DirectionInput + "E"
    Else
      If (Key = "Up") Then
        DirectionInput = DirectionInput + "N"
      Else
        If (Key = "Down") Then
          DirectionInput = DirectionInput + "S"
        EndIf
      EndIf
    EndIf
  EndIf
EndSub

Sub HandleGameOverKeyPress
  Key = GraphicsWindow.LastKey
  If (Key = "Escape") Then
    GameState=""
  Else
    If (Key="2") Then
      GameState = "Play"
      ScreenDirty = 1
    Else
      If (Key="1") Then
        GameState = "Instructions"
        ScreenDirty = 1
      EndIf
    EndIf
  EndIf
EndSub

Sub HandleKeyPress
  If (GameState="TitleScreen") Then
    HandleTitleScreenKeyPress()
  Else 
    If (GameState="Instructions") Then
      HandleInstructionsKeyPress()
    Else
      If (GameState="Play") Then
        HandlePlayKeyPress()
      Else
        If (GameState="GameOver") Then
          HandleGameOverKeyPress()
        Else
        EndIf
      EndIf
    EndIf
  EndIf    
EndSub

Sub DoTitleScreenLoop
  If (ScreenDirty = 1) Then
    ScreenDirty = 0
    GraphicsWindow.Clear()
    GraphicsWindow.BrushColor = "#000000"
    GraphicsWindow.FontSize = 32
    GraphicsWindow.DrawText(0,0,"SBSnake!")
    GraphicsWindow.FontSize = 16
    GraphicsWindow.DrawText(0,64,"F1 for instructions")
    GraphicsWindow.DrawText(0,80,"F2 for a new game")
    GraphicsWindow.DrawText(0,96,"esc to exit")
  EndIf
EndSub

Sub DoInstructionLoop
  If (ScreenDirty = 1) Then
    ScreenDirty = 0
    GraphicsWindow.Clear()
    GraphicsWindow.BrushColor = "#000000"
    GraphicsWindow.FontSize = 32
    GraphicsWindow.DrawText(0,0,"How To Play SBSnake!")
    GraphicsWindow.FontSize = 16
    GraphicsWindow.DrawText(0,64," to move snake.")
    GraphicsWindow.DrawText(0,80,"Don't hit the walls; don't hit your tail.")
    GraphicsWindow.DrawText(0,96,"Eat pellets to increase score.")
    GraphicsWindow.DrawText(0,112,"esc to return to main menu")
  EndIf
EndSub

Sub AddPellet
  PickPellet:
  PelletX = Math.GetRandomNumber(40)-1
  PelletY = Math.GetRandomNumber(30)-1
  Color = GraphicsWindow.GetPixel(PelletX * 16 + 8, PelletY * 16 + 8)
  If (Color = "#00FF00" Or Color="#FF0000") Then 
    Goto PickPellet
  EndIf
  GraphicsWindow.PenWidth = 0
  GraphicsWindow.BrushColor = "#FF0000"
  GraphicsWindow.FillRectangle(PelletX* 16+3, PelletY * 16+3,10,10)
EndSub

Sub DrawHead
  GraphicsWindow.PenWidth = 0
  GraphicsWindow.BrushColor = "#00FF00"
  GraphicsWindow.FillRectangle(SnakeHeadX * 16+2, SnakeHeadY * 16+2,12,12)
  If (Direction="South") Then
    GraphicsWindow.FillRectangle(SnakeHeadX * 16+4, SnakeHeadY*16,8,4)
  EndIf
  If (Direction="North") Then
    GraphicsWindow.FillRectangle(SnakeHeadX * 16+4, SnakeHeadY*16+12,8,4)
  EndIf
  If (Direction="East") Then
    GraphicsWindow.FillRectangle(SnakeHeadX * 16, SnakeHeadY*16+4,4,8)
  EndIf
  If (Direction="West") Then
    GraphicsWindow.FillRectangle(SnakeHeadX * 16+12, SnakeHeadY*16+4,4,8)
  EndIf
EndSub

Sub EraseHead
  If (GraphicsWindow.GetPixel(SnakeHeadX*16+8,SnakeHeadY*16)="#00FF00") Then
    NorthFlag = 1
  Else
    NorthFlag = Array.GetValue("NorthFlag",Direction)
  EndIf
  If (GraphicsWindow.GetPixel(SnakeHeadX*16+8,SnakeHeadY*16+15)="#00FF00") Then
    SouthFlag = 1
  Else
    SouthFlag = Array.GetValue("SouthFlag",Direction)
  EndIf
  If (GraphicsWindow.GetPixel(SnakeHeadX*16,SnakeHeadY*16+8)="#00FF00") Then
    WestFlag = 1
  Else
    WestFlag = Array.GetValue("WestFlag",Direction)
  EndIf
  If (GraphicsWindow.GetPixel(SnakeHeadX*16+15,SnakeHeadY*16+8)="#00FF00") Then
    EastFlag = 1
  Else
    EastFlag = Array.GetValue("EastFlag",Direction)
  EndIf
  GraphicsWindow.BrushColor = "#FFFFFF"
  GraphicsWindow.FillRectangle(SnakeHeadX * 16, SnakeHeadY*16,16,16)
  GraphicsWindow.BrushColor = "#00FF00"
  If (AtePellet = 1) Then
    GraphicsWindow.FillRectangle(SnakeHeadX * 16+3, SnakeHeadY*16+3,10,10)
  Else
    GraphicsWindow.FillRectangle(SnakeHeadX * 16+4, SnakeHeadY*16+4,8,8)
  EndIf
  If (NorthFlag = 1) Then
    GraphicsWindow.FillRectangle(SnakeHeadX * 16+4, SnakeHeadY*16,8,4)
  EndIf
  If (SouthFlag = 1) Then
    GraphicsWindow.FillRectangle(SnakeHeadX * 16+4, SnakeHeadY*16+12,8,4)
  EndIf
  If (WestFlag = 1) Then
    GraphicsWindow.FillRectangle(SnakeHeadX * 16, SnakeHeadY*16+4,4,8)
  EndIf
  If (EastFlag = 1) Then
    GraphicsWindow.FillRectangle(SnakeHeadX * 16+12, SnakeHeadY*16+4,4,8)
  EndIf
EndSub

Sub EraseTail
  If (GraphicsWindow.GetPixel(SnakeTailX*16+8,SnakeTailY*16)="#00FF00") Then
    NorthFlag = 1
  Else
    NorthFlag = 0
  EndIf
  If (GraphicsWindow.GetPixel(SnakeTailX*16+8,SnakeTailY*16+15)="#00FF00") Then
    SouthFlag = 1
  Else
    SouthFlag = 0
  EndIf
  If (GraphicsWindow.GetPixel(SnakeTailX*16,SnakeTailY*16+8)="#00FF00") Then
    WestFlag = 1
  Else
    WestFlag = 0
  EndIf
  If (GraphicsWindow.GetPixel(SnakeTailX*16+15,SnakeTailY*16+8)="#00FF00") Then
    EastFlag = 1
  Else
    EastFlag = 0
  EndIf
  GraphicsWindow.BrushColor = "#FFFFFF"
  GraphicsWindow.FillRectangle(SnakeTailX * 16, SnakeTailY*16,16,16)
  
  If (NorthFlag = 1) Then
    TailDirection = "North"
  EndIf
  If (SouthFlag = 1) Then
    TailDirection = "South"
  EndIf
  If (EastFlag = 1) Then
    TailDirection = "East"
  EndIf
  If (WestFlag = 1) Then
    TailDirection = "West"
  EndIf
  SnakeTailX = SnakeTailX + Array.GetValue("DeltaX",TailDirection)
  SnakeTailY = SnakeTailY + Array.GetValue("DeltaY",TailDirection)
  If (GraphicsWindow.GetPixel(SnakeTailX*16+3,SnakeTailY*16+3)="#00FF00") Then
    TailPellet = 1
  Else
    TailPellet = 0
  EndIf 
  If (GraphicsWindow.GetPixel(SnakeTailX*16+8,SnakeTailY*16)="#00FF00") Then
    NorthFlag = 1
  Else
    NorthFlag = 0
  EndIf
  If (GraphicsWindow.GetPixel(SnakeTailX*16+8,SnakeTailY*16+15)="#00FF00") Then
    SouthFlag = 1
  Else
    SouthFlag = 0
  EndIf
  If (GraphicsWindow.GetPixel(SnakeTailX*16,SnakeTailY*16+8)="#00FF00") Then
    WestFlag = 1
  Else
    WestFlag = 0
  EndIf
  If (GraphicsWindow.GetPixel(SnakeTailX*16+15,SnakeTailY*16+8)="#00FF00") Then
    EastFlag = 1
  Else
    EastFlag = 0
  EndIf
  If (TailDirection="North") Then
    SouthFlag = 0
  EndIf
  If (TailDirection="South") Then
    NorthFlag = 0
  EndIf
  If (TailDirection="East") Then
    WestFlag = 0
  EndIf
  If (TailDirection="West") Then
    EastFlag = 0
  EndIf
  GraphicsWindow.FillRectangle(SnakeTailX * 16, SnakeTailY*16,16,16)
  GraphicsWindow.BrushColor = "#00FF00"
  If (TailPellet = 1) Then
    GraphicsWindow.FillRectangle(SnakeTailX * 16+3, SnakeTailY*16+3,10,10)
  Else
    GraphicsWindow.FillRectangle(SnakeTailX * 16+4, SnakeTailY*16+4,8,8)
  EndIf
  If (NorthFlag = 1) Then
    GraphicsWindow.FillRectangle(SnakeTailX * 16+4, SnakeTailY*16,8,4)
  EndIf
  If (SouthFlag = 1) Then
    GraphicsWindow.FillRectangle(SnakeTailX * 16+4, SnakeTailY*16+12,8,4)
  EndIf
  If (WestFlag = 1) Then
    GraphicsWindow.FillRectangle(SnakeTailX * 16, SnakeTailY*16+4,4,8)
  EndIf
  If (EastFlag = 1) Then
    GraphicsWindow.FillRectangle(SnakeTailX * 16+12, SnakeTailY*16+4,4,8)
  EndIf
EndSub

Sub ProcessDirectionInput
  If (Text.GetLength(DirectionInput)>0) Then
    Temp = Text.GetSubText(DirectionInput,1,1)
    DirectionInput = Text.GetSubText(DirectionInput,1,Text.GetLength(DirectionInput)-1)
    Direction = Array.GetValue("DirectionInput",Temp)
  EndIf
EndSub

Sub StartGame
  Direction=""
  DirectionInput=""
  SnakeLength = 1
  SnakeMaximumLength = 4
  SnakeHeadX = 20
  SnakeHeadY = 15
  SnakeTailX = 20
  SnakeTailY = 15
  AtePellet = 0
  Score = 0
  GraphicsWindow.Clear()
  DrawHead()
  AddPellet()
  UpdateScore()
EndSub

Sub UpdateScore
  GraphicsWindow.Title = "SBSnake - "+Score
EndSub

Sub DoPlayLoop
  If (ScreenDirty = 1) Then
    ScreenDirty = 0
    StartGame()
  Else
    If (Direction <> "" Or DirectionInput<>"") Then
      ProcessDirectionInput()
      EraseHead()
      SnakeHeadX = SnakeHeadX + Array.GetValue("DeltaX",Direction)
      SnakeHeadY = SnakeHeadY + Array.GetValue("DeltaY",Direction)
      If (SnakeHeadX<0 Or SnakeHeadX>39 Or SnakeHeadY < 0 Or SnakeHeadY > 29) Then
        GameState = "GameOver"
        ScreenDirty = 1
      Else
        If (GraphicsWindow.GetPixel(SnakeHeadX*16+8,SnakeHeadY*16+8)="#FF0000") Then
          Score = Score + 1
          UpdateScore()
          AtePellet = 1
          SnakeMaximumLength = SnakeMaximumLength + 2
          AddPellet()
        Else
          AtePellet = 0
        EndIf
        If (GraphicsWindow.GetPixel(SnakeHeadX*16+8,SnakeHeadY*16+8)="#00FF00") Then
          GameState = "GameOver"
          DrawHead()
          ScreenDirty = 1
        Else
          SnakeLength = SnakeLength + 1
          DrawHead()
          While (SnakeLength>SnakeMaximumLength)
            EraseTail()
            SnakeLength = SnakeLength - 1
          EndWhile
          Program.Delay(GameDelay)
        EndIf
      EndIf
    EndIf
  EndIf
EndSub

Sub DoGameOverLoop
  If (ScreenDirty = 1) Then
    ScreenDirty = 0
    GraphicsWindow.BrushColor = "#000000"
    GraphicsWindow.FontSize = 32
    GraphicsWindow.DrawText(0,0,"Game Over!")
    GraphicsWindow.FontSize = 16
    GraphicsWindow.DrawText(0,64," for instructions")
    GraphicsWindow.DrawText(0,80," for a new game")
    GraphicsWindow.DrawText(0,96," to exit")
  EndIf
EndSub

Sub DoGameLoop
  If (GameState = "TitleScreen") Then
    DoTitleScreenLoop()
  Else
    If (GameState = "Instructions") Then
      DoInstructionLoop()
    Else
      If (GameState = "Play") Then
        DoPlayLoop()
      Else
        If (GameState = "GameOver") Then
          DoGameOverLoop()
        EndIf
      EndIf
    EndIf
  EndIf
EndSub
Goto appselect
airplane:
  ' Game area controls
gameWidth  = 1000
gameHeight = 800
fps = (Math.GetRandomNumber(50))+40
bgs = 2 'backgroundspeed
Player_Lives = 50

Path= "http://imode.free.fr/images1942/"

nbrisland = 0 'nomber of island images
islandcount = 0 'nomber of island in the wall field

' Window title
gameTitle = "1942, Score: "

GraphicsWindow.Hide()
GraphicsWindow.Title = gameTitle + "0"
GraphicsWindow.CanResize = "False"
GraphicsWindow.Width = gameWidth
GraphicsWindow.Height = gameHeight

'Presentation
' todo

' Start game
Init()
define_paths()
TimePlay = 0
pathNBR = 1
'create_enemies1()
Play()


' Setup world


Sub Init
  GraphicsWindow.Hide()
  
  Mouse.HideCursor()
  ' addImage in the right order is needed to define the shapes depth
  
  island4= ImageList.LoadImage(Path)
  island1= ImageList.LoadImage(Path)
  island2= ImageList.LoadImage(Path)
  island3= ImageList.LoadImage(Path)
  island5= ImageList.LoadImage(Path)
  player0 = ImageList.LoadImage(Path + "myplane1.png")
  background = ImageList.LoadImage(Path)
  bullet0 = ImageList.LoadImage(Path + "bullet.png")
  enemy= ImageList.LoadImage(Path + "enemy1.png")
  enemy2 = ImageList.LoadImage(Path + "enemy2.png")
  enemy_expl1=ImageList.LoadImage(Path + "explo1.png")
  enemy_expl2=ImageList.LoadImage(Path + "explo2.png")
  player_expl=ImageList.LoadImage(Path + "explo2.png")
  Enemy_bullet=ImageList.LoadImage(Path + "E_bullet.png")
  end = ImageList.LoadImage(Path + "End.png")
  
  
  
  enemy_Array = "EnemyArray" 'Array that contain all the enemies
  ' every enemy in tha array has 5 informations
  '  TimeLine: each enemy has its own timeline
  ' PathNBR: the precalculated path defineing the movement
  ' the movement is decomposed in LineNbr differents lines
  ' each line is define in the enemy_path table with rotation, deltaY and deltaY
  ' PositonX, PositonY: position in space
  '
  '
  enemy_TimeLine = "EnemyTimeLine"
  enemy_line = "enemyLineNbr"
  enemy_PosX = "enemyPositonX"
  enemy_PosY = "enemyPositonY"
  enemy_PathNBR="enemy_PathNBR"
  
  enemy_Nbr = 6
  enemy_Count = 0
  enemy_speed = 4
  'enemy_NextRemove = 1
  enemy_Life = 10
  player_size= 65
  enemy_size = 32
  enemy_ammo_size = 8
  player_bullet_size = 10
  
  island_Array = "Island array"
  IslandsPosition()
  create_level1()
  
  fond= Shapes.AddImage(background)
  Array.SetValue(island_Array,1,Shapes.AddImage(island1))
  Array.SetValue(island_Array,2,Shapes.AddImage(island2))
  Array.SetValue(island_Array,3,Shapes.AddImage(island3))
  Array.SetValue(island_Array,4,Shapes.AddImage(island4))
  Array.SetValue(island_Array,5,Shapes.AddImage(island5))
  For i = 6 to  islandcount 
    Array.SetValue(island_Array,i,Array.getValue(island_Array,Math.Remainder(i,4)))
  Endfor
  
  
  player = Shapes.AddImage(player0)
  GraphicsWindow.FontSize = 20
  GraphicsWindow.BackgroundColor = "Grey"
  GraphicsWindow.PenColor = "Yellow"
  
  Player_Ammo = "Player_AmmoArray"
  Player_load = 250
  Player_AmmoAge = "Player_AmmoAge"
  Player_AmmoMax = 100
  Player_AmmoCount = 5
  Player_Ammospeed = bgs + 90
  Player_AmmoLife = 50
  
  Enemy_Ammo = "Enemy_AmmoArray"
  Enemy_AmmoAge = "Enemy_AmmoAge"
  Enemy_Ammo_Angle="Enemy_Ammo_Angle"
  Enemy_AmmoMax = 10
  Enemy_AmmoCount = 0
  Enemy_Ammospeed = bgs + 30
  Enemy_AmmoLife = 300
  Enemy_Agresivity = 10
  score = 0
EndSub

' Main gane routine
Sub Play
  GraphicsWindow.Show()
  
  ' Main loop
  play = 1
  pause = 0
  incx =0   ' X-axis increment for background
  incy = 0  ' Y-axis increment for background
  incbx = 0  'increment for bullets and all objects on X
  incby = 0 'increment for bullets and all objects on Y
  squadron = 1
  ' Island initial position 
  j= 0
  
  
  For i= 1 To islandcount
    j=Math.Remainder(i,6)   
    posy[i]= islandPos[j][2]
    posx[i]= islandPos[j][3]
    incislandx[i] = 0
    incislandy[i] = 0  
  EndFor
  TimePlay = 0
  Shapes.Move(player, gameWidth/2 , gameHeight -80 ) 
  While(play = 1)
    Program.Delay(1000/fps)
    TimePlay = TimePlay +1
    
    If (pause = 0) Then
      If (TimePlay = level1[squadron][1]) then 
        
        pathNBR = level1[squadron][2]
        enemyPosX1 = level1[squadron][3]  'X position
        enemyPosY1 = level1[squadron][4]  'Y position
        enemy_Nbr = level1[squadron][6]
        enemy_type = level1[squadron][7]
        if (level1[squadron][5]=1) then
          create_enemies_left()
        Else
          create_enemies_right()
        endif
        squadron = squadron + 1
      endif
      If (TimePlay > 4000) then
        Shapes.Move(Shapes.addImage(end), 230,200)
        Program.Delay(5000)
        GraphicsWindow.Hide()
      Endif
      moveall()
            GraphicsWindow.MouseMove = OnMouseMove
      GraphicsWindow.TextInput = OnKeyDown
      GraphicsWindow.MouseDown = OnMouseDown
      AgePlayer_Ammo() 
      If Player_load <= 0 then
        GraphicsWindow.Hide()
      EndIf      
    EndIf
  EndWhile
  
EndSub


Sub OnMouseMove 
  paddleX = GraphicsWindow.MouseX - player_size/2
  paddleY = GraphicsWindow.MouseY- player_size 
  
  If (paddleX < 0) then
    paddleX = 0
  endif
  Shapes.Move(player, paddleX , paddleY ) 
EndSub
Sub OnMouseDown
  Player_Ammospeed = bgs +8
  ShootX = GraphicsWindow.MouseX - 15 ' in order to be from the neck of the plane
  ShootY = GraphicsWindow.MouseY - 80
  Player_load = Player_load - 1
  Fire()
  
  
EndSub
Sub OnKeyDown
  Player_Ammospeed = bgs +8
  ShootX = GraphicsWindow.MouseX - 15 ' in order to be from the neck of the plane
  ShootY = GraphicsWindow.MouseY - 80
  Player_load = Player_load - 1
  Fire2()
  
  
EndSub

Sub moveall
  incbx = 0
  incby =0
  GraphicsWindow.Title = gameTitle + score +"    Lives:"+Player_Lives + "Ammo:" +Player_load
  
  
  If (paddleX >(gameWidth-62) ) Then
    incx = incx - bgs
    incbx = incbx - bgs
    For i= 1 To islandcount
      incislandx[i] = incislandx[i] - bgs
    EndFor
    If (incx = -32 ) Then   
      incx =0
    Endif
  Endif 
  If (paddleX < 64 ) Then
    incx = incx + bgs
    incbx = incbx + bgs
    For i= 1 To islandcount
      incislandx[i] = incislandx[i] + bgs
    EndFor
    If (incx = 32 ) Then   
      incx =0
    Endif
  Endif 
  Shapes.Move(fond,incx -32 ,incy - 32)
  
  For i= 1 To islandcount
    islx = posx[i]+incislandx[i]
    isly = posy[i]+incislandy[i]
    Shapes.Move(Array.GetValue(island_Array,i),islx,isly)
  EndFor
  
  incy = incy + bgs
  incby = incby+ bgs
  For i= 1 To islandcount
    incislandy[i] = incislandy[i] + bgs
  EndFor
  
  If (incy = 32) Then   
    incy =0
  Endif
  
  For i= 1 To islandcount
    If ((posy[i]+incislandy[i]) > (gameHeight+15)) Then 'relaunch island if no more visible
      R= Math.Round(Math.GetRandomNumber(nbrisland))
      AA = Math.Remainder(TimePlay,6)
      'give new coordinates
      posx[i]= islandPos[AA][2]
      posy[i]= islandPos[AA][3]       
      Shapes.move(Array.GetValue(island_Array,R),posx[i],posy[i])
      incislandy[i]=0
      incislandx[i]=0
    EndIf
  ENDFOR
  ' Move playerammo
  For i = 1 To Player_AmmoCount
    Player_Ammox = Shapes.GetLeft(Array.GetValue(Player_Ammo, i)) +incbx 
    Player_Ammoy = Shapes.GetTop(Array.GetValue(Player_Ammo, i)) - Player_Ammospeed
    Shapes.Move(Array.GetValue(Player_Ammo, i), Player_Ammox, Player_Ammoy)
    Array.SetValue(Player_AmmoAge, i, Array.GetValue(Player_AmmoAge, i) + 1)
  EndFor 
  ' Move Enemy ammo
  For iea = 1 To Enemy_AmmoCount
    dx =(Math.Sin((Array.GetValue(Enemy_Ammo_Angle, iea) )) * Enemy_Ammospeed)
    dy =(Math.Cos((Array.GetValue(Enemy_Ammo_Angle, iea) ))* Enemy_Ammospeed)
    Enemy_Ammox = Shapes.GetLeft(Array.GetValue(Enemy_Ammo, iea)) +dx+incbx 
    Enemy_Ammoy = Shapes.GetTop(Array.GetValue(Enemy_Ammo, iea)) +dy+incby*0.1
    Shapes.Move(Array.GetValue(Enemy_Ammo, iea), Enemy_Ammox, Enemy_Ammoy)
    Array.SetValue(Enemy_AmmoAge, iea, Array.GetValue(Enemy_AmmoAge, iea) + 1)
  EndFor 
  
  
  ' move ennemies
  For i=1 To enemy_Count
    ' move as TimeLine and Path say
    eNBR= Array.GetValue(enemy_PathNBR,i)
    uu =Array.GetValue(enemy_line,i)
    Time= Array.GetValue(enemy_TimeLine, i)
    etl=enemyPath[eNBR][1][uu]  'enemy own timeLine
    IF (Time=etl) Then  'it's time to rotate enemy
      rr = enemyPath[eNBR][2][uu+1]
      Shapes.Rotate(Array.GetValue(enemy_Array,i),rr)
    EndIf
    IF (Time > etl)  Then
      uu = uu+1
      Array.SetValue(enemy_line,i,uu)    ' next line for enemy move
    EndIf   
    xx1=Array.GetValue(enemy_PosX,i)
    yy1= Array.GetValue(enemy_PosY,i)
    xx = xx1+enemyPath[eNBR][3][uu]+incbx
    yy = yy1+enemyPath[eNBR][4][uu]+incby*0.1
    ' Randomly fire-enemy
    If (Math.GetRandomNumber(Enemy_Agresivity)=1) Then
      Enemy_ShootX = xx1 + 16
      Enemy_ShootY = yy1 + 4
      If (yy1 > 0 AND xx1 > 0 And yy1< gameHeight And xx1 < gameWidth) then
        'this avoid enemy fire from outside the screen
        fire_Enemy()
      Endif
    EndIf  
    
    Shapes.Move(Array.GetValue(enemy_Array,i),xx,yy)
    Array.SetValue(enemy_PosX,i,xx)
    Array.SetValue(enemy_PosY,i,yy)
    Array.SetValue(enemy_TimeLine, i, Time + 1)
    If ((uu > enemyPath[eNBR][0][0]) And (Time > etl)) Then ' if last timelife remove the enemy sprite  
      next_enemy_remove = i 
      remove_enemy()
    endif
    Collision_pbe()  
    Collision_ep()
  EndFor
  
  
EndSub


Sub RemovePlayer_Ammo
  Shapes.Remove(Array.GetValue(Player_Ammo, Player_Ammo_nextRemove))
  For iz = Player_Ammo_nextRemove To Player_AmmoCount - 1
    Array.SetValue(Player_Ammo, iz, Array.GetValue(Player_Ammo, iz+1))
    Array.SetValue(Player_AmmoAge, iz, Array.GetValue(Player_AmmoAge, iz+1))
  EndFor
  Array.RemoveValue(Player_Ammo, Player_AmmoCount)
  Array.RemoveValue(Player_AmmoAge, Player_AmmoCount)
  Player_AmmoCount = Player_AmmoCount - 1
EndSub

Sub RemoveEnemy_Ammo
  Shapes.Remove(Array.GetValue(Enemy_Ammo, Enemy_Ammo_nextRemove))
  For irea = Enemy_Ammo_nextRemove To Enemy_AmmoCount - 1
    Array.SetValue(Enemy_Ammo, irea, Array.GetValue(Enemy_Ammo, irea+1))
    Array.SetValue(Enemy_AmmoAge, irea, Array.GetValue(Enemy_AmmoAge, irea+1))
    Array.SetValue(Enemy_Ammo_Angle, irea, Array.GetValue(Enemy_Ammo_Angle,irea+1))
    
  EndFor
  Array.RemoveValue(Enemy_Ammo, Enemy_AmmoCount)
  Array.RemoveValue(Enemy_AmmoAge, Enemy_AmmoCount)
  Array.RemoveValue(Enemy_Ammo_Angle,Enemy_AmmoCount)
  Enemy_AmmoCount = Enemy_AmmoCount - 1
EndSub

Sub fire
  ' Remove additional player Ammo
  While(Player_AmmoCount > Player_AmmoMax )
    Player_Ammo_nextRemove = 1
    RemovePlayer_Ammo()
  EndWhile
  
  ' Add the player Ammo
  
  Player_AmmoCount = Player_AmmoCount + 1
  Array.SetValue(Player_Ammo, Player_AmmoCount, Shapes.AddImage(bullet0))
  Shapes.Move(Array.GetValue(Player_Ammo, Player_AmmoCount), ShootX, ShootY)
EndSub
Sub fire2
  While(Player_AmmoCount > Player_AmmoMax )
    Player_Ammo_nextRemove = 1
    RemovePlayer_Ammo()
  EndWhile
  
  ' Add the player Ammo
  
  Player_AmmoCount = Player_AmmoCount + 1
  Array.SetValue(Player_Ammo, Player_AmmoCount, Shapes.AddImage(bullet0))
  Shapes.Move(Array.GetValue(Player_Ammo, Player_AmmoCount), ShootX, ShootY)
EndSub

Sub fire_Enemy
  ' Remove additional Enemy Ammo
  While(Enemy_AmmoCount > (Enemy_AmmoMax - 1))
    Enemy_Ammo_nextRemove = 1
    RemoveEnemy_Ammo()
  EndWhile
  
  ' Add the Enemy Ammo
  
  Enemy_AmmoCount = Enemy_AmmoCount + 1
  Array.SetValue(Enemy_Ammo, Enemy_AmmoCount, Shapes.AddImage(Enemy_bullet))
  Array.SetValue(Enemy_Ammo_Angle, Enemy_AmmoCount,Math.ArcTan((paddleX- Enemy_ShootX+player_size/2)/(paddleY-Enemy_ShootY)))
  Shapes.Move(Array.GetValue(Enemy_Ammo, Enemy_AmmoCount), Enemy_ShootX, Enemy_ShootY)
EndSub


'Check playerammo age
Sub AgePlayer_Ammo
  While (Array.GetValue(Player_AmmoAge, 1) > Player_AmmoLife)
    Player_Ammo_nextRemove = 1
    RemovePlayer_Ammo()
  EndWhile
EndSub
'Check enemy ammo age
Sub AgeEnemy_Ammo
  While (Array.GetValue(Enemy_AmmoAge, 1) > Enemy_AmmoLife)
    Enemy_Ammo_nextRemove = 1
    RemoveEnemy_Ammo()
  EndWhile
EndSub

Sub remove_enemy
  Shapes.remove(Array.GetValue(enemy_Array,next_enemy_remove))
  ' Remove all references from the arrays
  For ii = next_enemy_remove To enemy_Count - 1
    Array.SetValue(enemy_Array, ii, Array.GetValue(enemy_Array, ii+1))
    Array.SetValue(enemy_line, ii, Array.GetValue(enemy_line, ii+1))
    Array.SetValue(enemy_PosX, ii, Array.GetValue(enemy_PosX, ii+1))
    Array.SetValue(enemy_PosY, ii, Array.GetValue(enemy_PosY, ii+1))
    Array.SetValue(enemy_TimeLine, ii, Array.GetValue(enemy_TimeLine, ii+1)) 
    Array.SetValue(enemy_PathNBR, ii , Array.GetValue(enemy_PathNBR, ii+1))
  EndFor
  Array.RemoveValue(enemy_Array, enemy_Count)
  Array.RemoveValue(enemy_line, enemy_Count)
  Array.RemoveValue(enemy_PosX, enemy_Count)
  Array.RemoveValue(enemy_PosY, enemy_Count)
  Array.RemoveValue(enemy_TimeLine, enemy_Count)
  Array.RemoveValue(enemy_PathNBR,enemy_Count) 
  enemy_Count = enemy_Count - 1
EndSub

Sub create_enemies_left
  
  TimeLine1 =0
  For i=1 To enemy_Nbr
    enemy_Count= enemy_Count + 1  
    Array.SetValue(enemy_PathNBR,enemy_Count,pathNBR)
    If (enemy_type = 2) Then
      Array.SetValue(enemy_Array, enemy_Count,Shapes.AddImage(enemy2))
    Else
      Array.SetValue(enemy_Array, enemy_Count,Shapes.AddImage(enemy))
    EndIf
    Array.SetValue(enemy_line,enemy_Count,1)
    Array.SetValue(enemy_PosX, enemy_Count,enemyPosX1)
    Array.SetValue(enemy_PosY, enemy_Count,enemyPosY1)
    Array.SetValue(enemy_TimeLine, enemy_Count, TimeLine1)
    
    enemyPosX1 = enemyPosX1 - 64 'distance between ennemies
    TimeLine1 = TimeLine1 - 64 / enemy_speed
  EndFor
  For i=(enemy_Count-enemy_Nbr+1) To enemy_Count
    xxx=Array.GetValue(enemy_PosX,i)
    yyy= Array.GetValue(enemy_PosY,i)
    Shapes.Move(Array.GetValue(enemy_Array,i),xxx,yyy)
  EndFor
EndSub
Sub create_enemies_right
  
  TimeLine1 =0
  For i=1 To enemy_Nbr
    enemy_Count= enemy_Count + 1  
    Array.SetValue(enemy_PathNBR,enemy_Count,pathNBR)
    Array.SetValue(enemy_Array, enemy_Count,Shapes.AddImage(enemy))
    Array.SetValue(enemy_line,enemy_Count,1)
    Array.SetValue(enemy_PosX, enemy_Count,enemyPosX1)
    Array.SetValue(enemy_PosY, enemy_Count,enemyPosY1)
    Array.SetValue(enemy_TimeLine, enemy_Count, TimeLine1)
    
    enemyPosX1 = enemyPosX1 + 64 'distance between ennemies
    TimeLine1 = TimeLine1 - 64 / enemy_speed
  EndFor
  For i=(enemy_Count-enemy_Nbr+1) To enemy_Count
    xxx=Array.GetValue(enemy_PosX,i)
    yyy= Array.GetValue(enemy_PosY,i)
    Shapes.Move(Array.GetValue(enemy_Array,i),xxx,yyy)
  EndFor
EndSub
Sub Collision_pbe   'for player-bullet and enemies
  
  For i1 = 1 To Player_AmmoCount
    '  player bullet position
    Player_Ammox = Shapes.GetLeft(Array.GetValue(Player_Ammo, i1)) 
    Player_Ammoy = Shapes.GetTop(Array.GetValue(Player_Ammo, i1)) 
    px1=Player_Ammox+player_bullet_size/3   'in order to have a more precise collison than the bullet image size
    py1=Player_Ammoy+player_bullet_size/3
    px2=px1+2*player_bullet_size/3
    py2=py1+2*player_bullet_size/3
    
    For i2 = 1 to enemy_Count
      '  enemy position   
      
      ax1=Array.GetValue(enemy_PosX,i2)+enemy_size/4
      ay1=Array.GetValue(enemy_PosY,i2)+enemy_size/4
      
      ax2=ax1+3*enemy_size/4
      ay2=ay1+3*enemy_size/4
      
      
      If ( (ax1 < px1 And ax2 > px1) Or (ax1 < px2 And ax2 > px2) ) Then
        If ( (ay1 < py1 And ay2 > py1) Or (ay1 < py2 And ay2 > py2) ) Then
          '        collision between enemy nbr i2 and player bullet i
          '        remove bullet i and animate explosion and remove enemy i2
          Player_Ammo_nextRemove = i1
          RemovePlayer_Ammo()
          next_enemy_remove = i2
          remove_enemy() 
          ' begin animation for explosion at coordinate ax1, ay1
          toto= Shapes.AddImage(enemy_expl1)
          Shapes.move(toto,ax1,ay1)
          Program.Delay(30)
          Shapes.Remove(toto)
          toto= Shapes.AddImage(enemy_expl2)
          Shapes.move(toto,ax1,ay1)
          Program.Delay(30)
          Shapes.Remove(toto)
          score = score +100
        EndIf
      EndIf
    EndFor
    
  Endfor
  
EndSub


Sub Collision_ep   'for enemies and player   
  px1 = Shapes.GetLeft(player)
  py1 = Shapes.GetTop(player)
  px2 = px1 + player_size
  py2 = py1 + player_size 
  
  
  'Shapes.Move(Shapes.AddRectangle(px2-px1 ,py2-py1), px1, py1)
  For i2 = 1 to enemy_Count
    '  enemy position   
    
    ax1=Array.GetValue(enemy_PosX,i2)
    ay1=Array.GetValue(enemy_PosY,i2)
    
    ax2=ax1+enemy_size
    ay2=ay1+enemy_size
    'Shapes.Move(Shapes.AddRectangle(ax2-ax1 ,ay2-ay1), ax1, ay1)    
    
    If ( (px1 < ax1 And px2 > ax1) Or (px1 < ax2 And px2 > ax2) ) Then
      If ( (py1 < ay1 And py2 > ay1) Or (py1 < ay2 And py2 > ay2) ) Then
        '        collision between enemy nbr i2 and player 
        '        animate explosion and decrease lives
        next_enemy_remove = i2
        remove_enemy() 
        ' begin animation for explosion at coordinate ax1, ay1
        toto= Shapes.AddImage(enemy_expl1)
        Shapes.move(toto,ax1,ay1)
        Program.Delay(10)
        Shapes.Remove(toto)
        toto= Shapes.AddImage(player_expl)
        Shapes.move(toto,ax1,ay1)
        Program.Delay(10)
        Shapes.Remove(toto)
        Player_Lives = Player_Lives -1
        If (Player_Lives = 0) THEN
          GraphicsWindow.Hide()
        EndIf
      EndIf
    EndIf
  EndFor  
  px1 = paddleX
  py1 = paddleY
  px2 = px1 + player_size
  py2 = py1 + player_size
  'Shapes.Move(Shapes.AddRectangle(px2-px1 ,py2-py1), px1, py1)
  For i3 = 1 to Enemy_AmmoCount
    '  enemy position   
    
    ax1=Shapes.GetLeft(Array.GetValue(enemy_Ammo,i3))
    ay1=Shapes.GetTop(Array.GetValue(enemy_Ammo,i3))
    
    ax2=ax1+enemy_ammo_size
    ay2=ay1+enemy_ammo_size
    'Shapes.Move(Shapes.AddRectangle(ax2-ax1 ,ay2-ay1), ax1, ay1)     
    
    If ( (px1 < ax1 And px2 > ax1) Or (px1 < ax2 And px2 > ax2) ) Then
      If ( (py1 < ay1 And py2 > ay1) Or (py1 < ay2 And py2 > ay2) ) Then
        '        collision between enemy ammo nbr i3 and player 
        '        animate explosion and decrease lives
        Enemy_Ammo_nextRemove = i3
        RemoveEnemy_Ammo()
        
        ' begin animation for explosion at coordinate ax1, ay1
        toto= Shapes.AddImage(enemy_expl1)
        Shapes.move(toto,paddleX+ player_size/2,paddleY+ player_size/2)
        Program.Delay(10)
        Shapes.Remove(toto)
        toto= Shapes.AddImage(player_expl)
        Shapes.move(toto,paddleX+ player_size/2,paddleY+ player_size/2)
        Program.Delay(10)
        Shapes.Remove(toto)
        Player_Lives = Player_Lives -1
        If (Player_Lives = 0) THEN
          GraphicsWindow.Hide()
        EndIf
      EndIf
    EndIf
  EndFor  
  
EndSub


Sub IslandsPosition
  ' island positions, avoid randomGeneration and islands overlap 
  islandPos[0][1]=1
  islandPos[0][2]=0
  islandPos[0][3]=-150
  
  islandPos[1][1]=1
  islandPos[1][2]=-Math.Round(gameWidth/2)
  islandPos[1][3]=-150
  
  islandPos[2][1]=2
  islandPos[2][2]=-2*Math.Round(gameWidth/3)
  islandPos[2][3]=-150
  
  islandPos[3][1]=1 
  islandPos[3][2]=2*Math.Round(gameWidth/3)
  islandPos[3][3]=-150
  
  islandPos[4][1]=2 
  islandPos[4][2]=gameWidth
  islandPos[4][3]=-150
  
  islandPos[5][1]=3
  islandPos[5][2]=Math.Round(gameWidth/3)
  islandPos[5][3]=-150
  
  islandPos[6][1]=3
  islandPos[6][2]=-gameWidth
  islandPos[6][3]=-150
EndSub


Sub define_paths
  enemyPath[0][0][0] = 3  'nbr of strait lines of path
  enemyPath[0][1][1] = 30  'from 0 to this in timeline
  enemyPath[0][1][2] = 100 ' from this  to next in timeline
  enemyPath[0][1][3] = 400   'sprite goes up
  
  enemyPath[0][2][1] = 0 'first line rotation = 0
  enemyPath[0][2][2] = 45 ' second line rotation = 45
  enemyPath[0][2][3] = 45
  
  enemyPath[0][3][1] = enemy_speed ' first line x movment
  enemyPath[0][3][2] = enemy_speed 'second line x movment
  enemyPath[0][3][3] = enemy_speed ' third line ...
  
  enemyPath[0][4][1] = 0 ' first line y movment
  enemyPath[0][4][2] = enemy_speed 
  enemyPath[0][4][3] = enemy_speed
  '---------- second path
  enemyPath[1][0][0] = 4  
  enemyPath[1][1][1] = 1  
  enemyPath[1][1][2] = 1
  enemyPath[1][1][3] = 100  
  enemyPath[1][1][4] = 400
  
  enemyPath[1][2][1] = 180 
  enemyPath[1][2][2] = 135 
  enemyPath[1][2][3] = 135
  enemyPath[1][2][4] = 90
  
  enemyPath[1][3][1] = -enemy_speed 
  enemyPath[1][3][2] = -enemy_speed 
  enemyPath[1][3][3] = -enemy_speed
  enemyPath[1][3][4] = 0
  
  enemyPath[1][4][1] = 0 
  enemyPath[1][4][2] = 0 
  enemyPath[1][4][3] = enemy_speed
  enemyPath[1][4][4] = enemy_speed
  'round r=5
  enemyPath[2][0][0]=21    
  enemyPath[2][1][1]=50
  enemyPath[2][1][2]=55
  enemyPath[2][1][3]=60
  enemyPath[2][1][4]=65
  enemyPath[2][1][5]=70
  enemyPath[2][1][6]=75
  enemyPath[2][1][7]=80
  enemyPath[2][1][8]=85
  enemyPath[2][1][9]=90
  enemyPath[2][1][10]=95
  enemyPath[2][1][11]=100
  enemyPath[2][1][12]=105
  enemyPath[2][1][13]=110
  enemyPath[2][1][14]=115
  enemyPath[2][1][15]=120
  enemyPath[2][1][16]=125
  enemyPath[2][1][17]=130
  enemyPath[2][1][18]=135
  enemyPath[2][1][19]=140
  enemyPath[2][1][20]=145
  enemyPath[2][1][21]=350
  enemyPath[2][2][1]=0
  enemyPath[2][2][2]=18
  enemyPath[2][2][3]=36
  enemyPath[2][2][4]=54
  enemyPath[2][2][5]=72
  enemyPath[2][2][6]=90
  enemyPath[2][2][7]=108
  enemyPath[2][2][8]=126
  enemyPath[2][2][9]=144
  enemyPath[2][2][10]=162
  enemyPath[2][2][11]=180
  enemyPath[2][2][12]=198
  enemyPath[2][2][13]=216
  enemyPath[2][2][14]=234
  enemyPath[2][2][15]=252
  enemyPath[2][2][16]=-90
  enemyPath[2][2][17]=-72
  enemyPath[2][2][18]=-54
  enemyPath[2][2][19]=-36
  enemyPath[2][2][20]=-18
  enemyPath[2][2][21]=0
  enemyPath[2][3][1]=enemy_speed
  enemyPath[2][3][2]=0.95*enemy_speed
  enemyPath[2][3][3]=0.81*enemy_speed
  enemyPath[2][3][4]=0.59*enemy_speed
  enemyPath[2][3][5]=0.31*enemy_speed
  enemyPath[2][3][6]=0
  enemyPath[2][3][7]=-0.31*enemy_speed
  enemyPath[2][3][8]=-0.59*enemy_speed
  enemyPath[2][3][9]=-0.81*enemy_speed
  enemyPath[2][3][10]=-0.95*enemy_speed
  enemyPath[2][3][11]=-enemy_speed
  enemyPath[2][3][12]=-0.95*enemy_speed
  enemyPath[2][3][13]=-0.81*enemy_speed
  enemyPath[2][3][14]=-0.59*enemy_speed
  enemyPath[2][3][15]=-0.31*enemy_speed
  enemyPath[2][3][16]=0
  enemyPath[2][3][17]=0.31*enemy_speed
  enemyPath[2][3][18]=0.59*enemy_speed
  enemyPath[2][3][19]=0.81*enemy_speed
  enemyPath[2][3][20]=0.95*enemy_speed
  enemyPath[2][3][21]=enemy_speed
  enemyPath[2][4][1]=0
  enemyPath[2][4][2]=0.31*enemy_speed
  enemyPath[2][4][3]=0.59*enemy_speed
  enemyPath[2][4][4]=0.81*enemy_speed
  enemyPath[2][4][5]=0.95*enemy_speed
  enemyPath[2][4][6]=enemy_speed
  enemyPath[2][4][7]=0.95*enemy_speed
  enemyPath[2][4][8]=0.81*enemy_speed
  enemyPath[2][4][9]=0.59*enemy_speed
  enemyPath[2][4][10]=0.31*enemy_speed
  enemyPath[2][4][11]=0
  enemyPath[2][4][12]=-0.31*enemy_speed
  enemyPath[2][4][13]=-0.59*enemy_speed
  enemyPath[2][4][14]=-0.81*enemy_speed
  enemyPath[2][4][15]=-0.95*enemy_speed
  enemyPath[2][4][16]=-enemy_speed
  enemyPath[2][4][17]=-0.95*enemy_speed
  enemyPath[2][4][18]=-0.81*enemy_speed
  enemyPath[2][4][19]=-0.59*enemy_speed
  enemyPath[2][4][20]=-0.31*enemy_speed
  enemyPath[2][4][21]=0   
  'round r=20
  enemyPath[3][0][0]=21    
  enemyPath[3][1][1]=120
  enemyPath[3][1][2]=140
  enemyPath[3][1][3]=160
  enemyPath[3][1][4]=180
  enemyPath[3][1][5]=200
  enemyPath[3][1][6]=220
  enemyPath[3][1][7]=240
  enemyPath[3][1][8]=260
  enemyPath[3][1][9]=280
  enemyPath[3][1][10]=300
  enemyPath[3][1][11]=320
  enemyPath[3][1][12]=340
  enemyPath[3][1][13]=360
  enemyPath[3][1][14]=380
  enemyPath[3][1][15]=400
  enemyPath[3][1][16]=420
  enemyPath[3][1][17]=440
  enemyPath[3][1][18]=460
  enemyPath[3][1][19]=480
  enemyPath[3][1][20]=500
  enemyPath[3][1][21]=600
  enemyPath[3][2][1]=0
  enemyPath[3][2][2]=18
  enemyPath[3][2][3]=36
  enemyPath[3][2][4]=54
  enemyPath[3][2][5]=72
  enemyPath[3][2][6]=90
  enemyPath[3][2][7]=108
  enemyPath[3][2][8]=126
  enemyPath[3][2][9]=144
  enemyPath[3][2][10]=162
  enemyPath[3][2][11]=180
  enemyPath[3][2][12]=198
  enemyPath[3][2][13]=216
  enemyPath[3][2][14]=234
  enemyPath[3][2][15]=252
  enemyPath[3][2][16]=-90
  enemyPath[3][2][17]=-72
  enemyPath[3][2][18]=-54
  enemyPath[3][2][19]=-36
  enemyPath[3][2][20]=-18
  enemyPath[3][2][21]=0
  enemyPath[3][3][1]=enemy_speed
  enemyPath[3][3][2]=0.95*enemy_speed
  enemyPath[3][3][3]=0.81*enemy_speed
  enemyPath[3][3][4]=0.59*enemy_speed
  enemyPath[3][3][5]=0.31*enemy_speed
  enemyPath[3][3][6]=0
  enemyPath[3][3][7]=-0.31*enemy_speed
  enemyPath[3][3][8]=-0.59*enemy_speed
  enemyPath[3][3][9]=-0.81*enemy_speed
  enemyPath[3][3][10]=-0.95*enemy_speed
  enemyPath[3][3][11]=-enemy_speed
  enemyPath[3][3][12]=-0.95*enemy_speed
  enemyPath[3][3][13]=-0.81*enemy_speed
  enemyPath[3][3][14]=-0.59*enemy_speed
  enemyPath[3][3][15]=-0.31*enemy_speed
  enemyPath[3][3][16]=0
  enemyPath[3][3][17]=0.31*enemy_speed
  enemyPath[3][3][18]=0.59*enemy_speed
  enemyPath[3][3][19]=0.81*enemy_speed
  enemyPath[3][3][20]=0.95*enemy_speed
  enemyPath[3][3][21]=enemy_speed
  enemyPath[3][4][1]=0
  enemyPath[3][4][2]=0.31*enemy_speed
  enemyPath[3][4][3]=0.59*enemy_speed
  enemyPath[3][4][4]=0.81*enemy_speed
  enemyPath[3][4][5]=0.95*enemy_speed
  enemyPath[3][4][6]=enemy_speed
  enemyPath[3][4][7]=0.95*enemy_speed
  enemyPath[3][4][8]=0.81*enemy_speed
  enemyPath[3][4][9]=0.59*enemy_speed
  enemyPath[3][4][10]=0.31*enemy_speed
  enemyPath[3][4][11]=0
  enemyPath[3][4][12]=-0.31*enemy_speed
  enemyPath[3][4][13]=-0.59*enemy_speed
  enemyPath[3][4][14]=-0.81*enemy_speed
  enemyPath[3][4][15]=-0.95*enemy_speed
  enemyPath[3][4][16]=-enemy_speed
  enemyPath[3][4][17]=-0.95*enemy_speed
  enemyPath[3][4][18]=-0.81*enemy_speed
  enemyPath[3][4][19]=-0.59*enemy_speed
  enemyPath[3][4][20]=-0.31*enemy_speed
  enemyPath[3][4][21]=0
  
  'round r=10
  enemyPath[4][0][0]=21
  enemyPath[4][1][1]=110
  enemyPath[4][1][2]=120
  enemyPath[4][1][3]=130
  enemyPath[4][1][4]=140
  enemyPath[4][1][5]=150
  enemyPath[4][1][6]=160
  enemyPath[4][1][7]=170
  enemyPath[4][1][8]=180
  enemyPath[4][1][9]=190
  enemyPath[4][1][10]=200
  enemyPath[4][1][11]=210
  enemyPath[4][1][12]=220
  enemyPath[4][1][13]=230
  enemyPath[4][1][14]=240
  enemyPath[4][1][15]=250
  enemyPath[4][1][16]=260
  enemyPath[4][1][17]=270
  enemyPath[4][1][18]=280
  enemyPath[4][1][19]=290
  enemyPath[4][1][20]=300
  enemyPath[4][1][21]=500  
  enemyPath[4][2][1]=0
  enemyPath[4][2][2]=18
  enemyPath[4][2][3]=36
  enemyPath[4][2][4]=54
  enemyPath[4][2][5]=72
  enemyPath[4][2][6]=90
  enemyPath[4][2][7]=108
  enemyPath[4][2][8]=126
  enemyPath[4][2][9]=144
  enemyPath[4][2][10]=162
  enemyPath[4][2][11]=180
  enemyPath[4][2][12]=198
  enemyPath[4][2][13]=216
  enemyPath[4][2][14]=234
  enemyPath[4][2][15]=252
  enemyPath[4][2][16]=-90
  enemyPath[4][2][17]=-72
  enemyPath[4][2][18]=-54
  enemyPath[4][2][19]=-36
  enemyPath[4][2][20]=-18
  enemyPath[4][2][21]=0
  enemyPath[4][3][1]=enemy_speed
  enemyPath[4][3][2]=0.95*enemy_speed
  enemyPath[4][3][3]=0.81*enemy_speed
  enemyPath[4][3][4]=0.59*enemy_speed
  enemyPath[4][3][5]=0.31*enemy_speed
  enemyPath[4][3][6]=0
  enemyPath[4][3][7]=-0.31*enemy_speed
  enemyPath[4][3][8]=-0.59*enemy_speed
  enemyPath[4][3][9]=-0.81*enemy_speed
  enemyPath[4][3][10]=-0.95*enemy_speed
  enemyPath[4][3][11]=-enemy_speed
  enemyPath[4][3][12]=-0.95*enemy_speed
  enemyPath[4][3][13]=-0.81*enemy_speed
  enemyPath[4][3][14]=-0.59*enemy_speed
  enemyPath[4][3][15]=-0.31*enemy_speed
  enemyPath[4][3][16]=0
  enemyPath[4][3][17]=0.31*enemy_speed
  enemyPath[4][3][18]=0.59*enemy_speed
  enemyPath[4][3][19]=0.81*enemy_speed
  enemyPath[4][3][20]=0.95*enemy_speed
  enemyPath[4][3][21]=enemy_speed
  enemyPath[4][4][1]=0
  enemyPath[4][4][2]=0.31*enemy_speed
  enemyPath[4][4][3]=0.59*enemy_speed
  enemyPath[4][4][4]=0.81*enemy_speed
  enemyPath[4][4][5]=0.95*enemy_speed
  enemyPath[4][4][6]=enemy_speed
  enemyPath[4][4][7]=0.95*enemy_speed
  enemyPath[4][4][8]=0.81*enemy_speed
  enemyPath[4][4][9]=0.59*enemy_speed
  enemyPath[4][4][10]=0.31*enemy_speed
  enemyPath[4][4][11]=0
  enemyPath[4][4][12]=-0.31*enemy_speed
  enemyPath[4][4][13]=-0.59*enemy_speed
  enemyPath[4][4][14]=-0.81*enemy_speed
  enemyPath[4][4][15]=-0.95*enemy_speed
  enemyPath[4][4][16]=-enemy_speed
  enemyPath[4][4][17]=-0.95*enemy_speed
  enemyPath[4][4][18]=-0.81*enemy_speed
  enemyPath[4][4][19]=-0.59*enemy_speed
  enemyPath[4][4][20]=-0.31*enemy_speed
  enemyPath[4][4][21]=0
  
  'round r=15 + exit down
  enemyPath[5][0][0]=27    
  enemyPath[5][1][1]=120
  enemyPath[5][1][2]=125
  enemyPath[5][1][3]=150
  enemyPath[5][1][4]=165
  enemyPath[5][1][5]=180
  enemyPath[5][1][6]=195
  enemyPath[5][1][7]=210
  enemyPath[5][1][8]=225
  enemyPath[5][1][9]=240
  enemyPath[5][1][10]=255
  enemyPath[5][1][11]=270
  enemyPath[5][1][12]=285
  enemyPath[5][1][13]=300
  enemyPath[5][1][14]=315
  enemyPath[5][1][15]=330
  enemyPath[5][1][16]=345
  enemyPath[5][1][17]=360
  enemyPath[5][1][18]=375
  enemyPath[5][1][19]=390
  enemyPath[5][1][20]=405
  enemyPath[5][1][21]=600
  enemyPath[5][1][22]=615
  enemyPath[5][1][23]=630
  enemyPath[5][1][24]=645
  enemyPath[5][1][254]=660
  enemyPath[5][1][26]=675
  enemyPath[5][1][27]=800
  
  enemyPath[5][2][1]=0
  enemyPath[5][2][2]=18
  enemyPath[5][2][3]=36
  enemyPath[5][2][4]=54
  enemyPath[5][2][5]=72
  enemyPath[5][2][6]=90
  enemyPath[5][2][7]=108
  enemyPath[5][2][8]=126
  enemyPath[5][2][9]=144
  enemyPath[5][2][10]=162
  enemyPath[5][2][11]=180
  enemyPath[5][2][12]=198
  enemyPath[5][2][13]=216
  enemyPath[5][2][14]=234
  enemyPath[5][2][15]=252
  enemyPath[5][2][16]=-90
  enemyPath[5][2][17]=-72
  enemyPath[5][2][18]=-54
  enemyPath[5][2][19]=-36
  enemyPath[5][2][20]=-18
  enemyPath[5][2][21]=0
  
  enemyPath[5][2][22]=18
  enemyPath[5][2][23]=36
  enemyPath[5][2][24]=54
  enemyPath[5][2][25]=72
  enemyPath[5][2][26]=90
  enemyPath[5][2][27]=90
  
  
  enemyPath[5][3][1]=enemy_speed
  enemyPath[5][3][2]=0.95*enemy_speed
  enemyPath[5][3][3]=0.81*enemy_speed
  enemyPath[5][3][4]=0.59*enemy_speed
  enemyPath[5][3][5]=0.31*enemy_speed
  enemyPath[5][3][6]=0
  enemyPath[5][3][7]=-0.31*enemy_speed
  enemyPath[5][3][8]=-0.59*enemy_speed
  enemyPath[5][3][9]=-0.81*enemy_speed
  enemyPath[5][3][10]=-0.95*enemy_speed
  enemyPath[5][3][11]=-enemy_speed
  enemyPath[5][3][12]=-0.95*enemy_speed
  enemyPath[5][3][13]=-0.81*enemy_speed
  enemyPath[5][3][14]=-0.59*enemy_speed
  enemyPath[5][3][15]=-0.31*enemy_speed
  enemyPath[5][3][16]=0
  enemyPath[5][3][17]=0.31*enemy_speed
  enemyPath[5][3][18]=0.59*enemy_speed
  enemyPath[5][3][19]=0.81*enemy_speed
  enemyPath[5][3][20]=0.95*enemy_speed
  enemyPath[5][3][21]=enemy_speed
  enemyPath[5][3][22]=0.95*enemy_speed
  enemyPath[5][3][23]=0.81*enemy_speed
  enemyPath[5][3][24]=0.59*enemy_speed
  enemyPath[5][3][25]=0.31*enemy_speed
  enemyPath[5][3][26]=0
  enemyPath[5][3][27]=0
  
  
  
  enemyPath[5][4][1]=0
  enemyPath[5][4][2]=0.31*enemy_speed
  enemyPath[5][4][3]=0.59*enemy_speed
  enemyPath[5][4][4]=0.81*enemy_speed
  enemyPath[5][4][5]=0.95*enemy_speed
  enemyPath[5][4][6]=enemy_speed
  enemyPath[5][4][7]=0.95*enemy_speed
  enemyPath[5][4][8]=0.81*enemy_speed
  enemyPath[5][4][9]=0.59*enemy_speed
  enemyPath[5][4][10]=0.31*enemy_speed
  enemyPath[5][4][11]=0
  enemyPath[5][4][12]=-0.31*enemy_speed
  enemyPath[5][4][13]=-0.59*enemy_speed
  enemyPath[5][4][14]=-0.81*enemy_speed
  enemyPath[5][4][15]=-0.95*enemy_speed
  enemyPath[5][4][16]=-enemy_speed
  enemyPath[5][4][17]=-0.95*enemy_speed
  enemyPath[5][4][18]=-0.81*enemy_speed
  enemyPath[5][4][19]=-0.59*enemy_speed
  enemyPath[5][4][20]=-0.31*enemy_speed
  enemyPath[5][4][21]=0   
  enemyPath[5][4][22]=0.31*enemy_speed
  enemyPath[5][4][23]=0.59*enemy_speed
  enemyPath[5][4][24]=0.81*enemy_speed
  enemyPath[5][4][25]=0.95*enemy_speed
  enemyPath[5][4][26]=enemy_speed
  enemyPath[5][4][27]=enemy_speed
  
  enemyPath[6][0][0]=3
  enemyPath[6][1][1]=1
  enemyPath[6][1][2]=80
  enemyPath[6][1][3]=200
  enemyPath[6][2][1]=0
  enemyPath[6][2][2]=90
  enemyPath[6][2][3]=-90
  enemyPath[6][3][1]=0
  enemyPath[6][3][2]=0
  enemyPath[6][3][3]=0
  enemyPath[6][4][1]=0
  enemyPath[6][4][2]=enemy_speed
  enemyPath[6][4][3]=-enemy_speed
EndSub

Sub create_level1   'this define the behavior of the différent squadron along the time play for level 1
  level1[1][1]=20    'when timeplay=level1[1][1]
  level1[1][2]= 2     ' lauch enemy with Path level1[1][2]
  level1[1][3]= -10   ' at x coordinate level1[1][3]
  level1[1][4] = 0      ' at y coordinate level1[1][4]
  level1[1][5] = 1      ' 1 for create enemy at the left side; 2 for the right side of screen
  level1[1][6] = 4      'level[1][6] is the number of enemies
  level1[1][7] = 1      'type of enemy
  
  level1[2][1]= 80    
  level1[2][2]= 6     
  level1[2][3]= gameWidth/2   
  level1[2][4] = -500      
  level1[2][5] = 1
  level1[2][6] = 3
  level1[2][7] = 1
  
  level1[3][1]= 150    
  level1[3][2]= 0     
  level1[3][3]= -10   
  level1[3][4] = 0 
  level1[3][5] = 1
  level1[3][6] = 6   
  level1[3][7] = 2
  
  level1[4][1]= 280    
  level1[4][2]= 4     
  level1[4][3]= -10   
  level1[4][4] = 0      
  level1[4][5] = 1
  level1[4][6] = 3
  level1[4][7] = 2
  
  
  
  level1[5][1]= 410    
  level1[5][2]= 6    
  level1[5][3]= gameWidth/3   
  level1[5][4] = -50      
  level1[5][5] = 1
  level1[5][6] = 3
  level1[5][7] = 1
  
  level1[6][1]= 430    
  level1[6][2]= 6    
  level1[6][3]= 2*gameWidth/3   
  level1[6][4] = -50      
  level1[6][5] = 2
  level1[6][6] = 3
  level1[6][7] = 1
  
  level1[5][1]= 500    
  level1[5][2]= 6    
  level1[5][3]= gameWidth/3   
  level1[5][4] = -50      
  level1[5][5] = 1
  level1[5][6] = 6
  level1[5][7] = 2
  
  level1[6][1]= 590    
  level1[6][2]= 5    
  level1[6][3]= 100  
  level1[6][4] = -80      
  level1[6][5] = 1
  level1[6][6] = 3
  level1[6][7] = 3
  
  level1[7][1]= 690    
  level1[7][2]= 6    
  level1[7][3]= gameWidth/3   
  level1[7][4] = -50      
  level1[7][5] = 2
  level1[7][6] = 3
  level1[7][7] = 2
  For i= 1 To 10
    Level1[7+i][1]=700+50*i
    level1[7+i][2]= 6    
    level1[7+i][3]=  math.GetrandomNumber(gameWidth)
    level1[7+i][4] = -50 +i     
    level1[7+i][5] = math.GetrandomNumber(2)
    level1[7+i][6] = math.GetrandomNumber(3)
    level1[7+i][7] = math.GetrandomNumber(2)
  EndFor
  level1[18][1]= 1300    
  level1[18][2]= 1    
  level1[18][3]= gameWidth  
  level1[18][4] = -10      
  level1[18][5] = 2
  level1[18][6] = 6
  level1[18][7] = 2 
  
  For i= 1 To 10
    Level1[18+i][1]=1330+50*i
    level1[18+i][2]= 4+math.GetrandomNumber(2)    
    level1[18+i][3]=  math.GetrandomNumber(50)
    level1[18+i][4] = i     
    level1[18+i][5] = 1
    level1[18+i][6] = math.GetrandomNumber(3)
    level1[18+i][7] = math.GetrandomNumber(2)
  EndFor
  For i= 1 To 10
    Level1[28+i][1]=1900+50*i
    level1[28+i][2]= 4+math.GetrandomNumber(2)    
    level1[28+i][3]=  -math.GetrandomNumber(50)
    level1[28+i][4] = i     
    level1[28+i][5] = 1
    level1[28+i][6] = math.GetrandomNumber(3)
    level1[28+i][7] = math.GetrandomNumber(2)
  EndFor
  For i= 1 To 10
    Level1[38+i][1]=2450+100*i
    level1[38+i][2]= 6    
    level1[38+i][3]=  math.GetrandomNumber(gameWidth)
    level1[38+i][4] = -50 +i     
    level1[38+i][5] = math.GetrandomNumber(2)
    level1[38+i][6] = math.GetrandomNumber(5)
    level1[38+i][7] = math.GetrandomNumber(2)
  EndFor
  
  
EndSub
Goto appselect

dictionary:
TextWindow.WriteLine("Enter word to look up: Type </exit> to exit")
userin73687 = TextWindow.Read()
If userin73687 = "/exit" Then
  Goto appselect
EndIf
dictword324 = userin73687
'word = "Program"

GraphicsWindow.FontBold = "False"
GraphicsWindow.FontName = "Verdana"
GraphicsWindow.FontSize = 24
GraphicsWindow.BrushColor = "DarkGreen"
GraphicsWindow.DrawText(10, 10, dictword324)
GraphicsWindow.Width = 624
definition = Dictionary.GetDefinition(dictword324)
GraphicsWindow.FontSize = 12
GraphicsWindow.BrushColor = "Black"
GraphicsWindow.DrawText(10, 60, definition)
MyPortal:
TextWindow.WriteLine("This is ")
