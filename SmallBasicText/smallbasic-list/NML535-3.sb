GraphicsWindow.Title = "Pirate Ship
GraphicsWindow.BackgroundColor = "SkyBlue"
gw = 598
gh = 428
GraphicsWindow.Width = gw
GraphicsWindow.Height = gh
Shapes_Init()
scale = 1
angle = 0
Shapes_Add()
cx = 260
cy = -20
h = 350
a = 20
w2 = h * 2 * ldMath.Sin(a)
w1 = 30 * ldMath.Sin(a) 
GraphicsWindow.PenWidth = 8
GraphicsWindow.PenColor = "#000000"
GraphicsWindow.DrawEllipse(shX + cx - 15, shY + cy - 15, 30, 30)
GraphicsWindow.PenWidth = 16
For i = 1 To 2
  GraphicsWindow.DrawLine (shx+cx+(i - 1.5) * w1, shy+cy+15, shx+cx+(i - 1.5) * w2, h +shy+cy)
EndFor
GraphicsWindow.PenWidth = 0
GraphicsWindow.BrushColor = "#999999"
y = 430 - 50
GraphicsWindow.fillRectangle (0 y gw, 50)


While 1=1
  LDGraphicsWindow.Reposition ( 1 1 0 0 aa)
  Program.Delay (33)
  aa=math.Abs(LDMath.Sin(bb)*35)-17
  bb=bb+1
endwhile

Sub Shapes_Init
  shX = 52 ' x offset
  shY = 78 ' y offset
  sh = "fn=el;x=119;y=243;wd=95;ht=58;bc=#5F300Cp0!fn=rc;x=163;y=244;wd=245;ht=57;bc=#5F300Cp0!fn=tr;x=100;y=239;x1=21;y1=0;x2=0;y2=43;x3=43;y3=43;an=180;bc=#5F300Cp0!fn=tr;x=78;y=222;x1=22;y1=0;x2=0;y2=18;x3=45;y3=18;an=180;bc=#5F300Cp0!fn=tr;x=161;y=222;x1=13;y1=0;x2=0;y2=22;x3=26;y3=22;bc=#5F300Cp0!fn=tr;x=99;y=222;x1=22;y1=0;x2=0;y2=18;x3=45;y3=18;bc=#5F300Cp0!fn=rc;x=120;y=222;wd=54;ht=30;bc=#5F300Cp0!fn=tr;x=326;y=207;x1=14;y1=0;x2=0;y2=38;x3=28;y3=38;bc=#5F300Cp0!fn=tr;x=399;y=208;x1=14;y1=0;x2=0;y2=38;x3=28;y3=38;an=180;bc=#5F300Cp0!fn=rc;x=341;y=208;wd=72;ht=37;bc=#5F300Cp0!fn=rc;x=359;y=172;wd=72;ht=37;bc=#5F300Cp0!fn=tr;x=345;y=173;x1=14;y1=0;x2=0;y2=38;x3=28;y3=38;bc=#5F300Cp0!fn=tr;x=417;y=172;x1=14;y1=0;x2=0;y2=38;x3=28;y3=38;an=180;bc=#5F300Cp0!fn=ln;x=0;y=188;x1=93;y1=39;x2=0;y2=0;pc=#5F300C;pw=4!fn=ln;x=255;y=5;x1=0;y1=0;x2=3;y2=240;pc=#3B1E07;pw=4!fn=ln;x=140;y=45;x1=0;y1=0;x2=0;y2=177;pc=#3B1E07;pw=4!fn=rc;x=169;y=258;wd=17;ht=17;bc=#000000;pc=#CEA75F;pw=2!fn=rc;x=209;y=258;wd=17;ht=17;bc=#000000;pc=#CEA75F;pw=2!fn=rc;x=251;y=258;wd=17;ht=17;bc=#000000;pc=#CEA75F;pw=2!fn=rc;x=293;y=258;wd=17;ht=17;bc=#000000;pc=#CEA75F;pw=2!fn=rc;x=335;y=258;wd=17;ht=17;bc=#000000;pc=#CEA75F;pw=2!fn=el;x=171;y=260;wd=12;ht=12;bc=#000000;pc=#939393;pw=2!fn=el;x=211;y=259;wd=12;ht=12;bc=#000000;pc=#939393;pw=2!fn=el;x=253;y=260;wd=12;ht=12;bc=#000000;pc=#939393;pw=2!fn=el;x=295;y=259;wd=12;ht=12;bc=#000000;pc=#939393;pw=2!fn=el;x=337;y=259;wd=12;ht=12;bc=#000000;pc=#939393;pw=2!fn=ln;x=102;y=175;x1=0;y1=0;x2=71;y2=0;pc=#3B1E07;pw=4!fn=ln;x=103;y=97;x1=0;y1=0;x2=71;y2=0;pc=#3B1E07;pw=4!fn=ln;x=212;y=221;x1=0;y1=0;x2=71;y2=0;pc=#3B1E07;pw=4!fn=ln;x=210;y=132;x1=0;y1=0;x2=71;y2=0;pc=#3B1E07;pw=4!fn=ln;x=219;y=84;x1=0;y1=0;x2=71;y2=0;pc=#3B1E07;pw=4!fn=ln;x=220;y=32;x1=0;y1=0;x2=71;y2=0;pc=#3B1E07;pw=4!fn=ln;x=335;y=71;x1=0;y1=0;x2=71;y2=0;pc=#3B1E07;pw=4!fn=tr;x=54;y=112;x1=24;y1=0;x2=0;y2=89;x3=48;y3=89;an=33;bc=#E4E4A9p0!fn=tr;x=341;y=100;x1=28;y1=0;x2=0;y2=105;x3=56;y3=105;an=244;bc=#E4E4A9p0!fn=ln;x=336;y=152;x1=0;y1=0;x2=71;y2=0;pc=#3B1E07;pw=4!fn=ln;x=372;y=35;x1=0;y1=0;x2=1;y2=137;pc=#3B1E07;pw=4!fn=rc;x=239;y=105;wd=36;ht=18;bc=#5F300Cp0!fn=tr;x=229;y=105;x1=8;y1=0;x2=0;y2=18;x3=17;y3=18;an=179;bc=#5F300Cp0!fn=tr;x=266;y=105;x1=8;y1=0;x2=0;y2=18;x3=17;y3=18;an=179;bc=#5F300Cp0!fn=tr;x=95;y=101;x1=7;y1=0;x2=0;y2=22;x3=15;y3=22;bc=#EEEEC8p0!fn=tr;x=155;y=103;x1=7;y1=0;x2=0;y2=22;x3=15;y3=22;an=180;bc=#EEEEC8p0!fn=rc;x=101;y=103;wd=61;ht=19;bc=#EEEEC8p0!fn=rc;x=95;y=122;wd=68;ht=28;bc=#EEEEC8p0!fn=tr;x=156;y=148;x1=7;y1=0;x2=0;y2=21;x3=15;y3=21;bc=#EEEEC8p0!fn=tr;x=95;y=150;x1=7;y1=0;x2=0;y2=21;x3=15;y3=21;an=179;bc=#EEEEC8p0!fn=rc;x=102;y=150;wd=62;ht=19;bc=#EEEEC8p0!fn=tr;x=201;y=137;x1=8;y1=0;x2=0;y2=31;x3=17;y3=31;bc=#EEEEC8p0!fn=tr;x=262;y=186;x1=8;y1=0;x2=0;y2=31;x3=17;y3=31;bc=#EEEEC8p0!fn=tr;x=261;y=137;x1=8;y1=0;x2=0;y2=31;x3=17;y3=31;an=180;bc=#EEEEC8p0!fn=tr;x=202;y=187;x1=8;y1=0;x2=0;y2=31;x3=17;y3=31;an=180;bc=#EEEEC8p0!fn=rc;x=210;y=137;wd=60;ht=31;bc=#EEEEC8p0!fn=rc;x=210;y=186;wd=60;ht=31;bc=#EEEEC8p0!fn=rc;x=202;y=163;wd=67;ht=27;bc=#EEEEC8p0!fn=tr;x=214;y=38;x1=7;y1=0;x2=0;y2=11;x3=14;y3=11;bc=#EEEEC8p0!fn=tr;x=273;y=69;x1=7;y1=0;x2=0;y2=11;x3=14;y3=11;bc=#EEEEC8p0!fn=tr;x=274;y=38;x1=7;y1=0;x2=0;y2=11;x3=14;y3=11;an=180;bc=#EEEEC8p0!fn=tr;x=213;y=70;x1=7;y1=0;x2=0;y2=11;x3=14;y3=11;an=180;bc=#EEEEC8p0!fn=rc;x=222;y=38;wd=60;ht=10;bc=#EEEEC8p0!fn=rc;x=221;y=70;wd=60;ht=10;bc=#EEEEC8p0!fn=rc;x=214;y=48;wd=67;ht=25;bc=#EEEEC8p0!fn=tr;x=229;y=0;x1=8;y1=0;x2=0;y2=30;x3=17;y3=30;an=269;bc=#000000p0!fn=tr;x=114;y=41;x1=8;y1=0;x2=0;y2=30;x3=17;y3=30;an=269;bc=#000000p0!fn=tr;x=346;y=33;x1=8;y1=0;x2=0;y2=30;x3=17;y3=30;an=269;bc=#000000p0!fn=rc;x=350;y=216;wd=10;ht=24;bc=#000000;pc=#CEA75F;pw=2!fn=rc;x=371;y=216;wd=10;ht=24;bc=#000000;pc=#CEA75F;pw=2!fn=rc;x=392;y=216;wd=10;ht=24;bc=#000000;pc=#CEA75F;pw=2!fn=rc;x=366;y=182;wd=10;ht=24;bc=#000000;pc=#CEA75F;pw=2!fn=rc;x=389;y=182;wd=10;ht=24;bc=#000000;pc=#CEA75F;pw=2!fn=rc;x=411;y=182;wd=10;ht=24;bc=#000000;pc=#CEA75F;pw=2!fn=tr;x=329;y=77;x1=6;y1=0;x2=0;y2=22;x3=13;y3=22;bc=#EEEEC8p0!fn=tr;x=390;y=124;x1=6;y1=0;x2=0;y2=22;x3=13;y3=22;bc=#EEEEC8p0!fn=tr;x=328;y=127;x1=6;y1=0;x2=0;y2=22;x3=13;y3=22;an=181;bc=#EEEEC8p0!fn=tr;x=389;y=78;x1=6;y1=0;x2=0;y2=22;x3=13;y3=22;an=181;bc=#EEEEC8p0!fn=rc;x=336;y=78;wd=61;ht=21;bc=#EEEEC8p0!fn=rc;x=334;y=126;wd=61;ht=21;bc=#EEEEC8p0!fn=rc;x=328;y=99;wd=67;ht=28;bc=#EEEEC8p0!fn=el;x=222;y=151;wd=29;ht=22;bc=#000000p0!fn=ln;x=217;y=173;x1=0;y1=0;x2=38;y2=27;pc=#000000;pw=4!fn=ln;x=220;y=174;x1=35;y1=0;x2=0;y2=26;pc=#000000;pw=4!fn=rc;x=226;y=169;wd=5;ht=8;bc=#000000;pc=#000000;pw=4!fn=rc;x=233;y=171;wd=5;ht=8;bc=#000000;pc=#000000;pw=4!fn=rc;x=240;y=170;wd=5;ht=8;bc=#000000;pc=#000000;pw=4!fn=el;x=227;y=155;wd=7;ht=12;bc=#EEEEC8p0!fn=el;x=238;y=155;wd=7;ht=12;bc=#EEEEC8p0!fn=el;x=209;y=171;wd=9;ht=10;bc=#000000p0!fn=el;x=214;y=165;wd=9;ht=10;bc=#000000p0!fn=el;x=250;y=166;wd=9;ht=10;bc=#000000p0!fn=el;x=254;y=169;wd=9;ht=10;bc=#000000p0!fn=el;x=254;y=192;wd=9;ht=10;bc=#000000p0!fn=el;x=249;y=198;wd=9;ht=10;bc=#000000p0!fn=el;x=213;y=193;wd=9;ht=10;bc=#000000p0!fn=el;x=218;y=198;wd=9;ht=10;bc=#000000p0
  sh=LDText.Replace (sh "fn" "func")
  sh=LDText.Replace (sh "ln" "line")
  sh=LDText.Replace (sh "el" "ell")
  sh=LDText.Replace (sh "rc" "rect")
  sh=LDText.Replace (sh "tr" "tri")
  sh=LDText.Replace (sh "p0" ";pw=0")
  sh=LDText.Replace (sh "wd" "width")
  sh=LDText.Replace (sh "ht" "height") 
  sh=LDText.Replace (sh "an" "angle")
  shape=LDText.Split (sh "!")
EndSub

Sub Shapes_Add
  Stack.PushValue("local", i)
  Stack.PushValue("local", x)
  Stack.PushValue("local", y)
  Shapes_CalcWidthAndHeight()
  s = scale
  For i = 1 To 93
    shp = shape[i]
    GraphicsWindow.PenWidth = shp["pw"] * s
    If shp["pw"] > 0 Then
      GraphicsWindow.PenColor = shp["pc"]
    EndIf
    If Text.IsSubText("rect|ell|tri|text", shp["func"]) Then
      GraphicsWindow.BrushColor = shp["bc"]
    EndIf
    If shp["func"] = "rect" Then
      shp["obj"] = Shapes.AddRectangle(shp["width"] * s, shp["height"] * s)
    ElseIf shp["func"] = "ell" Then
      shp["obj"] = Shapes.AddEllipse(shp["width"] * s, shp["height"] * s)
    ElseIf shp["func"] = "tri" Then
      shp["obj"] = Shapes.AddTriangle(shp["x1"] * s, shp["y1"] * s, shp["x2"] * s, shp["y2"] * s, shp["x3"] * s, shp["y3"] * s)
    ElseIf shp["func"] = "line" Then
      shp["obj"] = Shapes.AddLine(shp["x1"] * s, shp["y1"] * s, shp["x2"] * s, shp["y2"] * s)
    EndIf
    x = shp["x"]
    y = shp["y"]
    shp["rx"] = x
    shp["ry"] = y
    
    Shapes.Move(shp["obj"], shX + x * s, shY + y * s)
    If Text.IsSubText("rect|ell|tri|text", shp["func"]) And (shp["angle"] <> 0) And (shp["angle"] <> "") Then
      Shapes.Rotate(shp["obj"], shp["angle"])
    EndIf
    shape[i] = shp
  EndFor
  shAngle = 0
  y = Stack.PopValue("local")
  x = Stack.PopValue("local")
  i = Stack.PopValue("local")
EndSub

Sub Shapes_CalcWidthAndHeight
  For i = 1 To 93
    shp = shape[i]
    If shp["func"] = "tri" Or shp["func"] = "line" Then
      xmin = shp["x1"]
      xmax = shp["x1"]
      ymin = shp["y1"]
      ymax = shp["y1"]
      If shp["x2"] < xmin Then
        xmin = shp["x2"]
      EndIf
      If xmax < shp["x2"] Then
        xmax = shp["x2"]
      EndIf
      If shp["y2"] < ymin Then
        ymin = shp["y2"]
      EndIf
      If ymax < shp["y2"] Then
        ymax = shp["y2"]
      EndIf
      If shp["func"] = "tri" Then
        If shp["x3"] < xmin Then
          xmin = shp["x3"]
        EndIf
        If xmax < shp["x3"] Then
          xmax = shp["x3"]
        EndIf
        If shp["y3"] < ymin Then
          ymin = shp["y3"]
        EndIf
        If ymax < shp["y3"] Then
          ymax = shp["y3"]
        EndIf
      EndIf
      shp["width"] = xmax - xmin
      shp["height"] = ymax - ymin
    EndIf
    If i = 1 Then
      shWidth = shp["x"] + shp["width"]
      shHeight = shp["y"] + shp["height"]
    Else
      If shWidth < shp["x"] + shp["width"] Then
        shWidth = shp["x"] + shp["width"]
      EndIf
      If shHeight < shp["y"] + shp["height"] Then
        shHeight = shp["y"] + shp["height"]
      EndIf
    EndIf
    shape[i] = shp
  EndFor
EndSub
