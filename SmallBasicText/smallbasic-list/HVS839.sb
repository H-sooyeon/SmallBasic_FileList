GraphicsWindow.Title = "Magnetic Pins Doll

GraphicsWindow.Width = 800

GraphicsWindow.Height = 500

GraphicsWindow.BackgroundColor = "Teal

GraphicsWindow.PenWidth = 0

GraphicsWindow.PenColor = "Black"



Init()

Anime()

Program.Delay(2000)

angle = 15

duration = 1000

center = "x=420;y=230

Rotate() 

Program.Delay(duration)

angle = -30

Rotate()

Program.Delay(duration)

angle = 15

Rotate()



Sub Anime

  cc="1=white;2=gold

  n = Array.GetItemCount(data)

  For i = 1 To n

    d = data[i]

    If Array.ContainsIndex(d, "sx") Then

      _sx = d["sx"]

      _sy = d["sy"]

    ElseIf Array.ContainsIndex(d, "c") Then

      GraphicsWindow.BrushColor = d["c"]

    Else

      sx[i] = _sx

      sy[i] = _sy

      haroon[i] = Shapes.AddEllipse(_sx, _sy)

      LDEffect.DropShadow(haroon[i] "color="+cc[Math.GetRandomNumber(2)])

      Shapes.Move(haroon[i], d["x1"], d["y1"])

      Shapes.Animate(haroon[i], d["x2"], d["y2"], d["d"])

      LDShapes.AnimateZoom(haroon[i] 150 30 1.5 1.5)

      LDShapes.AnimateOpacity(haroon[i] 500 5 )

      Program.Delay(3)

    EndIf

  EndFor

EndSub



Sub Rotate

  n = Array.GetItemCount(data)

  cx = center["x"]

  cy = center["y"]

  _a = Math.GetRadians(angle)

  For i = 1 To n

    x1 = Shapes.GetLeft(haroon[i]) + sx[i] - cx

    y1 = Shapes.GetTop(haroon[i]) + sy[i] - cy

    x2 = Math.Cos(_a) * x1 - Math.Sin(_a) * y1 + cx - sx[i]

    y2 = Math.Sin(_a) * x1 + Math.Cos(_a) * y1 + cy - sy[i]

    Shapes.Animate(haroon[i], x2, y2, duration)

  EndFor

EndSub



Sub Init

  dd="sx=20;sy=20|c=Gold|x1=000;y1=0;x2=380;y2=190;d=2000|x1=800;y1=0;x2=400;y2=190;d=2000|x1=000;y1=0;x2=420;y2=190;d=2000|x1=800;y1=0;x2=440;y2=190;d=2000|x1=000;y1=0;x2=380;y2=210;d=2000|x1=800;y1=0;x2=400;y2=210;d=2000|x1=000;y1=0;x2=420;y2=210;d=2000|x1=800;y1=0;x2=440;y2=210;d=2000|x1=000;y1=0;x2=380;y2=230;d=2000|x1=800;y1=0;x2=400;y2=230;d=2000|x1=000;y1=0;x2=420;y2=230;d=2000|x1=800;y1=0;x2=440;y2=230;d=2000|x1=000;y1=0;x2=380;y2=250;d=2000|x1=800;y1=0;x2=400;y2=250;d=2000|x1=000;y1=0;x2=420;y2=250;d=2000|x1=800;y1=0;x2=440;y2=250;d=2000|x1=000;y1=0;x2=380;y2=270;d=2000|x1=800;y1=0;x2=400;y2=270;d=2000|x1=000;y1=0;x2=420;y2=270;d=2000|x1=800;y1=0;x2=440;y2=270;d=2000|x1=000;y1=0;x2=380;y2=290;d=2000|x1=800;y1=0;x2=400;y2=290;d=2000|x1=000;y1=0;x2=420;y2=290;d=2000|x1=800;y1=0;x2=440;y2=290;d=2000|c=Navy|x1=000;y1=0;x2=380;y2=110;d=2000|x1=800;y1=0;x2=440;y2=110;d=2000|x1=000;y1=0;x2=368;y2=290;d=2000|x1=800;y1=0;x2=383;y2=303;d=2000|x1=000;y1=500;x2=355;y2=300;d=2000|x1=000;y1=500;x2=370;y2=313;d=2000|x1=000;y1=500;x2=340;y2=310;d=2000|x1=000;y1=500;x2=355;y2=322;d=2000|x1=800;y1=500;x2=455;y2=290;d=2000|x1=800;y1=500;x2=440;y2=300;d=2000|x1=000;y1=0;x2=470;y2=300;d=2000|x1=000;y1=0;x2=455;y2=310;d=2000|x1=000;y1=0;x2=485;y2=313;d=2000|x1=000;y1=0;x2=470;y2=325;d=2000|c=Red|x1=000;y1=0;x2=400;y2=150;d=2000|x1=800;y1=0;x2=420;y2=150;d=2000|x1=000;y1=0;x2=320;y2=190;d=2000|x1=800;y1=0;x2=340;y2=190;d=2000|x1=800;y1=0;x2=360;y2=190;d=2000|x1=000;y1=0;x2=320;y2=210;d=2000|x1=800;y1=0;x2=340;y2=210;d=2000|x1=800;y1=0;x2=360;y2=210;d=2000|x1=000;y1=0;x2=460;y2=190;d=2000|x1=800;y1=0;x2=480;y2=190;d=2000|x1=800;y1=0;x2=500;y2=190;d=2000|x1=000;y1=0;x2=480;y2=210;d=2000|x1=800;y1=0;x2=460;y2=210;d=2000|x1=800;y1=0;x2=500;y2=210;d=2000|c=Gainsboro|x1=800;y1=0;x2=340;y2=90;d=2000|x1=000;y1=0;x2=360;y2=90;d=2000|x1=800;y1=0;x2=380;y2=90;d=2000|x1=000;y1=0;x2=400;y2=90;d=2000|x1=800;y1=0;x2=420;y2=90;d=2000|x1=800;y1=0;x2=440;y2=90;d=2000|x1=000;y1=0;x2=400;y2=90;d=2000|x1=800;y1=0;x2=460;y2=90;d=2000|x1=800;y1=0;x2=480;y2=90;d=2000|x1=800;y1=0;x2=340;y2=70;d=2000|x1=000;y1=0;x2=360;y2=70;d=2000|x1=800;y1=0;x2=380;y2=70;d=2000|x1=000;y1=0;x2=400;y2=70;d=2000|x1=800;y1=0;x2=420;y2=70;d=2000|x1=800;y1=0;x2=440;y2=70;d=2000|x1=000;y1=0;x2=400;y2=70;d=2000|x1=800;y1=0;x2=460;y2=70;d=2000|x1=800;y1=0;x2=480;y2=70;d=2000|x1=800;y1=0;x2=340;y2=170;d=2000|x1=000;y1=0;x2=360;y2=170;d=2000|x1=800;y1=0;x2=380;y2=170;d=2000|x1=800;y1=0;x2=420;y2=170;d=2000|x1=800;y1=0;x2=440;y2=170;d=2000|x1=000;y1=0;x2=400;y2=170;d=2000|x1=800;y1=0;x2=460;y2=170;d=2000|x1=800;y1=0;x2=480;y2=170;d=2000|x1=800;y1=0;x2=340;y2=150;d=2000|x1=000;y1=0;x2=360;y2=150;d=2000|x1=800;y1=0;x2=380;y2=150;d=2000|x1=800;y1=0;x2=440;y2=150;d=2000|x1=000;y1=0;x2=460;y2=150;d=2000|x1=800;y1=0;x2=480;y2=150;d=2000|x1=800;y1=0;x2=340;y2=130;d=2000|x1=000;y1=0;x2=360;y2=130;d=2000|x1=800;y1=0;x2=380;y2=130;d=2000|x1=800;y1=0;x2=420;y2=130;d=2000|x1=800;y1=0;x2=440;y2=130;d=2000|x1=800;y1=0;x2=400;y2=130;d=2000|x1=800;y1=0;x2=460;y2=130;d=2000|x1=800;y1=0;x2=480;y2=130;d=2000|x1=800;y1=0;x2=340;y2=110;d=2000|x1=000;y1=0;x2=360;y2=110;d=2000|x1=800;y1=0;x2=400;y2=110;d=2000|x1=000;y1=0;x2=420;y2=110;d=2000|x1=800;y1=0;x2=460;y2=110;d=2000|x1=000;y1=0;x2=480;y2=110;d=2000|x1=800;y1=0;x2=260;y2=190;d=2000|x1=000;y1=0;x2=280;y2=190;d=2000|x1=800;y1=0;x2=300;y2=190;d=2000|x1=000;y1=0;x2=260;y2=210;d=2000|x1=000;y1=0;x2=280;y2=210;d=2000|x1=000;y1=0;x2=300;y2=210;d=2000|x1=000;y1=0;x2=520;y2=190;d=2000|x1=000;y1=0;x2=540;y2=190;d=2000|x1=000;y1=0;x2=560;y2=190;d=2000|x1=000;y1=0;x2=520;y2=210;d=2000|x1=000;y1=0;x2=540;y2=210;d=2000|x1=000;y1=0;x2=560;y2=210;d=2000|x1=000;y1=0;x2=325;y2=325;d=2000|x1=000;y1=0;x2=338;y2=335;d=2000|x1=000;y1=0;x2=310;y2=340;d=2000|x1=000;y1=0;x2=325;y2=348;d=2000|x1=000;y1=0;x2=297;y2=355;d=2000|x1=000;y1=0;x2=313;y2=363;d=2000|x1=000;y1=0;x2=500;y2=325;d=2000|x1=000;y1=0;x2=485;y2=340;d=2000|x1=000;y1=0;x2=515;y2=335;d=2000|x1=000;y1=0;x2=500;y2=350;d=2000|x1=000;y1=0;x2=530;y2=345;d=2000|x1=000;y1=0;x2=520;y2=360;d=2000|

  data=LDText.Split(dd "|")

EndSub


