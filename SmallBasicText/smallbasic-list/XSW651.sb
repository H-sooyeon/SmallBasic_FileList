image=imagelist.LoadImage( "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Beethoven.jpg/639px-Beethoven.jpg")

IH=ImageList.GetHeightOfImage(image) 
IW=ImageList.GetWidthOfImage(image)
args=0
GraphicsWindow.Top =0
GraphicsWindow.left =0
GraphicsWindow.Height=IH
GraphicsWindow.Width=IW

GraphicsWindow.DrawImage(image,0,0)
GraphicsWindow.fontname="Vivaldi
GraphicsWindow.FontSize=80
GraphicsWindow.BrushColor="#E7D3AD"
GraphicsWindow.DrawboundText(20,400,500,"Moonlight Sonata")
GraphicsWindow.FontSize=60
GraphicsWindow.BrushColor="#E7B3AB"
GraphicsWindow.DrawText(100,600"Ludwig v.Beethoven")
GraphicsWindow.FontSize=12
GraphicsWindow.BrushColor="#E7D3AD"
GraphicsWindow.FontSize=125      
BAR = Shapes.AddText("")
Shapes.Move(BAR,50, 50)
For M= 1 To 37  
  For T=1 TO 12
    a[m][t]=" "
    n[m][t]=" "
  EndFor 
endfor

Read_Measure() 
For M= 1 To 9
  Shapes.SetText(BAR,M)  
  For T=1 TO 12  
    aa=n[m][t]
    qrpl ()
    sound.PlayMusic (a[m][t]+aa)
    Program.Delay (30)
  endfor   
endfor

For M= 10 To 37
  Shapes.SetText(BAR,M)  
  For T=1 TO 12  
    sound.PlayMusic (a[m][t]+n[m][t])
    Program.Delay (30)
  endfor        
ENDFOR

SUB Read_Measure
  
  a[1][1]="O2L64 C#" +"O3L64 C#" +"O4L64 C#"
  n[1][1]="$G#"
  n[1][2]="%C#"
  n[1][3]="%E"
  
  n[1][4]="$G#"
  n[1][5]="%C#"
  n[1][6]="%E"
  
  n[1][7]="$G#"
  n[1][8]="%C#"
  n[1][9]="%E"
  
  n[1][10]="$G#"
  n[1][11]="%C#"
  n[1][12]="%E"
  
  ' measure 2
  
  a[2][1]="O2L64 B" +"O3L64 B" +"O4L64 B"
  n[2][1]="$G#"
  n[2][2]="%C#"
  n[2][3]="%E"
  
  n[2][4]="$G#"
  n[2][5]="%C#"
  n[2][6]="%E"
  
  n[2][7]="$G#"
  n[2][8]="%C#"
  n[2][9]="%E"
  
  n[2][10]="$G#"
  n[2][11]="%C#"
  n[2][12]="%E"
  
  
  ' measure 3
  
  a[3][1]="O2L64 A" +"O3L64 A" +"O4L64 A"
  n[3][1]="$A"
  n[3][2]="%C#"
  n[3][3]="%E"
  
  n[3][4]="$A"
  n[3][5]="%C#"
  n[3][6]="%E"
  
  a[3][7]="O2L64 F#" +"O3L64 F#" +"O4L64 A"
  n[3][7]="$A"
  n[3][8]="%D"
  n[3][9]="%F#"
  
  n[3][10]="$A"
  n[3][11]="%D"
  n[3][12]="%F#"
  
  
  ' measure 4
  
  a[4][1]="O2L64 G#" +"O3L64 G#" +"O4L64 G#"
  n[4][1]="$G#"
  n[4][2]="%C" 
  n[4][3]="%F#"
  
  n[4][4]="$G#"
  n[4][5]="%C#"
  n[4][6]="%E"
  
  a[4][7]="O2L64 G#" +"O3L64 G#" +"O4L64 G#"
  n[4][7]="$G#"
  n[4][8]="%C#"
  n[4][9]="%E"
  
  n[4][10]="$G#"
  n[4][11]="%C" ' SI di√®se ca existe ps SB ne le prends pas donc ( Do)
  n[4][12]="%D#"
  
  
  ' measure 5
  
  a[5][1]="O2L64 C#" +"O3L64 C#" +"O4L64 G#"
  n[5][1]="$E"
  n[5][2]="$G#"
  n[5][3]="$C#"
  
  n[5][4]="$G#"
  n[5][5]="%C#"
  n[5][6]="%E"
  
  n[5][7]="$G#"
  n[5][8]="%C#"
  n[5][9]="%E"
  
  a[5][10]="O4L64 G#" +"O6L64 G#"
  n[5][10]="^G#" ' mp 
  n[5][11]="%C#"
  a[5][12]="O5L64 E" +"O6L64 G#"
  n[5][12]="%E"
  
  ' measure 6
  
  a[6][1]="O2L64 F#" +"O3L64 F#" +"O4L64 C"
  n[6][1]="^G#"
  n[6][2]="%D#"
  n[6][3]="%F#"
  
  n[6][4]="$G#"
  n[6][5]="%D#"
  n[6][6]="%F#"
  
  n[6][7]="$G#"
  n[6][8]="%D#"
  n[6][9]="%F#"
  
  a[6][10]="O4L64 G#" +"O6L64 G#"
  n[6][10]="^G#" 
  n[6][11]="$D#"
  a[6][12]="O5L64 F#" +"O6L64 G#"
  n[6][12]="%F#"
  
  
  ' measure7
  
  a[7][1]="O3L64 C#" +"O4L64 G#"
  n[7][1]="^G#"
  n[7][2]="%C#"
  n[7][3]="%E"
  
  n[7][4]="$G#"
  n[7][5]="%C#"
  n[7][6]="%E"
  
  a[7][7]="O3L64 F#" +"O4L64 A"
  n[7][7]="^A"
  n[7][8]="$C#"
  n[7][9]="%F#"
  
  n[7][10]="$A"
  n[7][11]="%C#"
  n[7][12]="%F#"
  
  
  ' measure 8
  
  a[8][1]="O3L64 B" +"O4L64 G#"
  n[8][1]="^G#"
  n[8][2]="$B" 
  n[8][3]="%E" 
  
  n[8][4]="$G#"
  n[8][5]="$B" 
  n[8][6]="%E" 
  
  a[8][7]="O3L64 B" +"O4L64 G#"
  n[8][7]="^F#"
  n[8][8]="$B"
  n[8][9]="$D#" 
  
  a[8][10]="O4L64 A"+"O6L64 B"
  n[8][10]="^B"
  n[8][11]="$B"
  n[8][12]="%D#"
  
  
  
  ' measure 9
  
  a[9][1]="O3L64 E" +"O4L64 G#"
  n[9][1]="^E"
  n[9][2]="$B" 
  n[9][3]="%E" 
  
  n[9][4]="$G#"
  n[9][5]="$B" 
  n[9][6]="%E" 
  
  n[9][7]="$G#"
  n[9][8]="$B" 
  n[9][9]="%E"
  
  n[9][10]="$G#"
  n[9][11]="$B" 
  n[9][12]="%E"
  
  a[10][1]="O3L64 E" +"O4L64 E"
  a[10][10]="O3L64 G" +"O6L64 G"
  a[10][12]="O5L64 E" +"O6L64 G"
  LDCall.Function2 ("nset",10,"$G $B %E $G $B %E $G $B %E ^G $B %E") 
  
  a[11][1]="O3L64 D" +"O6L64 G"
  a[11][10]="O3L64 G" +"O6L64 G"
  a[11][12]="O5L64 E" +"O6L64 G"
  LDCall.Function2 ("nset",11,"^G $B %F $G $B %F $G $B %F ^G $F ^G")
  
  a[12][1]="O3L64 G" +"O5L64 G"
  a[12][4]="O3L64 B" +"O4L64 B"
  a[12][7]="O2L64 A#" +"O3L64 A#"
  a[12][10]="O4L64 F#"+"O6L64 F#"
  LDCall.Function2 ("nset",12,"^G $C %E %G $C %E %G %C# %E ^F# $A# %C#")
  
  a[13][1]="O3L64 B" +"O5L64 F#"
  a[13][7]="O3L64 E" +"O6L64 G"
  a[13][10]="O3L64 G" +"O6L64 E"
  LDCall.Function2 ("nset",13,"^F# $B %D $F# $B %D ^G $B %C# ^E $B %C#") 
  
  a[14][1]="O3L64 F#" +"O6L64 F#"
  a[14][7]="O3L64 F#" +"O4L64 F#"
  LDCall.Function2 ("nset",14,"^F# $B %D $F# $B %D ^F# $A# %C# $F# $A# %C#")
  
  a[15][1]="O3L64 B" +"O5L64 B"
  a[15][10]="O4L64 B" +"O6L64 B"
  LDCall.Function2 ("nset",15,"%B %D %F# $B %D %F# $D %D# %F# ^B %D# %F#")
  
  a[16][1]="O3L64 B" +"O7L64 C"
  a[16][4]="O3L64 E" +"O4L64 B"
  a[16][7]="O3L64 G" +"O4L64 B"
  a[16][10]="O3L64 C" +"O6L64 A#"
  LDCall.Function2 ("nset",16,"&C %E %G $B %E %G $B %E %G ^A# %E %G")
  
  a[17][1]="O3L64 B" +"O6L64 B"
  a[17][10]="O3L64 B" +"O6L64 B"
  LDCall.Function2 ("nset",17,"^B %D# %F# $B %D# %F# $B %D# %F# ^B %D# %F#")
  
  a[18][1]="O3L64 B" +"O7L64 C"
  a[18][4]="O3L64 E" +"O3L64 B"
  a[18][7]="O3L64 G" +"O3L64 B"
  a[18][10]="O3L64 C" +"O6L64 A#"
  LDCall.Function2 ("nset",18,"&C %E %G $B %E %G $B %E %G ^A# %E %G")
  
  a[19][1]="O2L64 B" +"O4L64 B" +"O6L64 B" 
  a[19][7]="O2L64 G#" +"O3L64 G#" +"O6L64 B"
  LDCall.Function2 ("nset",19,"^B %D# %F# $B %D# %F# ^B %D %F $B %D %F")
  
  a[20][1]="O2L64 F" +"O3L64 F" +"O6L64 B" ' MI# 
  a[20][7]="O2L64 F#" +"O3L64 F#" +"O6L64 A"
  LDCall.Function2 ("nset",20,"^B %C# %G# $B %C# %G# ^A %C# %F# $G# %C# %F#")
  
  a[21][1]="O3L64 B" +"O4L64 B" +"O6L64 G"
  a[21][7]="O3L64 C" +"O4L64 C" +"O6L64 F#" ' SI# 
  LDCall.Function2 ("nset",21,"^G $B %D $G $B %D ^F# $A %D# $F# $A %D#")
  
  a[22][1]="O3L64 C#" +"O5L64 C#"
  a[22][7]="O3L64 C#" +"O5L64 C#"
  a[22][10]="O3L64 C#" +"O5L64 C#"
  LDCall.Function2 ("nset",22,"%C# $F# $A %C# $F# $A %C# $F# $G# $C# $F $G#")
  
  a[23][1]="O2L64 F#" +"O3L64 C#" +"O4L64 F#"
  a[23][10]="O4L64 E" +"O6L64 C#"
  a[23][12]="O5L64 A" +"O6L64 C#"
  LDCall.Function2 ("nset",23,"$F# $A %C# $A %C# %F# %C# %F# %A ^C# %F# ^C#")
  
  a[24][1]="O3L64 F" +"O6L64 C#" ' MI #
  a[24][10]="O4L64 C#" +"O6L64 C#"
  a[24][12]="O4L64 B" +"O6L64 C#"
  LDCall.Function2 ("nset",24,"$C# $G# $B $C# $G# $B $C# $G# $B ^C# $G# ^C#") 
  
  a[25][1]="O3L64 F#" +"O6L64 C#"
  a[25][7]="O4L64 D#" +"O6L64 C" ' SI# donc C
  a[25][10]="O3L64 C#" +"O6L64 C#"
  LDCall.Function2 ("nset",25,"^C# $F# $A $C# $F# $A ^C $F# $A ^C# $F# $A")
  
  a[26][1]="O3L64 C" +"O6L64 D#" ' SI# donc C
  a[26][10]="O3L64 C" +"O6L64 D#" ' SI# donc C
  LDCall.Function2 ("nset",26,"^D# $F# $G# $D# $F# $G# $D# $F# $G# ^D# $F# $G#")
  
  a[27][1]="O3L64 C#" +"O6L64 E" 
  a[27][7]="O3L64 F#" +"O6L64 D#" 
  a[27][10]="O3L64 G" +"O6L64 C#" '  F# double diese
  LDCall.Function2 ("nset",27,"^E $G# $C# $E $G# $C# ^D# $F# $A ^C# $E $A#")
  
  a[28][1]="O3L64 G#" +"O6L64 C" ' si # 
  a[28][4]="O4L64 G#" +"O6L64 G#" 
  a[28][7]="O4L64 A" +"O6L64 A" 
  a[28][10]="O4L64 F#" +"O6L64 F#" 
  LDCall.Function2 ("nset",28,"%C $C $D# ^G# $C $D# ^A $C $D# ^F# $C $D#")
  
  a[29][1]="O3L64 G#" ' si # 
  a[29][4]="O3L64 G#" +"O5L64 G#" 
  a[29][7]="O3L64 G#" +"O5L64 A" 
  a[29][10]="O3L64 E" +"O5L64 F#" 
  LDCall.Function2 ("nset",29,"$C $C $D# %G# $C $D# %A $C $D# %F# $C $D#")
  
  a[30][1]="O3L64 G#" +"O3L64 E" 
  a[30][4]="O5L64 C#" +"O6L64 C#" 
  a[30][7]="O5L64 E" +"O6L64 E" 
  a[30][10]="O5L64 C#" +"O6L64 C#" 
  LDCall.Function2 ("nset",30,"!E $E $G# !E $E $G# ^E $E $G# ^C# $E $G#")
  
  a[31][1]="O3L64 G#"+"O3L64 G#" 
  a[31][4]="O5L64 C#" +"O5L64 C#" 
  a[31][7]="O4L64 E" +"O6L64 E" 
  a[31][10]="O4L64 C#" +"O5L64 C#" 
  LDCall.Function2 ("nset",31,"!G# $E $G# %C# $E $G# ^E $E $G# %C# $E $G#")
  
  a[32][1]="O2L64 G#"+"O3L64 F#" 
  LDCall.Function2 ("nset",32,"$F# !A !F# %C $A %D# %C %F# %D# %A %F# ^C") 
  
  a[33][1]="O2L64 G#"+"O3L64 E" 
  LDCall.Function2 ("nset",33,"$E $C# !G# %E %C# %G# %E ^C# %G# ^E ^C# %G#")
  
  a[34][1]="O2L64 G#"+"O3L64 G#" 
  LDCall.Function2 ("nset",34,"$G# %G %E %A# %G ^C# %A# ^E ^C# ^G ^E ^A#")  
  
  a[35][1]="O2L64 G#"+"O4L64 F#" 
  LDCall.Function2 ("nset",35,"%F# ^C %A ^D# ^C ^F# ^D# ^A ^F# &C ^A &D#")
  
  a[36][1]="O2L64 G#"+"O3L64 G#"+"O7L64 C" 
  LDCall.Function2 ("nset",36,"&C ^F# ^A ^D# ^F# ^C ^D# %A ^C %F# %A %D#")
  
  a[37][1]="O2L64 G#"+"O3L64 G#"+"O5L64 F#" 
  LDCall.Function2 ("nset",37,"%F# %C ^D# ^A &C ^F#") 
  
EndSub

Sub nset
  aa=args[2]
  ll=args[1]
  qrpl ()
  bb=ldtext.Split (aa," ")
  
  For x=1 To Array.GetItemCount (bb)
    a[ll][x]=bb[x]
  EndFor 
EndSub 

Sub qrpl
  aa=ldtext.Replace (aa,"!","O3L4")
  aa=ldtext.Replace (aa,"$","O4L4")
  aa=ldtext.Replace (aa,"%","O5L4")
  aa=ldtext.Replace (aa,"^","O6L4")
  aa=ldtext.Replace (aa,"&","O7L4")
EndSub 
