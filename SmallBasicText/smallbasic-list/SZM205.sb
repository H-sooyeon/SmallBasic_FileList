'======================================================================================='

'	Programmer:		EMLF										'

'	Software:		Equa√ß√£o do  2¬∫ Grau								'

'	Version:			2.3										'

'	Date:			2011/Oct/05									'

'	Variables:		coeficientes[], a, b, c, ??, ?îRaiz, x, x[], Œπ, √≠ndice, tecla, equa√ß√£o				'

'======================================================================================='





'---------------------------------------------------------------------------------------------------------------------'

'	Inicializa√ß√£o das constantes pra caracteres especiais de controle em c√≥digo ASCII:	'

'---------------------------------------------------------------------------------------------------------------------'



BEL= Text.GetCharacter	(7)	' Produz um beep pelo PC-Speaker interno

BS= Text.GetCharacter		(8)	' Backspace (Volta 1 posi√ß√£o  pra esquerda)

TAB= Text.GetCharacter	(9)	' Tabula√ß√£o Horizontal (HT)

LF= Text.GetCharacter		(10)	' Line-Feed (Pula-Linha)

CR= Text.GetCharacter		(13)	' Retorno de Carro (Volta ao in√≠cio da linha)

ESC= Text.GetCharacter	(27)	' Tecla "Esc"

TRI= Text.GetCharacter	(30)	' Tri√¢ngulo

SETA= Text.GetCharacter	(26)	' Flecha pra direita

SPC= " "				' Espa√ßo em Branco (SPaCe)



'---------------------------------------------------------------------------------------------------------------------'

'	Outros procedimentos de inicializa√ß√£o:						'

'---------------------------------------------------------------------------------------------------------------------'



TextWindow.Title= "C√°lculo de Fun√ß√£o Quadr√°tica

TextWindow.Left= 200

TextWindow.Top=  300

CorFundo= "Black

TextWindow.BackgroundColor= CorFundo



If Program.ArgumentCount > 0 Then	' Checa se algum argumento foi passado pela Interface de Comando de Linha (CLI)

  Argumentos()				' Inicializa a vari√°vel coeficientes[] com o conte√∫do dos argumentos

  Goto Pula_ABC			' Pula a 1¬™ subrotina ABC(), j√° q ser√£o usados os argumentos provindos da CLI

EndIf



'---------------------------------------------------------------------------------------------------------------------'

'	Ponto de partida do la√ßo do programa:						'

'---------------------------------------------------------------------------------------------------------------------'



La√ßo:

TextWindow.Clear()			' Limpa a janela de textos

ABC()					' Requisita q/ o usu√°rio digite 3 valores pra atribuir-lhes os coeficientes a, b & c



Pula_ABC:

Espelhar_Coeficientes()		' Transfere os 3 elementos do conjunto coeficientes[] pr√°s vari√°veis a, b & c

Criar_Equa√ß√£o()			' Cria a express√£o pra exibi√ß√£o q/ representa os coeficientes a, b & c 

Exibir_Equa√ß√£o()			' Mostra em forma de equa√ß√£o quadr√°tica os valores obtidos dos coeficientes



If a = 0 And b = 0 Then		' Equa√ß√£o sem ra√≠zes!

  Resultado_√ò()

  Goto Fim

EndIf



If a = 0 Then				' Equa√ß√£o de 1¬∫ grau!

  Calcular_Linear()

  Resultado_Linear()

  Goto Fim

EndIf



Calcular_??()				' Obter a discriminante delta e tamb√©m a sua raiz quadrada

Resultado_??()



If ?? < 0 Then				' Equa√ß√£o com ra√≠zes complexas!

  Calcular_Complexo()

  Resultado_Complexo()

Else					' Equa√ß√£o com ra√≠zes reais!

  Calcular_Quadr√°tico()

  Resultado_Quadr√°tico()

EndIf



Fim:

Encerrar()				' Perguntar se o usu√°rio deseja calcular outra raiz de 2¬∫ grau		:-D

Goto La√ßo				' Volta ao in√≠cio do la√ßo, caso positivo				^_^





'==================================================================================================='

'					Subrotinas das Compartimentaliza√ß√µes do Programa						'

'==================================================================================================='





Sub Encerrar

  ' Encerrar o programa se a tecla 'Q' ou 'Esc' for pressionada:

  

  TextWindow.ForegroundColor= "DarkMagenta

  TextWindow.WriteLine (LF + "Pressione 'Q' ou 'Esc' pra encerrar ou qualquer outra pra reiniciar...")

  

  tecla= Text.ConvertToUpperCase ( TextWindow.ReadKey() )

  If tecla = "Q" Or tecla = ESC Then

    Program.End()

  EndIf

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Argumentos

  ' Obtem os 3 primeiros argumentos usados ao rodar o programa

  ' e armazena-os na vari√°vel conjunto coeficientes[], representando os valores de a, b & c :

  

  For √≠ndice= 1 To 3

    coeficientes[√≠ndice]= Program.GetArgument(√≠ndice) * 1	' Multiplica-se por 1 pra for√ßar tipo num√©rico!

  EndFor

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub ABC

  ' Requisitar os valores de a, b & c do usu√°rio:

  

  TextWindow.ForegroundColor= "Red

  TextWindow.WriteLine ("Digite os valores de A, B & C pr√° equa√ß√£o do 2¬∫ grau:")

  TextWindow.ForegroundColor= "Magenta

  TextWindow.WriteLine ("Modelo -> ax¬≤ + bx + c = 0" + LF)

  

  For √≠ndice= 97 To 99					' Seq√º√™ncia em ASCII correspondentes √†s letras "a", "b" e "c"

    TextWindow.ForegroundColor= "Yellow

    TextWindow.Write ( "Valor de " + Text.GetCharacter(√≠ndice) + ": " )

    TextWindow.ForegroundColor= "White

    TextWindow.BackgroundColor= "DarkYellow

    coeficientes[√≠ndice - 96]= TextWindow.ReadNumber() * 1	' Armazena o ?Ññ digitado em coeficientes[]

    TextWindow.BackgroundColor= CorFundo

  EndFor

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Espelhar_Coeficientes

  ' Espelha os 3 valores armazenados em coeficientes[] pras vari√°veis a, b & c

  ' por motivos de est√©tica e clareza de c√≥digo, nas partes q calculam as ra√≠zes da equa√ß√£o:

  

  a= coeficientes[1]		' Coeficiente Quadr√°tico "a"

  b= coeficientes[2]		' Coeficiente Linear "b"

  c= coeficientes[3]		' Termo Constante "c"

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Criar_Equa√ß√£o

  ' Cria uma cord√£o alfanum√©rico representando a equa√ß√£o com os respectivos valores de a, b & c:

  

  equa√ß√£o= "f(x) " + SETA + SPC	' In√≠cio da forma√ß√£o da vari√°vel alfanum√©rica "equa√ß√£o"

  

  ' Coeficiente Quadr√°tico "a":

  ' ======================

  If a <> 0 Then			' Somente os termos com coeficientes ?â† 0 ser√£o exibidos!

    

    If a <> 1 And a <> -1 Then	' Condi√ß√£o impede de imprimir os ?Ññs 1 e -1 na frente da vari√°vel x¬≤!

      equa√ß√£o= equa√ß√£o + a

    ElseIf a = -1 Then		' No caso do -1, apenas o sinal negativo √© acrescentado

      equa√ß√£o= equa√ß√£o + "-

    EndIf

    

    equa√ß√£o= equa√ß√£o + "x¬≤ "

    

  EndIf

  '-------------------------------------------------

  

  ' Coeficiente Linear "b":

  '======================

  If b <> 0 Then			' Somente os termos com coeficientes ?â† 0 ser√£o exibidos!

    

    If b < 0 Then

      equa√ß√£o= equa√ß√£o + "- "

      If a = 0 Then

        equa√ß√£o= equa√ß√£o + BS		' Se o coeficiente quadr√°tico for nulo, faz com q o sinal negativo fique

      EndIf				'colado √† vari√°vel linear x, ao acrescentar um deslocamento pr√° esquerda

      

    ElseIf a <> 0 Then		' a ?â† 0 & b > 0

      equa√ß√£o= equa√ß√£o + "+ "

    EndIf

    

    If b <> 1 And b <> -1 Then	' Condi√ß√£o impede de imprimir os ?Ññs 1 e -1 na frente da vari√°vel x!

      equa√ß√£o= equa√ß√£o + Math.Abs(b)

    EndIf

    

    equa√ß√£o= equa√ß√£o + "x "

    

  EndIf

  '--------------------------------------------------

  

  ' Termo Constante "c":

  '======================

  If a = 0 And b = 0 Then		' Se ambos os x da equa√ß√£o forem nulos,

    equa√ß√£o= equa√ß√£o + c + SPC	'imprima o termo constante "c" sem qualquer altera√ß√£o

    

  ElseIf c <> 0 Then			' Caso contr√°rio, adiciona um sinal antes de imprimi-lo se c √± for nulo

    

    If c < 0 Then			' ( a ?â† 0 | b ?â† 0 ) & c < 0		c √© negativo

      equa√ß√£o= equa√ß√£o + "- "

    Else				' ( a ?â† 0 | b ?â† 0 ) & c > 0		c √© positivo

      equa√ß√£o= equa√ß√£o + "+ "

    EndIf

    

    equa√ß√£o= equa√ß√£o + Math.Abs(c) + SPC

    

  EndIf

  '--------------------------------------------------

  

  equa√ß√£o= equa√ß√£o + "= 0"          ' Fechamento da "equa√ß√£o"

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Exibir_Equa√ß√£o

  ' Exibir a equa√ß√£o pronta:

  

  TextWindow.ForegroundColor= "White

  TextWindow.BackgroundColor= "DarkGray

  TextWindow.WriteLine( LF + equa√ß√£o + LF )

  TextWindow.BackgroundColor= CorFundo

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Resultado_√ò

  ' As 2 vari√°veis x possuem coeficientes nulos:

  

  TextWindow.ForegroundColor= "DarkRed

  TextWindow.WriteLine ("Tanto os coeficientes quadr√°tico 'a' e linear 'b' s√£o = 0" + BEL)

  TextWindow.WriteLine ("Portanto, as vari√°veis x s√£o nulas, √± existindo raiz alguma pra calcular!")

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Calcular_Linear

  ' Raiz x de Equa√ß√£o Linear, pois o termo quadr√°tico a = 0:

  

  x= -c/b

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Resultado_Linear

  ' Exibir a raiz da equa√ß√£o linear:

  

  TextWindow.ForegroundColor= "Green

  TextWindow.WriteLine ("Esta equa√ß√£o √© linear com raiz |R x = " + x)

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Calcular_??

  ' Calcular o valor da discriminante ?? e tamb√©m o resultado da sua ?àö :

  

  ??= b*b - 4*a*c				' Express√£o Discriminante "??"

  ?îRaiz= Math.SquareRoot ( Math.Abs(??) )	' ?àö |??|

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Resultado_??

  ' Exibir o valor de ??:

  

  TextWindow.ForegroundColor= "White

  TextWindow.BackgroundColor= "Blue

  TextWindow.WriteLine (TRI + " = " + ?? + LF)

  TextWindow.BackgroundColor= CorFundo

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Calcular_Quadr√°tico

  ' Calcular as ra√≠zes reais X1 & X2 pela f√≥rmula de Bhaskara Akaria:

  

  x[1]= ( -b + ?îRaiz ) / (2*a)

  x[2]= ( -b - ?îRaiz ) / (2*a)

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Resultado_Quadr√°tico

  ' Exibir o resultado das ra√≠zes da equa√ß√£o quadr√°tica:

  

  TextWindow.ForegroundColor= "Green

  

  If ?? = 0 Then

    

    TextWindow.WriteLine ("Esta equa√ß√£o possui 1 √∫nica raiz |R sendo que x = " + x[1])

    

  Else

    

    TextWindow.WriteLine ("Esta equa√ß√£o possui 2 ra√≠zes |R e distintas:" + LF)

    TextWindow.ForegroundColor= "Cyan

    

    For √≠ndice= 1 To 2

      TextWindow.Write( TAB + "x" + √≠ndice + " = " )

      

      If x[√≠ndice] > 0 Then

        TextWindow.Write("+")

      EndIf

      

      TextWindow.WriteLine( x[√≠ndice] )

    EndFor

    

  EndIf

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Calcular_Complexo

  ' Calcular o conjugado |C com a parte |R em x e a parte |I em Œπ (iota):

  

  x= -b / (2*a)

  Œπ= ?îRaiz / (2*a)

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'



Sub Resultado_Complexo

  ' Exibir o conjugado complexo no modelo z = x ¬± Œπ, sendo Œπ = ?àö -1 :

  

  TextWindow.ForegroundColor= "Green

  TextWindow.WriteLine ("Esta equa√ß√£o possui 2 ra√≠zes complexas conjugadas")

  TextWindow.WriteLine ("tendo 1 parte em real e 2 imagin√°rias:" + LF)

  

  TextWindow.ForegroundColor= "Cyan

  TextWindow.WriteLine ( "   x = " + x + " ¬± i( " + Œπ + " )" )

  

EndSub



'-------------------------------------------------------------------------------------------------------------------------------------------------------------------------'


