t_`true
f_`false
_dw=Desktop.Width
_dh=Desktop.Height
wWidth=1000
wHeight=600
wTop=(_dh - wHeight - 74)/2
wLeft=(_dw - wWidth)/2
c_mn`MainPaint
_c_Color`First
_c_Tool`Pencil

DropDownSizeShown =f_
dd_t`None
DdPencilSize=1
Dd_bsz=7
DdEraserSize=10
Dd_ssz=10
DdBrushLeft=20
DdBrushTop=70
DdEraserLeft=19
DdEraserTop=69
DdSprayLeft=30
DdSprayTop=55
DdSprayBordersZoom=0.5
DdDotSize=1
xColorIndicator=138
ToolAdded =f_
CanMoveRedSlide =f_
CanMoveGreenSlide =f_
CanMoveBlueSlide`Falase
PencilSize=1.5
_bsz=6
EraserSize=10
_ssz=15
SprayColors=2
_ssp=10
_sdz=2
b_cl`Black
_c2=gw#GetColorFromRGB(225,225,225)
ColorPickerLoaded =f_
CpLeft=0
CpTop=0
CanMoveCp =f_
CanGetPixel =t_
x_sspIndi=378
Dd_sszIndiTop=115
DdDotSizeIndiLeft=414
CanMoveTxtIndies =f_
OldTxtBody`Quick brown fox Lorem ipsum lazy dogs
OldTxtName`Microsoft Sans Serif
OldTxtSize=12
OldTxtBold`Yes
OldTxtFontBold =f_
OldTxtFontItalic =f_
OldTxtSolid =f_
OldTxtTransparent =t_
TxtName=OldTxtName
TxtBody=OldTxtBody
TxtSize=12
cr_ss`Line
bgsh`Solid
pws_=2
_xwsh=535.5
_c_Mirror`None
MirrorAdded =f_
CanAddSelectLm =f_
CanMoveis_ =f_
CanAddis_ =t_
CanClick_stl =t_
c_pt`Lines
pr_wd=40
pr_ht=40
x_ip=613
y_ip=83
x_ipBorder=763
x_btc=615
p_brd =f_
pttwd=_dw
pttht=_dh
p_bt=1
CanResizet_dpt =f_
DrawFullscreen =f_
xIndiPatR&$Clrs=763
PatternR&$omClrs =f_
'Window
gw#Width=wWidth
gw#Height=wHeight
gw#Left=wLeft
gw#Top=wTop
gw#Title`Paint
gw#bc`#FFFFFF
gw#fr(0,0,_dw,_dh)
gw#FontBold =f_
gw#FontName`Microsoft Sans Serif
gw#PenWidth=1
'Colors
ClrBasicDark=gw#GetColorFromRGB(50 50 50)
ClrBackDark=gw#GetColorFromRGB(100 100 100)
ClrBorderDark=gw#GetColorFromRGB(150 150 150)
ClrTextDark=gw#GetColorFromRGB(200 200 200)
ClrLightGray=gw#GetColorFromRGB(245,245,245)
'Main
LoadImages()
LoadMainGUI()
Mouse.HideCursor()
AddTool()
sh#^^t_id["Pencil"],gw#MouseX - 38,gw#MouseY - 38)
!!gw#MouseY>50>>
sh#hh(t_idy)
||
sh#hh(t_id["Pencil"}
Mouse.ShowCursor()
}#
'
'Subroutines********************
Sub LoadImages
PathResources`j:\vb12pub\Images\
'ImageList.LoadImage(PathResources+il#pr
li_Colors=il#pr "Colors.png~
li_Pencil=il#pr "Pencil.png~
li_Brush=il#pr "Brush.png~
li_Eraser=il#pr "Eraser.png~
li_ColorPicker=il#pr "Color Picker.png~
li_Spray=il#pr "Spray.png~
li_CloseSm=il#pr "Close Spray Menu.png~
li_Text=il#pr "Text.png~
li_Fill=il#pr "Fill.png~
li_Shapes=il#pr "sh#png~
li_Mirror=il#pr "Mirror.png~
li_Horizontal=il#pr "Horizontal.png~
li_Vertical=il#pr "Vertical.png~
li_Select=il#pr "Select.png~
li_Cut=il#pr "Cut.png~
li_Copy=il#pr "Copy.png~
li_Paste=il#pr "Paste.png~
li_Pattern=il#pr "Pattern.png~
li_Lines=il#pr "Lines.bmp~
li_Squares=il#pr "Squares.bmp~
li_Circles=il#pr "Circles.bmp~
li_Triangles=il#pr "Triangles.bmp~
li_Rhombus=il#pr "Rhombus.bmp~
li_Cubes=il#pr "Cubes.bmp~
li_Spheres=il#pr "Spheres.bmp~
li_Pyramids=il#pr "Pyramids.bmp~
li_Ellipses=il#pr "Ellipses.bmp~
li_Crosses=il#pr "Crosses.bmp~
!es
'
Sub LoadMainGUI
gw#PenWidth=2
|>_T=1 To 49
gw#PenColor=gw#GetColorFromRGB(_T+50,_T+50,_T+50)
sh#AddLine(0,0+_T,_dw,0+_T)
#ef
gw#PenColor=ClrBorderDark
gw#bc=ClrTextDark
gw#PenWidth=3
|>_T=1 To 5
DdBorders[_T]=sh#AddEllipse(46,46)
sh#hh(DdBorders[_T}
#ef
gw#PenColor`Cyan
gw#bc`DarkTurquoise
sz_i=sh#AddEllipse(50,50)
sh#hh(sz_i)
gw#PenWidth=1.5
t_idy=sh#AddEllipse(50,50)
sh#^^t_idy,2,0)
sh#hh(t_idy)
gw#PenWidth=3
gw#PenColor=ClrBorderDark
gw#bc=ClrTextDark
|>_T=1 To 12
RecBorders[_T]=sh#AddEllipse(46,46)
sh#^^RecBorders[_T],_T * 55 - 51,2)
sh#Zoom(RecBorders[_T],0.9,0.9)
#ef
hSeparator=sh#AddLine(_dw/2,50,_dw/2,_dh)
sh#hh(hSeparator)
vSeparator=sh#AddLine(0,_dh/2 - 10,_dw,_dh/2 - 10)
sh#hh(vSeparator)
ImgColors=sh#AddImage(li_Colors)
sh#^^ImgColors,7,5)
sh#Zoom(ImgColors,0.8,0.8)
ImgPencil=sh#AddImage(li_Pencil)
sh#^^ImgPencil,63,5)
ImgBrush=sh#AddImage(li_Brush)
sh#^^ImgBrush,116,5)
ImgEraser=sh#AddImage(li_Eraser)
sh#^^ImgEraser,171,5)
ImgColorPicker=sh#AddImage(li_ColorPicker)
sh#^^ImgColorPicker,231,10)
ImgSpray=sh#AddImage(li_Spray)
sh#^^ImgSpray,286,9)
ImgText=sh#AddImage(li_Text)
sh#^^ImgText,340,10)
ImgFill=sh#AddImage(li_Fill)
sh#^^ImgFill,387,1)
sh#Zoom(ImgFill,0.9,0.9)
ImgShapes=sh#AddImage(li_Shapes)
sh#^^ImgShapes,442,2)
sh#Zoom(ImgShapes,0.85,0.85)
ImgMirror=sh#AddImage(li_Mirror)
sh#^^ImgMirror,498,1)
ImgSelect=sh#AddImage(li_Select)
sh#^^ImgSelect,561,9)
ImgPattern=sh#AddImage(li_Pattern)
sh#^^ImgPattern,612,5)
sh#Zoom(ImgPattern,0.7,0.7)
gw#PenWidth=1
gw#PenColor`Black
gw#bc`White
t_id["Pencil"]=sh#AddImage(li_Pencil)
t_id["Brush"]=sh#AddImage(li_Brush)
t_id["Eraser"]=!!(EraserSize,EraserSize)
t_id["ClrPck"]=sh#AddImage(li_ColorPicker)
t_id["Spray"]=sh#AddImage(li_Spray)
t_id["Fill"]=sh#AddImage(li_Fill)
!es
'
Sub AddTool
rm_aic()
_cmx=gw#MouseX
_cmy=gw#MouseY
!!_c_Tool`Select<<
||
CanClick_stl =t_
}#
!!_c_Tool`Pencil<<
sh#ss(t_id["Pencil"}
#ei _c_Tool`Brush<<
sh#ss(t_id["Brush"}
#ei _c_Tool`Eraser<<
!!EraserSize=10>>
cc#sz(t_id["Eraser"],10,10)
#ei EraserSize=15>>
cc#sz(t_id["Eraser"],15,15)
#ei EraserSize=20>>
cc#sz(t_id["Eraser"],20,20)
#ei EraserSize=25>>
cc#sz(t_id["Eraser"],25,25)
#ei EraserSize=30>>
cc#sz(t_id["Eraser"],30,30)
}#
sh#ss(t_id["Eraser"}
#ei _c_Tool`ColorPicker<<
sh#ss(t_id["ClrPck"}
#ei _c_Tool`Spray<<
sh#ss(t_id["Spray"}
#ei _c_Tool`Text<<
Mouse.ShowCursor()
#ei _c_Tool`Fill<<
sh#ss(t_id["Fill"}
#ei _c_Tool`Shapes<<
Mouse.ShowCursor()
}#
!es
'
Sub rm_aic
fx=ldtext.Split ("Pencil Brush Eraser ClrPck Spray Fill"," ~
|>f=1 To 8
sh#hh  (t_id [fx[f]}
#ef
!es
'
Sub AddIndicatorIcon
_cmx=gw#MouseX
_cmy=gw#MouseY
!!_c_Tool`Text" Or _c_Tool`Shapes" Or _c_Tool`Mirror" Or _c_Tool`Select" Or _c_Tool`Pattern<<
||
Mouse.HideCursor()
}#
!!_c_Tool`Pencil<<
sh#^^t_id["Pencil"],_cmx - 2,_cmy - 38)
sh#ss(t_id["Pencil"}
#ei _c_Tool`Brush<<
sh#^^t_id["Brush"],_cmx - 3,_cmy - 33)
sh#ss(t_id["Brush"}
#ei _c_Tool`Eraser<<
sh#^^t_id["Eraser"],_cmx - (EraserSize/2),_cmy - (EraserSize/2))
sh#ss(t_id["Eraser"}
#ei _c_Tool`ColorPicker<<
sh#^^t_id["ClrPck"],_cmx - 32,_cmy - 32)
sh#ss(t_id["ClrPck"}
!!ColorPickerLoaded =f_>>
LoadColorPicker()
ColorPickerLoaded =t_
}#
#ei _c_Tool`Spray<<
sh#^^t_id["Spray"],_cmx - 20,_cmy - 20)
sh#ss(t_id["Spray"}
#ei _c_Tool`Fill<<
sh#^^t_id["Fill"],_cmx - 20,_cmy - 20)
sh#ss(t_id["Fill"}
}#
!es
'
Sub ChooseColor
!!_lbd>>
gw#bc=b_cl
gw#PenColor=b_cl
#ei _rbd>>
gw#bc=_c2
gw#PenColor=_c2
}#
!es
'
Sub Draw
!!_Ym>0&&_Ym<50>>
rm_aic()
Mouse.ShowCursor()
||
AddIndicatorIcon()
!!C&$raw>>
!!_c_Tool`Pencil<<
ChooseColor()
gw#PenWidth=PencilSize
gw#DrawLine(x_m,_Ym,x_mNew,_YmNew)
!!MirrorAdded>>
!!_c_Mirror`Horizontal<<
!!_xd<(_dw/2)>>
gw#DrawLine(_dw - x_m,_Ym,_dw - x_mNew,_YmNew)
#ei _xd>(_dw/2)>>
xPosPencil=x_m - (_dw/2)
xPosPencil2=x_mNew - (_dw/2)
gw#DrawLine((_dw/2) - xPosPencil,_Ym,(_dw/2) - xPosPencil2,_YmNew)
}#
#ei _c_Mirror`Vertical<<
xPosVSeparator=_dh/2 - 10
!!_yd<xPosVSeparator>>
gw#DrawLine(x_m,_dh - _Ym - 20,x_mNew,_dh - _YmNew - 20)
||
yPosPencil=_Ym - (_dh/2)
yPosPencil2=_YmNew - (_dh/2)
gw#DrawLine(x_m,(_dh/2) - yPosPencil - 20,x_mNew,(_dh/2) - yPosPencil2 - 20)
}#3
#ei _c_Tool`Brush<<
ChooseColor()
gw#PenWidth=_bsz
gw#fe(x_m - (_bsz/2),_Ym - (_bsz/2),_bsz,_bsz)
gw#DrawLine(x_m,_Ym,x_mNew,_YmNew)
!!MirrorAdded>>
!!_c_Mirror`Horizontal<<
!!_xd<(_dw/2)>>
 gw#fe(_dw - x_m - (_bsz/2),_Ym - (_bsz/2),_bsz,_bsz)
  gw#DrawLine(_dw - x_m,_Ym,_dw - x_mNew,_YmNew)
#ei _xd>(_dw/2)>>
  xPosBrush=x_m - (_dw/2)
  xPosBrush2=x_mNew - (_dw/2)
 gw#fe(_dw - x_m - (_bsz/2),_Ym - (_bsz/2),_bsz,_bsz)
  gw#DrawLine((_dw/2) - xPosBrush,_Ym,(_dw/2) - xPosBrush2,_YmNew)
}#
#ei _c_Mirror`Vertical<<
xPosVSeparator=_dh/2 - 10
yPosBrush=_Ym - (_dh/2)
yPosBrush2=_YmNew - (_dh/2)
!!_yd<xPosVSeparator>>
 gw#fe(x_m - (_bsz/2),_dh - 20 - _Ym - (_bsz/2),_bsz,_bsz)
  gw#DrawLine(x_m,(_dh/2) - yPosbrush - 20,x_mNew,(_dh/2) - yPosBrush2 - 20)
||
 gw#fe(x_m - (_bsz/2),(_dh/2) - yPosBrush - 20 - (_bsz/2),_bsz,_bsz)
  gw#DrawLine(x_m,(_dh/2) - yPosBrush - 20,x_mNew,(_dh/2) - yPosBrush2 - 20)
}#
#ei _c_Tool`Eraser<<
!!_lbd>>
gw#PenColor`White
gw#bc`White
#ei _rbd>>
gw#PenColor=b_cl
gw#bc=b_cl
}#
gw#PenWidth=(EraserSize * 100)/80
gw#fr(x_m - (EraserSize/2),_Ym - (EraserSize/2),EraserSize,EraserSize)
gw#DrawLine(x_m,_Ym,x_mNew,_YmNew)
!!MirrorAdded>>
!!_c_Mirror`Horizontal<<
!!_xd<(_dw/2)>>
  gw#fr(_dw - x_m - (EraserSize/2),_Ym - (EraserSize/2),EraserSize,EraserSize)
  gw#DrawLine(_dw - x_m,_Ym,_dw - x_mNew,_YmNew)
#ei _xd>(_dw/2)>>
  xPosEraser=x_m - (_dw/2)
  xPosEraser2=x_mNew - (_dw/2)
  gw#fr((_dw/2) - xPosEraser - (EraserSize/2),_Ym - (EraserSize/2),EraserSize,EraserSize)
  gw#DrawLine((_dw/2) - xPosEraser,_Ym,(_dw/2) - xPosEraser2,_YmNew)
}#
#ei _c_Mirror`Vertical<<
xPosVSeparator=_dh/2 - 10
yPosEraser=_Ym - (_dh/2)
yPosEraser2=_YmNew - (_dh/2)
!!_yd<xPosVSeparator>>
  gw#fr(x_m - (EraserSize/2),_dh - 20 - _Ym - (EraserSize/2),EraserSize,EraserSize)
  gw#DrawLine(x_m,_dh - 20 - _Ym,x_mNew,_dh - 20 - _YmNew)
||
  gw#fr(x_m - (EraserSize/2),(_dh/2) - yPosEraser - 20 - (EraserSize/2),EraserSize,EraserSize)
  gw#DrawLine(x_m,(_dh/2) - yPosEraser - 20,x_mNew,(_dh/2) - yPosEraser2 - 20)
}#
#ei _c_Tool`Fill<<
ChooseColor()
gw#fr(0,0,_dw,_dh)
}#7
!es
'
Sub rm_sm
!!c_mn`TextMenu<<
TxtBody=cc#GetTextBoxText(t_sh[4}
TxtName=cc#GetTextBoxText(t_sh[9}
TxtSize=cc#GetTextBoxText(t_sh[13}
OldTxtBody=TxtBody
OldTxtName=TxtName
OldTxtSize=TxtSize
#ei c_mn`PatternsMenu<<
ClosePatternMenu()
}#
|>_T=1 To 5
sh#hh(DdBorders[_T}
sh#rm(PencilSizes[_T}
sh#rm(_bszs[_T}
sh#rm(EraserSizes[_T}
#ef
sh#hh(sz_i)

CloseColorPicker()
CloseSprayMenu()
CloseTextMenu()
CloseShapesMenu()
CloseMirrorMenu()
AddTool()
dd_t`None
c_mn`MainPaint
!es
'
Sub ShowDropDown
rm_aic()
gw#PenWidth=0
|>_T=1 To 5
sh#^^DdBorders[_T],d_px+1,_T * 47+3)
sh#ss(DdBorders[_T}
#ef
!!_c_Color`First<<
gw#PenColor=b_cl
gw#bc=b_cl
||
gw#PenColor=_c2
gw#bc=_c2
}#
!!dd_t`Pencil<<
|>_T=1 To 5
PencilSizes[_T]=!!(DdPencilSize,DdPencilSize)
sh#^^PencilSizes[_T],d_px+22,_T * 47+25)
DdPencilSize=DdPencilSize+1
#ef
DdPencilSize=1
#ei dd_t`Brush<<
|>_T=1 To 5
_bszs[_T]=sh#AddEllipse(Dd_bsz,Dd_bsz)
sh#^^_bszs[_T],d_px+DdBrushLeft,DdBrushTop)
DdBrushLeft=DdBrushLeft - 2
DdBrushTop=DdBrushTop+45
Dd_bsz=Dd_bsz+4
#ef
Dd_bsz=7
DdBrushLeft=20
DdBrushTop=70
#ei dd_t`Eraser<<
gw#PenColor`Black
gw#bc`White
gw#PenWidth=1
|>_T=1 To 5
EraserSizes[_T]=!!(DdEraserSize,DdEraserSize)
sh#^^EraserSizes[_T],d_px+DdEraserLeft,DdEraserTop)
DdEraserSize=DdEraserSize+5
DdEraserTop=DdEraserTop+44
DdEraserLeft=DdEraserLeft - 2
#ef
gw#PenWidth=0
sh#^^EraserSizes[4],d_px+DdEraserLeft+3,DdEraserTop - 88)
sh#^^EraserSizes[5],d_px+DdEraserLeft,DdEraserTop - 44)
DdEraserTop=69
DdEraserSize=10
DdEraserLeft=19
#ei dd_t`Spray<<
LoadSprayMenu()
}#
sh#^^sz_i,d_px - 1.15,48)
sh#ss(sz_i)
c_mn`DropDownSize
!es
'
Sub LoadColorPicker
ColorPickerLoaded =t_
PreviousTool=_c_Tool
gw#PenColor=ClrBorderDark
gw#bc=ClrBasicDark
cp_s[1]=!!(130,105)
gw#bc=ClrTextDark
cp_s[2]=sh#AddText("Hex:~
gw#SetPixel(0,0,b_cl)
px_p=gw#GetPixel(0,0)
gw#bc`S&$yBrown
cp_s[3]=sh#AddText(px_p)
gw#bc=b_cl
cp_s[4]=!!(110,60)
cp_s[5]=sh#AddImage(li_CloseSm)
MoveColorPicker()
!es
'
Sub CloseColorPicker
|>_T=1 To Array.GetItemCount(cp_s)
sh#rm(cp_s[_T}
#ef
!!PreviousTool`<<
||
_c_Tool=PreviousTool
PreviousTool`
}#
AddTool()
CpLeft=0
CpTop=0
ColorPickerLoaded =f_
c_mn`MainPaint
!es
'
sub MoveColorPicker
sh#^^cp_s[1],CpLeft,CpTop+50)
sh#^^cp_s[2],CpLeft+10,CpTop+60)
sh#^^cp_s[3],CpLeft+40,CpTop+61)
sh#^^cp_s[4],CpLeft+10,CpTop+85)
sh#^^cp_s[5],CpLeft+99,CpTop+49)
!es
'
sub LoadSprayMenu
|>_T=1 To 5
sh#hh(DdBorders[_T}
#ef
gw#PenColor=ClrBorderDark
gw#bc=ClrBasicDark
gw#PenWidth=1
s_sh[1]=!!(90,290)
sh#^^s_sh[1],d_px - 10,50)
gw#bc=ClrBasicDark
s_sh[2]=!!(210,290)
sh#^^s_sh[2],d_px+79,50)
gw#PenColor`DarkTurquoise
gw#bc`Cyan
s_sh[20]=sh#AddEllipse(34,34)
sh#^^s_sh[20],DdDotSizeIndiLeft,218)
s_sh[21]=!!(84,29)
s_sh[22]=!!(84,29)
sh#^^s_sh[21],x_sspIndi,298)
|>_T=1 To 5
gw#PenColor`Black
gw#bc=ClrBackDark
s_sh[3][_T]=sh#AddEllipse(50,50)
sh#^^s_sh[3][_T],d_px+10,_T * 50+15)
gw#bc=ClrBackDark
s_sh[4][_T]=sh#AddEllipse(30,30)
sh#^^s_sh[4][_T],55+d_px+190 * _T/5,220)
#ef
gw#PenWidth=3
gw#PenColor`DarkTurquoise
gw#bc`Cyan
s_sh[23]=sh#AddEllipse(50,50)
sh#^^s_sh[23],d_px+10,Dd_sszIndiTop)
gw#PenWidth=1
|>_T=1 To 5
gw#PenColor`Black
!!_c_Color`First<<
gw#PenColor=b_cl
gw#bc=b_cl
||
gw#PenColor=_c2
gw#bc=_c2
}#
s_sh[19][_T]=sh#AddEllipse(DdDotSize,DdDotSize)
sh#^^s_sh[19][_T],68+d_px+190 * _T/5,233)
s_sh[5][_T]=sh#AddEllipse(Dd_ssz,Dd_ssz)
sh#^^s_sh[5][_T],d_px+DdSprayLeft,DdSprayTop+30)
Dd_ssz=Dd_ssz+8
DdSprayBordersZoom=DdSprayBordersZoom+0.1
DdSprayLeft=DdSprayLeft - 4
DdSprayTop=DdSprayTop+46
DdDotSize=DdDotSize+1
s_sh[24][_T]=cc#AddButton("",d_px+10,_T * 50+15)
cc#sz(s_sh[24][_T],50,50)
sh#op(s_sh[24][_T],0)
s_sh[25][_T]=cc#AddButton("",55+d_px+190 * _T/5,220)
cc#sz(s_sh[25][_T],30,30)
sh#op(s_sh[25][_T],0)
#ef
Dd_ssz=10
DdSprayLeft=30
DdSprayTop=55
DdDotSize=1
gw#bc=ClrTextDark
s_sh[6]=sh#AddText("Amount of colors to use:~
s_sh[7]=sh#AddText("Size of dots:~
s_sh[8]=sh#AddText("Spraying speed:~
sh#^^s_sh[6],d_px+90,60)
sh#^^s_sh[7],d_px+90,190)
sh#^^s_sh[8],d_px+90,270)
gw#bc`Black
s_sh[9]=cc#AddButton("One",d_px+100,100)
s_sh[10]=cc#AddButton("Two",d_px+100,135)
s_sh[11]=cc#AddButton("Normal",d_px+95,300)
s_sh[12]=cc#AddButton("Fast",d_px+190,300)
|>_T=9 To 12
cc#sz(s_sh[_T],80,25)
#ef
gw#PenColor=ClrBorderDark
gw#PenWidth=2
s_sh[13]=!!(155,1)
s_sh[14]=!!(185,1)
s_sh[15]=!!(185,1)
sh#^^s_sh[13],d_px+90,80)
sh#^^s_sh[14],d_px+90,210)
sh#^^s_sh[15],d_px+90,290)
gw#PenWidth=1
gw#bc=_c2
gw#PenColor=ClrBorderDark
s_sh[17]=!!(60,60)
sh#^^s_sh[17],d_px+215,115)
gw#bc=b_cl
s_sh[16]=!!(60,60)
sh#^^s_sh[16],d_px+195,100)
!!SprayColors=1>>
sh#hh(s_sh[17}
sh#^^s_sh[22],d_px+98,98)
||
sh#ss(s_sh[17}
sh#^^s_sh[22],d_px+98,133)
}#
s_sh[18]=sh#AddImage(li_CloseSm)
sh#^^s_sh[18],d_px+258,49)
c_mn`SprayMenu
!es
'
sub CloseSprayMenu
|>_T=1 To Array.GetItemCount(s_sh)
sh#rm(s_sh[_T}
#ef
|>_L=3 To 5
|>_T=1 To 5
sh#rm(s_sh[_L][_T}
#ef
#ef
|>_T=1 To 5
sh#rm(s_sh[19][_T}
cc#Remove(s_sh[24][_T}
cc#Remove(s_sh[25][_T}
#ef
c_mn`MainPaint
!es
'
sub LoadTextMenu
gw#PenColor=ClrBorderDark
gw#bc=ClrBasicDark
t_sh[1]=!!(300,460)
sh#^^t_sh[1],d_px,50)
gw#bc=ClrTextDark
t_sh[2]=sh#AddText("Text to draw:~
sh#^^t_sh[2],d_px+10,60)
t_sh[3]=!!(250,1)
sh#^^t_sh[3],d_px+10,75)
gw#bc`Black
t_sh[4]=cc#AddMultiLineTextBox(d_px+10,85)
cc#sz(t_sh[4],280,150)
cc#SetTextBoxText(t_sh[4],OldTxtBody)
t_sh[5]=cc#AddButton("Clear",d_px+10,240)
cc#sz(t_sh[5],100,23)
t_sh[25]=cc#AddButton("Font",d_px+110,240)
cc#sz(t_sh[25],50,23)
gw#bc=ClrTextDark
t_sh[6]=sh#AddText("Font name:~
sh#^^t_sh[6],d_px+10,270)
t_sh[7]=!!(280,1)
sh#^^t_sh[7],d_px+10,285)
gw#bc`Black
t_sh[9]=cc#AddTextBox(d_px+10,295)
cc#sz(t_sh[9],280,20)
cc#SetTextBoxText(t_sh[9],OldTxtName)
gw#bc=ClrTextDark
t_sh[10]=sh#AddText("Font size:~
sh#^^t_sh[10],d_px+10,330)
t_sh[11]=!!(280,1)
sh#^^t_sh[11],d_px+10,345)
gw#bc`Black
t_sh[13]=cc#AddTextBox(d_px+10,355)
cc#sz(t_sh[13],280,20)
cc#SetTextBoxText(t_sh[13],OldTxtSize)
t_sh[15]=sh#AddImage(li_CloseSm)
sh#^^t_sh[15],d_px+269,49)
xCloseTm=sh#GetLeft(t_sh[15}
yCloseTm=sh#GetTop(t_sh[15}
gw#bc=ClrTextDark
t_sh[16]=sh#AddText("Font style:~
sh#^^t_sh[16],d_px+10,390)
t_sh[17]=!!(280,1)
sh#^^t_sh[17],d_px+10,405)
gw#PenColor`DarkTurquoise
gw#bc`Cyan
t_sh[21]=!!(139,27)
sh#^^t_sh[21],d_px+8,413)
t_sh[22]=!!(139,27)
sh#^^t_sh[22],d_px+153,413)
t_sh[23]=!!(139,27)
sh#^^t_sh[23],d_px+8,473)
t_sh[24]=!!(139,27)
sh#^^t_sh[24],d_px+153,473)
ConfigureOldTxtFontStyle()
ConfigureTmBackground()
gw#bc`Black
t_sh[19]=cc#AddButton("Bold",d_px+10,415)
cc#sz(t_sh[19],135,23)
t_sh[20]=cc#AddButton("Italic",d_px+155,415)
cc#sz(t_sh[20],135,23)
gw#bc=ClrTextDark
t_sh[8]=sh#AddText("Background:~
sh#^^t_sh[8],d_px+10,450)
gw#PenColor=ClrBorderDark
t_sh[12]=!!(280,1)
sh#^^t_sh[12],d_px+10,465)
gw#bc`Black
t_sh[18]=cc#AddButton("Solid",d_px+10,475)
cc#sz(t_sh[18],135,23)
t_sh[14]=cc#AddButton("Transparent",d_px+155,475)
cc#sz(t_sh[14],135,23)
c_mn`TextMenu
!es
'
sub CloseTextMenu
|>_T=1 To Array.GetItemCount(t_sh)
sh#rm(t_sh[_T}
#ef
!es
'
sub ConfigureOldTxtFontStyle
!!OldTxtFontBold =f_&&OldTxtFontItalic =f_>>
OldTxtFontStyle`None
sh#hh(t_sh[21}
sh#hh(t_sh[22}
#ei OldTxtFontBold =t_&&OldTxtFontItalic>>
OldTxtFontStyle`Bold,Italic
sh#ss(t_sh[21}
sh#ss(t_sh[22}
#ei OldTxtFontBold =t_&&OldTxtFontItalic =f_>>
OldTxtFontStyle`Bold
sh#ss(t_sh[21}
sh#hh(t_sh[22}
||
OldTxtFontStyle`Italic
sh#hh(t_sh[21}
sh#ss(t_sh[22}
}#
!es
'
Sub ConfigureTmBackground
!!OldTxtSolid>>
sh#ss(t_sh[23}
||
sh#hh(t_sh[23}
}#
!!OldTxtTransparent>>
sh#ss(t_sh[24}
||
sh#hh(t_sh[24}
}#
!es
'
Sub LoadShapesMenu
gw#PenColor=ClrBorderDark
gw#bc=ClrBasicDark
s_ms[1]=!!(230,360)
sh#^^s_ms[1],d_px,50)
gw#bc=ClrTextDark
s_ms[2]=sh#AddText("Shape:~
sh#^^s_ms[2],d_px+10,60)
s_ms[3]=!!(180,1)
sh#^^s_ms[3],d_px+10,75)
gw#PenColor`DarkTurquoise
gw#bc`Cyan
s_ms[12]=!!(104,84)
gw#PenColor`Black
gw#bc=ClrBackDark
s_ms[4]=!!(100,80)
sh#^^s_ms[4],d_px+10,85)
s_ms[5]=!!(100,80)
sh#^^s_ms[5],d_px+120,85)
s_ms[6]=!!(100,80)
sh#^^s_ms[6],d_px+10,175)
s_ms[7]=!!(100,80)
sh#^^s_ms[7],d_px+120,175)
gw#PenColor=b_cl
s_ms[8]=sh#AddLine(d_px+20,95,d_px+100,155)
s_ms[9]=!!(60,60)
sh#^^s_ms[9],d_px+140,95)
s_ms[10]=sh#AddEllipse(60,60)
sh#^^s_ms[10],d_px+30,185)
s_ms[11]=sh#AddTriangle(d_px+170,185,d_px+140,245,d_px+200,245)
gw#bc=ClrTextDark
s_ms[13]=sh#AddText("Background:~
sh#^^s_ms[13],d_px+10,270)
gw#PenColor=ClrBorderDark
s_ms[14]=!!(210,1)
sh#^^s_ms[14],d_px+10,285)
gw#PenColor`DarkTurquoise
gw#bc`Cyan
s_ms[17]=!!(104,27)
gw#PenColor=ClrBorderDark
gw#bc`Black
s_ms[15]=cc#AddButton("Solid",d_px+10,295)
cc#sz(s_ms[15],100,23)
s_ms[16]=cc#AddButton("Transparent",d_px+120,295)
cc#sz(s_ms[16],100,23)
gw#bc=ClrTextDark
s_ms[18]=sh#AddText("Border thickness:~
sh#^^s_ms[18],d_px+10,335)
s_ms[19]=!!(210,1)
sh#^^s_ms[19],d_px+10,350)
gw#PenColor`DarkTurquoise
gw#bc`Cyan
s_ms[22]=sh#AddEllipse(38,38)
sh#^^s_ms[22],_xwsh,358.5)
|>_T=1 To 5
gw#PenColor`Black
gw#bc=ClrBackDark
gw#PenWidth=1
s_ms[20][_T]=sh#AddEllipse(35,35)
sh#^^s_ms[20][_T],d_px+42 * _T - 29,360)
gw#PenWidth=_T - 1
gw#PenColor=b_cl
s_ms[21][_T]=sh#AddLine(0,0,20,0)
sh#^^s_ms[21][_T],d_px+42 * _T - 22,377)
s_ms[23][_T]=cc#AddButton("",d_px+42 * _T - 29,360)
cc#sz(s_ms[23][_T],35,35)
sh#op(s_ms[23][_T],0)
#ef
s_ms[0]=sh#AddImage(li_CloseSm)
sh#^^s_ms[0],d_px+199,49)
ud_sd()
c_mn`ShapesMenu
!es
'
Sub CloseShapesMenu
|>_T=0 To Array.GetItemCount(s_ms)
sh#rm(s_ms[_T}
#ef
|>_T=1 To 5
sh#rm(s_ms[20][_T}
sh#rm(s_ms[21][_T}
cc#Remove(s_ms[23][_T}
#ef
gw#PenWidth=1
!es
'
Sub ud_sd
|>_T=8 To 11
sh#rm(s_ms[_T}
#ef
!!cr_ss`Line<<
sh#^^s_ms[12],d_px+8,83)
#ei cr_ss`Rectangle<<
sh#^^s_ms[12],d_px+118,83)
#ei cr_ss`Ellipse<<
sh#^^s_ms[12],d_px+8,173)
#ei cr_ss`Triangle<<
sh#^^s_ms[12],d_px+118,173)
}#
!!bgsh`Solid<<
gw#bc=_c2
#ei bgsh`Transparent<<
gw#bc=ClrBackDark
}#
gw#PenWidth=pws_+1
s_ms[8]=sh#AddLine(d_px+20,95,d_px+100,155)
gw#PenWidth=pws_
s_ms[9]=!!(60,60)
sh#^^s_ms[9],d_px+140,95)
s_ms[10]=sh#AddEllipse(60,60)
sh#^^s_ms[10],d_px+30,185)
s_ms[11]=sh#AddTriangle(d_px+170,185,d_px+140,245,d_px+200,245)
gw#bc=ClrTextDark
!!bgsh`Solid<<
sh#^^s_ms[17],d_px+8,293)
#ei bgsh`Transparent<<
sh#^^s_ms[17],d_px+118,293)
}#
!es
'
Sub LoadMirrorMenu
gw#PenColor=ClrBorderDark
gw#bc=ClrBasicDark
MmShape[1]=!!(210,180)
sh#^^MmShape[1],d_px,50)
gw#PenColor`DarkTurquoise
gw#bc`Cyan
MmShape[4]=!!(94,94)
!!_c_Mirror`Horizontal<<
sh#^^MmShape[4],d_px+8,83)
#ei _c_Mirror`Vertical<<
sh#^^MmShape[4],d_px+108,83)
||
sh#hh(MmShape[4}
}#
gw#PenColor`Black
gw#bc=ClrBackDark
MmShape[2]=!!(90,90)
sh#^^MmShape[2],d_px+10,85)
MmShape[3]=!!(90,90)
sh#^^MmShape[3],d_px+110,85)
gw#PenColor=ClrBorderDark
MmShape[7]=sh#AddImage(li_Horizontal)
sh#^^MmShape[7],d_px+25,100)
MmShape[8]=sh#AddImage(li_Vertical)
sh#^^MmShape[8],d_px+125,100)
MmShape[5]=cc#AddButton("",d_px+10,90)
cc#sz(MmShape[5],90,90)
sh#op(MmShape[5],0)
MmShape[6]=cc#AddButton("",d_px+110,90)
cc#sz(MmShape[6],90,90)
sh#op(MmShape[6],0)
gw#bc`Black
MmShape[9]=cc#AddButton("Remove all mirrors",d_px+10,190)
cc#sz(MmShape[9],190,23)
gw#bc=ClrTextDark
MmShape[10]=sh#AddText("Mirror type:~
sh#^^MmShape[10],d_px+10,60)
MmShape[11]=!!(160,1)
sh#^^MmShape[11],d_px+10,75)
MmShape[12]=sh#AddImage(li_CloseSm)
sh#^^MmShape[12],d_px+179,49)
c_mn`MirrorMenu
!es
'
sub CloseMirrorMenu
|>_T=1 To Array.GetItemCount(MmShape)
sh#rm(MmShape[_T}
#ef
c_mn`MainPaint
!es
'
sub AddHorizontalMirror
CloseMirrorMenu()
RemoveMirrors()
_c_Mirror`Horizontal
sh#ss(hSeparator)
MirrorAdded =t_
!es
'
sub AddVerticalMirror
CloseMirrorMenu()
RemoveMirrors()
_c_Mirror`Vertical
sh#ss(vSeparator)
MirrorAdded =t_
!es
'
sub RemoveMirrors
CloseMirrorMenu()
sh#hh(hSeparator)
sh#hh(vSeparator)
_c_Mirror`None
MirrorAdded =f_
!es
'
sub lds_lm
gw#PenWidth=1
gw#PenColor=ClrBorderDark
gw#bc=ClrBasicDark
ww2=$r(gw#Width)
wh2=$r(gw#Height)
_sls[1]=!!(400,150)
sh#^^_sls[1],$r((ww2 - 400)/2),$r((wh2 - 100)/2))
gw#bc=ClrBackDark
_sls[2]=!!(380,110)
sh#^^_sls[2],$r((ww2 - 380)/2),$r((wh2 - 40)/2))
gw#bc`White
!!cr_ac`Copy" Or cr_ac`<<
_sls[3]=sh#AddText("Copying area...~
#ei cr_ac`Cut<<
_sls[3]=sh#AddText("Cutting area...~
#ei cr_ac`FlipHorizontal" Or cr_ac`FlipVertical<<
_sls[3]=sh#AddText("Please wait...~
||
_sls[3]=sh#AddText("~
}#
sh#^^_sls[3],$r((ww2 - 380)/2),$r((wh2/2) - 40))
gw#bc=ClrTextDark
!!cr_ac`Copy" Or cr_ac`<<
_sls[4]=sh#AddText("Please wait while the area is being copied.~
#ei cr_ac`Cut<<
_sls[4]=sh#AddText("Please wait while the area is being cut.~
#ei cr_ac`FlipHorizontal" Or cr_ac`FlipVertical<<
_sls[4]=sh#AddText("_c_ly storing the pixels of the area.~
}#
sh#^^_sls[4],(ww2 - 300)/2 (wh2/2)+10)
gw#bc=ClrBasicDark
_sls[5]=!!(300,10)
sh#^^_sls[5],$r((ww2 - 300)/2),$r((wh2/2)+40))
y_sls5=sh#GetTop(_sls[5}
gw#PenColor`Cyan
gw#bc`DarkTurquoise
_sls[13]=!!(54,54)
sh#^^_sls[13],$r((ww2 - 323)/2),$r(wh2/2+8))
sh#hh(_sls[13}
_sls[6]=!!(0,8)
sh#^^_sls[6],$r((ww2 - 300)/2+1),y_sls5+1)
_sls[7]=sh#AddImage(li_Cut)
sh#^^_sls[7],$r((ww2 - 315)/2),$r(wh2/2+10))
_sls[8]=sh#AddImage(li_Copy)
sh#^^_sls[8],$r((ww2 - 195)/2),$r(wh2/2+10))
_sls[9]=sh#AddImage(li_Paste)
sh#^^_sls[9],$r(ww2/2 - 27),$r(wh2/2+10))
_sls[10]=sh#AddImage(li_Horizontal)
sh#^^_sls[10],$r(ww2/2+30),$r(wh2/2+7))
sh#Zoom(_sls[10],0.8,0.8)
_sls[11]=sh#AddImage(li_Vertical)
sh#^^_sls[11],$r(ww2/2+95),$r(wh2/2+5))
sh#Zoom(_sls[11],0.8,0.8)
_sls[12]=sh#AddImage(li_CloseSm)
sh#^^_sls[12],$r(ww2/2+162),$r(wh2/2 - 50))
|>_T=7 To Array.GetItemCount(_sls)
sh#hh(_sls[_T}
#ef
c_mn`SelectLoadingMenu
!es
'
sub CopySelectedArea
c_mn`CopySelectedAreaMenu
MaxSelectedPixels=ar_w * ar_h
LbWidthAddition=298/MaxSelectedPixels
LbWidth=0
a1=ldArray.Create  ((ar_w+1)*(ar_h+1) )
sh#op(is_,10)
|>_L=ar_l To ar_w+ar_l
|>_T=ar_t To ar_h+ar_t
ldArray.SetValue (a1,_L-ar_l+(_T-ar_t)*ar_w   ,gw#GetPixel(_L,_T))
LbWidth=LbWidth+LbWidthAddition
!!LbWidth<298>>
cc#sz(_sls[6],LbWidth,8)
||
cc#sz(_sls[6],298,8)
}#
#ef
#ef
sh#op(is_,30)
shsam()
!es
'
Sub shsam
CanCloseis_ =f_
sh#rm(_sls[4}
sh#rm(_sls[5}
sh#rm(_sls[6}
|>_T=7 To Array.GetItemCount(_sls)
sh#ss(_sls[_T}
#ef
sh#tx(_sls[3],"Select an action |>the selected area~
sh#^^_sls[3],(ww2 - 380)/2,(wh2/2) - 40)
c_mn`SelectAction
!es
'
Sub cls_lm
|>_T=1 To Array.GetItemCount(_sls)
sh#rm(_sls[_T}
#ef
!!CanCloseis_>>
sh#rm(is_)
_c_Tool=Pre_stl
}#
CanAddis_ =t_
c_mn`MainPaint
!es
'
Sub pf_ac
!!cr_ac`Cut<<
CanCloseis_ =f_
cls_lm()
lds_lm()
CopySelectedArea()
gw#bc=_c2
gw#fr(ar_l,ar_t,ar_w,ar_h)
#ei cr_ac`Copy<<
CanCloseis_ =f_
cls_lm()
lds_lm()
CopySelectedArea()
#ei cr_ac`Paste<<
CanCloseis_ =t_
cls_lm()
LoadPastingMenu()
#ei cr_ac`FlipHorizontal<<
hFlipSelectedArea()
#ei cr_ac`FlipVertical<<
vFlipSelectedArea()
}#
!es
'
Sub LoadPastingMenu
c_mn`PastingMenu
CanPaste =t_
gw#PenWidth=1
gw#PenColor`Black
gw#bc`SkyBlue
IndiPaste=!!(ar_w,ar_h)
sh#op(IndiPaste,30)
sh#^^IndiPaste,_xd - (ar_w/2),_yd - (ar_h/2))
!es
'
Sub LoadVerifyPaste
c_mn`VerifyPasteMenu
gw#bc=ClrBasicDark
gw#PenColor=ClrBorderDark
Old_xd=_xd
Old_yd=_yd
!!_xd<199>>
_xd=100
#ei _xd>gw#Width - 199>>
_xd=gw#Width - 100
}#
!!_yd<90>>
_yd=50
#ei _yd>gw#Height - 40>>
_yd=gw#Height - 40
}#
Vp_sh[1]=!!(200,80)
sh#^^Vp_sh[1],_xd - 100,_yd - 40)
gw#bc=ClrBackDark
Vp_sh[2]=!!(180,40)
sh#^^Vp_sh[2],_xd - 90,_yd - 10)
gw#bc=ClrTextDark
Vp_sh[3]=sh#AddText("Paste here?~
sh#^^Vp_sh[3],_xd - 90,_yd - 30)
gw#bc`Black
Vp_sh[4]=cc#AddButton("Yes",_xd - 85,_yd)
cc#sz(Vp_sh[4],80,23)
Vp_sh[5]=cc#AddButton("No",_xd+5,_yd)
cc#sz(Vp_sh[5],80,23)
_xd=Old_xd
_yd=Old_yd
!es
'
Sub CloseVerifyPaste
sh#rm(IndiPaste)
|>_T=1 To Array.GetItemCount(Vp_sh)
sh#rm(Vp_sh[_T}
#ef
!es
'
Sub ReAddis_
gw#PenColor`Black
gw#bc`SkyBlue
is_=!!(ar_w,ar_h)
sh#op(is_,30)
sh#^^is_,ar_l,ar_t)
!es
'
Sub Paste
c_mn`PasteMenu
|>_L=ar_l To ar_w+ar_l
|>_T=ar_t To ar_h+ar_t
' gw#SetPixel(_xd+_L - ar_l,_yd+_T - ar_t,SelectedPixel[_L][_T}
gw#SetPixel(_xd +_L -ar_l ,_yd+_T - ar_t,ldArray.GetValue (a1,_L-ar_l  +(_T-ar_t)  *ar_w) )
#ef
#ef
sh#rm(is_)
c_mn`MainPaint
AddTool()
!es
'
Sub hFlipSelectedArea
c_mn`hFlipMenu
cls_lm()
lds_lm()
CopySelectedArea()
cls_lm()
sh#rm(is_)
|>x=ar_l To ar_l+ar_w Step 1
k=k+2
|>y=ar_t To ar_t+ar_h Step 1
gw#SetPixel((x - k)+ar_w,y,ldArray.GetValue (a1,x-ar_l +(y-ar_t )*ar_w) )
#ef
#ef
ldArray.Delete (a1)
k=0
!es
'
Sub vFlipSelectedArea
c_mn`vFlipMenu
cls_lm()
lds_lm()
CopySelectedArea()
cls_lm()
sh#rm(is_)
|>y=ar_t To ar_t+ar_h
k=k+2
|>x=ar_l To ar_l+ar_w
gw#SetPixel(x,y-k+ar_h ,ldArray.GetValue (a1,x-ar_l +(y-ar_t )*ar_w) )
#ef
#ef
ldArray.Delete (a1)
k=0
!es
'
Sub LoadPatternsMenu
gw#PenWidth=1
gw#PenColor=ClrBorderDark
gw#bc=ClrBasicDark
p_sh[1]=!!(310,545)
sh#^^p_sh[1],d_px,50)
gw#PenColor`Cyan
gw#bc`DarkTurquoise
p_sh[76]=!!(144,27)
sh#^^p_sh[76],xIndiPatR&$Clrs,493)
p_sh[40]=!!(54,54)
sh#^^p_sh[40],x_ip,y_ip)
p_sh[41]=!!(144,27)
sh#^^p_sh[41],x_ipBorder,353)
p_sh[42]=sh#AddEllipse(39,39)
sh#^^p_sh[42],x_btc,416)
!!p_brd =f_>>
sh#hh(p_sh[42}
}#
gw#PenColor=ClrBorderDark
gw#bc=ClrTextDark
p_sh[2]=sh#AddText("Pattern type:~
sh#^^p_sh[2],d_px+10,60)
p_sh[71]=sh#AddText(c_pt)
sh#^^p_sh[71],d_px+80,60)
p_sh[72]=sh#AddText("Use r&$om colors:~
sh#^^p_sh[72],d_px+10,470)
p_sh[77]=!!(290,1)
sh#^^p_sh[77],d_px+10,550)
p_sh[78]=sh#AddText("Pattern drawing mode:~
sh#^^p_sh[78],d_px+10,535)
p_sh[73]=!!(290,1)
sh#^^p_sh[73],d_px+10,485)
p_sh[3]=!!(260,1)
sh#^^p_sh[3],d_px+10,75)
gw#PenColor`Black
gw#bc=ClrBackDark
|>_T=4 To 8
p_sh[_T]=!!(50,50)
sh#^^p_sh[_T],_T * 60+d_px - 230,85)
#ef
|>_T=9 To 13
p_sh[_T]=!!(50,50)
sh#^^p_sh[_T],_T * 60+d_px - 530,145)
#ef
p_sh[61]=sh#AddImage(li_Lines)
sh#^^p_sh[61],d_px+13,88)
p_sh[62]=sh#AddImage(li_Squares)
sh#^^p_sh[62],d_px+73,88)
p_sh[63]=sh#AddImage(li_Circles)
sh#^^p_sh[63],d_px+133,88)
p_sh[64]=sh#AddImage(li_Triangles)
sh#^^p_sh[64],d_px+193,88)
p_sh[65]=sh#AddImage(li_Rhombus)
sh#^^p_sh[65],d_px+253,88)
p_sh[66]=sh#AddImage(li_Cubes)
sh#^^p_sh[66],d_px+13,148)
p_sh[67]=sh#AddImage(li_Spheres)
sh#^^p_sh[67],d_px+73,148)
p_sh[68]=sh#AddImage(li_Pyramids)
sh#^^p_sh[68],d_px+133,148)
p_sh[69]=sh#AddImage(li_Ellipses)
sh#^^p_sh[69],d_px+193,148)
p_sh[70]=sh#AddImage(li_Crosses)
sh#^^p_sh[70],d_px+253,148)
|>_T=50 To 54
p_sh[_T]=cc#AddButton("",_T * 60+d_px - 2990,85)
cc#sz(p_sh[_T],50,50)
sh#op(p_sh[_T],0)
#ef
|>_T=55 To 59
p_sh[_T]=cc#AddButton("",_T * 60+d_px - 3290,145)
cc#sz(p_sh[_T],50,50)
sh#op(p_sh[_T],0)
#ef
gw#PenColor=ClrBorderDark
gw#bc=ClrTextDark
p_sh[14]=sh#AddText("Particle width:~
sh#^^p_sh[14],d_px+10,210)
p_sh[15]=!!(290,1)
sh#^^p_sh[15],d_px+10,225)
gw#bc`Black
p_sh[16]=cc#AddTextBox(d_px+10,235)
cc#sz(p_sh[16],290,20)
cc#SetTextBoxText(p_sh[16],pr_wd)
gw#bc=ClrTextDark
p_sh[17]=sh#AddText("Particle height:~
sh#^^p_sh[17],d_px+10,270)
p_sh[18]=!!(290,1)
sh#^^p_sh[18],d_px+10,285)
gw#bc`Black
p_sh[19]=cc#AddTextBox(d_px+10,295)
cc#sz(p_sh[19],290,20)
cc#SetTextBoxText(p_sh[19],pr_ht)
p_sh[22]=cc#AddButton("Yes",d_px+10,355)
cc#sz(p_sh[22],140,23)
p_sh[23]=cc#AddButton("No",d_px+160,355)
cc#sz(p_sh[23],140,23)
gw#bc=ClrTextDark
p_sh[20]=sh#AddText("Add a border to each particle:~
sh#^^p_sh[20],d_px+10,330)
p_sh[21]=!!(290,1)
sh#^^p_sh[21],d_px+10,345)
gw#bc=ClrTextDark
p_sh[24]=sh#AddText("Border thickness:~
sh#^^p_sh[24],d_px+10,393)
p_sh[25]=!!(290,1)
sh#^^p_sh[25],d_px+10,408)
gw#PenColor`Black
gw#bc=ClrBackDark
|>_T=26 To 32
p_sh[_T]=sh#AddEllipse(35,35)
sh#^^p_sh[_T],_T * 42+d_px - 1080,418)
#ef
AdditionThickness=0
gw#PenColor`Black
|>_T=33 To 39
AdditionThickness=AdditionThickness+1
gw#PenWidth=AdditionThickness
p_sh[_T]=sh#AddLine(_T * 42+d_px - 1364,435,(_T * 42+d_px - 1364)+15,435)
#ef
|>_T=43 To 49
p_sh[_T]=cc#AddButton("",_T * 42+d_px - 1794,418)
cc#sz(p_sh[_T],35,35)
sh#op(p_sh[_T],0)
#ef
gw#bc`Black
p_sh[74]=cc#AddButton("Yes",d_px+10,495)
cc#sz(p_sh[74],140,23)
p_sh[75]=cc#AddButton("No",d_px+160,495)
cc#sz(p_sh[75],140,23)
p_sh[60]=cc#AddButton("Fullscreen",d_px+10,560)
cc#sz(p_sh[60],290,23)
p_sh[0]=sh#AddImage(li_CloseSm)
sh#^^p_sh[0],d_px+279,49)
c_mn`PatternsMenu
!es
'
Sub ClosePatternMenu
Getpr_wd=cc#GetTextBoxText(p_sh[16}
Getpr_ht=cc#GetTextBoxText(p_sh[19}
!!Getpr_wd`" Or Getpr_ht`<<
gw#ShowMessage("Please make sure that all data have been entered.","Information~
||
!!Getpr_wd>0&&Getpr_ht>0>>
pr_wd=Getpr_wd
pr_ht=Getpr_ht
|>_T=0 To Array.GetItemCount(p_sh)
sh#rm(p_sh[_T}
#ef
c_mn`MainPaint
||
gw#ShowMessage("Invalid values have been entered.","Error~
}#2
!es
'
Sub DrawPattern
gw#PenWidth=p_bt
!!DrawFullscreen =f_>>
pttwd=xUp - _xd
pttht=yUp - _yd
#ei DrawFullscreen>>
pttwd=_dw
pttht=_dh
_xd=0
_yd=50
xUp=_dw
yUp=_dh
}#
!!c_pt`Lines<<
|>_T=1 To (pttht+pr_ht)/pr_ht
!!PatternR&$omClrs =f_>>
gw#PenColor=b_cl
||
gw#PenColor=gw#GetR&$omColor()
}#
gw#DrawLine(_xd,_yd+_T * pr_ht - pr_ht,xUp,_yd+_T * pr_ht - pr_ht)
#ef
|>_T=1 To (pttwd+pr_wd)/pr_wd
!!PatternR&$omClrs =f_>>
gw#PenColor=b_cl
||
gw#PenColor=gw#GetR&$omColor()
}#
gw#DrawLine(_xd+_T * pr_wd - pr_wd,_yd,_xd+_T * pr_wd - pr_wd,yUp)
#ef
#ei c_pt`Squares<<
!!PatternR&$omClrs>>
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#bc=gw#GetR&$omColor()
gw#fr(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht)
#ef
#ef
||
gw#bc=_c2
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#fr(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht)
#ef
#ef
gw#bc=b_cl
|>_L=1 To (pttwd+pr_wd)/pr_wd Step 2
|>_T=1 To (pttht+pr_ht)/pr_ht Step 2
gw#fr(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht) 
#ef
#ef
|>_L=1 To (pttwd+pr_wd)/pr_wd Step 2
|>_T=1 To (pttht+pr_ht)/pr_ht Step 2
gw#fr(_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,pr_wd,pr_ht) 
#ef
#ef
}#
!!p_brd>>
|>_L=1 To (pttwd+pr_wd)/pr_wd Step 2
|>_T=1 To (pttht+pr_ht)/pr_ht Step 2
gw#DrawRectangle(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht) 
#ef
#ef
|>_L=1 To (pttwd+pr_wd)/pr_wd Step 2
|>_T=1 To (pttht+pr_ht)/pr_ht Step 2
gw#DrawRectangle(_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,pr_wd,pr_ht) 
#ef
#ef
}#
#ei c_pt`Circles<<
!!PatternR&$omClrs>>
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#bc=gw#GetR&$omColor()
gw#fe(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht)
#ef
#ef
||
gw#bc=_c2
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#fe(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht) 
#ef
#ef
gw#bc=b_cl
|>_L=1 To (pttwd+pr_wd)/pr_wd Step 2
|>_T=1 To (pttht+pr_ht)/pr_ht Step 2
gw#fe(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht) 
#ef
#ef
|>_L=1 To (pttwd+pr_wd)/pr_wd Step 2
|>_T=1 To (pttht+pr_ht)/pr_ht Step 2
gw#fe(_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,pr_wd,pr_ht)
#ef
#ef
}#
!!p_brd>>
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#DrawEllipse(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht) 
#ef
#ef
|>_L=1 To (pttwd+pr_wd)/pr_wd Step 2
|>_T=1 To (pttht+pr_ht)/pr_ht Step 2
gw#DrawEllipse(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht) 
#ef
#ef
|>_L=1 To (pttwd+pr_wd)/pr_wd Step 2
|>_T=1 To (pttht+pr_ht)/pr_ht Step 2
gw#DrawEllipse(_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,pr_wd,pr_ht) 
#ef
#ef
}#
#ei c_pt`Triangles<<
!!PatternR&$omClrs =f_>>
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#bc=b_cl
gw#FillTriangle(_xd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht)
gw#bc=_c2
gw#FillTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+pr_wd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht)
#ef
#ef
||
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#bc=gw#GetR&$omColor()
gw#FillTriangle(_xd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht)
gw#bc=gw#GetR&$omColor()
gw#FillTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+pr_wd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht)
#ef
#ef
}#
!!p_brd>>
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#DrawTriangle(_xd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht)
gw#DrawTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+pr_wd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht)
#ef
#ef
}#
#ei c_pt`Rhombuses<<
!!p_brd>>
!!Math.Remainder(p_bt,2)=0>>
||
p_bt=p_bt+1
}#
gw#PenWidth=p_bt
}#
!!PatternR&$omClrs>>
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
ColorUsed1=gw#GetR&$omColor()
gw#bc=ColorUsed1
gw#FillTriangle(_xd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#FillTriangle(_xd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht)
ColorUsed2=gw#GetR&$omColor()
gw#bc=ColorUsed2
gw#FillTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+pr_wd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#FillTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+pr_ht+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+pr_wd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht)
!!p_brd>>
gw#PenColor`Black
gw#DrawTriangle(_xd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#DrawTriangle(_xd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#DrawTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+pr_wd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#DrawTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+pr_ht+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+pr_wd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#PenColor=ColorUsed1
gw#DrawLine(_xd+p_bt+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd - p_bt,_yd+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#PenColor=ColorUsed2
gw#DrawLine(_xd+(pr_wd/2)+p_bt+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+pr_wd+_L * pr_wd - pr_wd - p_bt,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht)
}#
#ef
#ef
||
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#bc=b_cl
gw#FillTriangle(_xd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#FillTriangle(_xd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#bc=_c2
gw#FillTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+pr_wd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#FillTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+pr_ht+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+pr_wd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht)
!!p_brd>>
gw#PenColor`Black
gw#DrawTriangle(_xd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#DrawTriangle(_xd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#DrawTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+pr_wd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#DrawTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+pr_ht+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+pr_wd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#PenColor=b_cl
gw#DrawLine(_xd+p_bt+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd - p_bt,_yd+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#PenColor=_c2
gw#DrawLine(_xd+(pr_wd/2)+p_bt+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+pr_wd+_L * pr_wd - pr_wd - p_bt,_yd+(pr_ht/2)+(pr_ht/2)+_T * pr_ht - pr_ht)
}#
#ef
#ef
}#
#ei c_pt`Cubes<<
!!PatternR&$omClrs =f_>>
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#bc`Gray
gw#fr(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht)
gw#bc`DarkGray
gw#fr(_xd+(pr_wd - (pr_wd/1.2))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.2))/2+_T * pr_ht - pr_ht,pr_wd/1.2,pr_ht/1.2)
gw#bc`LightGray
gw#fr(_xd+(pr_wd - (pr_wd/1.4))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.4))/2+_T * pr_ht - pr_ht,pr_wd/1.4,pr_ht/1.4)
gw#bc`Gainsboro
gw#fr(_xd+(pr_wd - (pr_wd/1.8))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.8))/2+_T * pr_ht - pr_ht,pr_wd/1.8,pr_ht/1.8)
gw#bc`White
gw#fr(_xd+(pr_wd - (pr_wd/2.6))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/2.6))/2+_T * pr_ht - pr_ht,pr_wd/2.6,pr_ht/2.6)
#ef
#ef
||
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#bc=gw#GetR&$omColor()
gw#fr(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht)
gw#bc=gw#GetR&$omColor()
gw#fr(_xd+(pr_wd - (pr_wd/1.2))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.2))/2+_T * pr_ht - pr_ht,pr_wd/1.2,pr_ht/1.2)
gw#bc=gw#GetR&$omColor()
gw#fr(_xd+(pr_wd - (pr_wd/1.4))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.4))/2+_T * pr_ht - pr_ht,pr_wd/1.4,pr_ht/1.4)
gw#bc=gw#GetR&$omColor()
gw#fr(_xd+(pr_wd - (pr_wd/1.8))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.8))/2+_T * pr_ht - pr_ht,pr_wd/1.8,pr_ht/1.8)
gw#bc=gw#GetR&$omColor()
gw#fr(_xd+(pr_wd - (pr_wd/2.6))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/2.6))/2+_T * pr_ht - pr_ht,pr_wd/2.6,pr_ht/2.6)
#ef
#ef
}#
!!p_brd>>
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
'gw#PenColor`Black
gw#DrawRectangle(_xd+(pr_wd - (pr_wd/1.2))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.2))/2+_T * pr_ht - pr_ht,pr_wd/1.2,pr_ht/1.2)
gw#DrawRectangle(_xd+(pr_wd - (pr_wd/1.4))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.4))/2+_T * pr_ht - pr_ht,pr_wd/1.4,pr_ht/1.4)
gw#DrawRectangle(_xd+(pr_wd - (pr_wd/1.8))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.8))/2+_T * pr_ht - pr_ht,pr_wd/1.8,pr_ht/1.8)
gw#DrawRectangle(_xd+(pr_wd - (pr_wd/2.6))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/2.6))/2+_T * pr_ht - pr_ht,pr_wd/2.6,pr_ht/2.6)
#ef
#ef
}#
#ei c_pt`Spheres<<
!!PatternR&$omClrs =f_>>
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#bc`Gray
gw#fe(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht)
gw#bc`DarkGray
gw#fe(_xd+(pr_wd - (pr_wd/1.2))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.2))/2+_T * pr_ht - pr_ht,pr_wd/1.2,pr_ht/1.2)
gw#bc`LightGray
gw#fe(_xd+(pr_wd - (pr_wd/1.4))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.4))/2+_T * pr_ht - pr_ht,pr_wd/1.4,pr_ht/1.4)
gw#bc`Gainsboro
gw#fe(_xd+(pr_wd - (pr_wd/1.8))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.8))/2+_T * pr_ht - pr_ht,pr_wd/1.8,pr_ht/1.8)
gw#bc`White
gw#fe(_xd+(pr_wd - (pr_wd/2.6))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/2.6))/2+_T * pr_ht - pr_ht,pr_wd/2.6,pr_ht/2.6)
#ef
#ef
||
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#bc=gw#GetR&$omColor()
gw#fe(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht)
gw#bc=gw#GetR&$omColor()
gw#fe(_xd+(pr_wd - (pr_wd/1.2))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.2))/2+_T * pr_ht - pr_ht,pr_wd/1.2,pr_ht/1.2)
gw#bc=gw#GetR&$omColor()
gw#fe(_xd+(pr_wd - (pr_wd/1.4))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.4))/2+_T * pr_ht - pr_ht,pr_wd/1.4,pr_ht/1.4)
gw#bc=gw#GetR&$omColor()
gw#fe(_xd+(pr_wd - (pr_wd/1.8))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.8))/2+_T * pr_ht - pr_ht,pr_wd/1.8,pr_ht/1.8)
gw#bc=gw#GetR&$omColor()
gw#fe(_xd+(pr_wd - (pr_wd/2.6))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/2.6))/2+_T * pr_ht - pr_ht,pr_wd/2.6,pr_ht/2.6)
#ef
#ef
}#
!!p_brd>>
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#PenColor`Black
gw#DrawEllipse(_xd+(pr_wd - (pr_wd/1.2))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.2))/2+_T * pr_ht - pr_ht,pr_wd/1.2,pr_ht/1.2)
gw#DrawEllipse(_xd+(pr_wd - (pr_wd/1.4))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.4))/2+_T * pr_ht - pr_ht,pr_wd/1.4,pr_ht/1.4)
gw#DrawEllipse(_xd+(pr_wd - (pr_wd/1.8))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/1.8))/2+_T * pr_ht - pr_ht,pr_wd/1.8,pr_ht/1.8)
gw#DrawEllipse(_xd+(pr_wd - (pr_wd/2.6))/2+_L * pr_wd - pr_wd,_yd+(pr_wd - (pr_wd/2.6))/2+_T * pr_ht - pr_ht,pr_wd/2.6,pr_ht/2.6)
#ef
#ef
}#
#ei c_pt`Pyramids<<
!!PatternR&$omClrs =f_>>
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#bc`Gray
gw#FillTriangle(_xd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht)
gw#bc`DarkGray
gw#FillTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht - (pr_ht/3),_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht)
gw#bc`LightGray
#ef
#ef
||
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#bc=gw#GetR&$omColor()
gw#FillTriangle(_xd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht)
gw#bc=gw#GetR&$omColor()
gw#FillTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht - (pr_ht/3),_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht)
gw#bc=gw#GetR&$omColor()
#ef
#ef
}#
!!p_brd>>
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#DrawTriangle(_xd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht)
gw#DrawTriangle(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht - (pr_ht/3),_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,_xd+pr_wd+_L * pr_wd - pr_wd,_yd+pr_ht+_T * pr_ht - pr_ht)
#ef
#ef
}#
#ei c_pt`Ellipses<<
xLength=(pttwd/2) - pr_wd/2
yLength=(pttht/2) - pr_ht/2
Angle=0.0
AngleStepSize=0.1
While (Angle<2 * Math.Pi)
x=xLength * Math.Cos(Angle)
y=yLength * Math.Sin(Angle)
!!PatternR&$omClrs>>
gw#PenColor=gw#GetR&$omColor()
}#
gw#DrawEllipse(_xd+x+xLength,_yd+y+yLength,pr_wd,pr_ht)
Angle=Angle+AngleStepSize
EndWhile
#ei c_pt`Crosses<<
!!PatternR&$omClrs =f_>>
gw#PenColor=b_cl
gw#bc=_c2
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#DrawEllipse(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht)
gw#fe(_xd+(pr_wd/3.6)+_L * pr_wd - pr_wd,_yd+(pr_ht/3.6)+_T * pr_ht - pr_ht,pr_wd/2,pr_ht/2)
gw#DrawLine(_xd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+pttwd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#DrawLine(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+pttht)
#ef
#ef
||
|>_L=1 To (pttwd+pr_wd)/pr_wd
|>_T=1 To (pttht+pr_ht)/pr_ht
gw#PenColor=gw#GetR&$omColor()
gw#bc=gw#GetR&$omColor()
gw#DrawEllipse(_xd+_L * pr_wd - pr_wd,_yd+_T * pr_ht - pr_ht,pr_wd,pr_ht)
gw#fe(_xd+(pr_wd/3.6)+_L * pr_wd - pr_wd,_yd+(pr_ht/3.6)+_T * pr_ht - pr_ht,pr_wd/2,pr_ht/2)
gw#PenColor=gw#GetR&$omColor()
gw#DrawLine(_xd+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht,_xd+(pr_wd/2)+pttwd,_yd+(pr_ht/2)+_T * pr_ht - pr_ht)
gw#DrawLine(_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd,_xd+(pr_wd/2)+_L * pr_wd - pr_wd,_yd+(pr_ht/2)+pttht)
#ef
#ef
}#2
!es

'Subroutines - System'********************
cc#ButtonClicked=ButtonClicked
Sub ButtonClicked
lbt=cc#LastClickedButton
!!lbt=s_sh[9]>>
SprayColors=1
sh#hh(s_sh[17}
sh#^^s_sh[22],d_px+98,98)
#ei lbt=s_sh[10]>>
SprayColors=2
sh#ss(s_sh[17}
sh#^^s_sh[22],d_px+98,133)
#ei lbt=s_sh[11]>>
_ssp=10
x_sspIndi=d_px+93
sh#^^s_sh[21],x_sspIndi,298)
#ei lbt=s_sh[12]>>
_ssp=1
x_sspIndi=d_px+188
sh#^^s_sh[21],x_sspIndi,298)
#ei lbt=s_sh[24][1]>>
cc#Move(s_sh[23],d_px+10,65)
Dd_sszIndiTop=65
_ssz=10
#ei lbt=s_sh[24][2]>>
cc#Move(s_sh[23],d_px+10,115)
Dd_sszIndiTop=115
_ssz=15
#ei lbt=s_sh[24][3]>>
cc#Move(s_sh[23],d_px+10,165)
Dd_sszIndiTop=165
_ssz=20
#ei lbt=s_sh[24][4]>>
cc#Move(s_sh[23],d_px+10,215)
Dd_sszIndiTop=215
_ssz=25
#ei lbt=s_sh[24][5]>>
cc#Move(s_sh[23],d_px+10,265)
Dd_sszIndiTop=265
_ssz=30
#ei lbt=s_sh[25][1]>>
sh#^^s_sh[20],d_px+91,218)
DdDotSizeIndiLeft=d_px+91
_sdz=1
#ei lbt=s_sh[25][2]>>
sh#^^s_sh[20],d_px+129,218)
DdDotSizeIndiLeft=d_px+129
_sdz=2
#ei lbt=s_sh[25][3]>>
sh#^^s_sh[20],d_px+167,218)
DdDotSizeIndiLeft=d_px+167
_sdz=3
#ei lbt=s_sh[25][4]>>
sh#^^s_sh[20],d_px+205,218)
DdDotSizeIndiLeft=d_px+205
_sdz=4
#ei lbt=s_sh[25][5]>>
sh#^^s_sh[20],d_px+243,218)
DdDotSizeIndiLeft=d_px+243
_sdz=5
#ei lbt=t_sh[5]>>
cc#SetTextBoxText(t_sh[4],"~
#ei lbt=t_sh[19]>>
!!OldTxtFontBold =f_>>
OldTxtFontBold =t_
sh#ss(t_sh[21}
||
OldTxtFontBold =f_
sh#hh(t_sh[21}
}#
#ei lbt=t_sh[20]>>
!!OldTxtFontItalic =f_>>
OldTxtFontItalic =t_
sh#ss(t_sh[22}
||
OldTxtFontItalic =f_
sh#hh(t_sh[22}
}#
#ei lbt=t_sh[18]>>
OldTxtSolid =t_
OldTxtTransparent =f_
sh#ss(t_sh[23}
sh#hh(t_sh[24}
#ei lbt=t_sh[25]>>
ffn=LDDialogs.Font("~
cc#SetTextBoxText (t_sh [9],ffn[1}
cc#SetTextBoxText (t_sh [13] ,ffn[2}

#ei lbt=t_sh[14]>>
OldTxtTransparent =t_
OldTxtSolid =f_
sh#ss(t_sh[24}
sh#hh(t_sh[23}
#ei lbt=s_ms[23][1]>>
!!bgsh`Transparent<<
gw#ShowMessage("The thickness of the border can't be 0 when the background of the shape is transparent.","Information~
||
_xwsh=451.5
pws_=0
sh#^^s_ms[22],_xwsh,358.5)
ud_sd()
}#
#ei lbt=s_ms[23][2]>>
_xwsh=493.5
pws_=1
sh#^^s_ms[22],_xwsh,358.5)
ud_sd()
#ei lbt=s_ms[23][3]>>
_xwsh=535.5
pws_=2
sh#^^s_ms[22],_xwsh,358.5)
ud_sd()
#ei lbt=s_ms[23][4]>>
_xwsh=577.5
pws_=3
sh#^^s_ms[22],_xwsh,358.5)
ud_sd()
#ei lbt=s_ms[23][5]>>
_xwsh=619.5
pws_=4
sh#^^s_ms[22],_xwsh,358.5)
ud_sd()
#ei lbt=s_ms[15]>>
bgsh`Solid
ud_sd()
#ei lbt=s_ms[16]>>
!!pws_=0>>
gw#ShowMessage("The background of the shape can't be transparent when the thickness of the border is 0.","Information~
||
bgsh`Transparent
ud_sd()
}#
#ei lbt=MmShape[5]>>
AddHorizontalMirror()
#ei lbt=MmShape[6]>>
AddVerticalMirror()
#ei lbt=MmShape[9]>>
RemoveMirrors()
#ei lbt=Vp_sh[4]>>
CloseVerifyPaste()
Paste()
#ei lbt=Vp_sh[5]>>
CloseVerifyPaste()
ReAddis_()
lds_lm()
shsam()
#ei lbt=p_sh[22]>>
p_brd =t_
sh#ss(p_sh[42}
sh#^^p_sh[41],613,353)
x_ipBorder=613
#ei lbt=p_sh[23]>>
p_brd =f_
sh#hh(p_sh[42}
sh#^^p_sh[41],763,353)
x_ipBorder=763
#ei lbt=p_sh[43]&&p_brd>>
x_btc=d_px+10
sh#^^p_sh[42],x_btc,416)
p_bt=1
#ei lbt=p_sh[44]&&p_brd>>
x_btc=d_px+52
sh#^^p_sh[42],x_btc,416)
p_bt=2
#ei lbt=p_sh[45]&&p_brd>>
x_btc=d_px+94
sh#^^p_sh[42],x_btc,416)
p_bt=3
#ei lbt=p_sh[46]&&p_brd>>
x_btc=d_px+136
sh#^^p_sh[42],x_btc,416)
p_bt=4
#ei lbt=p_sh[47]&&p_brd>>
x_btc=d_px+178
sh#^^p_sh[42],x_btc,416)
p_bt=5
#ei lbt=p_sh[48]&&p_brd>>
x_btc=d_px+220
sh#^^p_sh[42],x_btc,416)
p_bt=6
#ei lbt=p_sh[49]&&p_brd>>
x_btc=d_px+262
sh#^^p_sh[42],x_btc,416)
p_bt=7
#ei lbt=p_sh[50]>>
x_ip=613
y_ip=83
sh#^^p_sh[40],x_ip,y_ip)
c_pt`Lines
sh#tx(p_sh[71],c_pt)
#ei lbt=p_sh[51]>>
x_ip=673
y_ip=83
sh#^^p_sh[40],x_ip,y_ip)
c_pt`Squares
sh#tx(p_sh[71],c_pt)
#ei lbt=p_sh[52]>>
x_ip=733
y_ip=83
sh#^^p_sh[40],x_ip,y_ip)
c_pt`Circles
sh#tx(p_sh[71],c_pt)
#ei lbt=p_sh[53]>>
x_ip=793
y_ip=83
sh#^^p_sh[40],x_ip,y_ip)
c_pt`Triangles
sh#tx(p_sh[71],c_pt)
#ei lbt=p_sh[54]>>
x_ip=853
y_ip=83
sh#^^p_sh[40],x_ip,y_ip)
c_pt`Rhombuses
sh#tx(p_sh[71],c_pt)
#ei lbt=p_sh[55]>>
x_ip=613
y_ip=143
sh#^^p_sh[40],x_ip,y_ip)
c_pt`Cubes
sh#tx(p_sh[71],c_pt)
#ei lbt=p_sh[56]>>
x_ip=673
y_ip=143
sh#^^p_sh[40],x_ip,y_ip)
c_pt`Spheres
sh#tx(p_sh[71],c_pt)
#ei lbt=p_sh[57]>>
x_ip=733
y_ip=143
sh#^^p_sh[40],x_ip,y_ip)
c_pt`Pyramids
sh#tx(p_sh[71],c_pt)
#ei lbt=p_sh[58]>>
x_ip=793
y_ip=143
sh#^^p_sh[40],x_ip,y_ip)
c_pt`Ellipses
sh#tx(p_sh[71],c_pt)
#ei lbt=p_sh[59]>>
x_ip=853
y_ip=143
sh#^^p_sh[40],x_ip,y_ip)
c_pt`Crosses
sh#tx(p_sh[71],c_pt)
#ei lbt=p_sh[60]>>
DrawFullscreen =t_
ClosePatternMenu()
DrawPattern()
DrawFullscreen =f_
#ei lbt=p_sh[74]>>
PatternR&$omClrs =t_
xIndiPatR&$Clrs=613
sh#^^p_sh[76],xIndiPatR&$Clrs,493)
#ei lbt=p_sh[75]>>
PatternR&$omClrs =f_
xIndiPatR&$Clrs=763
sh#^^p_sh[76],xIndiPatR&$Clrs,493)
}#
!es
'
gw#MouseDown=MouseDown
Sub MouseDown
_xd=gw#MouseX
_yd=gw#MouseY
!!c_mn`MainPaint<<
!!_yd>0&&_yd<50>>
!!_xd>0&&_xd<50>>

d_px=0
b_cl =LDDialogs.Colour()
#ei _xd>55&&_xd<105>>

_c_Tool`Pencil
AddTool()
!!_rbd>>
d_px=57
dd_t`Pencil
ShowDropDown()
}#
#ei  _xd>110&&_xd<160>>

_c_Tool`Brush
AddTool()
!!_rbd>>
d_px=112
dd_t`Brush
ShowDropDown()
}#
#ei  _xd>165&&_xd<215>>

_c_Tool`Eraser
AddTool()
!!_rbd>>
d_px=167
dd_t`Eraser
ShowDropDown()
}#
#ei _xd>220&&_xd<270>>
!!_lbd>>
LoadColorPicker()

Mouse.HideCursor()
_c_Tool`ColorPicker
c_mn`ColorPicker
AddTool()
}#
#ei _xd>275&&_xd<325>>

_c_Tool`Spray
!!_rbd>>
d_px=285
LoadSprayMenu()
}#
#ei _xd>330&&_xd<380>>

_c_Tool`Text
AddTool()
!!_rbd>>
d_px=330
rm_aic()
LoadTextMenu()
}#
#ei _xd>385&&_xd<435>>

_c_Tool`Fill
AddTool()
rm_aic()
#ei _xd>440&&_xd<490>>

_c_Tool`Shapes
AddTool()
!!_rbd>>
d_px=440
LoadShapesMenu()
}#
#ei _xd>495&&_xd<545>>

d_px=495
_c_Tool`Mirror
LoadMirrorMenu()
#ei _xd>605&&_xd<655>>

_c_Tool`Pattern
AddTool()
!!_rbd>>
d_px=605
LoadPatternsMenu()
}#2
||
C&$raw =t_
Draw()
}#
!!_yd>50>>
!!_c_Tool`Select"&&CanAddis_>>
gw#PenColor`Black
gw#bc`SkyBlue
is_=!!(0,0)
sh#^^is_,_xd,_yd)
sh#op(is_,30)
CanMoveis_ =t_
#ei _c_Tool`Pattern<<
gw#PenWidth=1
gw#PenColor`Black
gw#bc`White
t_dpt=!!(0,0)
sh#^^t_dpt,_xd,_yd)
sh#op(t_dpt,50)
CanResizet_dpt =t_
#ei _c_Tool`Text<<
gw#PenWidth=2
gw#PenColor`Black
TxtIndi["LineH"]=sh#AddLine(_xd,_yd,_xd+50,_yd)
TxtIndi["LineV"]=sh#AddLine(_xd,_yd,_xd,_yd+50)
TxtIndi["LineH2"]=sh#AddLine(0,0,50,0)
TxtIndi["LineV2"]=sh#AddLine(0,0,0,50)
CanMoveTxtIndies =t_

#ei _c_Tool`Shapes<<
gw#PenColor=b_cl
gw#bc=_c2
gw#PenWidth=pws_
!!cr_ss`Rectangle" Or cr_ss`Triangle<<
i_dw["Rec"]=!!(0,0)
sh#^^i_dw["Rec"],_xd,_yd)
#ei cr_ss`Ellipse<<
i_dw["El"]=sh#AddEllipse(0,0)
sh#^^i_dw["El"],_xd,_yd) 
#ei cr_ss`Line<<
gw#PenWidth=1
i_dw["Line1"]=sh#AddEllipse(10,10)
i_dw["Line2"]=sh#AddEllipse(10,10)
sh#^^i_dw["Line1"],_xd - 5,_yd - 5)
sh#^^i_dw["Line2"],_xd,_yd)
sh#op(i_dw["Line1"],50)
sh#op(i_dw["Line2"],50)
}#3
#ei c_mn`ColorPicker<<
!!_lbd>>
xCpBorder=sh#GetLeft(cp_s[1}
yCpBorder=sh#GetTop(cp_s[1}
xCloseCp=sh#GetLeft(cp_s[5}
yCloseCp=sh#GetTop(cp_s[5}
!!_xd>xCpBorder&&_xd<xCpBorder+130&&_yd>yCpBorder&&_yd<yCpBorder+155>>
!!_xd>xCloseCp&&_xd<xCloseCp+32&&_yd>yCloseCp&&_yd<yCloseCp+32>>
rm_sm()
|| 
CanMoveCp =t_
}#2
!!CanGetPixel>>
px_p=gw#GetPixel(_xd,_yd)
gw#PenColor=ClrBorderDark
gw#bc=px_p
sh#rm(cp_s[4}
cp_s[4]=!!(110,60)
sh#^^cp_s[4],CpLeft+10,CpTop+85)
sh#tx(cp_s[3],px_p)
b_cl=px_p
gw#PenColor=px_p
}#
#ei _rbd>>
px_p=gw#GetPixel(_xd,_yd)
gw#PenColor=ClrBorderDark
gw#bc=px_p
sh#rm(cp_s[4}
cp_s[4]=!!(110,60)
sh#^^cp_s[4],CpLeft+10,CpTop+85)
sh#tx(cp_s[3],px_p)
gw#PenColor=px_p
_c2=px_p
}#
#ei c_mn`SprayMenu<<
xCloseSm=sh#GetLeft(s_sh[18}
yCloseSm=sh#GetTop(s_sh[18}
!!_xd>xCloseSm&&_xd<xCloseSm+32&&_yd>yCloseSm&&_yd<yCloseSm+32>>

CloseSprayMenu()
}#
#ei c_mn`TextMenu<<
!!_xd>xCloseTm&&_xd<xCloseTm+32&&_yd>yCloseTm&&_yd<yCloseTm+32>>

TxtBody=cc#GetTextBoxText(t_sh[4}
TxtName=cc#GetTextBoxText(t_sh[9}
TxtSize=cc#GetTextBoxText(t_sh[13}
!!TxtBody`" Or TxtName`" Or TxtSize`<<
gw#ShowMessage("Please enter all the data in order to proceed.","Information~
||
!!TxtSize<8>>
TxtSize=8
}#
OldTxtBody=TxtBody
OldTxtName=TxtName
OldTxtSize=TxtSize
rm_sm()
}#2
#ei c_mn`ShapesMenu<<
xCloseShM=sh#GetLeft(s_ms[0}
yCloseShM=sh#GetTop(s_ms[0}
!!_xd>xCloseShM&&_xd<xCloseShM+32&&_yd>yCloseShM&&_yd<yCloseShM+32>>

CanCloseis_ =t_
rm_sm()
}#
!!_xd>d_px+10&&_xd<d_px+110&&_yd>85&&_yd<165>>
cr_ss`Line
ud_sd()
#ei _xd>d_px+120&&_xd<d_px+220&&_yd>85&&_yd<165>>
cr_ss`Rectangle
ud_sd()
#ei _xd>d_px+10&&_xd<d_px+110&&_yd>175&&_yd<255>>
cr_ss`Ellipse
ud_sd()
#ei _xd>d_px+120&&_xd<d_px+220&&_yd>175&&_yd<255>>
cr_ss`Triangle
ud_sd()
}#
#ei c_mn`MirrorMenu<<
xCloseMm=sh#GetLeft(MmShape[12}
yCloseMm=sh#GetTop(MmShape[12}
!!_xd>xCloseMm&&_xd<xCloseMm+32&&_yd>yCloseMm&&_yd<yCloseMm+32>>

rm_sm()
}#
#ei c_mn`PastingMenu<<
!!CanPaste>>
xIndiPaste=_xd - (ar_w/2)
yIndiPaste=_yd - (ar_h/2)
LoadVerifyPaste()
CanPaste =f_
}#
#ei c_mn`PatternsMenu<<
xClosePm=sh#GetLeft(p_sh[0}
yClosePm=sh#GetTop(p_sh[0}
!!_xd>xClosePm&&_xd<xClosePm+32&&_yd>yClosePm&&_yd<yClosePm+32>>

ClosePatternMenu()
}#2
!!dd_t`Pencil<<
!!_xd>d_px&&_xd<d_px+47>>
!!_yd>50&&_yd<97>>
PencilSize=1.5
rm_sm()
#ei _yd>97&&_yd<144>>
PencilSize=2.5
rm_sm()
#ei _yd>144&&_yd<191>>
PencilSize=3.5
rm_sm()
#ei _yd>191&&_yd<238>>
PencilSize=4.5
rm_sm()
#ei _yd>238&&_yd<285>>
PencilSize=5.5
rm_sm()
}#2
#ei dd_t`Brush<<
!!_xd>d_px&&_xd<d_px+47>>
!!_yd>50&&_yd<97>>
_bsz=6
rm_sm()
#ei _yd>97&&_yd<144>>
_bsz=10
rm_sm()
#ei _yd>144&&_yd<191>>
_bsz=14
rm_sm()
#ei _yd>191&&_yd<238>>
_bsz=18
rm_sm()
#ei _yd>238&&_yd<285>>
_bsz=22
rm_sm()
}#2
#ei dd_t`Eraser<<
!!_xd>d_px&&_xd<d_px+47>>
!!_yd>50&&_yd<97>>
EraserSize=10
rm_sm()
#ei _yd>97&&_yd<144>>
EraserSize=15
rm_sm()
#ei _yd>144&&_yd<191>>
EraserSize=20
rm_sm()
#ei _yd>191&&_yd<238>>
EraserSize=25
rm_sm()
#ei _yd>238&&_yd<285>>
EraserSize=30
rm_sm()
}#2
#ei dd_t`Spray<<
!!_xd>d_px&&_xd<d_px+47>>
!!_yd>50&&_yd<97>>
_ssz=10
rm_sm()
#ei _yd>97&&_yd<144>>
_ssz=15
rm_sm()
#ei _yd>144&&_yd<191>>
_ssz=20
rm_sm()
#ei _yd>191&&_yd<238>>
_ssz=25
rm_sm()
#ei _yd>238&&_yd<285>>
_ssz=30
rm_sm()
}#3
!!c_mn`SelectAction<<
xCloseSm=sh#GetLeft(_sls[12}
yCloseSm=sh#GetTop(_sls[12}
!!_xd>xCloseSm&&_xd<xCloseSm+32&&_yd>yCloseSm&&_yd<yCloseSm+32>>

CanCloseis_ =t_
cls_lm()
CanClick_stl =t_
#ei _xd>(ww2 - 323)/2&&_xd<(ww2 - 323)/2+54&&_yd>wh2/2+8&&_yd<wh2/2+8+54>>
cr_ac`Cut
pf_ac()
#ei _xd>(ww2 - 200)/2&&_xd<(ww2 - 200)/2+54&&_yd>wh2/2+8&&_yd<wh2/2+8+54>>
cr_ac`Copy
pf_ac()
#ei _xd>(ww2 - 65)/2&&_xd<(ww2 - 65)/2+54&&_yd>wh2/2+8&&_yd<wh2/2+8+54>>
cr_ac`Paste
pf_ac()
#ei _xd>ww2/2+35&&_xd<ww2/2+89&&_yd>wh2/2+8&&_yd<wh2/2+8+54>>
cr_ac`FlipHorizontal
pf_ac()
#ei _xd>ww2/2+100&&_xd<ww2/2+154&&_yd>wh2/2+8&&_yd<wh2/2+8+54>>
cr_ac`FlipVertical
pf_ac()
}#2
!es
'
gw#MouseMove=MouseMove
Sub MouseMove
x_m=gw#MouseX
_Ym=gw#MouseY
!!c_mn`MainPaint<<
Draw()
!!_Ym<50>>
sh#ss(t_idy)
!!x_m>0&&x_m<50>>
sh#^^t_idy,2,0)
#ei x_m>55&&x_m<105>>
sh#^^t_idy,57,0)
#ei  x_m>110&&x_m<160>>
sh#^^t_idy,112,0)
#ei  x_m>165&&x_m<215>>
sh#^^t_idy,167,0)
#ei x_m>220&&x_m<270>>
sh#^^t_idy,222,0)
#ei x_m>275&&x_m<325>>
sh#^^t_idy,277,0)
#ei x_m>330&&x_m<380>>
sh#^^t_idy,332,0)
#ei x_m>385&&x_m<435>>
sh#^^t_idy,387,0)
#ei x_m>440&&x_m<490>>
sh#^^t_idy,442,0)
#ei x_m>495&&x_m<545>>
sh#^^t_idy,497,0)
#ei x_m>550&&x_m<600>>
sh#^^t_idy,552,0)
#ei x_m>605&&x_m<655>>
sh#^^t_idy,607,0)
}#
||
sh#hh(t_idy)
!!_c_Tool`Select<<
!!x_m>_xd&&_Ym>_yd&&CanMoveis_>>
cc#sz(is_,x_m - _xd,_Ym - _yd)
}#
#ei _c_Tool`Text<<
!!x_m>_xd&&_Ym>_yd&&CanMoveTxtIndies>>
sh#^^TxtIndi["LineH2"],x_mNew - 50,_YmNew)
sh#^^TxtIndi["LineV2"],x_mNew,_YmNew - 50)
}#
#ei _c_Tool`Shapes<<
!!x_m>_xd&&_Ym>_yd>>
cc#sz(i_dw["Rec"],x_m - _xd,_Ym - _yd)
cc#sz(i_dw["El"],x_m - _xd,_Ym - _yd)
}#
sh#^^i_dw["Line2"],x_m - 5,_Ym - 5)
#ei _c_Tool`Pattern<<
!!x_m>_xd&&_Ym>_yd&&CanResizet_dpt>>
cc#sz(t_dpt,x_m - _xd,_Ym - _yd)
}#3
#ei c_mn`ColorPicker<<
!!_Ym>50>>
Mouse.HideCursor()
CanGetPixel =t_
!!x_m>CpLeft&&x_m<CpLeft+130&&_Ym>CpTop&&_Ym<CpTop+205>>
CanGetPixel =f_
rm_aic()
Mouse.ShowCursor()
ToolAdded =f_
||
!!ToolAdded =f_>>
AddTool()
ToolAdded =t_
}#2
||
CanGetPixel =f_
}#
!!CanMoveCp>>
Mouse.ShowCursor()
CpLeft=x_m - 62
CpTop=_Ym - 60
MoveColorPicker()
}#
#ei c_mn`SelectAction<<
!!x_m>(ww2 - 323)/2&&x_m<(ww2 - 323)/2+54&&_Ym>wh2/2+8&&_Ym<wh2/2+8+54>>
sh#^^_sls[13],$r((ww2 - 323)/2),$r(wh2/2+8))
sh#tx(_sls[3],"Select an action |>the selected area - Cut~
#ei x_m>(ww2 - 200)/2&&x_m<(ww2 - 200)/2+54&&_Ym>wh2/2+8&&_Ym<wh2/2+8+54>>
sh#^^_sls[13],$r((ww2 - 200)/2),$r(wh2/2+8))
sh#tx(_sls[3],"Select an action |>the selected area - Copy~
#ei x_m>(ww2 - 65)/2&&x_m<(ww2 - 65)/2+54&&_Ym>wh2/2+8&&_Ym<wh2/2+8+54>>
sh#^^_sls[13],$r((ww2 - 65)/2),$r(wh2/2+8))
sh#tx(_sls[3],"Select an action |>the selected area - Paste~
#ei x_m>ww2/2+35&&x_m<ww2/2+89&&_Ym>wh2/2+8&&_Ym<wh2/2+8+54>>
sh#^^_sls[13],$r(ww2/2+35),$r(wh2/2+10))
sh#tx(_sls[3],"Select an action |>the selected area - Horizontal flip~
#ei x_m>ww2/2+100&&x_m<ww2/2+154&&_Ym>wh2/2+8&&_Ym<wh2/2+8+54>>
sh#^^_sls[13],$r(ww2/2+100),$r(wh2/2+10))
sh#tx(_sls[3],"Select an action |>the selected area - Vertical flip~
||
sh#tx(_sls[3],"Select an action |>the selected area~
}#2
!!dd_t`None<<
||
!!x_m>d_px&&x_m<d_px+47>>
!!_Ym>50&&_Ym<97>>
sh#^^sz_i,d_px - 1.15,48)
#ei _Ym>97&&_Ym<144>>
sh#^^sz_i,d_px - 1.15,95)
#ei _Ym>144&&_Ym<191>>
sh#^^sz_i,d_px - 1.15,142)
#ei _Ym>191&&_Ym<238>>
sh#^^sz_i,d_px - 1.15,189)
#ei _Ym>238&&_Ym<285>>
sh#^^sz_i,d_px - 1.15,236)
}#3
!!c_mn`PastingMenu<<
!!CanPaste>>
sh#^^IndiPaste,x_m,_Ym)
}#2
sh#^^t_id["Pencil"],x_m - 2,_Ym - 38)
sh#^^t_id["Brush"],x_m - 3,_Ym - 33)
sh#^^t_id["Eraser"],x_m - EraserSize/2,_Ym - EraserSize/2)
sh#^^t_id["ClrPck"],x_m,_Ym - 29)
x_mNew=gw#MouseX
_YmNew=gw#MouseY
!es
'
gw#MouseUp=MouseUp
Sub MouseUp
xUp=gw#MouseX
yUp=gw#MouseY
C&$raw =f_
!!c_mn`MainPaint"&&_yd<50&&CanClick_stl>>
!!_xd>550&&_xd<600>>

Pre_stl=_c_Tool
_c_Tool`Select
CanAddSelectLm =t_
CanClick_stl =f_
}#2
!!c_mn`ColorPicker<<
CanMoveCp =f_
#ei c_mn`MainPaint<<
!!yUp>50>>
!!_c_Tool`Select<<
ar_l=_xd
ar_t=_yd
ar_w=xUp - _xd
ar_h=yUp - _yd
CanMoveis_ =f_
CanAddis_ =f_
lds_lm()
shsam()
#ei _c_Tool`Text<<
!!_xd >= xUp Or _yd >= yUp>>
CanMoveTxtIndies =f_
||
!!OldTxtFontBold>>
gw#FontBold =t_
||
gw#FontBold =f_
}#
!!OldTxtFontItalic>>
gw#FontItalic =t_
||
gw#FontItalic =f_
}#
gw#bc=b_cl
gw#FontName=TxtName
gw#FontSize=TxtSize
!!OldTxtTransparent>>
gw#DrawBoundText(_xd,_yd,xUp - _xd,TxtBody)
#ei OldTxtSolid>>
gw#bc=_c2
gw#fr(_xd,_yd,xUp - _xd,yUp - _yd)
gw#bc=b_cl
gw#DrawBoundText(_xd,_yd,xUp - _xd,TxtBody)
}#
CanMoveTxtIndies =f_
}#4
!!c_mn`MainPaint<<
!!yUp>50&&_yd>50>>
!!_c_Tool`Pattern<<
CanResizet_dpt =f_
sh#rm(t_dpt)
DrawPattern()
#ei _c_Tool`Shapes<<
gw#PenWidth=pws_
gw#PenColor=b_cl
gw#bc=_c2
!!cr_ss`Line<<
!!pws_=0>>
gw#PenWidth=1
||
gw#PenWidth=pws_+1
}#
gw#DrawLine(_xd,_yd,xUp,yUp)
}#
!!_c_Tool`Shapes"&&_xd<xUp&&_yd<yUp>>
gw#PenWidth=pws_
gw#PenColor=b_cl
gw#bc=_c2
!!cr_ss`Rectangle<<
!!bgsh`Solid<<
gw#fr(_xd,_yd,xUp - _xd,yUp - _yd)
gw#DrawRectangle(_xd,_yd,xUp - _xd,yUp - _yd)
#ei bgsh`Transparent<<
gw#DrawRectangle(_xd,_yd,xUp - _xd,yUp - _yd)
}#
#ei cr_ss`Ellipse<<
!!bgsh`Solid<<
gw#fe(_xd,_yd,xUp - _xd,yUp - _yd)
gw#DrawEllipse(_xd,_yd,xUp - _xd,yUp - _yd)
#ei bgsh`Transparent<<
gw#DrawEllipse(_xd,_yd,xUp - _xd,yUp - _yd)
}#
#ei cr_ss`Triangle<<
TriangleWidth=xUp - _xd
!!bgsh`Solid<<
gw#FillTriangle(_xd+(TriangleWidth/2),_yd,_xd,yUp,xUp,yUp)
gw#DrawTriangle(_xd+(TriangleWidth/2),_yd,_xd,yUp,xUp,yUp)
#ei bgsh`Transparent<<
gw#DrawTriangle(_xd+(TriangleWidth/2),_yd,_xd,yUp,xUp,yUp)
}#6
fx=ldtext.Split ("LineH LineH2 LineV LineV2 Rec Line1 Line2 El"," ~
|>f=1 To 4
sh#rm (TxtIndi[fx[f]}
sh#rm (i_dw[fx[f]}
#ef
gw#FontBold =f_
gw#FontItalic =f_
gw#FontName`Microsoft Sans Serif
gw#FontSize=12
gw#PenWidth=1
!es
'
gw#KeyDown =Ke_yd
Sub Ke_yd
LastKey=gw#LastKey
!!LastKey`Escape<<
!!c_mn`SelectLoadingMenu" Or c_mn`SelectAction" Or c_mn`PastingMenu" Or c_mn`VerifyPasteMenu" Or c_mn`hFlipMenu" Or c_mn`vFlipMenu<<
||
rm_sm()
}#
#ei LastKey`Delete<<
gw#bc`White
gw#fr(0,0,_dw,_dh)
}#
!es
'
Timer.Interval=_ssp
Timer.Tick=SprayCanvas
Sub SprayCanvas
!!c_mn`MainPaint"&&_c_Tool`Spray"&&C&$raw>>
!!SprayColors=1>>
xs_ =#rnd(_ssz)
ys_ =#rnd(_ssz)
gw#bc=b_cl
gw#fe(x_m+xs_ - _ssz/2 - 16,_Ym+ys_ - _ssz/2 - 16,_sdz,_sdz)
!!MirrorAdded>>
!!_c_Mirror`Horizontal<<
!!_xd<(_dw/2)>>
gw#fe(_dw - x_m+xs_ - _ssz/2+14,_Ym+ys_ - _ssz/2 - 16,_sdz,_sdz)
#ei _xd>(_dw/2)>>
x_ps1=x_m - (_dw/2)
gw#fe((_dw/2) - x_ps1+xs_ - _ssz/2+14,_Ym+ys_ - _ssz/2 - 16,_sdz,_sdz)
}#
#ei _c_Mirror`Vertical<<
_yVs=_dh/2
!!_yd<_yVs>>
gw#fe(x_m+xs_ - _ssz/2 - 16,_dh - _Ym+ys_ - _ssz/2 - 8,_sdz,_sdz)
#ei _yd>_yVs>>
yPosSprayOne=_Ym - (_dh/2)
gw#fe(x_m+xs_ - _ssz/2 - 16,(_dh/2) - yPosSprayOne+ys_ - _ssz/2 - 7,_sdz,_sdz)
}#3
#ei SprayColors=2>>
xs_ =#rnd(_ssz)
ys_ =#rnd(_ssz)
xs_2 =#rnd(_ssz)
ys_2 =#rnd(_ssz)
gw#bc=b_cl
gw#fe(x_m+xs_ - _ssz/2 - 16,_Ym+ys_ - _ssz/2 - 16,_sdz,_sdz)
gw#bc=_c2
gw#fe(x_m+xs_2 - _ssz/2 - 16,_Ym+ys_2 - _ssz/2 - 16,_sdz,_sdz)
!!MirrorAdded>>
!!_c_Mirror`Horizontal<<
!!_xd<(_dw/2)>>
gw#bc=b_cl
gw#fe(_dw - x_m+xs_ - _ssz/2+14,_Ym+ys_ - _ssz/2 - 16,_sdz,_sdz)
gw#bc=_c2
gw#fe(_dw - x_m+xs_2 - _ssz/2+14,_Ym+ys_2 - _ssz/2 - 16,_sdz,_sdz)
#ei _xd>(_dw/2)>>
x_ps1=x_m - (_dw/2)
gw#bc=b_cl
gw#fe((_dw/2) - x_ps1+xs_ - _ssz/2+14,_Ym+ys_ - _ssz/2 - 16,_sdz,_sdz)
gw#bc=_c2
gw#fe((_dw/2) - x_ps1+xs_2 - _ssz/2+14,_Ym+ys_2 - _ssz/2 - 16,_sdz,_sdz)
}#
#ei _c_Mirror`Vertical<<
_yVs=_dh/2
!!_yd<_yVs>>
gw#bc=b_cl
gw#fe(x_m+xs_ - _ssz/2 - 16,_dh - _Ym+ys_ - _ssz/2 - 8,_sdz,_sdz)
gw#bc=_c2
gw#fe(x_m+xs_2 - _ssz/2 - 16,_dh - _Ym+ys_2 - _ssz/2 - 8,_sdz,_sdz)
#ei _yd>_yVs>>
yPosSprayOne=_Ym - (_dh/2)
gw#bc=b_cl
gw#fe(x_m+xs_ - _ssz/2 - 16,(_dh/2) - yPosSprayOne+ys_ - _ssz/2 - 7,_sdz,_sdz)
gw#bc=_c2
gw#fe(x_m+xs_2 - _ssz/2 - 16,(_dh/2) - yPosSprayOne+ys_2 - _ssz/2 - 7,_sdz,_sdz)
}#5
!es
