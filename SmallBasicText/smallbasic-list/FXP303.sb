Sub MREG 'Matriz general'
  REG[1][1] = 3
  REG[1][2] = 1
  REG[1][3] = "F3"
  REG[1][4] = "MNP521"
  REG[1][5] = 1
  REG[1][6] = "CANCELADO"
  REG[2][1] = 3
  REG[2][2] = 1
  REG[2][3] = "F4"
  REG[2][4] = "IOT321"
  REG[2][5] = 2
  REG[2][6] = "PENDIENTE"
  REG[3][1] = 5
  REG[3][2] = 1
  REG[3][3] = "F2"
  REG[3][4] = "MNP521"
  REG[3][5] = 2
  REG[3][6] = "PENDIENTE"
  REG[4][1] = 17
  REG[4][2] = 1
  REG[4][3] = "F2"
  REG[4][4] = "MNP521"
  REG[4][5] = 2
  REG[4][6] = "CANCELADO"
  REG[5][1] = 13
  REG[5][2] = 1
  REG[5][3] = "F4"
  REG[5][4] = "IOT321"
  REG[5][5] = 3
  REG[5][6] = "CANCELADO"
  REG[6][1] = 4
  REG[6][2] = 2
  REG[6][3] = "F5"
  REG[6][4] = "BUP988"
  REG[6][5] = 3
  REG[6][6] = "CANCELADO"
  REG[7][1] = 13
  REG[7][2] = 2
  REG[7][3] = "F1"
  REG[7][4] = "MNP521"
  REG[7][5] = 3
  REG[7][6] = "CANCELADO"
  REG[8][1] = 14
  REG[8][2] = 2
  REG[8][3] = "F1"
  REG[8][4] = "DFD345"
  REG[8][5] = 3
  REG[8][6] = "PENDIENTE"
  REG[9][1] = 14
  REG[9][2] = 2
  REG[9][3] = "F4"
  REG[9][4] = "BUP988"
  REG[9][5] = 4
  REG[9][6] = "PENDIENTE"
  REG[10][1] = 14
  REG[10][2] = 2
  REG[10][3] = "F5"
  REG[10][4] = "BUP988"
  REG[10][5] = 4
  REG[10][6] = "PENDIENTE"
  REG[11][1] = 23
  REG[11][2] = 2
  REG[11][3] = "F2"
  REG[11][4] = "HHL328"
  REG[11][5] = 3
  REG[11][6] = "CANCELADO"
  REG[12][1] = 21
  REG[12][2] = 3
  REG[12][3] = "F3"
  REG[12][4] = "MNP521"
  REG[12][5] = 2
  REG[12][6] = "CANCELADO"
  REG[13][1] = 15
  REG[13][2] = 3
  REG[13][3] = "F4"
  REG[13][4] = "IOT321"
  REG[13][5] = 3
  REG[13][6] = "CANCELADO"
  REG[14][1] = 29
  REG[14][2] = 1
  REG[14][3] = "F2"
  REG[14][4] = "DFD345"
  REG[14][5] = 1
  REG[14][6] = "PENDIENTE"
  REG[15][1] = 15
  REG[15][2] = 3
  REG[15][3] = "F5"
  REG[15][4] = "BUP988"
  REG[15][5] = 4
  REG[15][6] = "PENDIENTE"
  REG[16][1] = 19
  REG[16][2] = 3
  REG[16][3] = "F5"
  REG[16][4] = "HHL328"
  REG[16][5] = 1
  REG[16][6] = "CANCELADO"
  REG[17][1] = 27
  REG[17][2] = 2
  REG[17][3] = "F4"
  REG[17][4] = "DFD345"
  REG[17][5] = 4
  REG[17][6] = "PENDIENTE"
  REG[18][1] = 13
  REG[18][2] = 3
  REG[18][3] = "F3"
  REG[18][4] = "IOT321"
  REG[18][5] = 4
  REG[18][6] = "PENDIENTE"
  REG[19][1] = 14
  REG[19][2] = 3
  REG[19][3] = "F3"
  REG[19][4] = "DFD345"
  REG[19][5] = 3
  REG[19][6] = "CANCELADO"
  REG[20][1] = 10
  REG[20][2] = 2
  REG[20][3] = "F2"
  REG[20][4] = "BUP988"
  REG[20][5] = 3
  REG[20][6] = "CANCELADO"
  REG[21][1] = 20
  REG[21][2] = 1
  REG[21][3] = "F1"
  REG[21][4] = "MNP521"
  REG[21][5] = 3
  REG[21][6] = "PENDIENTE"
EndSub
'Matriz de infracciones
Sub MINF
  INF[1][1] = "PASO DE SEMÁFORO EN ROJO"
  INF[1][2] = "F1"
  INF[2][1] = "VELOCIDAD LÍMITE SUPERADA"
  INF[2][2] = "F2"
  INF[3][1] = "REVISIÓN TÉCNICO MECÁNICA VENCIDA"
  INF[3][2] = "F3"
  INF[4][1] = "SOAT VENCIDO"
  INF[4][2] = "F4"
  INF[5][1] = "PICO Y PLACA"
  INF[5][2] = "F5"
EndSub
'Vehículos registrados en el Sistema de Tránsito de Medellín
Sub MVE
  VE[1][1] = "MNP521"
  VE[1][2] = "PARTICULAR"
  VE[1][3] = "MEDELLÍN"
  VE[2][1] = "IOT321"
  VE[2][2] = "SERVICIO PÚBLICO"
  VE[2][3] = "MEDELLÍN"
  VE[3][1] = "BUP988"
  VE[3][2] = "CARGA PESADA"
  VE[3][3] = "MEDELLÍN"
  VE[4][1] = "HHL328"
  VE[4][2] = "SERVICIO PUBLICO"
  VE[4][3] = "BOGOTA"
  VE[5][1] = "DFD345"
  VE[5][2] = "PARTICULAR"
  VE[5][3] = "MEDELLÍN"
  VE[6][1] = "URT456"
  VE[6][2] = "CARGA PESADA"
  VE[6][3] = "PASTO"
  VE[7][1] = "PIS208"
  VE[7][2] = "PARTICULAR"
  VE[7][3] = "BUCARAMANGA"
  VE[8][1] = "ASD557"
  VE[8][2] = "PARTICULAR"
  VE[8][3] = "BUCARAMANGA"
EndSub
'Cámaras - vector
Sub VCAM
  CAM[1] = "BOMBA LOS ALMENDROS"
  CAM[2] = "AVENIDA LAS VEGAS"
  CAM[3] = "AVENIDA ORIENTAL"
  CAM[4] = "AVENIDA REGIONAL"
EndSub
'Inicio del programa

resprog = "1" 'Ciclo para repetir el ciclo general
While resprog = "1"  
  TextWindow.WriteLine ("SISTEMA  DE FOTOMULTAS")
  TextWindow.WriteLine ("")
  TextWindow.WriteLine("¿Qué tipo de usuario es usted?")
  TextWindow.WriteLine("")
  TextWindow.WriteLine("  1. Propietario de Vehículo")
  TextWindow.WriteLine("  2. Administrador")
  TextWindow.WriteLine("")
  user = TextWindow.ReadNumber()
  TextWindow.Clear()  
  If user >= 1 And user <= 2 Then 'Validación de respuesta del menú  (menú inicial)
    If user = 1 Then 'Define si es usuario
      usradm = "usr"
  
      TextWindow.WriteLine("Bienvenido, Señor Usuario")
      TextWindow.WriteLine("")
      ConsultaPlaca()
    ElseIf user = 2 Then 'Define si es Administrador
      usradm = "adm"
      progadmin = "1"
      While progadmin = "1"
        TextWindow.WriteLine("Por favor digite nombre de usuario y contraseña")
        TextWindow.WriteLine("")
        
        TextWindow.Write("  Nombre: ")
     
        nombre = TextWindow.Read()
        TextWindow.WriteLine("")   
        TextWindow.Write("  Contraseña: ")
        PW = Text.ConvertToUpperCase(TextWindow.Read())
        TextWindow.Clear()        
        If nombre = "admin" And PW = "FMUNAC" Then
          consadmin = "1"
          While consadmin = "1"
            TextWindow.WriteLine("¿Qué consulta desea realizar?")
            TextWindow.WriteLine("")
            TextWindow.WriteLine("  1. Consulta por Placa")
            TextWindow.WriteLine("  2. Total de Fotomultas por Tipo de Infracción y Estado")
            TextWindow.WriteLine("  3. Total de Fotomultas por Mes")
            TextWindow.WriteLine("  4. Consultar por Cámara, Tipo de Infracción o Estado de la Fotomulta")
            TextWindow.WriteLine("  5. Cantidad y Porcentaje según Tipo de Infraccion")
            TextWindow.WriteLine("  6. Cantidad Y Porcentaje según Cámara")
            TextWindow.WriteLine("  7. Ingresos por Fotomultas Agrupados por Tipo de Infracción y Estado")
            TextWindow.WriteLine("    8. Volver al menú inicial")
            TextWindow.WriteLine("    9. Salir")
            TextWindow.WriteLine("")
            opcadmin = TextWindow.ReadNumber()
            TextWindow.Clear()            
            If opcadmin >= 1 And opcadmin <= 9 then 'Validacion de respuesta del admin 
              If opcadmin = 1 Then 'Consulta por Placa
                ConsultaPlaca()
              ElseIf opcadmin = 2 Then 'Total de Fotomultas por Tipo de Infracción y Estado
                progopc = "1"
                While progopc = "1"                
                  TextWindow.WriteLine("Por favor digite la opción que desea consultar")
                  TextWindow.WriteLine("")
                  TextWindow.WriteLine("Tipo de Infracción")
                  TextWindow.WriteLine("")
                  infraccionesmenu()
                  Tipinf = TextWindow.ReadNumber()
                  If Tipinf >= 1 And Tipinf <= 5 Then 'Validacion de respuesta del tipo de infracción a consultar
                    Infracciones()
                    progEst = "1"
                    While progEst = "1"
                      TextWindow.WriteLine("")
                      TextWindow.WriteLine("Estado de la Multa")
                      TextWindow.WriteLine("")
                      TextWindow.WriteLine("1. Cancelado")
                      TextWindow.WriteLine("2. Pendiente")
                      TextWindow.WriteLine("")
                      Tipest = TextWindow.ReadNumber()
                      If Tipest >= 1 And Tipest <= 2 Then 'Validacion de la respuesta de estado de la multa
                        States()
                        progEst = "2"
                      Else
                        MSJerror()
                      EndIf
                      TextWindow.Clear()
                    EndWhile
                    consultaInfEst()
                    MfinalAdm()
                  Else
                    TextWindow.WriteLine("")
                    MSJerror()
                  EndIf
                EndWhile
              ElseIf opcadmin = 3 Then 'Total de Fotomultas por Mes
                progopc = "1"
                While progopc = "1"
                  TextWindow.WriteLine("¿Qué mes desea consultar?")
                  TextWindow.WriteLine("")
                  TextWindow.WriteLine("1. Enero")
                  TextWindow.WriteLine("2. Febrero")
                  TextWindow.WriteLine("3. Marzo")
                  TextWindow.WriteLine("")
                  mes = TextWindow.ReadNumber()
                  If mes >= 1 And mes <= 3 Then 'Validación de respuesta
                    consultaMes()
                    MfinalAdm()
                  Else
                    MSJerror()
                  EndIf
                EndWhile
              ElseIf opcadmin = 4 Then 'Consultar por Cámara, Tipo de Infracción o Estado de la Fotomulta
                progopc = "1"
                While progopc = "1"
                  TextWindow.WriteLine("Por favor digite su criterio de busqueda")
                  TextWindow.WriteLine("")
                  TextWindow.WriteLine("1. Cámara")
                  TextWindow.WriteLine("2. Tipo de Infracción")
                  TextWindow.WriteLine("3. Estado de la Multa")
                  TextWindow.WriteLine("")
                  CamInfEst = TextWindow.ReadNumber()
                  TextWindow.Clear()
                  If CamInfEst >= 1 And CamInfEst <= 3 Then 'Busqueda conrrespecto:
                    progCIE = "1"
                    While progCIE = "1"
                      If CamInfEst = 1 Then 'Cámara
                        TextWindow.WriteLine("¿Qué cámara desea consultar?")
                        TextWindow.WriteLine("")
                        camarasmenu()
                        CIEcam = TextWindow.ReadNumber()
                        opcionC = CIEcam
                        TextWindow.Clear()
                        If CIEcam >= 1 And CIEcam <= 4 Then
                          If CIEcam = 1 Then 'cámara bomba los almendros
                            CIEc()
                            MfinalAdm()
                          ElseIf CIEcam = 2 Then 'cámara Av. las Vegas
                            CIEc()
                            MfinalAdm()
                          ElseIf CIEcam = 3 Then 'cámara Av. Oriental
                            CIEc()
                            MfinalAdm()
                          ElseIf CIEcam = 4 Then 'cámara regional
                            CIEc()
                            MfinalAdm()
                          EndIf
                        Else
                          MSJerror()
                        EndIf
                      ElseIf CamInfEst = 2 Then 'Tipo Infracción
                        TextWindow.WriteLine("¿Para qué infracción desea consultar?")
                        TextWindow.WriteLine("")
                        infraccionesmenu()                        
                        CIEinf = TextWindow.ReadNumber()
                        opcionI = CIEinf
                        TextWindow.Clear()
                        If CIEinf >= 1 And CIEinf <= 5 Then
                          If CIEinf = 1 Then
                            CIEinf = "F1"
                            CIEi()
                            MfinalAdm()
                          ElseIf CIEinf = 2 Then
                            CIEinf = "F2"
                            CIEi()
                            MfinalAdm()
                          ElseIf CIEinf = 3 Then
                            CIEinf = "F3"
                            CIEi()
                            MfinalAdm()
                          ElseIf CIEinf = 4 Then
                            CIEinf = "F4"
                            CIEi()
                            MfinalAdm()
                          ElseIf CIEinf = 5 Then
                            CIEinf = "F5"
                            CIEi()
                            MfinalAdm()
                          EndIf
                        Else
                          MSJerror()
                        EndIf
                      ElseIf CamInfEst = 3 Then 'Estado Multa
                        TextWindow.WriteLine("Escoja la opción que desea revisar")
                        TextWindow.WriteLine("")
                        estadomenu()
                        CIEestado = TextWindow.ReadNumber()
                        TextWindow.Clear()
                        If CIEestado >= 1 And CIEestado <= 2 Then
                          If CIEestado = 1 Then
                            opcionE = "cancelado"
                            CIEest()
                            MfinalAdm()
                          ElseIf CIEestado = 2 Then
                            opcionE = "pendiente"
                            CIEest()
                            MfinalAdm()
                          EndIf
                        Else
                          MSJerror()
                        EndIf
                      EndIf
                    EndWhile
                  Else
                    MSJerror()
                  EndIf
                EndWhile
              ElseIf opcadmin = 5 Then 'Cantidad y Porcentaje según Tipo de Infraccion
                      CantPorcInf()
                      MfinalAdm()
              ElseIf opcadmin = 6 Then 'Cantidad Y Porcentaje según Cámara
                CantPorCam()
                MfinalAdm()               
                
              ElseIf opcadmin = 7 Then 'Ingresos por Fotomultas Agrupados por Tipo de Infracción y Estado
                progopc = "1"
                While progopc = "1"
                  TextWindow.WriteLine("¿Según qué estado desea consultar los ingresos?")
                  TextWindow.WriteLine("")
                  estadomenu()
                  ingr = TextWindow.ReadNumber()
                  TextWindow.Clear()
                  If ingr >= 1 And ingr <= 2 Then
                    If ingr = 1 Then
                      opcionE = "cancelado"
                      estadoxinfrac()
                      MfinalAdm()
                    ElseIf ingr = 2 Then
                      opcionE = "pendiente"
                      estadoxinfrac()
                      MfinalAdm()
                    EndIf
                  Else
                    MSJerror()
                  EndIf
                EndWhile
              ElseIf opcadmin = 8 Then 'Regresar al menú inicial
                consadmin = "2"
                progadmin = "2"
              ElseIf opcadmin = 9 Then 'Salir
                consadmin = "2"
                progadmin = "2"
                resprog = "2"
              EndIf              
            Else
              MSJerror()
            EndIf
          EndWhile          
        Else
          If nombre <> "admin" Then
            TextWindow.WriteLine("Usuario incorrecto")
            TextWindow.WriteLine("Por favor digite de nuevo las credenciales")
            TextWindow.Pause()
            TextWindow.Clear()
          ElseIf PW <> "FMUNAC" Then
            TextWindow.WriteLine("Contraseña incorrecta")
            TextWindow.WriteLine("Por favor digite de nuevo las credenciales")
            TextWindow.Pause()
            TextWindow.Clear()
          EndIf
        EndIf        
      EndWhile      
    EndIf    
  Else   
    MSJerror()  'Mensaje de error
  EndIf 
EndWhile
TextWindow.Title = "¡HASTA LUEGO!" 'Fin del programa
Program.Delay(850)
Program.End()



Sub InfoPlaca
  MVE()
  TextWindow.WriteLine("Para: (placa - tipo de vehículo - ciudad)")
  For i = 1 to 8  'Se abren filas de la matriz VE
    For j = 1 to 3 'Se abren las clomunas
      If placarro = VE[i][j] Then
        For k = 1 to 3
          TextWindow.Write(VE[i][k]+" - ")
        EndFor
      EndIf
    EndFor
  EndFor
  TextWindow.WriteLine("")
  TextWindow.WriteLine("")
EndSub

Sub Multas
  TextWindow.WriteLine("")
  TextWindow.WriteLine("Fecha (dd/mm) -- Infracción -- Càmara -- Estado")
  TextWindow.WriteLine("")
  If consmulta = 3 Then
    todas()
  Else
    pendcanc()
  EndIf
EndSub

Sub pendcanc
  For i = 1 to 21 'Buscamos en las filas de la matriz REG
    For j = 1 to 6 'Buscamos las columnas de la matriz REG
      If placarro = REG[i][j] And REG[i][6] = estado Then 'Condición que indica que placa debe buscar y en qué estado está la multa
        BusquedaINF() 'Cambio de f1-f5 por el nombre de la infracción
        BusquedaCAM() 'Cambio del número de la cámara por el nombre de la cámara
        TextWindow.WriteLine(REG[i][1]+"/"+REG[i][2]+" -- "+REG[i][3]+" -- "+REG[i][5]+" -- "+REG[i][6])
      EndIf
    EndFor
  EndFor
  TextWindow.WriteLine("")
EndSub

Sub todas
  For i = 1 to 21 'Buscamos en las filas de la matriz REG
    For j = 1 to 6 'Byscamos en las columnas de la matriz REG
      If placarro = REG[i][j] Then 'Busca la placa en cualquier estado de la multa
        BusquedaINF() 'Cambio de f1-f5 por el nombre de la infracción
        BusquedaCAM() 'Cambio del número de la cámara por el nombre de la cámara
        TextWindow.WriteLine(REG[i][1]+"/"+REG[i][2]+" -- "+REG[i][3]+" -- "+REG[i][5]+" -- "+REG[i][6])
      EndIf
    EndFor
  EndFor
  TextWindow.WriteLine("")
EndSub

Sub BusquedaINF
  For n = 1 To 21 'Buscamos en las filas de la matriz REG
    For o = 1 To 6 'Buscamos en las columnas de la matriz REG
      For p = 1 To 5 'Buscamos en las filas de la matriz INF
        For q = 1 To 2 'Buscamos en las cilumnas de la matriz INF
          If REG[n][3] = INF[p][q] Then 'Se realiza el cambio del nombre de la infracción F1-F5 al nombre asignado de la infracción
            REG[n][3] = INF[p][1]
          EndIf
        EndFor
      EndFor
    EndFor
  EndFor  
EndSub

Sub BusquedaCAM
  For n = 1 To 26 'Buscamos en las filas de la matriz REG
    For o = 1 To 6 'Buscamos en las columnas de la matriz REG
      For p = 1 To 4 'Se abre el Vector CAM
        If REG[n][5] = p Then 'Se realiza el cambio del número de la cámara por su nombre
          REG[n][5] = CAM[p]
        EndIf
      EndFor
    EndFor    
  EndFor
EndSub

Sub MSJerror
  TextWindow.WriteLine("Usted digitó una opción incorrecta")
  Program.Delay(650)
  TextWindow.WriteLine("Por favor digite de nuevo")
  Program.Delay(850)
  TextWindow.Clear()
EndSub

Sub Menfinal
  TextWindow.WriteLine("¿Qué desea hacer a continuación?")
  TextWindow.WriteLine("")
  TextWindow.WriteLine("  1. Revisar Multas para otra placa")
  TextWindow.WriteLine("  2. Salir al menú inicial")
  TextWindow.WriteLine("    3. Salir del programa")
  respfin = TextWindow.ReadNumber()
  TextWindow.WriteLine("")
  If respfin >= 1 And respfin <= 3 Then 'Validación de Respuesta qué desea hacer a continuación
    If respfin = 1 Then 'Revisar multas para otra placa      
      validresp = "2"
      proguser = "1"
      TextWindow.Clear()
    ElseIf respfin = 2 Then 'Salir al menú inicial
      validresp = "2"
      proguser = "2"
      resprog = "1"
      TextWindow.Clear()
    ElseIf respfin = 3 Then 'Salir del programa
     validresp = "2"
      proguser = "2"
      resprog = "2"
      TextWindow.Clear()
    EndIf
  Else
    MSJerror() 'Mensaje de Error
  EndIf
EndSub

Sub plaka
  
  TextWindow.Write(" "+placarro+" ")
 
EndSub

Sub ConsultaPlaca
  MVE()
  MREG()
  MINF()
  VCAM()
  proguser = "1" 'Ciclo que sirve para repetir el menú del propietario de vehículo
  While proguser = "1"
    TextWindow.WriteLine("Por favor ingrese la placa del carro")
    TextWindow.WriteLine("")
    placarro = TextWindow.Read()
    placarro = Text.ConvertToUpperCase(placarro)
    TextWindow.Clear()
    hallado = 0
    For i = 1 To 8 'Revisando la mtariz de vehículos 'Se busca en las filas de la matriz VE
      For j = 1 To 3 'Se busca en las columnas de la matriz VE
        If placarro = VE[i][j] Then
          hallado = 1
        EndIf
      EndFor
    EndFor    
    If hallado = 0 Then      
      TextWindow.Write("¡La Placa ")
      plaka()
      TextWindow.Write(" no tiene multas!")
      TextWindow.WriteLine("")
      Program.Delay(1000)
      TextWindow.Clear()      
    ElseIf hallado = 1 Then
      If usradm = "usr" Then
        PlacaUser()
      ElseIf usradm = "adm" Then
        PlacaAdm()
      EndIf      
    Else
      MSJerror()'Mensaje de Error
    EndIf    
  EndWhile
EndSub

Sub PlacaUser
  validresp = "1" 'Ciclo que sirve como apoyo a validación de respuesta del menú final
  While validresp = "1"    
    TextWindow.Write("Placa: ")
    plaka()
    TextWindow.WriteLine("")
    TextWindow.WriteLine("Por favor digite la opción que desea revisar:")
    TextWindow.WriteLine("")
    TextWindow.WriteLine("  1. Multas Pendientes")
    TextWindow.WriteLine("  2. Multas Canceladas")
    TextWindow.WriteLine("  3. Todas las Multas")
    TextWindow.WriteLine("    4. Volver al menú inicial")
    TextWindow.WriteLine("    5. Salir")
    TextWindow.WriteLine("")
    consmulta = TextWindow.ReadNumber()
    TextWindow.Clear()    
    If consmulta >= 1 And consmulta <= 5 Then 'Validación de respuesta del menú final     
      If consmulta = 1 Then 'Multas pendientes        
        InfoPlaca()
        estado = "PENDIENTE"
        Multas()
        Menfinal()        
      ElseIf consmulta = 2 Then 'Multas canceladas
        InfoPlaca()
        estado = "CANCELADO"
        Multas()
        Menfinal()        
      ElseIf consmulta = 3 Then 'Todas las Multas
        InfoPlaca()
        Multas()
        Menfinal()        
      ElseIf consmulta = 4 Then
        proguser = "2"
        validresp = "2"            
      ElseIf consmulta = 5 Then
        proguser = "2"
        validresp = "2"
        resprog = "2"
      EndIf      
    Else      
      MSJerror() 'Mensaje de Error  
    EndIf    
  EndWhile
EndSub

Sub PlacaAdm
  validresp = "1"
  While validresp = "1"    
    TextWindow.Write("Placa: ")
    plaka()
    TextWindow.WriteLine("")
    TextWindow.WriteLine("Por favor digite la opción que desea revisar:")
    TextWindow.WriteLine("")
    TextWindow.WriteLine("  1. Multas Pendientes")
    TextWindow.WriteLine("  2. Multas Canceladas")
    TextWindow.WriteLine("  3. Todas las Multas")
    TextWindow.WriteLine("  4. Volver al menú anterior")
    TextWindow.WriteLine("    5. Volver al menú inicial")
    TextWindow.WriteLine("    6. Salir")
    TextWindow.WriteLine("")
    consmulta = TextWindow.ReadNumber()
    TextWindow.Clear()    
    If consmulta >= 1 And consmulta <= 6 Then      
      If consmulta = 1 Then 'Multas pendientes
        InfoPlaca()
        estado = "PENDIENTE"
        Multas()
        Menfinal()        
      ElseIf consmulta = 2 Then 'Multas canceladas
        InfoPlaca()
        estado = "CANCELADO"
        Multas()
        Menfinal()        
      ElseIf consmulta = 3 Then 'Todas las Multas
        InfoPlaca()
        Multas()
        Menfinal()
      ElseIf consmulta = 4 Then
        validresp = "2"
        proguser = "2"
      ElseIf consmulta = 5 Then
        consadmin = "2"
        progadmin = "2"
        validresp = "2"           
      ElseIf consmulta = 6 Then
        progadmin = "2"
        consadmin = "2"
        validresp = "2"
        resprog = "2"
      EndIf      
    Else      
      MSJerror() 'Mensaje de Error      
    EndIf    
  EndWhile
EndSub

Sub Infracciones
  If Tipinf = 1 Then
    Finf = "F1"
    infrac = "Paso de semáforo en rojo"
  ElseIf Tipinf = 2 Then
    Finf = "F2"
    infrac = "Velocidad límite superada"
  ElseIf Tipinf = 3 Then
    Finf = "F3"
    infrac = "Revisión técnico mecánica vencida"
  ElseIf Tipinf = 4 Then
    Finf = "F4"
    infrac = "SOAT Vencido"
  ElseIf Tipinf = 5 Then
    Finf = "F5"
    infrac = "Pico y Placa"
  EndIf    
EndSub

Sub States
  If Tipest = 1 Then
    stat = "CANCELADO"
  ElseIf Tipest = 2 Then
    stat = "PENDIENTE"
  EndIf
EndSub

Sub consultaInfEst
  MREG()
  MINF()
  VCAM()
  TextWindow.WriteLine("Los criterios de busqueda son: ")
  TextWindow.WriteLine("")
  infrac = Text.ConvertToUpperCase(infrac)
  tinf = ""
  For i = 1 To 5 'Se abre la matriz de infracciones
    For j = 1 To 2
      If infrac = INF[i][1] Then
        tinf = INF[i][2]        
      EndIf
    EndFor
  EndFor
  stat = Text.ConvertToUpperCase(stat)
  suma = 0
  For i = 1 To 21 'Se abre la matriz de registros
    For j = 1 To 6
      If tinf = REG[i][j] And stat = REG[i][6] Then 'Se busca la infracción y el estado de la multa
        suma = suma + 1
      EndIf
    EndFor
  EndFor
  TextWindow.WriteLine(infrac+" -- "+suma+" multas en estado "+stat)
  TextWindow.WriteLine("")
EndSub

Sub MfinalAdm
  valMfinal = "1"
  While valMfinal = "1"
    TextWindow.WriteLine("")
    TextWindow.WriteLine("")
    TextWindow.WriteLine("")
    TextWindow.WriteLine("¿Qué desea hacer a continuación?")
    TextWindow.WriteLine("")
    TextWindow.WriteLine("  1. Consultar de nuevo")
    TextWindow.WriteLine("  2. Volver al menú de administrador")
    TextWindow.WriteLine("  3. Vovler al menú inicial")
    TextWindow.WriteLine("    4. Salir del programa")
    respfin = TextWindow.ReadNumber()
    TextWindow.WriteLine("")
    If respfin >= 1 And respfin <= 4 Then
      If respfin = 1 Then 'Revisar multas por Tipo y Estado
        progCIE = "2"
        valMfinal = "2"
        progEst = "2"
        TextWindow.Clear()
      ElseIf respfin = 2 Then 'Volver al Menú de administrador
        progCIE = "2"
        valMfinal = "2"
        progEst = "2"
        progopc = "2"
        TextWindow.Clear()
      ElseIf respfin = 3 Then 'Salir al menú inicial
        progCIE = "2"
        valMfinal = "2"
        progEst = "2"
        progopc = "2"
        consadmin = "2"
        progadmin = "2"
        TextWindow.Clear()
      ElseIf respfin = 4 Then 'Salir del programa
        progCIE = "2"
        valMfinal = "2"
        progEst = "2"
        progopc = "2"
        consadmin = "2"
        progadmin = "2"
        resprog = "2"
        TextWindow.Clear()
      EndIf
    Else
      MSJerror() 'Mensaje de Error
    EndIf
  EndWhile
EndSub

Sub consultaMes
  MREG()
  anio()
  sumames = 0
  For i = 1 To 21 'Se abre la matrz de registros
    For j = 2 To 2
      If mes = REG[i][j] Then 'Se busca el mes que el usuario digitó
        sumames = sumames + 1
      EndIf
    EndFor
  EndFor
  TextWindow.WriteLine("Para: "+nombremes+" hay "+sumames+" multas")
  TextWindow.WriteLine("")
EndSub  

Sub anio
  If mes = 1 Then
    nombremes = "Enero"
  ElseIf mes = 2 Then
    nombremes = "Febrero"
  ElseIf mes = 3 Then
    nombremes = "Marzo"
  EndIf
EndSub

Sub CIEc
  MREG()
  MINF()
  VCAM()
  For i = 1 To 4
    If opcionC = i Then
      opcionC = CAM[i]
    EndIf
  EndFor
  BusquedaINF()
  TextWindow.WriteLine("Para la cámara "+opcionC+" estan las siguientes fotomultas")
  TextWindow.WriteLine("")
  For i = 1 to 21 'Se abre la matriz de registros
    For j = 5 To 5
      If CIEcam = REG[i][5] Then 'Imprime la cámara y los datos  escogido por el usuario
        TextWindow.WriteLine(REG[i][1]+"/"+REG[i][2]+" -- "+REG[i][3]+" -- "+REG[i][6])
      EndIf
    EndFor
  EndFor
  TextWindow.WriteLine("")
EndSub 

Sub CIEi
  MREG()
  MINF()
  VCAM()
  For i = 1 To 5
    For j = 1 To 2
      If opcionI = i Then
        opcionI = INF[i][1]
      EndIf
    EndFor
  EndFor
  BusquedaCAM()
  TextWindow.WriteLine(opcionI+": Hay las siguientes fotomultas")
  TextWindow.WriteLine("")
  For i = 1 to 21
    For j = 3 To 3
      If CIEinf = REG[i][j] Then        
        TextWindow.WriteLine(REG[i][1]+"/"+REG[i][2]+" -- "+REG[i][5]+" -- "+REG[i][6])
      EndIf
    EndFor
  EndFor
  TextWindow.WriteLine("")
EndSub

Sub CIEest
  MREG()
  MINF()
  VCAM()
  opcionE = Text.ConvertToUpperCase(opcionE)
  TextWindow.WriteLine("Las multas "+opcionE+"S son las siguientes")
  TextWindow.WriteLine("")
  BusquedaCAM()
  BusquedaINF()
  For i = 1 to 21
    For j = 6 To 6
      If opcionE = REG[i][j] Then        
        TextWindow.WriteLine(REG[i][1]+"/"+REG[i][2]+" -- "+REG[i][3]+" -- "+REG[i][5])
      EndIf
    EndFor
  EndFor
  TextWindow.WriteLine("")
EndSub

Sub CantPorcInf
  MREG()
  MINF()
      i = 1
      While i <= 5
        coI[i] = 0
        j = 1
        While j <= 21
          If REG[j][3] = INF[i][2] then 
            coI[i] = coI[i] + 1
          EndIf
          j = j + 1
        endwhile 
        infT[i] = INF[i][1]
        i = i  + 1
      endwhile 
      i = 1
      While i <= 5
        porcI[i] = coI[i] * 100 / 21
        porcI[i] = Math.Round(porcI[i])
        i = i + 1
      endwhile 
      
      For i = 1 to 4
        For j = i + 1 to 5
          If coI[j] > coI[i] then 
            t = coI[i]
            coI[i] = coI[j]
            coI[j] = t 
            t = infT[i]
            infT[i] = infT[j]
            infT[j] = t 
            t = porcI[i] 
            porcI[i] = porcI[j]
            porcI[j] = t 
          EndIf
        endfor 
      endfor
      i = 1
      While i <= 5
        TextWindow.WriteLine("           ")
        TextWindow.WriteLine(INFT[i]+":"+" "+coI[i]+" Corresponde al "+"  "+porcI[i]+ "%")
        i = i + 1
      endwhile
EndSub


Sub CantPorCam
  MREG()
  VCAM()
 TextWindow.WriteLine("           ")
      i = 1
      While i <= 4
        coC[i] = 0
        j = 1
        While j <= 21
          If REG[j][5] = i then 
            coC[i] = coC[i] + 1
          EndIf
          j = j + 1
        endwhile 
        camT[i] = CAM[i]
        i = i  + 1
      endwhile 
      i = 1
      While i <= 4
        porcCAM[i] = coC[i] * 100 / 21
        porcCAM[i] = Math.Round(porcCAM[i])
        i = i + 1
        endwhile
        
      For i = 1 to 3
        For j = i + 1 to 4
          If coC[j] > coC[i] then 
            t = wcC[i]
            coC[i] = coC[j]
            coC[j] = t 
            t = camT[i]
            camT[i] = camT[j]
            camT[j] = t 
            t = porcCAM[i] 
            porcCAM[i] = porcCAM[j]
            porcCAM[j] = t 
          EndIf
        endfor 
      endfor
      i = 1
      While i <= 4
        TextWindow.WriteLine(camT[i]+":"+" "+coC[i]+" Corresponde al  "+porcCAM[i]+ "%")
        i = i + 1
        endwhile
    
EndSub

Sub infraccionesmenu
  TextWindow.WriteLine("1. Paso de semáforo en rojo")
  TextWindow.WriteLine("2. Velocidad límite superada")
  TextWindow.WriteLine("3. Revisión técnico mecánica vencida")
  TextWindow.WriteLine("4. SOAT vencido")
  TextWindow.WriteLine("5. Pico y Placa")
  TextWindow.WriteLine("")
EndSub

Sub camarasmenu
  TextWindow.WriteLine("1. Bomba los Almendros")
  TextWindow.WriteLine("2. Avenida las Vegas")
  TextWindow.WriteLine("3. Avenida Oriental")
  TextWindow.WriteLine("4. Avenida Regional")
  TextWindow.WriteLine("")
EndSub

Sub estadomenu
  TextWindow.WriteLine("1. Cancelado")
  TextWindow.WriteLine("2. Pendiente")
  TextWindow.WriteLine("")
Endsub

Sub estadoxinfrac
  MREG()
  opcionE = Text.ConvertToUpperCase(opcionE)
  BusquedaINF()
  costomulta = 380000
  TextWindow.WriteLine(opcionE)
  TextWindow.WriteLine("")
  Tipinf = 6
  totalsuma = 0
  While Tipinf > 1
    suma = 0
    Tipinf = Tipinf - 1
    Infracciones()
    For i = 1 to 21
      For j = 6 To 6
        If opcionE = REG[i][j] Then 
          For k = 3 To 3
            If Finf = REG[i][k] Then
              suma = suma + 1
              totalsuma = totalsuma + 1
            EndIf
          EndFor
        EndIf
      EndFor
    EndFor
    infrac = Text.ConvertToUpperCase(infrac)  
    TextWindow.Write(infrac+": "+suma+" multas, son $"+(suma*costomulta))
    TextWindow.WriteLine("")
    TextWindow.WriteLine("")
  EndWhile
  TextWindow.WriteLine("")
  TextWindow.WriteLine("Total de ingresos por multas "+opcionE+": $"+(totalsuma*costomulta))
EndSub
