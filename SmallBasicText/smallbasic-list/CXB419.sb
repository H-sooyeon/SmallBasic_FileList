
GraphicsWindow.Width=1300
GraphicsWindow.Height=720
GraphicsWindow.BackgroundColor="darkblue
GraphicsWindow.PenWidth=0
GraphicsWindow.BrushColor="white

zz=1
nn="false
not="true=false;false=true
nt="0=false;2=false;1=true
txx="false
tt=100
m1[256][176][2]=2
mm=LDFastArray.CreateFromValues(m1)
qcc[ 0]="~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~oooo~~~~oooo~~~~oooooooooooooooo~~~~oooo~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~o~o~o~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[ 1]="~~oooo~~~ooooo~~~~oooo~~~oooo~~~~oooooo~~oooooo~~$ooooo~~~oooo~~~o$~~@o~~~oooo~~~o$~~@o~~~~~~$o~~~oooo~~~@oooo~~~oooooo~ooooooo~~o$~~~~~~o~~~@o~~o~~~~o~~o$~~o@~~ooooo~~~ooooo~~~o$~~@o~~o$~~@o~@o~~~$o~o$~~~~o@~ooooo~~~~oo$~~~~~oooo~~~~oooo~~~~oooo~~~oooooo~~~oooo~	~~oooo~~~~oooo~~~oooooo~~~~~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~o~o~~~~~o~~~~~~~~~~o~~~~~~o~~~~~~o~~~~~~oo~~~~~oooo~~~~~~~~~~~~~~oooooooooooo~~~~oooooooo~~~~oooooooo~~o~~o~~~~~~~o~~~~o~~o~~~~o~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~o~o~o~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[ 2]="~o$~~@o~~o$~~@o~~o$~~@o~~o$~@o~~~o$~~~~~~o$~~~~~~~~$o~~~~o$~~$o~~o$~~@o~~o$~~@o~~o$~~@o~~~~~~$o~~o$~~~~~@o~~~$o~~~~~~o$~~~$o~~~~~o$~~~~~~oo~~@o~~oo~~oo~~o$~o@~~~o$~~@o~~o$~~@o~~o$~~@o~~o$~~@o~~@o~$o~~~o$~~o@~o~~~~~o~~o~o$~~~~o~~~$o~~o$~~@o~~o@~~$o~~o$~~~~~~o$~~~~~~o@~~$o~~o$~~oo~~~~~~~o~~~~oo~~~~~o~~~~~~~~~~~~~~~~~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~o~o~~~ooooo~~~~~~~o~~~~~~o~~~~~~~~o~~~~o~~o~~~o~~~~o~~~o~~~o~~~~~oooooooooooo~~~~oooooooo~~~~oooooooo~~~oo~~~~~~~o~~~~~~oo~~~~~~o~~~~~oooo~~~~~~~o~~~~~~~~~~~~~~~o~~~~~~~~~~~o~o~o~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[ 3]="~o$~~@o~~ooooo~~~o$~~~~~~o$~~@o~~ooooo~~~ooooo~~~~~$o~~~~o$~~$o~~o$~~@o~~o$~~~~~~oooooo~~~~~~$o~~~oooo~~@o~~~$o~~~~~o$~~~~$o~~~~~o$~~~~~~o$o~@o~~o$oo@o~~ooo@~~~~o$~~@o~~o$~~@o~~o$~~@o~~o$~~@o~~~@oo~~~~~o$o@~~o~ooo~o~~~~o$~~~~~~~~$o~~~oooo~~~o@~~$o~~ooooo~~~ooooo~~~~~~oo~~~o$~o@o~~~~~~o~~~~o~o~~~~~~o~~~~~oooooo~~~~~o~~~~~~~~~~~~~~~o~~~~~~~~~~~~~~o~o~~o~~o~~~~~~~~o~~~~~~o~~~~~~~~~~o~~o~~~~o~~~~~~~o~~~~o~o~~~~~~oooooooooooo~~~~oooooooo~~~~oooooooo~~oooo~~~~oooo~~~~oooo~~~ooooo~~~o$~~o~~~~~o~~~~~~~~~~~~~~~~o~~~~oooooo~~o~o~o~o~~~~~~~~~~~~~~~~~~~~~~
qcc[ 4]="~oooooo~~o$~~@o~~o$~~~~~~o$~~@o~~o$~~~~~~o$~~~~~~~~$o~~~~o$~~$o~~o$~~@o~~o$~ooo~~o$~~@o~~o@~~$o~~~~~~$o~@o~o~$o~~~~o$~~~~~$o~~~~~o$~~~~~~o@$o@o~~o$~~@o~~o$$o~~~~ooooo~~~ooooo~~~o$~~@o~~o$~~@o~~~$oo~~~~~~o$~~~o~o~~~o~~~~o$~~~~~oooo~~~o$~~@o~~~ooooo~~~~~~$o~~o$~~@o~~~~~~$o~~o$o~@o~~~~~o~~~~o~~o~~~~~~~o~~~~~~~~~~~~~ooooo~~~ooooo~~~~~~~~~~~~~~~~~~~~~~~~~~ooooo~~~~~o~~~~~~~o~~~~~~~~~~o~~~~~~~~~~~~~oo~~~ooooooo~~~~oooooooooooo~~~~oooooooo~~~~oooooooo~o$~~@o~~o$~~@o~~o$~~~~~~~~$o~~~~o$~~@o~~~o~~~~~~~~~~~~~~~~~o~~~o~o~~o~~o~o~o~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[ 5]="~o$~~@o~~o$~~@o~~o$~~@o~~o$~@o~~~o$~~~~~~o$~~~~~~~~$o~~~~o$~~$o~~o$~~@o~~o$~~@o~~o$~~@o~~o@~~$o~~o$~~$o~@o~~o$o~~~o$~~~~~~$o~~~~~o$~~~~~~o@~$oo~~o$~~@o~~o$~$o~~~o$~~~~~~o$~@o~~~~o$@o~~~o$oo@o~~$o~@o~~~~~o$~~~o~ooo~o~~~~o$~~~~o$~~~~~~o$~~@o~~~~~~$o~~o@~~$o~~o$~~@o~~o@~~$o~~oo~~@o~~~~o~~~~~oooooo~~~~o~~~~~oooooo~~~~~o~~~~~~~~~~~~~~~o~~~~~~~o~~~~~~~~~~~~~~o~~o~~~o~~~~~~~~o~~~~~~~~~~o~~~~~~~~~~~~o~~~~~~~o~o~~oooo~~~~oooo~~~~oooooooooooooooo~~~~oooo~o$~~~~~~o$~~~~~~~oooo~~~~$o~~~~ooo$~@o~~~~o~~~~~~~~~~~~~~~~o~~~~~o~~o~~~o~o~o~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[ 6]="~o$~~@o~~ooooo~~~~oooo~~~oooo~~~~oooooo~~o$~~~~~~$ooooo~~~oooo~~~~oooo~~~~oooo~~~o$~~@o~~~oooo~~~~oooo~~~@oooo~~~oooooo~~~$o~~~~~oooooo~~o@~~$o~~o$~~@o~~o$~~$o~~o$~~~~~~o$~~@o~~~~oo~~~~~o~~o~~$o~~~@o~~~~o$~~~o~~~~~o~~ooooo$~~oooooo~~~oooo~~~@oooo~~~~oooo~~~~oooo~~~~oooo~~~~oooo~~~~~o~~~~~~~~o~~~~~o~~~~~~~~~~~~~~~~~o~~~~~~~~~~~~~~~~~~~~~~~o~~~~~~~~~~~~ooooo~~~o~~~~~~~~~~o~~~~~~~~o~~~~~~~~~~~~~~~~~~~~o~~~o~oooo~~~~oooo~~~~oooooooooooooooo~~~~oooo~o$~~@o~~o$~~@o~~~~~~@o~~$o~~~~~~o$~~o~~~~~~o~~~~~~oo~~~~~~~~~~~~~o~~o~~o~o~o~o~~~~~~~~~~~~~~~~~~~~~
qcc[ 7]="~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ooooo~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~o~~~~~~~~~~~~~~~o~~~~o~~~~~~~~~~~~o~~~~~~o~~~~~~~~~~~~~~o~~~~~~~~~~~~oooo~~~~oooo~~~~oooooooooooooooo~~~~oooo~~oooo~~~~oooo~~~ooooo~~~ooooo~~~oooo~~~~~~~~~~~~~~oo~~~~~~~o~~~~~o~~o~~~o~o~o~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[ 8]="~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~oooo~~~~oooo~~~~oooooooooooooooo~~~~oooo~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~o~o~o~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[ 9]="~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[10]="~~~oo~~~~~ooo~~~~~~oo~~~~~ooo~~~~~oooo~~~~oooo~~~~~~o~~~~~~oo~~~~~o~~o~~~~~ooo~~~~o~~o~~~~~~~o~~~~~ooo~~~~~oo~~~~~oooo~~~ooooo~~~~o~~~~~~~o~~o~~~o~~~o~~~~o~~o~~~~ooo~~~~~ooo~~~~~o~~o~~~~o~~~o~~~o~~~o~~~o~~~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[11]="~~o~~o~~~~o~~o~~~~o~~o~~~~o~~o~~~~o~~~~~~~o~~~~~~~~~o~~~~~o~~o~~~~o~~o~~~~o~~~~~~~o~~o~~~~~~~o~~~~o~~~~~~~o~~o~~~~~~~o~~~~~o~~~~~~o~~~~~~~oo~o~~~oo~oo~~~~o~o~~~~~o~~o~~~~o~~o~~~~o~~o~~~~o~~~o~~~~o~o~~~~~o~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[12]="~~oooo~~~~ooo~~~~~o~~~~~~~o~~o~~~~ooo~~~~~ooo~~~~~~~o~~~~~o~~o~~~~o~~o~~~~o~oo~~~~oooo~~~~~~~o~~~~~oo~~~~~o~~o~~~~~~o~~~~~~o~~~~~~o~~~~~~~o~oo~~~o~o~o~~~~oo~~~~~~ooo~~~~~ooo~~~~~o~~o~~~~o~~~o~~~~~o~~~~~~~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[13]="~~o~~o~~~~o~~o~~~~o~~o~~~~o~~o~~~~o~~~~~~~o~~~~~~~~~o~~~~~o~~o~~~~o~~o~~~~o~~o~~~~o~~o~~~~o~~o~~~~~~~o~~~~o~oo~~~~~o~~~~~~~o~~~~~~o~~~~~~~o~~o~~~o~~~o~~~~o~o~~~~~o~~~~~~~o~o~~~~~o~o~~~~~o~o~o~~~~o~o~~~~~~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[14]="~~o~~o~~~~ooo~~~~~~oo~~~~~ooo~~~~~oooo~~~~o~~~~~~~~~o~~~~~~oo~~~~~~oo~~~~~~ooo~~~~o~~o~~~~~oo~~~~~ooo~~~~~~o~o~~~~oooo~~~~~o~~~~~~oooo~~~~o~~o~~~o~~~o~~~~o~~o~~~~o~~~~~~~o~~o~~~~~o~~~~~~~o~o~~~~o~~~o~~~~~o~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
qcc[15]="~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ccc["o"]=1
ccc["~"]=0
ccc["#"]=0
ccc["@"]=0
dc="1=red;2=darkblue;3=red
'LDEvents.MouseWheel=www
inn="true

Sub genn
  For y=1 To 176
    For x=1 To 256
      px=math.Floor((x-1)/8)
      py=math.Floor((y-1)/8)
      ff=math.Remainder(px+py 2)
      pcc=qcc[Math.Remainder(y-1 16)]
      
      pc=Text.GetSubText(pcc x 1)
      If txx Then
        If Text.GetSubText(qcc[Math.Remainder(y 15)] x 1)="o" Then
          LDFastArray.Set3D(mm x y 1 0)
        EndIf
      Else
        If inn Then
          LDFastArray.Set3D(mm x y 1 0)
        EndIf
        LDFastArray.Set3D(mm x y 2 dc[2])
        LDFastArray.Set3D(mm x y 3 dc[2])
      EndIf
      
    EndFor
  EndFor
  inn="false
  
  For r=0 To 360 Step .5
    fy=math.floor(LDMath.Sin(r)*80)+85
    fx=math.floor(LDMath.Cos(r)*80)+128
    LDFastArray.Set3D(mm fx fy 1 1)
    LDFastArray.Set3D(mm fx fy 2 "white")
    LDFastArray.Set3D(mm fx fy 3 "white")
  EndFor
  
  GraphicsWindow.Title="ZX Screen overlay demo
  cc="0=darkblue;1=white
  bc="red
  f2=4
  
  LDCall.Function4("ffil" "100:100" 0 1 "red")
  For r=0 To 360 Step .5
    fy=math.floor(LDMath.Sin(r)*50)+85
    fx=math.floor(LDMath.Cos(r)*50)+128
    LDFastArray.Set3D(mm fx fy 1 0)
    LDFastArray.Set3D(mm fx fy 2 "white")
    LDFastArray.Set3D(mm fx fy 3 "white")
  EndFor
  LDCall.Function4("ffil" "120:85" 1 0 "")
  LDCall.Function4("ffil" "120:85"  0 1 "yellow")
  For r=0 To 360 Step .5
    fy=math.floor(LDMath.Sin(r)*65)+85
    fx=math.floor(LDMath.Cos(r)*70)+128
    LDFastArray.Set3D(mm fx fy 1 0)
    LDFastArray.Set3D(mm fx fy 2 "black")
    LDFastArray.Set3D(mm fx fy 3 "white")
  EndFor
  For r=0 To 360 Step .5
    fy=math.floor(LDMath.Sin(r)*55)+85
    fx=math.floor(LDMath.Cos(r)*55)+128
    LDFastArray.Set3D(mm fx fy 1 0)
    LDFastArray.Set3D(mm fx fy 2 "black")
    LDFastArray.Set3D(mm fx fy 3 "white")
  EndFor
  LDCall.Function4("ffil" "70:85"   1 0 "black")
  
EndSub


While 1=1
  
  txx="false
  inn="true
  genn()
  For zx=1 To 256
    
    For zy=1 To 175
      
      rr=LDFastArray.Get3D(mm zx zy 1 )
      c0=LDFastArray.Get3D(mm zx zy 2 )
      ' cl=LDFastArray.Get3D(mm zx zy 3 )
      
      If rr=1 Then
        GraphicsWindow.BrushColor=c0
        GraphicsWindow.FillRectangle(zx*f2 zy*f2 f2 f2)
      Else
        ' GraphicsWindow.BrushColor="darkblue
        
      EndIf
      
      
      
    EndFor
  EndFor
  txx="true
  genn()
  
  Program.Delay(2500)
  For zy=1 To 175
    For zx=1 To 256
      
      rr=LDFastArray.Get3D(mm zx zy 1 )
      
      If rr=1 Then
        GraphicsWindow.BrushColor="cyan
      Else
        GraphicsWindow.BrushColor="Darkblue
        
      EndIf
      GraphicsWindow.FillRectangle(zx*f2 zy*f2 f2 f2)
      
    EndFor
  EndFor
  GraphicsWindow.BrushColor="darkblue
  GraphicsWindow.FillRectangle(255*f2 0 500 900)
  Program.Delay(2500)
  txx="false
  genn()
  
  For zx=1 To 256
    For zy=1 To 175
      rr=LDFastArray.Get3D(mm zx zy 1 )
      c0=LDFastArray.Get3D(mm zx zy 2 )
      If rr=1 Then
        GraphicsWindow.BrushColor=c0
        GraphicsWindow.FillRectangle((zx+100)*f2 zy*f2 f2 f2)
        
        
      EndIf
      
    EndFor
  EndFor
  Program.Delay(2500)
EndWhile



Sub www
  oo=oo+LDEvents.LastMouseWheelDelta*5
  If oo<0 Then 
    oo=0
  ElseIf oo>90 Then
    oo=90
  EndIf
  genn()
EndSub


'Flood-fill (node, target-color, replacement-color):
args=0
Sub ffil
  nd=LDText.Split(args[1] ":")
  a0=args[2]
  a1=args[3]
  a11=args[4]
  cc=0
  
  If LDFastArray.Get3D(mm nd[1] nd[2] 1 )<>a0 Then
    Goto xxx
  EndIf
  LDQueue.Enqueue("qq" nd[1]+":"+nd[2])
  LDFastArray.Set3D(mm nd[1] nd[2] 1 a1 )
  LDFastArray.Set3D(mm nd[1] nd[2] 2 a11 )
  
  While LDQueue.GetCount("qq")>0
    cc=cc+1
    ndd=LDQueue.Dequeue("qq")
    nd=LDText.Split(ndd ":")
    '  Remove first element from Q.
    If LDFastArray.Get3D(mm nd[1]+1 nd[2] 1 )=a0 Then
      LDFastArray.Set3D(mm nd[1]+1 nd[2] 1 a1 )
      LDFastArray.Set3D(mm nd[1]+1 nd[2] 2 a11 )
      nd[1]=nd[1]+1
      LDQueue.Enqueue("qq" nd[1]+":"+nd[2])
      'set the color of that node To replacement-color and add that node To the end of Q.
    EndIf
    If LDFastArray.Get3D(mm nd[1]-1 nd[2] 1 )=a0 Then
      LDFastArray.Set3D(mm nd[1]-1 nd[2] 1 a1 )
      LDFastArray.Set3D(mm nd[1]-1 nd[2] 2 a11 )
      nd[1]=nd[1]-1
      LDQueue.Enqueue("qq" nd[1]+":"+nd[2])
      ' set the color of that nde To replacement-color and add that node To the end of Q.
    EndIf
    If LDFastArray.Get3D(mm nd[1] 1+nd[2] 1 )=a0 Then
      LDFastArray.Set3D(mm nd[1] 1+nd[2] 1 a1 )
      LDFastArray.Set3D(mm nd[1] 1+nd[2] 2 a11 )
      nd[2]=nd[2]+1
      LDQueue.Enqueue("qq" nd[1]+":"+nd[2])
      'set the color of that node To replacement-color and add that node To the end of Q.
    EndIf
    If LDFastArray.Get3D(mm nd[1] nd[2]-1 1 )=a0 Then
      LDFastArray.Set3D(mm nd[1] nd[2]-1 1 a1)
      LDFastArray.Set3D(mm nd[1] nd[2]-1 2 a11)
      nd[2]=nd[2]-1
      LDQueue.Enqueue("qq" nd[1]+":"+nd[2])
      'set the color of that node To replacement-color and add that node To the end of Q.
    EndIf
    
    
  EndWhile
  xxx:
 ' GraphicsWindow.Title=cc+" ok
EndSub


