'Variables

CurrentFontName = "Microsoft Sans Serif"

CurrentFontSize = 13

CurrentFontBold = "False"

CurrentFontItalic = "False"

CurrentFontColor = "Black"

CurrentMenu = ""

PrevFDFontName = ""

PrevFDFontSize = ""

PrevFDFontBold = ""

PrevFDFontItalic = ""

PrevFDFontColor = ""

UserWantsFontSettingsRestored = "No"

FurtherFontNamesHidden = "Yes"

SecondScreenAdded = "No"

ImageAdded = "No"

PreviousTop = ""

ChangesAffect = "TF1"



'Images

ImgFontLogo = "C:\Users\?˜Î±Î½Î??ƒÎ·Ï?\Documents\Small Basic\Images\Notebook\FontIcon.png"

' The following line could be harmful and has been automatically commented.

' ImgTMNewFile = "C:\Users\?˜Î±Î½Î??ƒÎ·Ï?\Documents\Small Basic\Images\Notebook\NewFile.png"

' The following line could be harmful and has been automatically commented.

' ImgTMOpenFile = "C:\Users\?˜Î±Î½Î??ƒÎ·Ï?\Documents\Small Basic\Images\Notebook\OpenFile.png"

' The following line could be harmful and has been automatically commented.

' ImgTMSaveFile = "C:\Users\?˜Î±Î½Î??ƒÎ·Ï?\Documents\Small Basic\Images\Notebook\SaveFile.png"

ImgTMFontSize = "C:\Users\?˜Î±Î½Î??ƒÎ·Ï?\Documents\Small Basic\Images\Notebook\FontSize.png"

ImgTMSecondScreen = "C:\Users\?˜Î±Î½Î??ƒÎ·Ï?\Documents\Small Basic\Images\Notebook\SecondScreen.png"

ImgDMInfoIcon = "C:\Users\?˜Î±Î½Î??ƒÎ·Ï?\Documents\Small Basic\Images\Notebook\InfoIcon.png"

ImgCopyPaste = "C:\Users\?˜Î±Î½Î??ƒÎ·Ï?\Documents\Small Basic\Images\Notebook\CopyPaste.png"

ImgTMAddImage = "C:\Users\?˜Î±Î½Î??ƒÎ·Ï?\Documents\Small Basic\Images\Notebook\AddImage.png"

ImgTMGear = "C:\Users\?˜Î±Î½Î???Î·??\Documents\Small Basic\Images\Notebook\Gear.png"



'Colors

GrayControl = GraphicsWindow.GetColorFromRGB(240, 240, 240)

GrayControlShadow = GraphicsWindow.GetColorFromRGB(160, 160, 160)



'Window

GraphicsWindow.Hide()

GraphicsWindow.Title = "Notebook"

GraphicsWindow.Width = 1000

GraphicsWindow.Height = 600

GraphicsWindow.Top = 2500

GraphicsWindow.Left = 1500

GraphicsWindow.CanResize = "False"

GraphicsWindow.BackgroundColor = GraphicsWindow.GetColorFromRGB(200, 200, 200)

GraphicsWindow.Show()



'Main

SetupProgram()

GraphicsWindow.Top = (Desktop.Height - 670) / 2

GraphicsWindow.Left = (Desktop.Width - 1000) / 2



'SUBROUTINES

'***************

'SetupProgram

Sub SetupProgram

  GraphicsWindow.Hide()

  AddTopMenu()

  HideTopMenu()

  AddScreen()

  HideScreen()

  AddNewFileDialog()

  HideNewFileDialog()

  AddOpenFileDialog()

  HideOpenFileDialog()

  AddSaveFileDialog()

  HideSaveFileDialog()

  AddFontDialog()

  HideFontDialog()

  AddCopyPasteDialog()

  HideCopyPasteDialog()

  AddSettingsDialog()

  HideSettingsDialog()

  ShowTopMenu()

  Shapes.ShowShape(Screen)

  GraphicsWindow.Show()

EndSub



'AddTopMenu

Sub AddTopMenu

  GraphicsWindow.BrushColor = GrayControl

  GraphicsWindow.PenWidth = 1

  GraphicsWindow.PenColor = GrayControlShadow

  TMBackRec = Shapes.AddRectangle(GraphicsWindow.Width - 10, 35)

  Shapes.Move(TMBackRec, 5, 5)

  TMSeperator8 = Shapes.AddRectangle(39, 35)

  Shapes.Move(TMSeperator8, 233, 5)

  TMSeperator7 = Shapes.AddRectangle(229, 35)

  Shapes.Move(TMSeperator7, 5, 5)

  TMSeperator5 = Shapes.AddRectangle(191, 35)

  Shapes.Move(TMSeperator5, 5, 5)

  TMSeperator4 = Shapes.AddRectangle(153, 35)

  Shapes.Move(TMSeperator4, 5, 5)

  TMSeperator3 = Shapes.AddRectangle(115, 35)

  Shapes.Move(TMSeperator3, 5, 5)

  TMSeperator2 = Shapes.AddRectangle(77, 35)

  Shapes.Move(TMSeperator2, 5, 5)

  TMSeperator = Shapes.AddRectangle(39, 35)

  Shapes.Move(TMSeperator, 5, 5)

  TMIconNewFile = Shapes.AddImage(ImgTMNewFile)

  Shapes.Move(TMIconNewFile, 12, 12)

  TMIconOpenFile = Shapes.AddImage(ImgTMOpenFile)

  Shapes.Move(TMIconOpenFile, 52, 12)

  TMIconSaveFile = Shapes.AddImage(ImgTMSaveFile)

  Shapes.Move(TMIconSaveFile, 90, 12)

  TMIconFontSize = Shapes.AddImage(ImgTMFontSize)

  Shapes.Move(TMIconFontSize, 128, 12)

  TMIconSecondScreen = Shapes.AddImage(ImgTMSecondScreen)

  Shapes.Move(TMIconSecondScreen, 166, 11)

  TMIconAddImage = Shapes.AddImage(ImgTMAddImage)

  Shapes.Move(TMIconAddImage, 204, 15)

  TMIconGear = Shapes.AddImage(ImgTMGear)

  Shapes.Move(TMIconGear, 242, 13)

  TMBtnNewFile = Controls.AddButton("", 6, 6)

  Controls.SetSize(TMBtnNewFile, 37, 33)

  Shapes.SetOpacity(TMBtnNewFile, 20)

  TMBtnOpenFile = Controls.AddButton("", 44, 6)

  Controls.SetSize(TMBtnOpenFile, 39, 33)

  Shapes.SetOpacity(TMBtnOpenFile, 20)

  TMBtnSaveFile = Controls.AddButton("", 81, 6)

  Controls.SetSize(TMBtnSaveFile, 39, 33)

  Shapes.SetOpacity(TMBtnSaveFile, 20)

  TMBtnFont = Controls.AddButton("", 120, 6)

  Controls.SetSize(TMBtnFont, 37, 33)

  Shapes.SetOpacity(TMBtnFont, 20)

  TMBtnSecondScreen = Controls.AddButton("", 158, 6)

  Controls.SetSize(TMBtnSecondScreen, 37, 33)

  Shapes.SetOpacity(TMBtnSecondScreen, 20)

  TMBtnAddImage = Controls.AddButton("", 196, 6)

  Controls.SetSize(TMBtnAddImage, 37, 33)

  Shapes.SetOpacity(TMBtnAddImage, 20)

  TMBtnSettings = Controls.AddButton("", 234, 6)

  Controls.SetSize(TMBtnSettings, 37, 33)

  Shapes.SetOpacity(TMBtnSettings, 20)

  TMBackRec2 = Shapes.AddRectangle(0, 35)

  Shapes.Move(TMBackRec2, 503, 5)

  Shapes.SetOpacity(TMBackRec2, 0)

  TMSeperator6 = Shapes.AddRectangle(39, 35)

  Shapes.Move(TMSeperator6, 503, 5)

  TMIconCopyPaste = Shapes.AddImage(ImgCopyPaste)

  Shapes.Move(TMIconCopyPaste, 512, 13)

  TMBtnCopyPaste = Controls.AddButton("", 504, 6)

  Controls.SetSize(TMBtnCopyPaste, 37, 33)

  Shapes.SetOpacity(TMBtnCopyPaste, 20)

EndSub



'HideTopMenu

Sub HideTopMenu

  Shapes.HideShape(TMBackRec)

  Shapes.HideShape(TMSeperator)

  Shapes.HideShape(TMSeperator2)

  Shapes.HideShape(TMSeperator3)

  Shapes.HideShape(TMSeperator4)

  Shapes.HideShape(TMSeperator5)

  Shapes.HideShape(TMSeperator6)

  Shapes.HideShape(TMSeperator7)

  Shapes.HideShape(TMSeperator8)

  Shapes.HideShape(TMIconNewFile)

  Shapes.HideShape(TMIconOpenFile)

  Shapes.HideShape(TMIconSaveFile)

  Shapes.HideShape(TMIconFontSize)

  Shapes.HideShape(TMIconSecondScreen)

  Shapes.HideShape(TMIconCopyPaste)

  Shapes.HideShape(TMIconAddImage)

  Shapes.HideShape(TMIconGear)

  Shapes.HideShape(TMBackRec2)

  Controls.HideControl(TMBtnNewFile)

  Controls.HideControl(TMBtnOpenFile)

  Controls.HideControl(TMBtnSaveFile)

  Controls.HideControl(TMBtnFont)

  Controls.HideControl(TMBtnSecondScreen)

  Controls.HideControl(TMBtnCopyPaste)

  Controls.HideControl(TMBtnAddImage)

  Controls.HideControl(TMBtnSettings)

EndSub



'ShowTopMenu

Sub ShowTopMenu

  Shapes.ShowShape(TMBackRec)

  Shapes.ShowShape(TMSeperator)

  Shapes.ShowShape(TMSeperator2)

  Shapes.ShowShape(TMSeperator3)

  Shapes.ShowShape(TMSeperator4)

  Shapes.ShowShape(TMSeperator5)

  Shapes.ShowShape(TMSeperator7)

  Shapes.ShowShape(TMSeperator8)

  Shapes.ShowShape(TMIconSaveFile)

  Shapes.ShowShape(TMIconFontSize)

  Shapes.ShowShape(TMIconNewFile)

  Shapes.ShowShape(TMIconOpenFile)

  Shapes.ShowShape(TMIconSecondScreen)

  Shapes.ShowShape(TMIconAddImage)

  Shapes.ShowShape(TMIconGear)

  Controls.ShowControl(TMBtnFont)

  Controls.ShowControl(TMBtnNewFile)

  Controls.ShowControl(TMBtnOpenFile)

  Controls.ShowControl(TMBtnSaveFile)

  Controls.ShowControl(TMBtnSecondScreen)

  Controls.ShowControl(TMBtnAddImage)

  Controls.ShowControl(TMBtnSettings)

  If SecondScreenAdded = "Yes" Then

    Controls.ShowControl(TMBtnCopyPaste)

    Shapes.ShowShape(TMBackRec2)

    Shapes.ShowShape(TMIconCopyPaste)

    Shapes.ShowShape(TMSeperator6)

  EndIf

EndSub



'AddNewFileDialog

Sub AddNewFileDialog

  GraphicsWindow.BrushColor = "Gainsboro"

  GraphicsWindow.PenColor = GrayControlShadow

  DMBackRec = Shapes.AddRectangle(190, 35)

  Shapes.Move(DMBackRec, 405, 155)

  GraphicsWindow.BrushColor = "Black"

  GraphicsWindow.FontSize = 13

  DMTitle = Shapes.AddText("")

  Shapes.Move(DMTitle, (GraphicsWindow.Width - 58) / 2, 164)

  GraphicsWindow.BrushColor = GrayControl

  DMBackRec2 = Shapes.AddRectangle(600, 200)

  Shapes.Move(DMBackRec2, (GraphicsWindow.Width - 600) / 2, 200)

  GraphicsWindow.BrushColor = "White"

  GraphicsWindow.PenColor = "White"

  DMBackColor = Shapes.AddRectangle(598, 98)

  Shapes.Move(DMBackColor, (GraphicsWindow.Width - 598) / 2, 201)

  GraphicsWindow.BrushColor = "Gainsboro"

  GraphicsWindow.PenColor = "Gainsboro"

  DMBackColor2 = Shapes.AddRectangle(598, 98)

  Shapes.Move(DMBackColor2, (GraphicsWindow.Width - 598) / 2, 301)

  GraphicsWindow.PenColor = "Black"

  GraphicsWindow.BrushColor = "Black"

  DMLabel = Shapes.AddText("Are you sure you wish to make a new file? All unsaved data will be lost.")

  Shapes.Move(DMLabel, (GraphicsWindow.Width - 400) / 2, 245)

  DMIconInfo = Shapes.AddImage(ImgDMInfoIcon)

  Shapes.Move(DMIconInfo, (GraphicsWindow.Width - 630) / 2, 190)

  Shapes.Zoom(DMIconInfo, 0.5, 0.5)

  DMBtnYes = Controls.AddButton("Yes", (GraphicsWindow.Width - 210) / 2, 335)

  Controls.SetSize(DMBtnYes, 100, 30)

  DMBtnNo = Controls.AddButton("No", GraphicsWindow.Width / 2, 335)

  Controls.SetSize(DMBtnNo, 100, 30)

EndSub



'ShowNewFileDialog

Sub ShowNewFileDialog

  Shapes.Move(DMTitle, (GraphicsWindow.Width - 58) / 2, 164)

  Shapes.Move(DMBackRec, 405, 155)

  Shapes.SetText(DMTitle, "New File")

  Shapes.SetText(DMLabel, "Are you sure you wish to make a new file? All unsaved data will be lost.")

  Controls.ShowControl(DMBtnNo)

  Controls.ShowControl(DMBtnYes)

  ShowBasicDM()

EndSub



'HideNewFileDialog

Sub HideNewFileDialog

  HideBasicDM()

  Controls.HideControl(DMBtnNo)

  Controls.HideControl(DMBtnYes)

EndSub



'ShowBasicDM

Sub ShowBasicDM

  Shapes.ShowShape(DMBackColor)

  Shapes.ShowShape(DMBackColor2)

  Shapes.ShowShape(DMBackRec)

  Shapes.ShowShape(DMBackRec2)

  Shapes.ShowShape(DMIconInfo)

  Shapes.ShowShape(DMLabel)

  Shapes.ShowShape(DMTitle)

EndSub



'HideBasicDM

Sub HideBasicDM

  Shapes.HideShape(DMBackColor)

  Shapes.HideShape(DMBackColor2)

  Shapes.HideShape(DMBackRec)

  Shapes.HideShape(DMBackRec2)

  Shapes.HideShape(DMIconInfo)

  Shapes.HideShape(DMLabel)

  Shapes.HideShape(DMTitle)

EndSub



'AddScreen

Sub AddScreen

  Controls.Remove(Screen)

  Controls.Remove(Screen2)

  GraphicsWindow.FontName = CurrentFontName

  GraphicsWindow.BrushColor = CurrentFontColor

  GraphicsWindow.FontBold = CurrentFontBold

  GraphicsWindow.FontItalic = CurrentFontItalic

  GraphicsWindow.FontSize = CurrentFontSize

  Screen = Controls.AddMultiLineTextBox(5, 45)

  If SecondScreenAdded = "No" Then

    Controls.SetSize(Screen, GraphicsWindow.Width - 10, GraphicsWindow.Height - 50)

  ElseIf SecondScreenAdded = "Yes" Then

    Controls.SetSize(Screen, 492.5, GraphicsWindow.Height - 50)

  EndIf

  Screen2 = Controls.AddMultiLineTextBox(502.5, 45)

  Controls.SetSize(Screen2, 492.5, GraphicsWindow.Height - 50)

  Controls.HideControl(Screen2)

  If SecondScreenAdded = "No" Then

    Shapes.SetOpacity(Screen2, 0)

  EndIf

EndSub



'HideScreen

Sub HideScreen

  Controls.HideControl(Screen)

  Controls.HideControl(Screen2)

EndSub



'AddOpenFileDialog

Sub AddOpenFileDialog

  OFTextBox = Controls.AddTextBox((GraphicsWindow.Width - 400) / 2, 320)

  Controls.SetSize(OFTextBox, 400, 23)

  OFBtnConfirm = Controls.AddButton("Open", (GraphicsWindow.Width - 210) / 2, 350)

  Controls.SetSize(OFBtnConfirm, 100, 30)

  OFBtnCancel = Controls.AddButton("Cancel", GraphicsWindow.Width / 2, 350)

  Controls.SetSize(OFBtnCancel, 100, 30)

EndSub



'ShowOpenFileDialog

Sub ShowOpenFileDialog

  Shapes.Move(DMTitle, (GraphicsWindow.Width - 65) / 2, 164)

  Shapes.Move(DMBackRec, 405, 155)

  Shapes.SetText(DMTitle, "Open File")

  Shapes.SetText(DMLabel, "Enter the path the name and the extension of the file you wish to open.")

  ShowBasicDM()

  Controls.ShowControl(OFTextBox)

  Controls.ShowControl(OFBtnConfirm)

  Controls.ShowControl(OFBtnCancel)

EndSub



'HideOpenFileDialog

Sub HideOpenFileDialog

  HideBasicDM()

  Controls.HideControl(OFTextBox)

  Controls.HideControl(OFBtnConfirm)

  Controls.HideControl(OFBtnCancel)

EndSub



'AddSaveFileDialog

Sub AddSaveFileDialog

  SFTextBox = Controls.AddTextBox((GraphicsWindow.Width - 400) / 2, 320)

  Controls.SetSize(SFTextBox, 400, 23)

  SFBtnConfirm = Controls.AddButton("Save", (GraphicsWindow.Width - 210) / 2, 350)

  Controls.SetSize(SFBtnConfirm, 100, 30)

  SFBtnCancel = Controls.AddButton("Cancel", GraphicsWindow.Width / 2, 350)

  Controls.SetSize(SFBtnCancel, 100, 30)

EndSub



'ShowSaveFileDialog

Sub ShowSaveFileDialog

  Shapes.Move(DMTitle, (GraphicsWindow.Width - 65) / 2, 164)

  Shapes.Move(DMBackRec, 405, 155)

  Shapes.SetText(DMTitle, "Save File")

  Shapes.SetText(DMLabel, "Enter the path the name and the extension of the file you wish to save.")

  ShowBasicDM()

  Controls.ShowControl(SFTextBox)

  Controls.ShowControl(SFBtnConfirm)

  Controls.ShowControl(SFBtnCancel)

EndSub



'HideSaveFileDialog

Sub HideSaveFileDialog

  HideBasicDM()

  Controls.HideControl(SFTextBox)

  Controls.HideControl(SFBtnConfirm)

  Controls.HideControl(SFBtnCancel)

EndSub



'AddFontDialog

Sub AddFontDialog

  GraphicsWindow.BrushColor = "Gainsboro"

  GraphicsWindow.PenColor = GrayControlShadow

  FDBackRec = Shapes.AddRectangle(400, 300)

  Shapes.Move(FDBackRec, 300, 150)

  GraphicsWindow.BrushColor = "Black"

  FDLabel = Shapes.AddText("Font name:")

  Shapes.Move(FDLabel, 340, 185)

  FDTBFontName = Controls.AddTextBox(430, 183)

  Controls.SetTextBoxText(FDTBFontName, "Microsoft Sans Serif")

  FDBtnFurtherFontNames = Controls.AddButton("Names", 600, 183)

  Controls.SetSize(FDBtnFurtherFontNames, 55, 23)

  FDLabel2 = Shapes.AddText("Font size:")

  Shapes.Move(FDLabel2, 340, 230)

  FDTBFontSize = Controls.AddTextBox(430, 227)

  Controls.SetTextBoxText(FDTBFontSize, 13)

  Controls.SetSize(FDTBFontSize, 37, 22)

  FDBtnIncrFS = Controls.AddButton("+", 472, 227)

  Controls.SetSize(FDBtnIncrFS, 22, 22)

  FDBtnDecrFS =  Controls.AddButton("-", 499, 227)

  Controls.SetSize(FDBtnDecrFS, 22, 22)

  FDLabel3 = Shapes.AddText("Font bold:")

  Shapes.Move(FDLabel3, 340, 275)

  FDBtnFontBold = Controls.AddButton("No", 430, 270)

  Controls.SetSize(FDBtnFontBold, 32, 27)

  FDLabel4 = Shapes.AddText("Font italic:")

  Shapes.Move(FDLabel4, 340, 320)

  FDBtnFontItalic = Controls.AddButton("No", 430, 315)

  Controls.SetSize(FDBtnFontItalic, 32, 27)

  FDTBFontColor = Controls.AddTextBox(430, 377)

  Controls.SetSize(FDTBFontColor, 80, 23)

  Controls.SetTextBoxText(FDTBFontColor, "Black")

  FDIconFont = Shapes.AddImage(ImgFontLogo)

  Shapes.Move(FDIconFont, 540, 220)

  FDLabel5 = Shapes.AddText("Font color:")

  Shapes.Move(FDLabel5, 340, 380)

  GraphicsWindow.BrushColor = "Red"

  FDBtnRed = Controls.AddButton("?– ", 520, 360)

  GraphicsWindow.BrushColor = "Green"

  FDBtnGreen = Controls.AddButton("?– ", 545, 360)

  GraphicsWindow.BrushColor = "Blue"

  FDBtnBlue = Controls.AddButton("?– ", 570, 360)

  GraphicsWindow.BrushColor = "Gold"

  FDBtnGold = Controls.AddButton("?– ", 595, 360)

  GraphicsWindow.BrushColor = "Magenta"

  FDBtnMagenta = Controls.AddButton("?– ", 620, 360)

  GraphicsWindow.BrushColor = "Pink"

  FDBtnPink = Controls.AddButton("?– ", 645, 360)

  GraphicsWindow.BrushColor = "Crimson"

  FDBtnCrimson = Controls.AddButton("?– ", 520, 389)

  GraphicsWindow.BrushColor = "Lime"

  FDBtnLime = Controls.AddButton("?– ", 545, 389)

  GraphicsWindow.BrushColor = "Cyan"

  FDBtnCyan = Controls.AddButton("?– ", 570, 389)

  GraphicsWindow.BrushColor = "Yellow"

  FDBtnYellow = Controls.AddButton("?– ", 595, 389)

  GraphicsWindow.BrushColor = "Indigo"

  FDBtnIndigo = Controls.AddButton("?– ", 620, 389)

  GraphicsWindow.BrushColor = "Black"

  FDBtnBlack = Controls.AddButton("?– ", 645, 389)

  GraphicsWindow.BrushColor = "GainsBoro"

  GraphicsWindow.PenColor = GrayControlShadow

  FDBackRec2 = Shapes.AddRectangle(200, 300)

  Shapes.Move(FDBackRec2, 720, 150)

  GraphicsWindow.BrushColor = "Black"

  FDBtnRestore = Controls.AddButton("Restore", 340, 460)

  Controls.SetSize(FDBtnRestore, 100, 30)

  FDBtnConfirm = Controls.AddButton("Confirm", 450, 460)

  Controls.SetSize(FDBtnConfirm, 100, 30)

  FDBtnCancel = Controls.AddButton("Cancel", 560, 460)

  Controls.SetSize(FDBtnCancel, 100, 30)

  GraphicsWindow.BrushColor = "Black"

  GraphicsWindow.FontName = "Times New Roman"

  FDTBName = Controls.AddTextBox(738, 168)

  GraphicsWindow.FontName = "Arial"

  FDTBName2 = Controls.AddTextBox(738, 198)

  GraphicsWindow.FontName = "Consolas"

  FDTBName3 = Controls.AddTextBox(738, 228)

  GraphicsWindow.FontName = "CASTELLAR"

  FDTBName4 = Controls.AddTextBox(738, 258)

  GraphicsWindow.FontName = "Curlz MT"

  FDTBName5 = Controls.AddTextBox(738, 288)

  GraphicsWindow.FontName = "Baskerville Old Face"

  FDTBName6 = Controls.AddTextBox(738, 318)

  GraphicsWindow.FontName = "Blackadder ITC"

  FDTBName7 = Controls.AddTextBox(738, 348)

  GraphicsWindow.FontName = "Ravie"

  FDTBName8 = Controls.AddTextBox(738, 378)

  GraphicsWindow.FontName = "Snap ITC"

  FDTBName9 = Controls.AddTextBox(738, 408)

  SetFDTBNames()

EndSub



'ShowFontDialog

Sub ShowFontDialog

  Shapes.Move(DMTitle, (GraphicsWindow.Width - 75) / 2, 114)

  Shapes.Move(DMBackRec, 405, 105)

  Shapes.SetText(DMTitle, "Font Dialog")

  Shapes.ShowShape(DMTitle)

  Shapes.ShowShape(DMBackRec)

  Shapes.ShowShape(FDBackRec)

  Shapes.ShowShape(FDLabel)

  Shapes.ShowShape(FDLabel2)

  Shapes.ShowShape(FDLabel3)

  Shapes.ShowShape(FDLabel4)

  Shapes.ShowShape(FDLabel5)

  Shapes.ShowShape(FDIconFont)

  Controls.ShowControl(FDBtnFontBold)

  Controls.ShowControl(FDBtnFontItalic)

  Controls.ShowControl(FDTBFontName)

  Controls.ShowControl(FDTBFontSize)

  Controls.ShowControl(FDBtnCancel)

  Controls.ShowControl(FDBtnConfirm)

  Controls.ShowControl(FDBtnFontBold)

  Controls.ShowControl(FDBtnFontItalic)

  Controls.ShowControl(FDTBFontName)

  Controls.ShowControl(FDTBFontSize)

  Controls.ShowControl(FDBtnCancel)

  Controls.ShowControl(FDBtnConfirm)

  Controls.ShowControl(FDTBFontColor)

  Controls.ShowControl(FDBtnBlack)

  Controls.ShowControl(FDBtnBlue)

  Controls.ShowControl(FDBtnRed)

  Controls.ShowControl(FDBtnMagenta)

  Controls.ShowControl(FDBtnGold)

  Controls.ShowControl(FDBtnGreen)

  Controls.ShowControl(FDBtnIndigo)

  Controls.ShowControl(FDBtnCyan)

  Controls.ShowControl(FDBtnLime)

  Controls.ShowControl(FDBtnPink)

  Controls.ShowControl(FDBtnYellow)

  Controls.ShowControl(FDTBFontColor)

  Controls.ShowControl(FDBtnCrimson)

  Controls.ShowControl(FDBtnDecrFS)

  Controls.ShowControl(FDBtnIncrFS)

  Controls.ShowControl(FDBtnFurtherFontNames)

  Controls.ShowControl(FDBtnRestore)

  If FurtherFontNamesHidden = "No" Then

    Controls.ShowControl(FDTBName)

    Controls.ShowControl(FDTBName2)

    Controls.ShowControl(FDTBName3)

    Controls.ShowControl(FDTBName4)

    Controls.ShowControl(FDTBName5)

    Controls.ShowControl(FDTBName6)

    Controls.ShowControl(FDTBName7)

    Controls.ShowControl(FDTBName8)

    Controls.ShowControl(FDTBName9)

    Controls.ShowControl(FDBackRec2)

  EndIf

EndSub



'HideFontDialog

Sub HideFontDialog

  Shapes.HideShape(DMTitle)

  Shapes.HideShape(DMBackRec)

  Shapes.HideShape(FDBackRec)

  Shapes.HideShape(FDLabel)

  Shapes.HideShape(FDLabel2)

  Shapes.HideShape(FDLabel3)

  Shapes.HideShape(FDLabel4)

  Shapes.HideShape(FDLabel5)

  Shapes.HideShape(FDIconFont)

  Controls.HideControl(FDBtnFurtherFontNames)

  Controls.HideControl(FDBtnFontBold)

  Controls.HideControl(FDBtnFontItalic)

  Controls.HideControl(FDTBFontName)

  Controls.HideControl(FDTBFontSize)

  Controls.HideControl(FDBtnCancel)

  Controls.HideControl(FDBtnConfirm)

  Controls.HideControl(FDTBFontColor)

  Controls.HideControl(FDBtnBlack)

  Controls.HideControl(FDBtnBlue)

  Controls.HideControl(FDBtnRed)

  Controls.HideControl(FDBtnMagenta)

  Controls.HideControl(FDBtnGold)

  Controls.HideControl(FDBtnGreen)

  Controls.HideControl(FDBtnIndigo)

  Controls.HideControl(FDBtnCyan)

  Controls.HideControl(FDBtnLime)

  Controls.HideControl(FDBtnPink)

  Controls.HideControl(FDBtnYellow)

  Controls.HideControl(FDBtnCrimson)

  Controls.HideControl(FDBtnRestore)

  Controls.HideControl(FDTBName)

  Controls.HideControl(FDTBName2)

  Controls.HideControl(FDTBName3)

  Controls.HideControl(FDTBName4)

  Controls.HideControl(FDTBName5)

  Controls.HideControl(FDTBName6)

  Controls.HideControl(FDTBName7)

  Controls.HideControl(FDTBName8)

  Controls.HideControl(FDTBName9)

  Controls.HideControl(FDBackRec2)

  Controls.HideControl(FDBtnDecrFS)

  Controls.HideControl(FDBtnIncrFS)

EndSub



'AddCopyPasteDialog

Sub AddCopyPasteDialog

  GraphicsWindow.FontName = "Microsoft Sans Serif"

  CPBtnLeft = Controls.AddButton("Left", 340, 335)

  Controls.SetSize(CPBtnLeft, 100, 30)

  CPBtnRight= Controls.AddButton("Right", 450, 335)

  Controls.SetSize(CPBtnRight, 100, 30)

  CPBtnCancel = Controls.AddButton("Cancel", 560, 335)

  Controls.SetSize(CPBtnCancel, 100, 30)

EndSub



'ShowCopyPasteDialog

Sub ShowCopyPasteDialog

  Shapes.Move(DMTitle, (GraphicsWindow.Width - 80) / 2, 164)

  Shapes.Move(DMBackRec, 405, 155)

  Shapes.SetText(DMTitle, "Copy Paste")

  Shapes.SetText(DMLabel, "Select where you want the text to be pasted.")

  ShowBasicDM()

  Controls.ShowControl(CPBtnLeft)

  Controls.ShowControl(CPBtnRight)

  Controls.ShowControl(CPBtnCancel)

EndSub



'HideCopyPasteDialog

Sub HideCopyPasteDialog

  HideBasicDM()

  Controls.HideControl(SFTextBox)

  Controls.HideControl(SFBtnConfirm)

  Controls.HideControl(SFBtnCancel)

  Controls.HideControl(CPBtnLeft)

  Controls.HideControl(CPBtnRight)

  Controls.HideControl(CPBtnCancel)

EndSub



'AddSettingsDialog

Sub AddSettingsDialog

  GraphicsWindow.BrushColor = GrayControl

  SDBackRec = Shapes.AddRectangle(500, 180)

  Shapes.Move(SDBackRec, 250, 175)

  SDSeperator2 = Shapes.AddRectangle(500, 120)

  Shapes.Move(SDSeperator2, 250, 175)

  SDSeperator = Shapes.AddRectangle(500, 60)

  Shapes.Move(SDSeperator, 250, 175)

  GraphicsWindow.BrushColor = "White"

  SDBackRadio = Shapes.AddEllipse(15, 15)

  Shapes.Move(SDBackRadio, 270, 197)

  SDBackRadio2 = Shapes.AddEllipse(15, 15)

  Shapes.Move(SDBackRadio2, 270, 257)

  SDBackRadio3 = Shapes.AddEllipse(15, 15)

  Shapes.Move(SDBackRadio3, 270, 317)

  GraphicsWindow.FontSize = 13

  GraphicsWindow.BrushColor = "Black"

  SDLabel = Shapes.AddText("Future changes will affect the first text field.")

  Shapes.Move(SDLabel, 295, 197)

  SDLabel2 = Shapes.AddText("Future changes will affect the second text field.")

  Shapes.Move(SDLabel2, 295, 257)

  SDLabel3 = Shapes.AddText("Future changes will affect both text fields.")

  Shapes.Move(SDLabel3, 295, 317)

  SDBtnConfirm = Controls.AddButton("Confirm", 395, 365)

  Controls.SetSize(SDBtnConfirm, 100, 30)

  SDBtnCancel = Controls.AddButton("Cancel", 505, 365)

  Controls.SetSize(SDBtnCancel, 100, 30)

  GraphicsWindow.PenColor = "Black"

  SDRadio = Shapes.AddEllipse(7, 7)

  Shapes.Move(SDRadio, 274, 201)

EndSub



'ShowSettingsDialog

Sub ShowSettingsDialog

  Shapes.Move(DMBackRec, 405, 120)

  Shapes.SetText(DMTitle, "Settings")

  Shapes.Move(DMTitle, 472, 131)

  Shapes.ShowShape(DMTitle)

  Shapes.ShowShape(DMBackRec)

  Shapes.ShowShape(SDBackRec)

  Shapes.ShowShape(SDBackRadio)

  Shapes.ShowShape(SDBackRadio2)

  Shapes.ShowShape(SDBackRadio3)

  Shapes.ShowShape(SDRadio)

  Shapes.ShowShape(SDLabel)

  Shapes.ShowShape(SDLabel2)

  Shapes.ShowShape(SDLabel3)

  Shapes.ShowShape(SDSeperator)

  Shapes.ShowShape(SDSeperator2)

  Controls.ShowControl(SDBtnCancel)

  Controls.ShowControl(SDBtnConfirm)

EndSub



'HideSettingsDialog

Sub HideSettingsDialog

  HideBasicDM()

  Shapes.HideShape(SDBackRec)

  Shapes.HideShape(SDLabel)

  Shapes.HideShape(SDLabel2)

  Shapes.HideShape(SDLabel3)

  Shapes.HideShape(SDBackRadio)

  Shapes.HideShape(SDBackRadio2)

  Shapes.HideShape(SDBackRadio3)

  Shapes.HideShape(SDSeperator)

  Shapes.HideShape(SDSeperator2)

  Shapes.HideShape(SDRadio)

  Controls.HideControl(SDBtnCancel)

  Controls.HideControl(SDBtnConfirm)

EndSub



'ApplyFontSettings

Sub ApplyFontSettings

  CurrentFontName = Controls.GetTextBoxText(FDTBFontName)

  CurrentFontSize = Controls.GetTextBoxText(FDTBFontSize)

  CurrentFontColor = Controls.GetTextBoxText(FDTBFontColor)

  CurrentFontBold = Controls.GetButtonCaption(FDBtnFontBold)

  CurrentFontItalic = Controls.GetButtonCaption(FDBtnFontItalic)

  GetScreenText = Controls.GetTextBoxText(Screen)

  GetScreen2Text = Controls.GetTextBoxText(Screen2)

  Controls.Remove(Screen)

  If CurrentFontBold = "Yes" Then

    CurrentFontBold = "True"

  Else

    CurrentFontBold = "False"

  EndIf

  If CurrentFontItalic = "Yes" Then

    CurrentFontItalic = "True"

  Else

    CurrentFontItalic = "False"

  EndIf

  GraphicsWindow.FontBold = CurrentFontBold

  GraphicsWindow.FontItalic = CurrentFontItalic

  GraphicsWindow.FontSize = CurrentFontSize

  GraphicsWindow.FontName = CurrentFontName

  GraphicsWindow.BrushColor = CurrentFontColor

EndSub



'CancelFontSettings

Sub CancelFontSettings

  Controls.SetTextBoxText(FDTBFontName, PrevFDFontName)

  Controls.SetTextBoxText(FDTBFontSize, PrevFDFontSize)

  Controls.SetTextBoxText(FDTBFontColor, PrevFDFontColor)

  If PrevFDFontBold = "No" Then

    Controls.SetButtonCaption(FDBtnFontBold, "No")

    CurrentFontBold = "False"

  ElseIf PrevFDFontBold = "Yes" Then

    Controls.SetButtonCaption(FDBtnFontBold, "Yes")

    CurrentFontBold = "True"

  EndIf

  If PrevFDFontItalic = "No" Then

    Controls.SetButtonCaption(FDBtnFontItalic, "No")

    CurrentFontItalic = "False"

  ElseIf PrevFDFontItalic = "Yes" Then

    Controls.SetButtonCaption(FDBtnFontItalic, "Yes")

    CurrentFontItalic = "True"

  EndIf

EndSub



'RestoreFontSettings

Sub RestoreFontSettings

  Controls.SetTextBoxText(FDTBFontName, "Microsoft Sans Serif")

  Controls.SetTextBoxText(FDTBFontSize, 13)

  Controls.SetButtonCaption(FDBtnFontBold, "No")

  Controls.SetButtonCaption(FDBtnFontItalic, "No")

  Controls.SetTextBoxText(FDTBFontColor, "Black")

  UserWantsFontSettingsRestored = "Yes"

EndSub



'HideAllMenus

Sub HideAllMenus

  CurrentMenu = ""

  HideTopMenu()

  HideScreen()

  HideNewFileDialog()

  HideOpenFileDialog()

  HideSaveFileDialog()

  HideFontDialog()

  HideCopyPasteDialog()

  HideSettingsDialog()

EndSub



'SetFDTBNames

Sub SetFDTBNames

  Controls.SetTextBoxText(FDTBName, "Times New Roman")

  Controls.SetTextBoxText(FDTBName2, "Arial")

  Controls.SetTextBoxText(FDTBName3, "Consolas")

  Controls.SetTextBoxText(FDTBName4, "CASTELLAR")

  Controls.SetTextBoxText(FDTBName5, "Curlz MT")

  Controls.SetTextBoxText(FDTBName6, "Baskerville Old Face")

  Controls.SetTextBoxText(FDTBName7, "Blackadder ITC")

  Controls.SetTextBoxText(FDTBName8, "Ravie")

  Controls.SetTextBoxText(FDTBName9, "Snap ITC")

EndSub



'GetPreviousSettings

Sub GetPreviousSettings

  PrevFDFontBold = Controls.GetButtonCaption(FDBtnFontBold)

  PrevFDFontItalic = Controls.GetButtonCaption(FDBtnFontItalic)

  PrevFDFontName = Controls.GetTextBoxText(FDTBFontName)

  PrevFDFontSize = Controls.GetTextBoxText(FDTBFontSize)

  PrevFDFontColor = Controls.GetTextBoxText(FDTBFontColor)

EndSub



'TextTyped

Controls.TextTyped = TextTyped

Sub TextTyped

  SetFDTBNames()

  If Controls.GetTextBoxText(FDTBFontSize) < 8 Then

    Controls.SetTextBoxText(FDTBFontSize, 8)  

  ElseIf Text.IsSubText(Controls.GetTextBoxText(FDTBFontName), 0) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontName), 1) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontName), 2) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontName), 3) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontName), 4) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontName), 5) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontName), 6) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontName), 7) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontName), 8) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontName), 9) Then

    Controls.SetTextBoxText(FDTBFontName, PrevFDFontName)

  ElseIf Text.IsSubText(Controls.GetTextBoxText(FDTBFontColor), 0) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontColor), 1) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontColor), 2) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontColor), 3) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontColor), 4) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontColor), 5) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontColor), 6) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontColor), 7) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontColor), 8) Or Text.IsSubText(Controls.GetTextBoxText(FDTBFontColor), 9) Then

    Controls.SetTextBoxText(FDTBFontColor, PrevFDFontColor)

  EndIf

EndSub



'MouseDown

GraphicsWindow.MouseDown = MouseDown

Sub MouseDown

  x = GraphicsWindow.MouseX

  y = GraphicsWindow.MouseY

  

  If CurrentMenu = "Settings" Then

    If x > 270 And x < 550 And y > 197 And y < 212 Then

      Sound.PlayClick()

      Shapes.Move(SDRadio, 274, 201)

    ElseIf x > 270 And x < 570 And y > 257 And y < 272 Then

      Sound.PlayClick()

      Shapes.Move(SDRadio, 274, 261)

    ElseIf x > 270 And x < 540 And y > 317 And y < 332 Then

      Sound.PlayClick()

      Shapes.Move(SDRadio, 274, 321)

    EndIf

  EndIf

EndSub



'ButtonClicked

Controls.ButtonClicked = ButtonClicked

Sub ButtonClicked

  If Controls.LastClickedButton = TMBtnNewFile Then

    Sound.PlayClick()

    HideTopMenu()

    HideScreen()

    ShowNewFileDialog()

  ElseIf Controls.LastClickedButton = TMBtnOpenFile Then

    Sound.PlayClick()

    HideTopMenu()

    HideScreen()

    ShowOpenFileDialog()

  ElseIf Controls.LastClickedButton = DMBtnYes Then

    Sound.PlayClick()

    HideNewFileDialog()

    ShowTopMenu()

    If ChangesAffect = "TF1" Then

      Controls.SetTextBoxText(Screen, "")

    ElseIf ChangesAffect = "TF2" Then

      Controls.SetTextBoxText(Screen2, "")

    ElseIf ChangesAffect = "Both" Then

      Controls.SetTextBoxText(Screen, "")

      Controls.SetTextBoxText(Screen2, "")

    EndIf

    Shapes.ShowShape(Screen)

    If SecondScreenAdded = "Yes" Then

      Shapes.ShowShape(Screen2)

    EndIf

  ElseIf Controls.LastClickedButton  = DMBtnNo Then

    Sound.PlayClick()

    HideNewFileDialog()

    ShowTopMenu()

    Shapes.ShowShape(Screen)

    If SecondScreenAdded = "Yes" Then

      Shapes.ShowShape(Screen2)

    EndIf

  ElseIf Controls.LastClickedButton = OFBtnCancel Then

    Sound.PlayClick()

    HideOpenFileDialog()

    ShowTopMenu()

    Shapes.ShowShape(Screen)

    If SecondScreenAdded = "Yes" Then

      Shapes.ShowShape(Screen2)

    EndIf

  ElseIf Controls.LastClickedButton = OFBtnConfirm Then

    Sound.PlayClick()

    GetOpenFilePath = Controls.GetTextBoxText(OFTextBox)

    If GetOpenFilePath = "" Then

      GraphicsWindow.ShowMessage("Please enter a path.", "Information")

      Sound.PlayClick()

    Else

' The following line could be harmful and has been automatically commented.

'       FileContents = File.ReadContents(GetOpenFilePath)

      If FileContents = "" Then

        GraphicsWindow.ShowMessage("There is no such file.", "Information")

        Sound.PlayClick()

      Else

        If ChangesAffect = "TF1" Then

          Controls.SetTextBoxText(Screen, FileContents)

        ElseIf ChangesAffect = "TF2" Then

          Controls.SetTextBoxText(Screen2, FileContents)

        ElseIf ChangesAffect = "Both" Then

          Controls.SetTextBoxText(Screen, FileContents)

          Controls.SetTextBoxText(Screen2, FileContents)

        EndIf

        HideOpenFileDialog()

        ShowTopMenu()

        Shapes.ShowShape(Screen)

        If SecondScreenAdded = "Yes" Then

          Shapes.ShowShape(Screen2)

        EndIf

      EndIf

    EndIf

  ElseIf Controls.LastClickedButton = TMBtnSaveFile Then

    Sound.PlayClick()

    HideTopMenu()

    HideScreen()

    ShowSaveFileDialog()

  ElseIf Controls.LastClickedButton = SFBtnCancel Then

    Sound.PlayClick()

    HideSaveFileDialog()

    ShowTopMenu()

    Controls.ShowControl(Screen)

    If SecondScreenAdded = "Yes" Then

      Shapes.ShowShape(Screen2)

    EndIf

  ElseIf Controls.LastClickedButton = SFBtnConfirm Then

    Sound.PlayClick()

    GetSaveFilePath = Controls.GetTextBoxText(SFTextBox)

    If GetSaveFilePath = "" Then

      GraphicsWindow.ShowMessage("Please enter a path.", "Information")

      Sound.PlayClick()

    Else

      GetScreenText = Controls.GetTextBoxText(Screen)

      GetScreen2Text = Controls.GetTextBoxText(Screen2)

      PathLength = Text.GetLength(GetSaveFilePath)

      FileExtention = Text.GetSubText(GetSaveFilePath, PathLength - 4, 5)

      If ChangesAffect = "TF1" Then

' The following line could be harmful and has been automatically commented.

'         File.WriteContents(GetSaveFilePath, GetScreenText)

      ElseIf ChangesAffect = "TF2" Then

' The following line could be harmful and has been automatically commented.

'         File.WriteContents(GetSaveFilePath, GetScreen2Text)

      ElseIf ChangesAffect = "Both" Then

' The following line could be harmful and has been automatically commented.

'         File.WriteContents(GetSaveFilePath, GetScreenText)

' The following line could be harmful and has been automatically commented.

'         File.WriteContents(GetSaveFilePath + "2" + FileExtention, GetScreen2Text)

      EndIf

      HideSaveFileDialog()

      ShowTopMenu()

      Shapes.ShowShape(Screen)

      If SecondScreenAdded = "Yes" Then

        Shapes.ShowShape(Screen2)

      EndIf

    EndIf

  ElseIf Controls.LastClickedButton = TMBtnFont Then

    Sound.PlayClick()

    GetPreviousSettings()

    HideTopMenu()

    HideScreen()

    ShowFontDialog()

  ElseIf Controls.LastClickedButton = FDBtnFontBold Then

    Sound.PlayClick()

    If Controls.GetButtonCaption(FDBtnFontBold) = "No" Then

      Controls.SetButtonCaption(FDBtnFontBold, "Yes")

      Controls.SetSize(FDBtnFontBold, 32, 27)

      CurrentFontBold = "True"

    ElseIf Controls.GetButtonCaption(FDBtnFontBold) = "Yes" Then

      Controls.SetButtonCaption(FDBtnFontBold, "No")

      Controls.SetSize(FDBtnFontBold, 32, 27)

      CurrentFontBold = "False"

    EndIf

  ElseIf Controls.LastClickedButton = FDBtnFontItalic Then

    Sound.PlayClick()

    If Controls.GetButtonCaption(FDBtnFontItalic) = "No" Then

      Controls.SetButtonCaption(FDBtnFontItalic, "Yes")

      Controls.SetSize(FDBtnFontItalic, 32, 27)

      CurrentFontItalic = "True"

    ElseIf Controls.GetButtonCaption(FDBtnFontItalic) = "Yes" Then

      Controls.SetButtonCaption(FDBtnFontItalic, "No")

      Controls.SetSize(FDBtnFontItalic, 32, 27)

      CurrentFontItalic = "False"

    EndIf

  ElseIf Controls.LastClickedButton = FDBtnCancel Then

    Sound.PlayClick()

    UserWantsFontSettingsRestored = "No"

    HideFontDialog()

    CancelFontSettings()

    ShowTopMenu()

    Shapes.ShowShape(Screen)

    If SecondScreenAdded = "Yes" Then

      Shapes.ShowShape(Screen2)

    EndIf

  ElseIf Controls.LastClickedButton = FDBtnConfirm Then

    Sound.PlayClick()

    GetFontName = Controls.GetTextBoxText(FDTBFontName)

    GetFontSize = Controls.GetTextBoxText(FDTBFontSize)

    GetFontColor = Controls.GetTextBoxText(FDTBFontColor)

    If GetFontName = "" Or GetFontSize = "" Or GetFontColor = "" Then

      GraphicsWindow.ShowMessage("Please fill all the text fields.", "Attention")

    Else

      If UserWantsFontSettingsRestored = "No" Then

        UserWantsFontSettingsRestored = "No"

        HideFontDialog()

        ApplyFontSettings()

        ShowTopMenu()

        AddScreen()

        If SecondScreenAdded = "Yes" Then

          Shapes.ShowShape(Screen2)

        EndIf

        Controls.SetTextBoxText(Screen, GetScreenText)

        Controls.SetTextBoxText(Screen2, GetScreen2Text)

      Else

        UserWantsFontSettingsRestored = "No"

        CurrentFontName = "Microsoft Sans Serif"

        CurrentFontSize = 11

        CurrentFontBold = "False"

        CurrentFontItalic = "False"

        CurrentFontColor = "Black"

        HideFontDialog()

        ApplyFontSettings()

        ShowTopMenu()

        AddScreen()

        Shapes.ShowShape(Screen2)

        Controls.SetTextBoxText(Screen, GetScreenText)

        Controls.SetTextBoxText(Screen2, GetScreen2Text)

      EndIf

    EndIf

  ElseIf Controls.LastClickedButton = FDBtnRed Then

    Sound.PlayClick()

    Controls.SetTextBoxText(FDTBFontColor, "Red")

    CurrentFontColor = "Red"

  ElseIf Controls.LastClickedButton = FDBtnGreen Then

    Sound.PlayClick()

    Controls.SetTextBoxText(FDTBFontColor, "Green")

    CurrentFontColor = "Green"

  ElseIf Controls.LastClickedButton = FDBtnBlue Then

    Sound.PlayClick()

    Controls.SetTextBoxText(FDTBFontColor, "Blue")

    CurrentFontColor = "Blue"

  ElseIf Controls.LastClickedButton = FDBtnGold Then

    Sound.PlayClick()

    Controls.SetTextBoxText(FDTBFontColor, "Gold")

    CurrentFontColor = "Gold"

  ElseIf Controls.LastClickedButton = FDBtnMagenta Then

    Sound.PlayClick()

    Controls.SetTextBoxText(FDTBFontColor, "Magenta")

    CurrentFontColor = "Magenta"

  ElseIf Controls.LastClickedButton = FDBtnPink Then

    Sound.PlayClick()

    Controls.SetTextBoxText(FDTBFontColor, "Pink")

    CurrentFontColor = "Pink"

  ElseIf Controls.LastClickedButton = FDBtnCrimson Then

    Sound.PlayClick()

    Controls.SetTextBoxText(FDTBFontColor, "Crimson")

    CurrentFontColor = "Crimson"

  ElseIf Controls.LastClickedButton = FDBtnLime Then

    Sound.PlayClick()

    Controls.SetTextBoxText(FDTBFontColor, "Lime")

    CurrentFontColor = "Lime"

  ElseIf Controls.LastClickedButton = FDBtnCyan Then

    Sound.PlayClick()

    Controls.SetTextBoxText(FDTBFontColor, "Cyan")

    CurrentFontColor = "Cyan"

  ElseIf Controls.LastClickedButton = FDBtnYellow Then

    Sound.PlayClick()

    Controls.SetTextBoxText(FDTBFontColor, "Yellow")

    CurrentFontColor = "Yellow"

  ElseIf Controls.LastClickedButton = FDBtnIndigo Then

    Sound.PlayClick()

    Controls.SetTextBoxText(FDTBFontColor, "Indigo")

    CurrentFontColor = "Indigo"

  ElseIf Controls.LastClickedButton = FDBtnBlack Then

    Sound.PlayClick()

    Controls.SetTextBoxText(FDTBFontColor, "Black")

    CurrentFontColor = "Black"

  ElseIf Controls.LastClickedButton = FDBtnRestore Then

    Sound.PlayClick()

    RestoreFontSettings()

  ElseIf Controls.LastClickedButton = FDBtnFurtherFontNames Then

    Sound.PlayClick()

    If Controls.GetButtonCaption(FDBtnFurtherFontNames) = "Names" Then

      FurtherFontNamesHidden = "No"

      Controls.SetButtonCaption(FDBtnFurtherFontNames, "Hide")

      Controls.ShowControl(FDTBName)

      Controls.ShowControl(FDTBName2)

      Controls.ShowControl(FDTBName3)

      Controls.ShowControl(FDTBName4)

      Controls.ShowControl(FDTBName5)

      Controls.ShowControl(FDTBName6)

      Controls.ShowControl(FDTBName7)

      Controls.ShowControl(FDTBName8)

      Controls.ShowControl(FDTBName9)

      Shapes.ShowShape(FDBackRec2)

    Else

      Controls.SetButtonCaption(FDBtnFurtherFontNames, "Names")

      FurtherFontNamesHidden = "Yes"

      Controls.HideControl(FDTBName)

      Controls.HideControl(FDTBName2)

      Controls.HideControl(FDTBName3)

      Controls.HideControl(FDTBName4)

      Controls.HideControl(FDTBName5)

      Controls.HideControl(FDTBName6)

      Controls.HideControl(FDTBName7)

      Controls.HideControl(FDTBName8)

      Controls.HideControl(FDTBName9)

      Shapes.HideShape(FDBackRec2)

    EndIf

  ElseIf Controls.LastClickedButton = TMBtnSecondScreen Then

    Sound.PlayClick()

    If ImageAdded = "Yes" Then

      GraphicsWindow.ShowMessage("You can not add a second text field while using an image.", "Information")

      Sound.PlayClick()

    Else

      Controls.HideControl(TMBtnSecondScreen)

      Controls.HideControl(TMBtnNewFile)

      Controls.HideControl(TMBtnOpenFile)

      Controls.HideControl(TMBtnSaveFile)

      Controls.HideControl(TMBtnFont)

      Controls.HideControl(TMBtnAddImage)

      Controls.HideControl(TMBtnSettings)

      If SecondScreenAdded = "No" Then

        PrevText = Controls.GetTextBoxText(Screen)

        PrevTxt = Controls.GetTextBoxText(Screen2)

        Controls.SetTextBoxText(Screen, "")

        Controls.SetTextBoxText(Screen2, "")

        For Decrease = 980 To 492.5 Step -0.8

          Controls.SetSize(TMBackRec, Decrease, 35)

          Controls.SetSize(Screen, Decrease, GraphicsWindow.Height - 50)

        EndFor

        Shapes.ShowShape(Screen2)

        Shapes.ShowShape(TMBackRec2)

        For Times = 0 To 492 Step 0.8

          Controls.SetSize(TMBackRec2, Times, 35)

          Shapes.SetOpacity(TMBackRec2, Times / 3)

          Controls.SetSize(Screen2, Times, GraphicsWindow.Height - 50)

          Shapes.SetOpacity(Screen2, (Times) / 3)

        EndFor

        Controls.SetTextBoxText(Screen, PrevText)

        Controls.SetTextBoxText(Screen2, PrevTxt)

        Controls.ShowControl(TMBtnSecondScreen)

        SecondScreenAdded = "Yes"

        ShowTopMenu()

      Else

        PrevText1 = Controls.GetTextBoxText(Screen)

        PrevText2 = Controls.GetTextBoxText(Screen2)

        Controls.SetTextBoxText(Screen, "")

        Controls.SetTextBoxText(Screen2, "")

        Shapes.HideShape(TMIconCopyPaste)

        Shapes.HideShape(TMSeperator6)

        Controls.HideControl(TMBtnCopyPaste)

        For Fade = 100 To 0 Step -0.08

          Shapes.SetOpacity(Screen2, Fade)

          Shapes.SetOpacity(TMBackRec2, Fade)

        EndFor

        Controls.HideControl(Screen2)

        For Increase = 492 To 990 Step 0.8

          Controls.SetSize(TMBackRec, Increase, 35)

          Controls.SetSize(Screen, Increase, GraphicsWindow.Height - 50)

        EndFor

        Controls.SetTextBoxText(Screen, PrevText1)

        Controls.SetTextBoxText(Screen2, PrevText2)

        Controls.ShowControl(TMBtnSecondScreen)

        Controls.ShowControl(TMBtnNewFile)

        Controls.ShowControl(TMBtnOpenFile)

        Controls.ShowControl(TMBtnSaveFile)

        Controls.ShowControl(TMBtnFont)

        Controls.ShowControl(TMBtnAddImage)

        Controls.ShowControl(TMBtnSettings)

        SecondScreenAdded = "No"

      EndIf

    EndIf

  ElseIf Controls.LastClickedButton = FDBtnIncrFS Then

    Sound.PlayClick()

    PrevFontSize = Controls.GetTextBoxText(FDTBFontSize)

    Controls.SetTextBoxText(FDTBFontSize, PrevFontSize + 1)

  ElseIf Controls.LastClickedButton = FDBtnDecrFS Then

    Sound.PlayClick()

    PrevFontSize = Controls.GetTextBoxText(FDTBFontSize)

    Controls.SetTextBoxText(FDTBFontSize, PrevFontSize - 1)

  ElseIf Controls.LastClickedButton = TMBtnCopyPaste Then

    Sound.PlayClick()

    HideAllMenus()

    ShowCopyPasteDialog()

  ElseIf Controls.LastClickedButton = CPBtnCancel Then

    Sound.PlayClick()

    HideAllMenus()

    ShowTopMenu()

    Shapes.ShowShape(Screen)

    Shapes.ShowShape(Screen2)

  ElseIf Controls.LastClickedButton = CPBtnRight Then

    Sound.PlayClick()

    HideAllMenus()

    ShowTopMenu()

    Shapes.ShowShape(Screen)

    Shapes.ShowShape(Screen2)

    If Controls.GetTextBoxText(Screen) = "" Then

      GraphicsWindow.ShowMessage("The first text field is empty.", "Information")

      Sound.PlayClick()

    Else

      Controls.SetTextBoxText(Screen2, Controls.GetTextBoxText(Screen))

    EndIf

  ElseIf Controls.LastClickedButton = CPBtnLeft Then

    Sound.PlayClick()

    HideAllMenus()

    ShowTopMenu()

    Shapes.ShowShape(Screen)

    Shapes.ShowShape(Screen2)

    If Controls.GetTextBoxText(Screen2) = "" Then

      GraphicsWindow.ShowMessage("The second text field is empty.", "Information")

      Sound.PlayClick()

    Else

      Controls.SetTextBoxText(Screen, Controls.GetTextBoxText(Screen2))

    EndIf

  ElseIf Controls.LastClickedButton = TMBtnAddImage Then

    Sound.PlayClick()

    If SecondScreenAdded = "Yes" Then

      GraphicsWindow.ShowMessage("You can not add an image while using a second text field.", "Information")

      Sound.PlayClick()

    Else

      If ImageAdded = "No" Then

        ImageAdded = "Yes"

      ElseIf ImageAdded = "Yes" Then

        ImageAdded = "No"

      EndIf

    EndIf

  ElseIf Controls.LastClickedButton = TMBtnSettings Then

    Sound.PlayClick()

    HideAllMenus()

    ShowSettingsDialog()

    PreviousTop = Shapes.GetTop(SDRadio)

    CurrentMenu = "Settings"

  ElseIf Controls.LastClickedButton = SDBtnCancel Then

    Sound.PlayClick()

    HideAllMenus()

    Shapes.Move(SDRadio, 274, PreviousTop)

    ShowTopMenu()

    Shapes.ShowShape(Screen)

    If SecondScreenAdded = "Yes" Then

      Shapes.ShowShape(Screen2)

    EndIf

  ElseIf Controls.LastClickedButton = SDBtnConfirm Then

    Sound.PlayClick()

    HideAllMenus()

    If Shapes.GetTop(SDRadio) = 201 Then

      ChangesAffect = "TF1"

    ElseIf Shapes.GetTop(SDRadio) = 261 Then

      ChangesAffect = "TF2"

    ElseIf Shapes.GetTop(SDRadio) = 321 Then

      ChangesAffect = "Both"

    EndIf

    ShowTopMenu()

    Shapes.ShowShape(Screen)

    If SecondScreenAdded = "Yes" Then

      Shapes.ShowShape(Screen2)

    EndIf

  EndIf

EndSub


