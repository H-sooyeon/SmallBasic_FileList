GraphicsWindow.BackgroundColor="darkblue

tt=LDControls.AddRichTextBox(600 800)

GraphicsWindow.Height=850

GraphicsWindow.Width=1200

GraphicsWindow.Title="SimpleBasic

LDShapes.BrushColour(tt "transparent")

LDControls.RichTextBoxFontFamily="Lucida Console

LDControls.RichTextBoxFontSize=14

LDControls.RichTextBoxFontForeground="cyan

LDControls.RichTextBoxFontBackground="#007799

LDControls.RichTextBoxDefault(tt)

LDControls.RichTextBoxTextTyped=rttx

dnbtt="<none>"

chrs="~#~.#.#.#~.@@@#~.#;@@.#~.@@#.#~.@@#.;.@@#~~#~~#~~.@@;@#~#~#.#~.@~#.@#~;@@@~~@#~#~~@@#;@@@~~@#~#~~#~~;.@@#~~#~@#~.#.@@;#~.@~.@@@#~.@~.#;~#~~#~~#~~#~~#~;~~#~~#~~@~.#.@#.;#~#.#.#~@#~#~#.#~.#;#~~#~~#~~#~~@@#;#~.@#.@#.#.@~.@~.#;#~.@#~@.#.@~@#~.#;.@#.#~.@~.@~.#.@#.;@@.#~.@@#.#~~#~~;.@#.#~.@~.@~#~@.#;@@.#~.@@#.#~#.#~.#;.@@#~~.@#~~.@@#.;@@#~#~~#~~#~~#~;#~.@~.@~.@~.#.@#.;#~.@~.@~.#.#.#~.#~;#~.@~.@.#.@#.@#~.#;#~.#.#.#~.#~.#.#.#~.#;#~.#.#.#~.#~~#~~#~;@@#~.#~.#~.#~.@@#;~#~.@~#.#~~#~.@#.;.@#.#~.#~.#~#~.@@#;.@#.#~.#~.#.#~.#.@#.;~#~.#~.#~#.@@#~.#.;@@@~~@@~~.@@#.;.@@#~~@@.#~.#.@#.;@@#~~#~.#~.#~~#~;.@#.#~.#.@#.#~.#.@#.;.@#.#~.#.@@~~@@#.

chrs=LDText.Replace(chrs "@" "##")

chrs=LDText.Replace(chrs "~" "..")

chm=LDText.Split(chrs ";")



Controls.AddButton ("  Run >>>  " 5 5)

cmp=Controls.AddButton (" >>Cmpct<< " 95 5)

bsv=Controls.AddButton ("[   Save   ]" 195 5)

bld=Controls.AddButton ("[   Load   ]" 295 5)

bcl=Controls.AddButton ("[   Clear  ]" 395 5)

nln=Text.GetCharacter(13)+Text.GetCharacter(10)

dd=LDText.Replace("get a supply_a_value;loop 5;get b supply_b_value;set c %a+%b;? result:_%a+%b=%c;eloop" ";" nln)

dd=LDText.Replace("clr  ;set  h 0;for  0 120 15;set  a 0;set  x 0;set  h %h+15;lpp  500;set  y Math.Sin(%a)*70;set  a %a+.02;hsb  %h 1 .5;ell  %x %y+155+%1 5 5 %ccc;set  x %x+1;elp  ;nxt  ;dly  3333" ";" nln)

LDControls.RichTextBoxSetText(tt dd "false")

Shapes.Move(tt 5 35)

rtbcc()

Controls.ButtonClicked=bbb



Sub rttx

  If text.StartsWith( GraphicsWindow.Title "*") Then

  Else

    GraphicsWindow.Title="*** "+GraphicsWindow.Title

  EndIf

EndSub



While "true

  If run Then

    mm=""

    Shapes.SetOpacity(tt 15)

    tx=ldtext.split(LDControls.RichTextBoxGetText(tt) nln)

    xx=1 

    For x=1 To Array.GetItemCount(tx)

      tx[x]= LDText.Trim(tx[x])

      If Text.StartsWith(tx[x] "`") Then

        lbm[Text.GetSubTextToEnd(tx[x] 2)]=x+1

      EndIf

    EndFor

    ' TextWindow.WriteLine(lbm)

    While xx<=Array.GetItemCount(tx)

      ll=LDText.Split(ldtext.Replace(ldtext.Replace(tx[xx] " " "~") "_" " ") "~")

      lc=Text.ConvertToLowerCase(ll[1])

      ii=Array.GetAllIndices(mm)

      'TextWindow.WriteLine(ii)

      For q=2 To Array.GetItemCount(ll)

        

        For m=1 To Array.GetItemCount(mm)

          ll[q]=LDText.Replace(ll[q] "%"+ii[m] mm[ii[m]])

        EndFor

        For m=1 To Array.GetItemCount(lp)

          ll[q]=LDText.Replace(ll[q] "%"+m lps[m])

        EndFor

        ll[q]=LDText.Replace(ll[q] "%ccc" clr) 

        

      EndFor

      ' TextWindow.WriteLine(ll)

      If lc="get" or lc="inp" or lc="<<<" Then

        mm[ll[2]]= FCDialogs.AskForTextLine(ll[3])

        

      ElseIf lc="for" or lc="{::" Then

        lw=lw+1

        lp[lw]=xx+1

        lpc[lw]=Math.Floor((ll[3]-ll[2])/ll[4])

        lps[lw]=ll[2]

        lpi[lw]=ll[4]

        

      ElseIf lc="jmp" or lc=">+>" Then

        xx=xx+ll[2]

        Goto nxt

        

      ElseIf lc="iff" or lc="whn" Then

        If LDMath.Evaluate3(ll[2]) Then

        Else

          xx=xx+ll[3]

          Goto nxt

        EndIf

        

      ElseIf lc="jtl" or lc=">>:" Then

        xx=ll[2]

        Goto nxt

        

      ElseIf lc="btn" Then

        mm[ll[2]]=Controls.AddButton(ll[3] ll[4] ll[5])

        gtt[ll[2]]=ll[6]

        

      ElseIf lc="rct" or lc="rect" Then

        GraphicsWindow.BrushColor=ll[6]

        GraphicsWindow.FillRectangle(ldmath.Evaluate(ll[2]+"+0") ldmath.Evaluate("0+"+ll[3])  ldmath.Evaluate("0+"+ll[4])  ldmath.Evaluate("0+"+ll[5]))

        

      ElseIf lc="ell" or lc="elip" Then

        GraphicsWindow.BrushColor=ll[6]

        GraphicsWindow.FillEllipse(ldmath.Evaluate(ll[2]+"+0") ldmath.Evaluate("0+"+ll[3])  ldmath.Evaluate("0+"+ll[4])  ldmath.Evaluate("0+"+ll[5]))

        

      ElseIf lc="jlb" or lc=">>>" Then

        xx=lbm[ll[2]]

        Goto nxt

        

      ElseIf lc="lps" Then

        fff=1

        

        For fy=0 To 4

          For fx=0 To 4

            lm[fff]=Shapes.AddRectangle(9 27)

            Shapes.Move(lm[fff] ll[2]+fx*33 ll[3]+fy*33)

            LDShapes.PenWidth(lm[fff] 0)

            If Text.GetSubText(ll[4] fff 1)="#" Then

              LDShapes.BrushColour(lm[fff] "orange")

            Else

              LDShapes.BrushColour(lm[fff] "darkred")

            EndIf

            fff=fff+1

          EndFor

        EndFor

        

        

        

          ElseIf lc="lp@" Then

        For qq=1 To 25

          cc=LDShapes.GetColour(lm[qq])

          if (cc[1])="#FF8B0000" Then

            LDShapes.BrushColour(lm[qq] "orange")

          Else

            LDShapes.BrushColour(lm[qq] "darkred")

            EndIf

            

          EndFor

        

      ElseIf lc="lp#" Then

        For qq=1 To 25

          Shapes.Remove(lm[qq])

        EndFor

        

      ElseIf lc="lp$" Then

        For fff=1 To 25

          If Text.GetSubText(ll[2] fff 1)="#" Then

            LDShapes.BrushColour(lm[fff] "orange")

          Else

            LDShapes.BrushColour(lm[fff] "darkred")

          EndIf

        EndFor

        

       ElseIf lc="lp&" Then

        For fff=1 To 25

          If Text.GetSubText(chm[ll[2]] fff 1)="#" Then

            LDShapes.BrushColour(lm[fff] "orange")

          Else

            LDShapes.BrushColour(lm[fff] "darkred")

          EndIf

        EndFor

        

      ElseIf lc="tsp" Then

        Turtle.Speed=ll[2]

        GraphicsWindow.PenWidth=ldmath.Evaluate(ll[3]+"+0")

        GraphicsWindow.PenColor=ll[4]

        

      ElseIf lc="trt" Then

        Turtle.Turn(ldmath.Evaluate(ll[2]+"+0"))

        Turtle.Move(ldmath.Evaluate(ll[3]+"+0"))

        

      ElseIf lc="trm" Then

        Turtle.MoveTo(ldmath.Evaluate(ll[2]+"+0") ldmath.Evaluate(ll[3]+"+0"))

        

      ElseIf lc="tru" Then

        Turtle.PenUp()

        

      ElseIf lc="trd" Then

        Turtle.PenDown()

        

      ElseIf lc="trr" Then

        LDShapes.RasteriseTurtleLines()

        LDShapes.RemoveTurtleLines()

        Turtle.Hide()

        Turtle.Angle=0

        

      ElseIf lc="trp" Then

        Turtle.x=ldmath.Evaluate(ll[2]+"+0")

        Turtle.y=ldmath.Evaluate(ll[3]+"+0")

        

      ElseIf lc="hsb" Then

        clr= LDColours.HSLtoRGB(ldmath.Evaluate(ll[2]+"+0") ldmath.Evaluate(ll[3]+"+0") ldmath.Evaluate(ll[4]+"+0"))

        

      ElseIf lc="loop" or lc="lpp" or lc="{" Then

        lw=lw+1

        lp[lw]=xx+1

        lpc[lw]=ll[2]-1

        lps[lw]=0

        

      ElseIf lc="clr" Then

        GraphicsWindow.BrushColor="darkblue"

        GraphicsWindow.FillRectangle(0 0 GraphicsWindow.Width GraphicsWindow.Height)

        

      ElseIf lc="dly" or lc="pause" Then

        Program.Delay(ll[2])

        

      ElseIf lc="efor" or lc="efr" or lc="}/}" or lc="nxt" Then

        If lpc[lw]>0 Then

          lpc[lw]=lpc[lw]-1

          xx=lp[lw]

          lps[lw]=lps[lw]+lpi[lw]

          Goto nxt

        Else

          lw=lw-1

        EndIf

        

      ElseIf lc="eloop" or lc="elp" or lc="}" Then

        If lpc[lw]>0 Then

          lpc[lw]=lpc[lw]-1

          xx=lp[lw]

          lps[lw]=lps[lw]+1

          Goto nxt

        Else

          lw=lw-1

        EndIf

        

      ElseIf lc="inc" or lc="add"  or lc="+++" Then 

        vv=LDMath.Evaluate(ll[3]+"0")

        If ll[3]="" Then

          vv=1

        EndIf

        

        mm[ll[2]]= mm[ll[2]]+vv

        

        

      ElseIf lc="dec" or lc="sbs"  or lc="---" Then 

        vv=LDMath.Evaluate(ll[3]+"0")

        If ll[3]="" Then

          vv=1

        EndIf

        mm[ll[2]]= mm[ll[2]]-vv

        

      ElseIf lc="flc" Then

        pc=imagelist.LoadImage( Flickr.GetRandomPicture(ll[2]))

        GraphicsWindow.DrawResizedImage(pc ll[3] ll[4] ll[5] ll[6])

        

      ElseIf lc="mul" or lc="fct"  or lc="***" Then 

        vv=LDMath.Evaluate(ll[3]+"0")

        If ll[3]="" Then

          vv=mm[ll[2]]

        EndIf

        

        mm[ll[2]]= mm[ll[2]]*vv

        

      ElseIf lc="div" or lc="///" Then 

        vv=LDMath.Evaluate(ll[3]+"0")

        If ll[3]="" Then

          mm[ll[2]]=Math.SquareRoot(mm[ll[2]])

        Else

          mm[ll[2]]= mm[ll[2]]/vv

        EndIf

        

        

      ElseIf lc="set" or lc="let" or lc=":::" Then

        mm[ll[2]]=LDMath.Evaluate(ll[3])

        ' TextWindow.WriteLine( mm[ll[2]])

        

      ElseIf lc="?" or lc="???" or lc="msg" Then

        GraphicsWindow.ShowMessage(ll[2] "Info")

      EndIf

      If dnbtt="<none>" Then

        xx=xx+1

      Else

        xx=gtt[dnbtt]

      EndIf

      

      nxt:

    EndWhile

    

    Shapes.SetOpacity(tt 95)

    run="false

  EndIf

  

EndWhile



Sub bbb

  lbb=Controls.LastClickedButton

  If lbb=cmp Then

    rtbcc()

    

  ElseIf lbb=bld Then

    ff=LDDialogs.OpenFile("rtf" "e:\")

    LDControls.RichTextBoxLoad(tt ff "false")

    GraphicsWindow.Title=ff

    

  ElseIf lbb=bcl Then

    LDControls.RichTextBoxClear(tt)

    

  ElseIf lbb=bsv Then

    If ss="" Then

      ss=LDDialogs.SaveFile("rtf" "e:\")

    EndIf

    LDControls.RichTextBoxSave(tt ss)

    GraphicsWindow.Title=ss

    

  ElseIf run Then

    dnbtt="<none>"

    in=Array.GetAllIndices(mm)

    For w=1 To Array.GetItemCount(mm)

      If lbb=mm[in[w]] Then

        dnbtt=lbb

        'TextWindow.WriteLine(dnbtt)

      EndIf

    EndFor

    

  Else

    run="true

  EndIf

EndSub





Sub rtbcc

  tx=ldtext.split(LDControls.RichTextBoxGetText(tt) nln)

  

  For x=1 To Array.GetItemCount(tx)

    tx[x]= LDText.Trim(tx[x])

    ln=LDText.Split(tx[x] " ")

    q1=ln[1]

    If q1="loop" or q1="lpp"Then

      ln[1]="lpp

      ln[2]=ln[2]+" ?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïó

      ln[3]=" "

      

    ElseIf q1="eloop" or q1="elp" Then

      ln[1]="elp ?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïê?ïù

      ln[2]=" "

      

      ElseIf q1="?" Then

      ln[1]="?  "

    EndIf

    agg=""

    For r=2 To Array.GetItemCount(ln)

      agg=Text.Append(agg ln[r]+" ")

    EndFor

    tx[x]=ln[1]+"@"+ldtext.trim(agg)

  EndFor

  agg=""

  LDControls.RichTextBoxClear(tt)

  tx1="{\rtf1\ansi\ansicpg1252\deff0\nouicompat\deflang1033{\fonttbl{\f0\fnil\fcharset0 Lucida console;}{\f1\fnil\fcharset0 Calibri;}}

  tx1=tx1+"{\colortbl ;\red255\green85\blue0;\red0\green128\blue128;\red255\green170\blue0;\red255\green255\blue0;\red170\green255\blue0;\red85\green255\blue0;\red0\green255\blue0;\red0\green255\blue85;\red0\green255\blue170;\red0\green255\blue255;\red0\green170\blue255;\red0\green85\blue255;\red0\green0\blue255;\red0\green0\blue0;}

  tx1=tx1+"{\*\generator Riched20 6.3.9600}\viewkind4\uc1"

  tx1=tx1+"\pard\cf1\highlight2\f0 

  For r=1 To Array.GetItemCount(tx)

    ty=LDText.Split(tx[r] "@")

    tx1=tx1+"\cf3\fs22 "+ty[1]+"  "

    tx1=tx1+"\cf5\fs24 "+ty[2]+"\par \pard

  EndFor

  tx1=tx1+"\par}"

' The following line could be harmful and has been automatically commented.

'   File.WriteContents(Program.Directory+"\tx.rtf" tx1)

  LDControls.RichTextBoxLoad (tt Program.Directory+"\tx.rtf" "false")

EndSub


