GraphicsWindow.Show()

GraphicsWindow.Title =("Star Trek")  

GraphicsWindow.Width = 600

GraphicsWindow.Height = 420

GraphicsWindow.CanResize = "No"

DeepSpaceNineBG =ImageList.LoadImage(Program.Directory +"\Background.jpg")

TScreen = ImageList.LoadImage (Program.Directory +"\Title Screen.jpg")

GraphicsWindow.BackgroundColor = "Black"

TitleScreen()

Sub TitleScreen

  

  GraphicsWindow.Clear ()

  GraphicsWindow.DrawResizedImage   (TScreen, 0,0, 610, 410,)

  GraphicsWindow.BrushColor = "Black"

StartNormal =  Controls.AddButton ("Impulse Mode", 220, 180)

StartSpeedy = Controls.Addbutton  ("Warp Mode" 320, 180)

Instructions = Controls.AddButton ("              Instructions            ", 220, 210) 

Controls.ButtonClicked = Select



  Endsub 



Sub InstructionScreen 

  GraphicsWindow.Clear ()

  Instructions = ImageList.LoadImage(Program.Directory +"\Instructions.jpg")

  GraphicsWindow.DrawResizedImage   (Instructions, 0,0, 610, 410,)

  GraphicsWindow.DrawRectangle (0, 418,610, 10) 

  Back = Controls.AddButton ("Back", 295, 360)



  EndSub 

   

   Sub Select

     

     Button = Controls.LastClickedButton

If Button = StartNormal Then 

  Speed = 100

  Start()

ElseIf Button = StartSpeedy Then 

  Speed = 10

  Start() 

Elseif Button = Instructions Then 

  InstructionScreen()

  ElseIf Button = Back  Then 

    TitleScreen ()

  Elseif Button = Reset Then 

 

     

    TitleScreen ()

   

  EndIf 

EndSub 





Sub Start

  

  GraphicsWindow.Clear()



GraphicsWindow.DrawResizedImage   (DeepSpaceNineBG, 0,0, 610, 410,)

Wormhole = Shapes.AddImage  (Program.Directory+ "\Wormhole1.GIF")

Shapes.Move (Wormhole, -100,-100) 





Angle = 315

DefiantY = 350

DefiantX = 525

Shields = 100

Score = 0



BigRock = Shapes.AddImage  (Program.Directory+"\Asteroids_BigRock1.png")

MedRock = Shapes.AddImage  (Program.Directory + "\Asteroids_MediumRock.png")

SmlRock = Shapes.AddImage  (Program.Directory +"\Asteroids_SmallRock.png")

Big1Rock = Shapes.AddImage  (Program.Directory+"\Asteroids_BigRock1.png")

Med1Rock = Shapes.AddImage  (Program.Directory + "\Asteroids_MediumRock.png")

Sml1Rock = Shapes.AddImage  (Program.Directory +"\Asteroids_SmallRock.png")

Big2Rock = Shapes.AddImage  (Program.Directory+"\Asteroids_BigRock1.png")

Med2Rock = Shapes.AddImage  (Program.Directory + "\Asteroids_MediumRock.png")

Sml2Rock = Shapes.AddImage  (Program.Directory +"\Asteroids_SmallRock.png")

Big3Rock = Shapes.AddImage  (Program.Directory+"\Asteroids_BigRock1.png")

Med3Rock = Shapes.AddImage  (Program.Directory + "\Asteroids_MediumRock.png")

Sml3Rock = Shapes.AddImage  (Program.Directory +"\Asteroids_SmallRock.png")

Bullet =  Shapes.AddImage (Program.Directory + "\Bullet1.gif")

Defiant = Shapes.AddImage (Program.Directory + "\defiant.png")



Shapes.Move(Defiant, DefiantX , DefiantY)'525, 350)



GraphicsWindow.KeyDown = MoveDefiant1



    Timer.Interval = Speed 

Timer.Tick = MoveDefiant2



BigRockSub ()

MedRockSub ()

SmlRockSub ()

Big1RockSub ()

Med1RockSub()

Sml1RockSub()

Big2RockSub ()

Med2RockSub()

Sml2RockSub()

Big3RockSub ()

Med3RockSub()

Sml3RockSub()

EndSub 



Sub MoveDefiant1

  

'  If GraphicsWindow.LastKey = "Up" Then 

'    Speed = Speed -10

'  ElseIf  GraphicsWindow.LastKey = "Down" Then 

'    Speed = Speed +10 

'    EndIf 

  If GraphicsWindow.LastKey = "Right" Then

    Angle = Angle + 45

   Shapes.Rotate(Defiant, Angle)

  elseif GraphicsWindow.LastKey = "Left" Then

    Angle = Angle - 45

    Shapes.Rotate(Defiant, Angle)

  Elseif GraphicsWindow.LastKey = "Space" Then 

    DrawBullet()

EndIf 

    If Angle >= 360 Then 

     Angle = 0

 ElseIf Angle < 0 Then 

    Angle = 315

  EndIf 





EndSub





   Sub MoveDefiant2

     

     If DefiantY = 0 Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then

         Angle = 135  

       elseIf Angle = 315 Then

         Angle = 225         

        EndIf 

      

     

     elseIf DefiantY = 370 Then 

       If Angle = 135 Then 

         Angle =  45

       elseIf Angle = 180 Then

         Angle = 0

       elseIf Angle = 225 Then

         Angle = 315        

        EndIf 

       

      elseIf DefiantX = 0 Then 

       If Angle = 225 Then 

         Angle =  135

       elseIf Angle = 270 Then

         Angle = 90  

       elseIf Angle = 315 Then

         Angle = 45         

       EndIf 

       

       elseIf DefiantX = 570 Then 

       If Angle = 90 Then 

         Angle =  270

       elseIf Angle = 45 Then

         Angle = 315

       elseIf Angle = 135 Then

         Angle = 225

       EndIf  

       endif

       Shapes.Rotate(Defiant,Angle)

       

       If DefiantX <0 Or DefiantX > 600 Or DefiantY <0 Or DefiantY >400 Then 

         DefiantX = 45

         DefiantY = 40

         Angle = 135

         Shapes.Move (Wormhole, 0, 0 )

         EndIf 



     If Angle = 0  Then 'North 

       DefiantY =DefiantY -5

     ElseIf Angle = 45 then 'NE

       DefiantX = DefiantX +5

       DefiantY = DefiantY - 5

     Elseif Angle = 90 then 'East

       DefiantX = DefiantX + 5

     Elseif Angle = 135 Then 'SE

       DefiantX =DefiantX +5

       DefiantY =DefiantY +5

     elseif Angle = 180 Then 'South 

       DefiantY = DefiantY +5

     Elseif Angle = 225 Then 'SW

       DefiantX = DefiantX - 5

       DefiantY = DefiantY + 5 

     Elseif Angle = 270 Then ' West 

       DefiantX = DefiantX - 5

     Elseif Angle = 315 Then 'NW

       DefiantX = DefiantX -5

       DefiantY = DefiantY -5

     Else 

       Angle = 0

     EndIf 

       Shapes.Move (Defiant ,DefiantX ,DefiantY ,)

    

 '  DevWindow ()

   MoveBigRock()

   MoveMedRock ()

   MoveSmlRock ()

   MoveBig1Rock()

   MoveMed1Rock ()

   MoveSml1Rock ()

   MoveBig2Rock()

   MoveMed2Rock ()

   MoveSml2Rock ()

   MoveBig3Rock()

   MoveMed3Rock ()

   MoveSml3Rock ()

   MoveBullet ()

   HUDSub ()

 EndSub 

 

 Sub DevWindow 

   TextWindow.Clear ()

   TextWindow.WriteLine ("Defiant's Angle ="+Angle )

   TextWindow.WriteLine ("Defiants Co-ordanates= "+DefiantX +", " +DefiantY )

   TextWindow.WriteLine ("Speed = "+Speed )

   TextWindow.WriteLine ("Big Asteroid= "+BigPosX+ ", "+BigPosY )

   TextWindow.WriteLine ("Medium Asteroid= "+MedPosX+ ", "+MedPosY )

   TextWindow.WriteLine ("Small Asteroid= "+SmlPosX+ ", "+SmlPosY )

      TextWindow.WriteLine ("Big Asteroid= "+Big1PosX+ ", "+Big1PosY )

   TextWindow.WriteLine ("Medium Asteroid= "+Med1PosX+ ", "+Med1PosY )

   TextWindow.WriteLine ("Small Asteroid= "+Sml1PosX+ ", "+Sml1PosY )

   TextWindow.WriteLine ("Shields at "+Shields+"% and holding!")

   TextWindow.WriteLine ("Bullet Angle = "+BulletAngle )

   TextWindow.WriteLine ("Bullet's Co Ordanates = "+BulletX+ ", "+ BulletY )

   TextWindow.WriteLine ("Score = "+Score )

   TextWindow.WriteLine ("Big Direction = "+BigDirection )

   EndSub 

  

  Sub BigRockSub

    BigTopX = 0

    BigBottomX = 0

    BigPosX = 0

    BigDistance = 0

    BigMoveX = 0

    BigPosY = 0

    

    BigDirection = Math.GetRandomNumber(4)

    

    If BigDirection = 1 Then 

    

 BigTopX = Math.GetRandomNumber(600)

 BigBottomX = Math.GetRandomNumber(600)

 BigPosX = BigTopX 

 

 BigDistance = BigTopX - BigBottomX 

 

 BigMoveX = BigDistance/400

 BigPosY = 0

' Shapes.Move (BigRock , BigTopX , 0)

Elseif BigDirection = 2 Then 

  BigTopX = Math.GetRandomNumber(600)

 BigBottomX = Math.GetRandomNumber(600)

 BigPosX = BigBottomX 

 

 BigDistance = BigTopX - BigBottomX 

 

 BigMoveX = BigDistance/400

 BigPosY = 400

' Shapes.Move (BigRock , BigBottomX  , 400)

 

Elseif BigDirection = 3 Then 

   BigLeftY = Math.GetRandomNumber(400)

 BigRightY = Math.GetRandomNumber(400)

 BigPosY = BigLeftY 

 

 BigDistance = BigLeftY - BigRightY 

 

 BigMoveY = BigDistance/275

 BigPosX =  0

 'Shapes.Move (BigRock , 0  , BigRightY)

 Elseif BigDirection = 4 Then 

   BigLeftY = Math.GetRandomNumber(400)

 BigRightY = Math.GetRandomNumber(400)

 BigPosY = BigRightY 

 

 BigDistance = BigLeftY - BigRightY 

 

 BigMoveY = BigDistance/275

 BigPosX =  600

 'Shapes.Move (BigRock , 0  , BigRightY)

 EndIf 



 EndSub 

 

Sub MoveBigRock 

 

  If BigDirection = 1 Then 

    

      BigPosX = BigPosX + BigMoveX 

   BigPosY = BigPosY + 1 

   Shapes.Move (BigRock, BigPosX, BigPosY )

   

 Elseif BigDirection = 2 Then 

   

   BigPosX = BigPosX - BigMoveX 

   BigPosY = BigPosY - 1 

   Shapes.Move (BigRock, BigPosX, BigPosY )

   

 Elseif BigDirection = 3 Then

         BigPosX = BigPosX + 2

   BigPosY = BigPosY + BigMoveY 

   Shapes.Move (BigRock, BigPosX, BigPosY )

    Elseif BigDirection = 4 Then

         BigPosX = BigPosX - 2

   BigPosY = BigPosY - BigMoveY 

   Shapes.Move (BigRock, BigPosX, BigPosY )

   EndIf 

   BigCollision() 

   If BigPosX > 600 Or BigPosX < 0 Or BigPosY > 400 Or BigPosY < 0 Then 

     BigRockSub ()

     EndIf 

 EndSub 

 

 Sub BigCollision 

   If (DefiantX >= BigPosX -25 And DefiantX <= BigPosX + 55) And (DefiantY >= BigPosY -20 And DefiantY <= BigPosY + 55) Then 



     Shields  = Shields - Math.GetRandomNumber(15)

     If Shields < 0 Then 

       GameOver ()

       Endif

   EndIf 

   

    If (DefiantY >= BigPosY -20 And DefiantY <= BigPosY + 55) And  (DefiantX >= BigPosX -25 And DefiantX <= BigPosX + 55) Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then  

         Angle = 225 

           DefiantX = DefiantX -10

       DefiantY = DefiantY + 10

       elseIf Angle = 315 Then

       Angle = 135

       DefiantX = DefiantX +10

       DefiantY = DefiantY +10

    ElseIf Angle = 135 Then 

      Angle =  315

             DefiantX =DefiantX -10

       DefiantY =DefiantY -10

       elseIf Angle = 180 Then

       Angle = 0

       DefiantY = DefiantY -10

       elseIf Angle = 225 Then

         Angle = 45         

       DefiantX = DefiantX +10

       DefiantY = DefiantY -10

       elseIf Angle = 270 Then

       Angle = 90 

      DefiantX = DefiantX +10 

 ElseIf Angle = 90 Then 

   Angle = 270

    DefiantX = DefiantX -10

     

       EndIf

     endif

  

EndSub 



Sub MedRockSub

    MedTopX = 0

    MedBottomX = 0

    MedPosX = 0

    MedDistance = 0

    MedMoveX = 0

    MedPosY = 0

    

    MedDirection = Math.GetRandomNumber(4)

    

 If MedDirection = 1 Then 

    

 MedTopX = Math.GetRandomNumber(600)

 MedBottomX = Math.GetRandomNumber(600)

 MedPosX = MedTopX 

 

 MedDistance = MedTopX - MedBottomX 

 

 MedMoveX = MedDistance/400



MedPosY = 0 

ElseIf MedDirection = 2 Then 

   MedTopX = Math.GetRandomNumber(600)

 MedBottomX = Math.GetRandomNumber(600)

 MedPosX = MedBottomX 

 

 MedDistance = MedTopX - MedBottomX 

 

 MedMoveX = MedDistance/400





MedPosY = 400



Elseif MedDirection = 3 Then 

   MedLeftY = Math.GetRandomNumber(400)

 MedRightY = Math.GetRandomNumber(400)

 MedPosY = MedLeftY 

 

 MedDistance = MedLeftY - MedRightY 

 

 MedMoveY = MedDistance/275

 MedPosX =  0



 Elseif MedDirection = 4 Then 

   MedLeftY = Math.GetRandomNumber(400)

 MedRightY = Math.GetRandomNumber(400)

 MedPosY = MedRightY 

 

 MedDistance = MedLeftY - MedRightY 

 

 MedMoveY = MedDistance/275

 MedPosX =  600





EndIf 

 EndSub 



Sub MoveMedRock 

  If MedDirection = 1 Then 

      MedPosX = MedPosX + MedMoveX 

   MedPosY = MedPosY + 1 

   Shapes.Move (MedRock, MedPosX, MedPosY )

 ElseIf MedDirection = 2 Then 

    MedPosX = MedPosX - MedMoveX 

   MedPosY = MedPosY - 1 

   Shapes.Move (MedRock, MedPosX, MedPosY )

   Elseif MedDirection = 3 Then

         MedPosX = MedPosX + 2

   MedPosY = MedPosY + MedMoveY 

   Shapes.Move (MedRock, MedPosX, MedPosY )

    Elseif MedDirection = 4 Then

         MedPosX = MedPosX - 2

   MedPosY = MedPosY - MedMoveY 

   Shapes.Move (MedRock, MedPosX, MedPosY )

   EndIf



 

   MedCollision() 

   If MedPosX > 600 Or MedPosX < 0 Or MedPosY > 400 Or MedPosY < 0 Then 

   

     

    MedRockSub ()

     EndIf  

   EndSub

   

     Sub MedCollision 

   If (DefiantX >= MedPosX -25 And DefiantX <= MedPosX + 30) And (DefiantY >= MedPosY -25 And DefiantY <= MedPosY + 35) Then 



     Shields  = Shields - Math.GetRandomNumber(10)

          If Shields < 0 Then 

       GameOver ()

       Endif

   EndIf 

   

    If (DefiantY >= MedPosY -25 And DefiantY <= MedPosY + 35) And  (DefiantX >= MedPosX -25 And DefiantX <= MedPosX + 30) Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then  

         Angle = 225 

           DefiantX = DefiantX -10

       DefiantY = DefiantY + 10

       elseIf Angle = 315 Then

       Angle = 135

       DefiantX = DefiantX +10

       DefiantY = DefiantY +10

    ElseIf Angle = 135 Then 

      Angle =  315

             DefiantX =DefiantX -10

       DefiantY =DefiantY -10

       elseIf Angle = 180 Then

       Angle = 0

       DefiantY = DefiantY -10

       elseIf Angle = 225 Then

         Angle = 45         

       DefiantX = DefiantX +10

       DefiantY = DefiantY -10

       elseIf Angle = 270 Then

       Angle = 90 

      DefiantX = DefiantX +10 

 ElseIf Angle = 90 Then 

   Angle = 270

    DefiantX = DefiantX -10

     

       EndIf

     endif

   Endsub

   

   Sub SmlRockSub

    SmlTopX = 0

    SmlBottomX = 0

    SmlPosX = 0

    SmlDistance = 0

    SmlMoveX = 0

    SmlPosY = 0

    

    SmlDirection= Math.GetRandomNumber(4)

    

    If SmlDirection = 1 Then 

 SmlTopX = Math.GetRandomNumber(600)

 SmlBottomX = Math.GetRandomNumber(600)

 SmlPosX = SmlTopX 

 

 SmlDistance = SmlTopX - SmlBottomX 

 

 SmlMoveX = SmlDistance/400

 

 SmlPosY = 0

 



ElseIf SmlDirection = 2 Then 

 SmlTopX = Math.GetRandomNumber(600)

 SmlBottomX = Math.GetRandomNumber(600)

 SmlPosX = SmlBottomX 

 

 SmlDistance = SmlTopX - SmlBottomX 

 

 SmlMoveX = SmlDistance/400

 

 SmlPosY = 400

 



Elseif SmlDirection = 3 Then 

   SmlLeftY = Math.GetRandomNumber(400)

 SmlRightY = Math.GetRandomNumber(400)

 SmlPosY = SmlLeftY 

 

 SmlDistance = SmlLeftY - SmlRightY 

 

 SmlMoveY = SmlDistance/275

 SmlPosX =  0



 Elseif SmlDirection = 4 Then 

   SmlLeftY = Math.GetRandomNumber(400)

 SmlRightY = Math.GetRandomNumber(400)

 SmlPosY = SmlRightY 

 

 SmlDistance = SmlLeftY - SmlRightY 

 

 SmlMoveY = SmlDistance/275

 SmlPosX =  600



EndIf 

 EndSub 



Sub MoveSmlRock 

  

  If SmlDirection = 1 Then 

      SmlPosX = SmlPosX + SmlMoveX 

   SmlPosY = SmlPosY + 1 

   Shapes.Move (SmlRock, SmlPosX, SmlPosY )

 ElseIf SmlDirection = 2 Then 

         SmlPosX = SmlPosX - SmlMoveX 

   SmlPosY = SmlPosY - 1 

   Shapes.Move (SmlRock, SmlPosX, SmlPosY )

   Elseif SmlDirection = 3 Then

         SmlPosX = SmlPosX + 2

   SmlPosY = SmlPosY + SmlMoveY 

   Shapes.Move (SmlRock, SmlPosX, SmlPosY )

    Elseif SmlDirection = 4 Then

         SmlPosX = SmlPosX - 2

   SmlPosY = SmlPosY - SmlMoveY 

   Shapes.Move (SmlRock, SmlPosX, SmlPosY )

   EndIf



   SmlCollision() 

   If SmlPosX > 600 Or SmlPosX < 0 Or SmlPosY > 400 Or SmlPosY < 0 Then 

   

     

    SmlRockSub ()

     EndIf  

   EndSub

   

     Sub SmlCollision 

   If (DefiantX >= SmlPosX -20 And DefiantX <= SmlPosX + 15) And (DefiantY >= SmlPosY -25 And DefiantY <= SmlPosY + 15) Then 

 

     Shields  = Shields - Math.GetRandomNumber(5)

     If Shields < 0 Then 

       GameOver ()

       Endif

   EndIf 

   

    If (DefiantY >= SmlPosY -25 And DefiantY <= SmlPosY + 15) And  (DefiantX >= SmlPosX -20 And DefiantX <= SmlPosX + 15) Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then  

         Angle = 225 

           DefiantX = DefiantX -10

       DefiantY = DefiantY + 10

       elseIf Angle = 315 Then

       Angle = 135

       DefiantX = DefiantX +10

       DefiantY = DefiantY +10

    ElseIf Angle = 135 Then 

      Angle =  315

             DefiantX =DefiantX -10

       DefiantY =DefiantY -10

       elseIf Angle = 180 Then

       Angle = 0

       DefiantY = DefiantY -10

       elseIf Angle = 225 Then

         Angle = 45         

       DefiantX = DefiantX +10

       DefiantY = DefiantY -10

       elseIf Angle = 270 Then

       Angle = 90 

      DefiantX = DefiantX +10 

 ElseIf Angle = 90 Then 

   Angle = 270

    DefiantX = DefiantX -10

     

       EndIf

     endif

     Endsub

     

    Sub Big1RockSub

    Big1TopX = 0

    Big1BottomX = 0

    Big1PosX = 0

    Big1Distance = 0

    Big1MoveX = 0

    Big1PosY = 0

    

    Big1Direction = Math.GetRandomNumber(4)

    

    If Big1Direction = 1 Then 

    

 Big1TopX = Math.GetRandomNumber(600)

 Big1BottomX = Math.GetRandomNumber(600)

 Big1PosX = Big1TopX 

 

 Big1Distance = Big1TopX - Big1BottomX 

 

 Big1MoveX = Big1Distance/400

 Big1PosY = 0

' Shapes.Move (Big1Rock , Big1TopX , 0)

Elseif Big1Direction = 2 Then 

  Big1TopX = Math.GetRandomNumber(600)

 Big1BottomX = Math.GetRandomNumber(600)

 Big1PosX = Big1BottomX 

 

 Big1Distance = Big1TopX - Big1BottomX 

 

 Big1MoveX = Big1Distance/400

 Big1PosY = 400

' Shapes.Move (Big1Rock , Big1BottomX  , 400)

 

Elseif Big1Direction = 3 Then 

   Big1LeftY = Math.GetRandomNumber(400)

 Big1RightY = Math.GetRandomNumber(400)

 Big1PosY = Big1LeftY 

 

 Big1Distance = Big1LeftY - Big1RightY 

 

 Big1MoveY = Big1Distance/275

 Big1PosX =  0

 'Shapes.Move (Big1Rock , 0  , Big1RightY)

 Elseif Big1Direction = 4 Then 

   Big1LeftY = Math.GetRandomNumber(400)

 Big1RightY = Math.GetRandomNumber(400)

 Big1PosY = Big1RightY 

 

 Big1Distance = Big1LeftY - Big1RightY 

 

 Big1MoveY = Big1Distance/275

 Big1PosX =  600

 'Shapes.Move (Big1Rock , 0  , Big1RightY)

 EndIf 



 EndSub 

 

Sub MoveBig1Rock 

 

  If Big1Direction = 1 Then 

    

      Big1PosX = Big1PosX + Big1MoveX 

   Big1PosY = Big1PosY + 1 

   Shapes.Move (Big1Rock, Big1PosX, Big1PosY )

   

 Elseif Big1Direction = 2 Then 

   

   Big1PosX = Big1PosX - Big1MoveX 

   Big1PosY = Big1PosY - 1 

   Shapes.Move (Big1Rock, Big1PosX, Big1PosY )

   

 Elseif Big1Direction = 3 Then

         Big1PosX = Big1PosX + 2

   Big1PosY = Big1PosY + Big1MoveY 

   Shapes.Move (Big1Rock, Big1PosX, Big1PosY )

    Elseif Big1Direction = 4 Then

         Big1PosX = Big1PosX - 2

   Big1PosY = Big1PosY - Big1MoveY 

   Shapes.Move (Big1Rock, Big1PosX, Big1PosY )

   EndIf 

   Big1Collision() 

   If Big1PosX > 600 Or Big1PosX < 0 Or Big1PosY > 400 Or Big1PosY < 0 Then 

     Big1RockSub ()

     EndIf 

 EndSub 

 

 Sub Big1Collision 

   If (DefiantX >= Big1PosX -25 And DefiantX <= Big1PosX + 55) And (DefiantY >= Big1PosY -20 And DefiantY <= Big1PosY + 55) Then 



     Shields  = Shields - Math.GetRandomNumber(15)

     If Shields < 0 Then 

       GameOver ()

       Endif

   EndIf 

   

    If (DefiantY >= Big1PosY -20 And DefiantY <= Big1PosY + 55) And  (DefiantX >= Big1PosX -25 And DefiantX <= Big1PosX + 55) Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then  

         Angle = 225 

           DefiantX = DefiantX -10

       DefiantY = DefiantY + 10

       elseIf Angle = 315 Then

       Angle = 135

       DefiantX = DefiantX +10

       DefiantY = DefiantY +10

    ElseIf Angle = 135 Then 

      Angle =  315

             DefiantX =DefiantX -10

       DefiantY =DefiantY -10

       elseIf Angle = 180 Then

       Angle = 0

       DefiantY = DefiantY -10

       elseIf Angle = 225 Then

         Angle = 45         

       DefiantX = DefiantX +10

       DefiantY = DefiantY -10

       elseIf Angle = 270 Then

       Angle = 90 

      DefiantX = DefiantX +10 

 ElseIf Angle = 90 Then 

   Angle = 270

    DefiantX = DefiantX -10

     

       EndIf

     endif

  

EndSub 



Sub Med1RockSub

    Med1TopX = 0

    Med1BottomX = 0

    Med1PosX = 0

    Med1Distance = 0

    Med1MoveX = 0

    Med1PosY = 0

    

    Med1Direction = Math.GetRandomNumber(4)

    

 If Med1Direction = 1 Then 

    

 Med1TopX = Math.GetRandomNumber(600)

 Med1BottomX = Math.GetRandomNumber(600)

 Med1PosX = Med1TopX 

 

 Med1Distance = Med1TopX - Med1BottomX 

 

 Med1MoveX = Med1Distance/400



Med1PosY = 0 

ElseIf Med1Direction = 2 Then 

   Med1TopX = Math.GetRandomNumber(600)

 Med1BottomX = Math.GetRandomNumber(600)

 Med1PosX = Med1BottomX 

 

 Med1Distance = Med1TopX - Med1BottomX 

 

 Med1MoveX = Med1Distance/400





Med1PosY = 400



Elseif Med1Direction = 3 Then 

   Med1LeftY = Math.GetRandomNumber(400)

 Med1RightY = Math.GetRandomNumber(400)

 Med1PosY = Med1LeftY 

 

 Med1Distance = Med1LeftY - Med1RightY 

 

 Med1MoveY = Med1Distance/275

 Med1PosX =  0



 Elseif Med1Direction = 4 Then 

   Med1LeftY = Math.GetRandomNumber(400)

 Med1RightY = Math.GetRandomNumber(400)

 Med1PosY = Med1RightY 

 

 Med1Distance = Med1LeftY - Med1RightY 

 

 Med1MoveY = Med1Distance/275

 Med1PosX =  600





EndIf 

 EndSub 



Sub MoveMed1Rock 

  If Med1Direction = 1 Then 

      Med1PosX = Med1PosX + Med1MoveX 

   Med1PosY = Med1PosY + 1 

   Shapes.Move (Med1Rock, Med1PosX, Med1PosY )

 ElseIf Med1Direction = 2 Then 

    Med1PosX = Med1PosX - Med1MoveX 

   Med1PosY = Med1PosY - 1 

   Shapes.Move (Med1Rock, Med1PosX, Med1PosY )

   Elseif Med1Direction = 3 Then

         Med1PosX = Med1PosX + 2

   Med1PosY = Med1PosY + Med1MoveY 

   Shapes.Move (Med1Rock, Med1PosX, Med1PosY )

    Elseif Med1Direction = 4 Then

         Med1PosX = Med1PosX - 2

   Med1PosY = Med1PosY - Med1MoveY 

   Shapes.Move (Med1Rock, Med1PosX, Med1PosY )

   EndIf



 

   Med1Collision() 

   If Med1PosX > 600 Or Med1PosX < 0 Or Med1PosY > 400 Or Med1PosY < 0 Then 

   

     

    Med1RockSub ()

     EndIf  

   EndSub

   

     Sub Med1Collision 

   If (DefiantX >= Med1PosX -25 And DefiantX <= Med1PosX + 30) And (DefiantY >= Med1PosY -25 And DefiantY <= Med1PosY + 35) Then 



     Shields  = Shields - Math.GetRandomNumber(10)

          If Shields < 0 Then 

       GameOver ()

       Endif

   EndIf 

   

    If (DefiantY >= Med1PosY -25 And DefiantY <= Med1PosY + 35) And  (DefiantX >= Med1PosX -25 And DefiantX <= Med1PosX + 30) Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then  

         Angle = 225 

           DefiantX = DefiantX -10

       DefiantY = DefiantY + 10

       elseIf Angle = 315 Then

       Angle = 135

       DefiantX = DefiantX +10

       DefiantY = DefiantY +10

    ElseIf Angle = 135 Then 

      Angle =  315

             DefiantX =DefiantX -10

       DefiantY =DefiantY -10

       elseIf Angle = 180 Then

       Angle = 0

       DefiantY = DefiantY -10

       elseIf Angle = 225 Then

         Angle = 45         

       DefiantX = DefiantX +10

       DefiantY = DefiantY -10

       elseIf Angle = 270 Then

       Angle = 90 

      DefiantX = DefiantX +10 

 ElseIf Angle = 90 Then 

   Angle = 270

    DefiantX = DefiantX -10

     

       EndIf

     endif

   Endsub

   

   Sub Sml1RockSub

    Sml1TopX = 0

    Sml1BottomX = 0

    Sml1PosX = 0

    Sml1Distance = 0

    Sml1MoveX = 0

    Sml1PosY = 0

    

    Sml1Direction= Math.GetRandomNumber(4)

    

    If Sml1Direction = 1 Then 

 Sml1TopX = Math.GetRandomNumber(600)

 Sml1BottomX = Math.GetRandomNumber(600)

 Sml1PosX = Sml1TopX 

 

 Sml1Distance = Sml1TopX - Sml1BottomX 

 

 Sml1MoveX = Sml1Distance/400

 

 Sml1PosY = 0

 



ElseIf Sml1Direction = 2 Then 

 Sml1TopX = Math.GetRandomNumber(600)

 Sml1BottomX = Math.GetRandomNumber(600)

 Sml1PosX = Sml1BottomX 

 

 Sml1Distance = Sml1TopX - Sml1BottomX 

 

 Sml1MoveX = Sml1Distance/400

 

 Sml1PosY = 400

 



Elseif Sml1Direction = 3 Then 

   Sml1LeftY = Math.GetRandomNumber(400)

 Sml1RightY = Math.GetRandomNumber(400)

 Sml1PosY = Sml1LeftY 

 

 Sml1Distance = Sml1LeftY - Sml1RightY 

 

 Sml1MoveY = Sml1Distance/275

 Sml1PosX =  0



 Elseif Sml1Direction = 4 Then 

   Sml1LeftY = Math.GetRandomNumber(400)

 Sml1RightY = Math.GetRandomNumber(400)

 Sml1PosY = Sml1RightY 

 

 Sml1Distance = Sml1LeftY - Sml1RightY 

 

 Sml1MoveY = Sml1Distance/275

 Sml1PosX =  600



EndIf 

 EndSub 



Sub MoveSml1Rock 

  

  If Sml1Direction = 1 Then 

      Sml1PosX = Sml1PosX + Sml1MoveX 

   Sml1PosY = Sml1PosY + 1 

   Shapes.Move (Sml1Rock, Sml1PosX, Sml1PosY )

 ElseIf Sml1Direction = 2 Then 

         Sml1PosX = Sml1PosX - Sml1MoveX 

   Sml1PosY = Sml1PosY - 1 

   Shapes.Move (Sml1Rock, Sml1PosX, Sml1PosY )

   Elseif Sml1Direction = 3 Then

         Sml1PosX = Sml1PosX + 2

   Sml1PosY = Sml1PosY + Sml1MoveY 

   Shapes.Move (Sml1Rock, Sml1PosX, Sml1PosY )

    Elseif Sml1Direction = 4 Then

         Sml1PosX = Sml1PosX - 2

   Sml1PosY = Sml1PosY - Sml1MoveY 

   Shapes.Move (Sml1Rock, Sml1PosX, Sml1PosY )

   EndIf



   Sml1Collision() 

   If Sml1PosX > 600 Or Sml1PosX < 0 Or Sml1PosY > 400 Or Sml1PosY < 0 Then 

   

     

    Sml1RockSub ()

     EndIf  

   EndSub

   

     Sub Sml1Collision 

   If (DefiantX >= Sml1PosX -20 And DefiantX <= Sml1PosX + 15) And (DefiantY >= Sml1PosY -25 And DefiantY <= Sml1PosY + 15) Then 

  

     Shields  = Shields - Math.GetRandomNumber(5)

     If Shields < 0 Then 

       GameOver ()

       Endif

   EndIf 

   

    If (DefiantY >= Sml1PosY -25 And DefiantY <= Sml1PosY + 15) And  (DefiantX >= Sml1PosX -20 And DefiantX <= Sml1PosX + 15) Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then  

         Angle = 225 

           DefiantX = DefiantX -10

       DefiantY = DefiantY + 10

       elseIf Angle = 315 Then

       Angle = 135

       DefiantX = DefiantX +10

       DefiantY = DefiantY +10

    ElseIf Angle = 135 Then 

      Angle =  315

             DefiantX =DefiantX -10

       DefiantY =DefiantY -10

       elseIf Angle = 180 Then

       Angle = 0

       DefiantY = DefiantY -10

       elseIf Angle = 225 Then

         Angle = 45         

       DefiantX = DefiantX +10

       DefiantY = DefiantY -10

       elseIf Angle = 270 Then

       Angle = 90 

      DefiantX = DefiantX +10 

 ElseIf Angle = 90 Then 

   Angle = 270

    DefiantX = DefiantX -10

     

       EndIf

     endif

     Endsub

  Sub Big2RockSub

    Big2TopX = 0

    Big2BottomX = 0

    Big2PosX = 0

    Big2Distance = 0

    Big2MoveX = 0

    Big2PosY = 0

    

    Big2Direction = Math.GetRandomNumber(4)

    

    If Big2Direction = 1 Then 

    

 Big2TopX = Math.GetRandomNumber(600)

 Big2BottomX = Math.GetRandomNumber(600)

 Big2PosX = Big2TopX 

 

 Big2Distance = Big2TopX - Big2BottomX 

 

 Big2MoveX = Big2Distance/400

 Big2PosY = 0

' Shapes.Move (Big2Rock , Big2TopX , 0)

Elseif Big2Direction = 2 Then 

  Big2TopX = Math.GetRandomNumber(600)

 Big2BottomX = Math.GetRandomNumber(600)

 Big2PosX = Big2BottomX 

 

 Big2Distance = Big2TopX - Big2BottomX 

 

 Big2MoveX = Big2Distance/400

 Big2PosY = 400

' Shapes.Move (Big2Rock , Big2BottomX  , 400)

 

Elseif Big2Direction = 3 Then 

   Big2LeftY = Math.GetRandomNumber(400)

 Big2RightY = Math.GetRandomNumber(400)

 Big2PosY = Big2LeftY 

 

 Big2Distance = Big2LeftY - Big2RightY 

 

 Big2MoveY = Big2Distance/275

 Big2PosX =  0

 'Shapes.Move (Big2Rock , 0  , Big2RightY)

 Elseif Big2Direction = 4 Then 

   Big2LeftY = Math.GetRandomNumber(400)

 Big2RightY = Math.GetRandomNumber(400)

 Big2PosY = Big2RightY 

 

 Big2Distance = Big2LeftY - Big2RightY 

 

 Big2MoveY = Big2Distance/275

 Big2PosX =  600

 'Shapes.Move (Big2Rock , 0  , Big2RightY)

 EndIf 



 EndSub 

 

Sub MoveBig2Rock 

 

  If Big2Direction = 1 Then 

    

      Big2PosX = Big2PosX + Big2MoveX 

   Big2PosY = Big2PosY + 1 

   Shapes.Move (Big2Rock, Big2PosX, Big2PosY )

   

 Elseif Big2Direction = 2 Then 

   

   Big2PosX = Big2PosX - Big2MoveX 

   Big2PosY = Big2PosY - 1 

   Shapes.Move (Big2Rock, Big2PosX, Big2PosY )

   

 Elseif Big2Direction = 3 Then

         Big2PosX = Big2PosX + 2

   Big2PosY = Big2PosY + Big2MoveY 

   Shapes.Move (Big2Rock, Big2PosX, Big2PosY )

    Elseif Big2Direction = 4 Then

         Big2PosX = Big2PosX - 2

   Big2PosY = Big2PosY - Big2MoveY 

   Shapes.Move (Big2Rock, Big2PosX, Big2PosY )

   EndIf 

   Big2Collision() 

   If Big2PosX > 600 Or Big2PosX < 0 Or Big2PosY > 400 Or Big2PosY < 0 Then 

     Big2RockSub ()

     EndIf 

 EndSub 

 

 Sub Big2Collision 

   If (DefiantX >= Big2PosX -25 And DefiantX <= Big2PosX + 55) And (DefiantY >= Big2PosY -20 And DefiantY <= Big2PosY + 55) Then 

  

     Shields  = Shields - Math.GetRandomNumber(15)

     If Shields < 0 Then 

       GameOver ()

       Endif

   EndIf 

   

    If (DefiantY >= Big2PosY -20 And DefiantY <= Big2PosY + 55) And  (DefiantX >= Big2PosX -25 And DefiantX <= Big2PosX + 55) Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then  

         Angle = 225 

           DefiantX = DefiantX -10

       DefiantY = DefiantY + 10

       elseIf Angle = 315 Then

       Angle = 135

       DefiantX = DefiantX +10

       DefiantY = DefiantY +10

    ElseIf Angle = 135 Then 

      Angle =  315

             DefiantX =DefiantX -10

       DefiantY =DefiantY -10

       elseIf Angle = 180 Then

       Angle = 0

       DefiantY = DefiantY -10

       elseIf Angle = 225 Then

         Angle = 45         

       DefiantX = DefiantX +10

       DefiantY = DefiantY -10

       elseIf Angle = 270 Then

       Angle = 90 

      DefiantX = DefiantX +10 

 ElseIf Angle = 90 Then 

   Angle = 270

    DefiantX = DefiantX -10

     

       EndIf

     endif

  

EndSub 



Sub Med2RockSub

    Med2TopX = 0

    Med2BottomX = 0

    Med2PosX = 0

    Med2Distance = 0

    Med2MoveX = 0

    Med2PosY = 0

    

    Med2Direction = Math.GetRandomNumber(4)

    

 If Med2Direction = 1 Then 

    

 Med2TopX = Math.GetRandomNumber(600)

 Med2BottomX = Math.GetRandomNumber(600)

 Med2PosX = Med2TopX 

 

 Med2Distance = Med2TopX - Med2BottomX 

 

 Med2MoveX = Med2Distance/400



Med2PosY = 0 

ElseIf Med2Direction = 2 Then 

   Med2TopX = Math.GetRandomNumber(600)

 Med2BottomX = Math.GetRandomNumber(600)

 Med2PosX = Med2BottomX 

 

 Med2Distance = Med2TopX - Med2BottomX 

 

 Med2MoveX = Med2Distance/400





Med2PosY = 400



Elseif Med2Direction = 3 Then 

   Med2LeftY = Math.GetRandomNumber(400)

 Med2RightY = Math.GetRandomNumber(400)

 Med2PosY = Med2LeftY 

 

 Med2Distance = Med2LeftY - Med2RightY 

 

 Med2MoveY = Med2Distance/275

 Med2PosX =  0



 Elseif Med2Direction = 4 Then 

   Med2LeftY = Math.GetRandomNumber(400)

 Med2RightY = Math.GetRandomNumber(400)

 Med2PosY = Med2RightY 

 

 Med2Distance = Med2LeftY - Med2RightY 

 

 Med2MoveY = Med2Distance/275

 Med2PosX =  600





EndIf 

 EndSub 



Sub MoveMed2Rock 

  If Med2Direction = 1 Then 

      Med2PosX = Med2PosX + Med2MoveX 

   Med2PosY = Med2PosY + 1 

   Shapes.Move (Med2Rock, Med2PosX, Med2PosY )

 ElseIf Med2Direction = 2 Then 

    Med2PosX = Med2PosX - Med2MoveX 

   Med2PosY = Med2PosY - 1 

   Shapes.Move (Med2Rock, Med2PosX, Med2PosY )

   Elseif Med2Direction = 3 Then

         Med2PosX = Med2PosX + 2

   Med2PosY = Med2PosY + Med2MoveY 

   Shapes.Move (Med2Rock, Med2PosX, Med2PosY )

    Elseif Med2Direction = 4 Then

         Med2PosX = Med2PosX - 2

   Med2PosY = Med2PosY - Med2MoveY 

   Shapes.Move (Med2Rock, Med2PosX, Med2PosY )

   EndIf



 

   Med2Collision() 

   If Med2PosX > 600 Or Med2PosX < 0 Or Med2PosY > 400 Or Med2PosY < 0 Then 

   

     

    Med2RockSub ()

     EndIf  

   EndSub

   

     Sub Med2Collision 

   If (DefiantX >= Med2PosX -25 And DefiantX <= Med2PosX + 30) And (DefiantY >= Med2PosY -25 And DefiantY <= Med2PosY + 35) Then 

  

     Shields  = Shields - Math.GetRandomNumber(10)

          If Shields < 0 Then 

       GameOver ()

       Endif

   EndIf 

   

    If (DefiantY >= Med2PosY -25 And DefiantY <= Med2PosY + 35) And  (DefiantX >= Med2PosX -25 And DefiantX <= Med2PosX + 30) Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then  

         Angle = 225 

           DefiantX = DefiantX -10

       DefiantY = DefiantY + 10

       elseIf Angle = 315 Then

       Angle = 135

       DefiantX = DefiantX +10

       DefiantY = DefiantY +10

    ElseIf Angle = 135 Then 

      Angle =  315

             DefiantX =DefiantX -10

       DefiantY =DefiantY -10

       elseIf Angle = 180 Then

       Angle = 0

       DefiantY = DefiantY -10

       elseIf Angle = 225 Then

         Angle = 45         

       DefiantX = DefiantX +10

       DefiantY = DefiantY -10

       elseIf Angle = 270 Then

       Angle = 90 

      DefiantX = DefiantX +10 

 ElseIf Angle = 90 Then 

   Angle = 270

    DefiantX = DefiantX -10

     

       EndIf

     endif

   Endsub

   

   Sub Sml2RockSub

    Sml2TopX = 0

    Sml2BottomX = 0

    Sml2PosX = 0

    Sml2Distance = 0

    Sml2MoveX = 0

    Sml2PosY = 0

    

    Sml2Direction= Math.GetRandomNumber(4)

    

    If Sml2Direction = 1 Then 

 Sml2TopX = Math.GetRandomNumber(600)

 Sml2BottomX = Math.GetRandomNumber(600)

 Sml2PosX = Sml2TopX 

 

 Sml2Distance = Sml2TopX - Sml2BottomX 

 

 Sml2MoveX = Sml2Distance/400

 

 Sml2PosY = 0

 



ElseIf Sml2Direction = 2 Then 

 Sml2TopX = Math.GetRandomNumber(600)

 Sml2BottomX = Math.GetRandomNumber(600)

 Sml2PosX = Sml2BottomX 

 

 Sml2Distance = Sml2TopX - Sml2BottomX 

 

 Sml2MoveX = Sml2Distance/400

 

 Sml2PosY = 400

 



Elseif Sml2Direction = 3 Then 

   Sml2LeftY = Math.GetRandomNumber(400)

 Sml2RightY = Math.GetRandomNumber(400)

 Sml2PosY = Sml2LeftY 

 

 Sml2Distance = Sml2LeftY - Sml2RightY 

 

 Sml2MoveY = Sml2Distance/275

 Sml2PosX =  0



 Elseif Sml2Direction = 4 Then 

   Sml2LeftY = Math.GetRandomNumber(400)

 Sml2RightY = Math.GetRandomNumber(400)

 Sml2PosY = Sml2RightY 

 

 Sml2Distance = Sml2LeftY - Sml2RightY 

 

 Sml2MoveY = Sml2Distance/275

 Sml2PosX =  600



EndIf 

 EndSub 



Sub MoveSml2Rock 

  

  If Sml2Direction = 1 Then 

      Sml2PosX = Sml2PosX + Sml2MoveX 

   Sml2PosY = Sml2PosY + 1 

   Shapes.Move (Sml2Rock, Sml2PosX, Sml2PosY )

 ElseIf Sml2Direction = 2 Then 

         Sml2PosX = Sml2PosX - Sml2MoveX 

   Sml2PosY = Sml2PosY - 1 

   Shapes.Move (Sml2Rock, Sml2PosX, Sml2PosY )

   Elseif Sml2Direction = 3 Then

         Sml2PosX = Sml2PosX + 2

   Sml2PosY = Sml2PosY + Sml2MoveY 

   Shapes.Move (Sml2Rock, Sml2PosX, Sml2PosY )

    Elseif Sml2Direction = 4 Then

         Sml2PosX = Sml2PosX - 2

   Sml2PosY = Sml2PosY - Sml2MoveY 

   Shapes.Move (Sml2Rock, Sml2PosX, Sml2PosY )

   EndIf



   Sml2Collision() 

   If Sml2PosX > 600 Or Sml2PosX < 0 Or Sml2PosY > 400 Or Sml2PosY < 0 Then 

   

     

    Sml2RockSub ()

     EndIf  

   EndSub

   

     Sub Sml2Collision 

   If (DefiantX >= Sml2PosX -20 And DefiantX <= Sml2PosX + 15) And (DefiantY >= Sml2PosY -25 And DefiantY <= Sml2PosY + 15) Then 

 

     Shields  = Shields - Math.GetRandomNumber(5)

     If Shields < 0 Then 

       GameOver ()

       Endif

   EndIf 

   

    If (DefiantY >= Sml2PosY -25 And DefiantY <= Sml2PosY + 15) And  (DefiantX >= Sml2PosX -20 And DefiantX <= Sml2PosX + 15) Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then  

         Angle = 225 

           DefiantX = DefiantX -10

       DefiantY = DefiantY + 10

       elseIf Angle = 315 Then

       Angle = 135

       DefiantX = DefiantX +10

       DefiantY = DefiantY +10

    ElseIf Angle = 135 Then 

      Angle =  315

             DefiantX =DefiantX -10

       DefiantY =DefiantY -10

       elseIf Angle = 180 Then

       Angle = 0

       DefiantY = DefiantY -10

       elseIf Angle = 225 Then

         Angle = 45         

       DefiantX = DefiantX +10

       DefiantY = DefiantY -10

       elseIf Angle = 270 Then

       Angle = 90 

      DefiantX = DefiantX +10 

 ElseIf Angle = 90 Then 

   Angle = 270

    DefiantX = DefiantX -10

     

       EndIf

     endif

     Endsub



  Sub Big3RockSub

    Big3TopX = 0

    Big3BottomX = 0

    Big3PosX = 0

    Big3Distance = 0

    Big3MoveX = 0

    Big3PosY = 0

    

    Big3Direction = Math.GetRandomNumber(4)

    

    If Big3Direction = 1 Then 

    

 Big3TopX = Math.GetRandomNumber(600)

 Big3BottomX = Math.GetRandomNumber(600)

 Big3PosX = Big3TopX 

 

 Big3Distance = Big3TopX - Big3BottomX 

 

 Big3MoveX = Big3Distance/400

 Big3PosY = 0

' Shapes.Move (Big3Rock , Big3TopX , 0)

Elseif Big3Direction = 2 Then 

  Big3TopX = Math.GetRandomNumber(600)

 Big3BottomX = Math.GetRandomNumber(600)

 Big3PosX = Big3BottomX 

 

 Big3Distance = Big3TopX - Big3BottomX 

 

 Big3MoveX = Big3Distance/400

 Big3PosY = 400

' Shapes.Move (Big3Rock , Big3BottomX  , 400)

 

Elseif Big3Direction = 3 Then 

   Big3LeftY = Math.GetRandomNumber(400)

 Big3RightY = Math.GetRandomNumber(400)

 Big3PosY = Big3LeftY 

 

 Big3Distance = Big3LeftY - Big3RightY 

 

 Big3MoveY = Big3Distance/275

 Big3PosX =  0

 'Shapes.Move (Big3Rock , 0  , Big3RightY)

 Elseif Big3Direction = 4 Then 

   Big3LeftY = Math.GetRandomNumber(400)

 Big3RightY = Math.GetRandomNumber(400)

 Big3PosY = Big3RightY 

 

 Big3Distance = Big3LeftY - Big3RightY 

 

 Big3MoveY = Big3Distance/275

 Big3PosX =  600

 'Shapes.Move (Big3Rock , 0  , Big3RightY)

 EndIf 



 EndSub 

 

Sub MoveBig3Rock 

 

  If Big3Direction = 1 Then 

    

      Big3PosX = Big3PosX + Big3MoveX 

   Big3PosY = Big3PosY + 1 

   Shapes.Move (Big3Rock, Big3PosX, Big3PosY )

   

 Elseif Big3Direction = 2 Then 

   

   Big3PosX = Big3PosX - Big3MoveX 

   Big3PosY = Big3PosY - 1 

   Shapes.Move (Big3Rock, Big3PosX, Big3PosY )

   

 Elseif Big3Direction = 3 Then

         Big3PosX = Big3PosX + 2

   Big3PosY = Big3PosY + Big3MoveY 

   Shapes.Move (Big3Rock, Big3PosX, Big3PosY )

    Elseif Big3Direction = 4 Then

         Big3PosX = Big3PosX - 2

   Big3PosY = Big3PosY - Big3MoveY 

   Shapes.Move (Big3Rock, Big3PosX, Big3PosY )

   EndIf 

   Big3Collision() 

   If Big3PosX > 600 Or Big3PosX < 0 Or Big3PosY > 400 Or Big3PosY < 0 Then 

     Big3RockSub ()

     EndIf 

 EndSub 

 

 Sub Big3Collision 

   If (DefiantX >= Big3PosX -25 And DefiantX <= Big3PosX + 55) And (DefiantY >= Big3PosY -20 And DefiantY <= Big3PosY + 55) Then 

  

     Shields  = Shields - Math.GetRandomNumber(15)

     If Shields < 0 Then 

       GameOver ()

       Endif

   EndIf 

   

    If (DefiantY >= Big3PosY -20 And DefiantY <= Big3PosY + 55) And  (DefiantX >= Big3PosX -25 And DefiantX <= Big3PosX + 55) Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then  

         Angle = 225 

           DefiantX = DefiantX -10

       DefiantY = DefiantY + 10

       elseIf Angle = 315 Then

       Angle = 135

       DefiantX = DefiantX +10

       DefiantY = DefiantY +10

    ElseIf Angle = 135 Then 

      Angle =  315

             DefiantX =DefiantX -10

       DefiantY =DefiantY -10

       elseIf Angle = 180 Then

       Angle = 0

       DefiantY = DefiantY -10

       elseIf Angle = 225 Then

         Angle = 45         

       DefiantX = DefiantX +10

       DefiantY = DefiantY -10

       elseIf Angle = 270 Then

       Angle = 90 

      DefiantX = DefiantX +10 

 ElseIf Angle = 90 Then 

   Angle = 270

    DefiantX = DefiantX -10

     

       EndIf

     endif

  

EndSub 



Sub Med3RockSub

    Med3TopX = 0

    Med3BottomX = 0

    Med3PosX = 0

    Med3Distance = 0

    Med3MoveX = 0

    Med3PosY = 0

    

    Med3Direction = Math.GetRandomNumber(4)

    

 If Med3Direction = 1 Then 

    

 Med3TopX = Math.GetRandomNumber(600)

 Med3BottomX = Math.GetRandomNumber(600)

 Med3PosX = Med3TopX 

 

 Med3Distance = Med3TopX - Med3BottomX 

 

 Med3MoveX = Med3Distance/400



Med3PosY = 0 

ElseIf Med3Direction = 2 Then 

   Med3TopX = Math.GetRandomNumber(600)

 Med3BottomX = Math.GetRandomNumber(600)

 Med3PosX = Med3BottomX 

 

 Med3Distance = Med3TopX - Med3BottomX 

 

 Med3MoveX = Med3Distance/400





Med3PosY = 400



Elseif Med3Direction = 3 Then 

   Med3LeftY = Math.GetRandomNumber(400)

 Med3RightY = Math.GetRandomNumber(400)

 Med3PosY = Med3LeftY 

 

 Med3Distance = Med3LeftY - Med3RightY 

 

 Med3MoveY = Med3Distance/275

 Med3PosX =  0



 Elseif Med3Direction = 4 Then 

   Med3LeftY = Math.GetRandomNumber(400)

 Med3RightY = Math.GetRandomNumber(400)

 Med3PosY = Med3RightY 

 

 Med3Distance = Med3LeftY - Med3RightY 

 

 Med3MoveY = Med3Distance/275

 Med3PosX =  600





EndIf 

 EndSub 



Sub MoveMed3Rock 

  If Med3Direction = 1 Then 

      Med3PosX = Med3PosX + Med3MoveX 

   Med3PosY = Med3PosY + 1 

   Shapes.Move (Med3Rock, Med3PosX, Med3PosY )

 ElseIf Med3Direction = 2 Then 

    Med3PosX = Med3PosX - Med3MoveX 

   Med3PosY = Med3PosY - 1 

   Shapes.Move (Med3Rock, Med3PosX, Med3PosY )

   Elseif Med3Direction = 3 Then

         Med3PosX = Med3PosX + 2

   Med3PosY = Med3PosY + Med3MoveY 

   Shapes.Move (Med3Rock, Med3PosX, Med3PosY )

    Elseif Med3Direction = 4 Then

         Med3PosX = Med3PosX - 2

   Med3PosY = Med3PosY - Med3MoveY 

   Shapes.Move (Med3Rock, Med3PosX, Med3PosY )

   EndIf



 

   Med3Collision() 

   If Med3PosX > 600 Or Med3PosX < 0 Or Med3PosY > 400 Or Med3PosY < 0 Then 

   

     

    Med3RockSub ()

     EndIf  

   EndSub

   

     Sub Med3Collision 

   If (DefiantX >= Med3PosX -25 And DefiantX <= Med3PosX + 30) And (DefiantY >= Med3PosY -25 And DefiantY <= Med3PosY + 35) Then 

   

     Shields  = Shields - Math.GetRandomNumber(10)

          If Shields < 0 Then 

       GameOver ()

       Endif

   EndIf 

   

    If (DefiantY >= Med3PosY -25 And DefiantY <= Med3PosY + 35) And  (DefiantX >= Med3PosX -25 And DefiantX <= Med3PosX + 30) Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then  

         Angle = 225 

           DefiantX = DefiantX -10

       DefiantY = DefiantY + 10

       elseIf Angle = 315 Then

       Angle = 135

       DefiantX = DefiantX +10

       DefiantY = DefiantY +10

    ElseIf Angle = 135 Then 

      Angle =  315

             DefiantX =DefiantX -10

       DefiantY =DefiantY -10

       elseIf Angle = 180 Then

       Angle = 0

       DefiantY = DefiantY -10

       elseIf Angle = 225 Then

         Angle = 45         

       DefiantX = DefiantX +10

       DefiantY = DefiantY -10

       elseIf Angle = 270 Then

       Angle = 90 

      DefiantX = DefiantX +10 

 ElseIf Angle = 90 Then 

   Angle = 270

    DefiantX = DefiantX -10

     

       EndIf

     endif

   Endsub

   

   Sub Sml3RockSub

    Sml3TopX = 0

    Sml3BottomX = 0

    Sml3PosX = 0

    Sml3Distance = 0

    Sml3MoveX = 0

    Sml3PosY = 0

    

    Sml3Direction= Math.GetRandomNumber(4)

    

    If Sml3Direction = 1 Then 

 Sml3TopX = Math.GetRandomNumber(600)

 Sml3BottomX = Math.GetRandomNumber(600)

 Sml3PosX = Sml3TopX 

 

 Sml3Distance = Sml3TopX - Sml3BottomX 

 

 Sml3MoveX = Sml3Distance/400

 

 Sml3PosY = 0

 



ElseIf Sml3Direction = 2 Then 

 Sml3TopX = Math.GetRandomNumber(600)

 Sml3BottomX = Math.GetRandomNumber(600)

 Sml3PosX = Sml3BottomX 

 

 Sml3Distance = Sml3TopX - Sml3BottomX 

 

 Sml3MoveX = Sml3Distance/400

 

 Sml3PosY = 400

 



Elseif Sml3Direction = 3 Then 

   Sml3LeftY = Math.GetRandomNumber(400)

 Sml3RightY = Math.GetRandomNumber(400)

 Sml3PosY = Sml3LeftY 

 

 Sml3Distance = Sml3LeftY - Sml3RightY 

 

 Sml3MoveY = Sml3Distance/275

 Sml3PosX =  0



 Elseif Sml3Direction = 4 Then 

   Sml3LeftY = Math.GetRandomNumber(400)

 Sml3RightY = Math.GetRandomNumber(400)

 Sml3PosY = Sml3RightY 

 

 Sml3Distance = Sml3LeftY - Sml3RightY 

 

 Sml3MoveY = Sml3Distance/275

 Sml3PosX =  600



EndIf 

 EndSub 



Sub MoveSml3Rock 

  

  If Sml3Direction = 1 Then 

      Sml3PosX = Sml3PosX + Sml3MoveX 

   Sml3PosY = Sml3PosY + 1 

   Shapes.Move (Sml3Rock, Sml3PosX, Sml3PosY )

 ElseIf Sml3Direction = 2 Then 

         Sml3PosX = Sml3PosX - Sml3MoveX 

   Sml3PosY = Sml3PosY - 1 

   Shapes.Move (Sml3Rock, Sml3PosX, Sml3PosY )

   Elseif Sml3Direction = 3 Then

         Sml3PosX = Sml3PosX + 2

   Sml3PosY = Sml3PosY + Sml3MoveY 

   Shapes.Move (Sml3Rock, Sml3PosX, Sml3PosY )

    Elseif Sml3Direction = 4 Then

         Sml3PosX = Sml3PosX - 2

   Sml3PosY = Sml3PosY - Sml3MoveY 

   Shapes.Move (Sml3Rock, Sml3PosX, Sml3PosY )

   EndIf



   Sml3Collision() 

   If Sml3PosX > 600 Or Sml3PosX < 0 Or Sml3PosY > 400 Or Sml3PosY < 0 Then 

   

     

    Sml3RockSub ()

     EndIf  

   EndSub

   

     Sub Sml3Collision 

   If (DefiantX >= Sml3PosX -20 And DefiantX <= Sml3PosX + 15) And (DefiantY >= Sml3PosY -25 And DefiantY <= Sml3PosY + 15) Then 

 

     Shields  = Shields - Math.GetRandomNumber(5)

     If Shields < 0 Then 

       GameOver ()

       Endif

   EndIf 

   

    If (DefiantY >= Sml3PosY -25 And DefiantY <= Sml3PosY + 15) And  (DefiantX >= Sml3PosX -20 And DefiantX <= Sml3PosX + 15) Then 

       If Angle = 0 Then 

         Angle =  180

       elseIf Angle = 45 Then  

         Angle = 225 

           DefiantX = DefiantX -10

       DefiantY = DefiantY + 10

       elseIf Angle = 315 Then

       Angle = 135

       DefiantX = DefiantX +10

       DefiantY = DefiantY +10

    ElseIf Angle = 135 Then 

      Angle =  315

             DefiantX =DefiantX -10

       DefiantY =DefiantY -10

       elseIf Angle = 180 Then

       Angle = 0

       DefiantY = DefiantY -10

       elseIf Angle = 225 Then

         Angle = 45         

       DefiantX = DefiantX +10

       DefiantY = DefiantY -10

       elseIf Angle = 270 Then

       Angle = 90 

      DefiantX = DefiantX +10 

 ElseIf Angle = 90 Then 

   Angle = 270

    DefiantX = DefiantX -10

     

       EndIf

     endif

     Endsub





Sub GameOver

      

GraphicsWindow.Clear()

GraphicsWindow.DrawResizedImage   (DeepSpaceNineBG, 0,0, 610, 410,)

GraphicsWindow.DrawBoundText (250,200,150, "Warp Core Breach!")

Reset =  Controls.AddButton ("Play Again",250, 230)



EndSub 







Sub DrawBullet

  Shapes.Move (Wormhole, -100,-100)

  If Angle = 0 Then 

    BulletX = DefiantX+8

    BulletY = DefiantY-10

    BulletAngle = 0

ElseIf Angle = 45 Then 

  BulletX =DefiantX +23

  BulletY =DefiantY - 3

  BulletAngle =45

Elseif Angle = 90 Then 

  BulletX = DefiantX +27 

  BulletY =DefiantY + 10

  BulletAngle = 90

Elseif Angle = 135 Then 

  BulletX =DefiantX +23

 BulletY = DefiantY +25

  BulletAngle =135

Elseif Angle = 180 Then 

  BulletX =DefiantX +9

  BulletY =DefiantY +32

  BulletAngle =180

Elseif Angle = 225 Then 

  BulletX =DefiantX -4

  BulletY =DefiantY +27

  BulletAngle =225

Elseif Angle = 270 Then 

  BulletX =DefiantX -12

  BulletY =DefiantY +12

  BulletAngle =270

Elseif Angle = 315 Then 

  BulletX =DefiantX -7

  BulletY =DefiantY -2

  BulletAngle =315

EndIf 



Shapes.Rotate (Bullet, BulletAngle )



EndSub 



Sub MoveBullet



 If BulletAngle = 0  Then 'North 

       BulletY =BulletY -15

     ElseIf BulletAngle = 45 then 'NE

       BulletX = BulletX +15

       BulletY = BulletY - 15

     Elseif BulletAngle = 90 then 'East

       BulletX = BulletX + 15

     Elseif BulletAngle = 135 Then 'SE

       BulletX =BulletX +15

       BulletY =BulletY +15

     elseif BulletAngle = 180 Then 'South 

       BulletY = BulletY +15

     Elseif BulletAngle = 225 Then 'SW

       BulletX = BulletX - 15

       BulletY = BulletY + 15 

     Elseif BulletAngle = 270 Then ' West 

       BulletX = BulletX - 15

     Elseif BulletAngle = 315 Then 'NW

       BulletX = BulletX -15

       BulletY = BulletY -15

     Else 

       BulletAngle = 0

     EndIf 

     Shapes.Move (Bullet, BulletX, BulletY)

     RockDestroy ()

   EndSub

   

   Sub RockDestroy 

     If (BulletX >= BigPosX -25 And BulletX <= BigPosX + 55) And (BulletY >= BigPosY -20 And BulletY <= BigPosY + 55) Then 

       BigRockSub ()

       Score = Score + 20 

       BulletX = -100

       BulletY = -100

       BulletAngle = 315

       

     EndIf 

       

       If (BulletX >= MedPosX -25 And BulletX <= MedPosX + 30) And (BulletY >= MedPosY -25 And BulletY <= MedPosY + 35) Then 

         MedRockSub ()

         Score = Score + 50

       BulletX = -100

       BulletY = -100

       BulletAngle = 315 



       EndIf 

       If (BulletX >= SmlPosX -20 And BulletX <= SmlPosX + 15) And (BulletY >= SmlPosY -25 And BulletY <= SmlPosY + 15) Then

         SmlRockSub ()

         Score = Score + 100

       BulletX = -100

       BulletY = -100

       BulletAngle = 315



       Endif

       If (BulletX >= Big1PosX -25 And BulletX <= Big1PosX + 55) And (BulletY >= Big1PosY -20 And BulletY <= Big1PosY + 55) Then 

       Big1RockSub ()

       Score = Score + 20 

       BulletX = -100

       BulletY = -100

       BulletAngle = 315



     EndIf 

       

       If (BulletX >= Med1PosX -25 And BulletX <= Med1PosX + 30) And (BulletY >= Med1PosY -25 And BulletY <= Med1PosY + 35) Then 

         Med1RockSub ()

         Score = Score + 50

       BulletX = -100

       BulletY = -100

       BulletAngle = 315 



       EndIf 

       If (BulletX >= Sml1PosX -20 And BulletX <= Sml1PosX + 15) And (BulletY >= Sml1PosY -25 And BulletY <= Sml1PosY + 15) Then

         Sml1RockSub ()

         Score = Score + 100

       BulletX = -100

       BulletY = -100

       BulletAngle = 315



         Endif

If (BulletX >= Big2PosX -25 And BulletX <= Big2PosX + 55) And (BulletY >= Big2PosY -20 And BulletY <= Big2PosY + 55) Then 

       Big2RockSub ()

       Score = Score + 20 

       BulletX = -100

       BulletY = -100

       BulletAngle = 315



     EndIf 

       

       If (BulletX >= Med2PosX -25 And BulletX <= Med2PosX + 30) And (BulletY >= Med2PosY -25 And BulletY <= Med2PosY + 35) Then 

         Med2RockSub ()

         Score = Score + 50

       BulletX = -100

       BulletY = -100

       BulletAngle = 315 



       EndIf 

       If (BulletX >= Sml2PosX -20 And BulletX <= Sml2PosX + 15) And (BulletY >= Sml2PosY -25 And BulletY <= Sml2PosY + 15) Then

         Sml2RockSub ()

         Score = Score + 100

       BulletX = -100

       BulletY = -100

       BulletAngle = 315



         Endif

If (BulletX >= Big3PosX -25 And BulletX <= Big3PosX + 55) And (BulletY >= Big3PosY -20 And BulletY <= Big3PosY + 55) Then 

       Big3RockSub ()

       Score = Score + 20 

       BulletX = -100

       BulletY = -100

       BulletAngle = 315



     EndIf 

       

       If (BulletX >= Med3PosX -25 And BulletX <= Med3PosX + 30) And (BulletY >= Med3PosY -25 And BulletY <= Med3PosY + 35) Then 

         Med3RockSub ()

         Score = Score + 50

       BulletX = -100

       BulletY = -100

       BulletAngle = 315 



       EndIf 

       If (BulletX >= Sml3PosX -20 And BulletX <= Sml3PosX + 15) And (BulletY >= Sml3PosY -25 And BulletY <= Sml3PosY + 15) Then

         Sml3RockSub ()

         Score = Score + 100

       BulletX = -100

       BulletY = -100

       BulletAngle = 315



         Endif



EndSub 



Sub HUDSub 

 GraphicsWindow.PenColor = "Black"

GraphicsWindow.PenWidth = "15"

GraphicsWindow.DrawRectangle (0, 418,610, 10) 

GraphicsWindow.BrushColor = "Gold"

If Shields > 0 And Shields < 101 Then 

  GraphicsWindow.DrawBoundText (10, 410, 500 , "Shields at "+Shields+ "% and holding!")

ElseIf Shields < 0 Or Shields > 100 Then 

  GraphicsWindow.DrawBoundText (10, 410, 500 , "Shields Down!")

  Shields = 999999999999999999999999999

Endif





GraphicsWindow.DrawBoundText (520, 410, 200, "Score = "+ Score )

EndSub 


