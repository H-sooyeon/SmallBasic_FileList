'Version 8' uses both rotation and wheel substitution

'This version will encode, save and decode entered text as characters in a limited 96 character set

'Produces all keyboard characters - 96 characters

'returns"~" for unknown character.  Uses proper Delay coding

'Handles CR and LF

'Handles Main Menu options 1,2,3 & 8  All Sub Men Options

'Adds User information

'Adds display option for clear and encoded

'Fixes welcome and menu spacing

TextWindow.ForegroundColor="yellow"

TextWindow.WriteLine(" ")

TextWindow.WriteLine(" ")

TextWindow.WriteLine(" WW  WWW  WWW EEEEEEEE  LLL      CCCCCCC     OOOOOOO    MMM      MMM  EEEEEEE")

TextWindow.WriteLine("  WW WWW WW   EEE       LLL     CC      C   OO     OO   MMM     MMMM  EEE")

TextWindow.WriteLine("  WW WWW WW   EEEEEEEE  LLL    CC          OO       OO  MM MM  MM MM  EEEEE")

TextWindow.WriteLine("   WW   WW    EEE       LLL     CC      C   OO     OO   MM   MM   MM  EEE")

TextWindow.WriteLine("    W   W     EEEEEEEE  LLLLLLL  CCCCCCC     OOOOOOO    MM        MM  EEEEEEE")

TextWindow.WriteLine(" ")

TextWindow.WriteLine(" ")

TextWindow.WriteLine("                              TTTTTTTTT     OOOOOOO")

TextWindow.WriteLine("                                 TTT       OO     OO")

TextWindow.WriteLine("                                 TTT      OO       OO")

TextWindow.WriteLine("                                 TTT       OO     OO")

TextWindow.WriteLine("                                 TTT        OOOOOOO")

TextWindow.WriteLine(" ")

TextWindow.WriteLine(" ")

TextWindow.WriteLine(" ")

TextWindow.WriteLine("            111     0000000              9999999      5555555     7777777")

TextWindow.WriteLine("           1 11    00     00            999   999     555             77")

TextWindow.WriteLine("             11   00       00     ?–„?–„?–„    99999999     555555         77")

TextWindow.WriteLine("             11    00     00                   99         555       77")

TextWindow.WriteLine("          1111111   0000000                    99     555555       77")

TextWindow.WriteLine("Medium Security Demo Version ")

TextWindow.WriteLine("10-296 Serial # - ATL00001                            Copyright 2016 HHE, Inc.")

Beep=Text.GetCharacter(7)

Flipswitch="ROTATE"

Program.Delay(3000)

textwindow.write(Beep)

showclear=0

showcoded=0

authflag=0

menu:

DailyCodeAlpha="A 0 w U"

Blot = "?– "

longblot = "?– ?– ?– >"

beentheredonethat=0

For i = 1 to 16

  TextWindow.WriteLine(" ")

endfor

'Establish vectors

initialize()

'Establish variables

outstack = ""

itemout=" "

vtodecode[1]=" "

itemout=" "

choseoutputfile = 0

chooseoutputdecoded = 0

Flipswitch="ROTATE1"

authflag=0

'Present Menu

TextWindow.WriteLine ("                               MAIN MENU")

TextWindow.WriteLine (" ")

TextWindow.WriteLine ("                 1 - Encode Keyboard Entered Text with save option")

TextWindow.WriteLine (" ")

TextWindow.WriteLine ("                 2 - Decode Current Text")

TextWindow.WriteLine (" ")

TextWindow.WriteLine ("                 3 - Decode a file knowing a Daily Code with save option")

TextWindow.WriteLine (" ")

TextWindow.WriteLine ("                 4 - Select a file to Encode and save")

TextWindow.WriteLine (" ")

TextWindow.WriteLine ("                 5 - Select Program Options")

TextWindow.WriteLine (" ")

TextWindow.WriteLine ("                 7 - User Information - Sorta a READ ME")

TextWindow.WriteLine (" ")

TextWindow.WriteLine ("                 8 - MRST Information & Background")

TextWindow.WriteLine (" ")

TextWindow.WriteLine ("                 9 - EXIT")

For i = 1 To 3

  TextWindow.WriteLine(" ")

EndFor

TextWindow.Write(longblot)

choice =textwindow.Read()



'Main Menu Choices     ************************************************

If choice = 1 then

  goto encodenow

endif

If choice = "2" then

  Goto decode

endif

If choice = "3" then     'Decode a file with a Daily Code

  beentheredonethat=0

  TextWindow.WriteLine (" ")

  TextWindow.WriteLine (" ")

  Wrong:

  'TextWindow.WriteLine("Your unique program code is "+DailyCodeAlpha) 

  TextWindow.Writeline ("Enter complete input File Path of file to dedode: ")

  TextWindow.Writeline ("Enter Key uses Path below ")

  TextWindow.WriteLine ("                Such as - C:\temp\outfile.zap")

  TextWindow.Write     ("                      "+longblot)

  filepath = textwindow.Read()

  If filepath = "" then 

    filepath = "C:\temp\outfile.zap"

    TextWindow.WriteLine ("Using default Filepath - "+filepath) 

  endif

  TextWindow.WriteLine("Using filepath - "+filepath) 

  TextWindow.WriteLine (" ")

  TextWindow.WriteLine ("Enter Daily Numeric Code 1 for this file")

  TextWindow.Write(longblot)

  rotatedelta  =textwindow.Read()

  TextWindow.WriteLine (" ")

  TextWindow.WriteLine("Roger "+rotatedelta)

  TextWindow.WriteLine ("Enter Daily Numeric Code 2 for this file")

  TextWindow.Write(longblot)

  rotatestep  =textwindow.Read()

  TextWindow.WriteLine("Roger "+rotatestep)

  TextWindow.WriteLine (" ")

' The following line could be harmful and has been automatically commented.

'   item =File.ReadContents(FilePath)

  'TextWindow.WriteLine("item -"+item+"---")

  'Text.GetSubText(text, start, length)

  len=Text.GetLength(item)

  'TextWindow.WriteLine("len -"+len)

  'len = len-2

  'TextWindow.WriteLine("len -"+len)

  encoded = Text.GetSubText(item,1,len)

  'TextWindow.WriteLine ("DECODING -"+encoded+"---")

  'encoded = item

  'TextWindow.WriteLine(encoded)

  

  'Text.GetSubText(text, start, length)

  'rotatedelta=text.getsubtext(DailyCode,5,1)

  'TextWindow.WriteLine("rotatedelta-"+rotatedelta)

  'Program.Delay(1000)

  Goto decode

endif

If choice = 4 then

  Goto textmenu

endif

'Main Menu choice 5 - choose show options

If choice = 5 then

  loop51:

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine(" ")

  showclear = 1

  TextWindow.WriteLine("Option is currently set to SHOW clear text that is being encoded")

  TextWindow.WriteLine("Change to NOT SHOW?   Y or N")

  response =TextWindow.Read()

  if response ="N" or response = "n" then

    showclear = 1

    TextWindow.WriteLine("Clear text will BE shown")

    TextWindow.WriteLine("Enter Key to continue")

    response =TextWindow.Read()

    Goto loop52

  endif

  If response ="Y" or response = "y" then 

    showclear = 0

    TextWindow.WriteLine("Clear text will NOT be  shown")

    TextWindow.WriteLine("Enter Key to continue")

    response =TextWindow.Read()

    Goto loop52

  endif

  TextWindow.WriteLine(Beep+Beep+Beep+Beep)

  TextWindow.WriteLine("***********************")

  TextWindow.WriteLine("*****  Try again  *****")

  TextWindow.WriteLine("***********************")

  Goto loop51

  loop52:  

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine(" ")

  showcoded = 1

  TextWindow.WriteLine("Option is currently set to SHOW encoded text produced")

  TextWindow.WriteLine("Change to NOT SHOW?   Y or N")

  response =TextWindow.Read()

  if response ="N" or response = "n" then

    showcoded = 1

    TextWindow.WriteLine("Clear text will BE shown")

    TextWindow.WriteLine("Enter Key to continue")

    response =TextWindow.Read()

    Goto loop53

  endif

  If response ="Y" or response = "y" then 

    showcoded = 0

    TextWindow.WriteLine("Clear text will NOT be  shown")

    TextWindow.WriteLine("Enter Key to continue")

    response =TextWindow.Read()

    Goto loop53

  endif

  TextWindow.WriteLine(Beep+Beep+Beep+Beep)

  TextWindow.WriteLine("***********************")

  TextWindow.WriteLine("*****  Try again  *****")

  TextWindow.WriteLine("***********************")

  Goto loop52

  loop53:  

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine("Option is currently set to NOT generate or require Authentication Code")

  TextWindow.WriteLine("Change to generate and require?   Y or N")

  response =TextWindow.Read()

  if response ="N" or response = "n" then

    authflag = 0

    TextWindow.WriteLine("Authentication Code will NOT be generated and required")

    TextWindow.WriteLine("Enter Key to continue")

    response =TextWindow.Read()

    Goto Appology

  endif  

  If response ="Y" or response = "y" then 

    authflag = 1

    TextWindow.WriteLine("Authentication Code WILL BE be generated and required")

    TextWindow.WriteLine("Enter Key to continue")

    response =TextWindow.Read()

    Goto Appology

    endif

  TextWindow.WriteLine(Beep+Beep+Beep+Beep)

  TextWindow.WriteLine("***********************")

  TextWindow.WriteLine("*****  Try again  *****")

  TextWindow.WriteLine("***********************")

  Goto loop53



  Appology:

  TextWindow.WriteLine("**********************************************")

  TextWindow.WriteLine("********** Options are set...except **********")

  TextWindow.WriteLine("************* Authentication Code ************")

  TextWindow.WriteLine("******* Not available in this version ********")

  TextWindow.WriteLine("**********************************************")

  TextWindow.WriteLine(longblot+longblot+"any me")

  response =TextWindow.Read()

  Goto menu

endif 

'Display instructions

If choice = 7 then

  For i = 1 To 10

    TextWindow.WriteLine(" ")

  EndFor

  TextWindow.WriteLine("                                HHECODE 10-296 ")

  TextWindow.WriteLine("                              DEMONSTRATION VERSION ") 

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine("     This program is intended to be a demonstration of the encryption power")

  TextWindow.WriteLine("of HHECODE.  It only handles keyboard characters and is intended for")

  TextWindow.WriteLine("encryption of simple text messages and text only files.  Although it will")

  TextWindow.WriteLine("handle files of most any size, it's efficiency degrades in a non linear")

  TextWindow.WriteLine("and negative fashion with files over 20K.  10-296 allows you to encrypt")

  TextWindow.WriteLine("keyboard files easily then waste your time and resources on attempting decode.")

  TextWindow.WriteLine("The Gettsburb Address is provided so you have the clear and encoded text.")

  TextWindow.WriteLine("Explore away!")

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine("     The algorithms used are actually simple.  Although 10-957 is written in a")

  TextWindow.WriteLine("high level language, 10-296 is written in Simple Basic.  Enjoy the good old")

  TextWindow.WriteLine("fashion console look. ")

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine("    All versions of HHECODE use Multiple Random Substutional Technology (MRST).")

  TextWindow.WriteLine("MRST is historically rooted in the Jefferson Wheel and WWII Enigma concepts,")

  TextWindow.WriteLine("but enhanced by modern computational capabilities. The 10-957 version provides")

  TextWindow.WriteLine("10 to the power of 957 possible substitutions for a file.  Internal")

  TextWindow.WriteLine("manipulations 10-957 are designed to keep even the largest of Crays busy, but")

  TextWindow.WriteLine("not successful in searching for a decryption algorithm.  10-296 is dicey if the")

  TextWindow.WriteLine("FED's, the boys at Fort Mead or the guys at Langley are after you.")

  For i = 1 To 2

    TextWindow.WriteLine(" ")

  EndFor

  TextWindow.Write(longblot+"ENTER KEY")

  choice =textwindow.Read() 

  For i = 1 To 3

    TextWindow.WriteLine(" ")

  EndFor

  TextWindow.WriteLine("                      SOME OPERATIONAL INFORMATION")  

  TextWindow.WriteLine(" ")  

  TextWindow.WriteLine("    Individual copies of the Demo 10-296 utilize an unalterable Internal")  

  TextWindow.WriteLine("Alpha Designator (IAD).  In both 10-296 and 10-957, only copies of an")  

  TextWindow.WriteLine("individual program are able to encode and decode files for each other. Any")

  TextWindow.WriteLine("program  with a different IAD will not be able to encode or decode files")  

  TextWindow.WriteLine("generated with a mismatched IAD.  The IAD is factory set and cannot be altered")  

  TextWindow.WriteLine("by the user.  The IAD is displayed during some file operations in the 10-296")  

  TextWindow.WriteLine("demonstration version for reference purposes only.  The 10-957 version never")

  TextWindow.WriteLine("reveals the IAD.  No records are maintained of individual IAD?™s in factory")

  TextWindow.WriteLine("produced programs for user security.  The user should safe-guard copies for")

  textwindow.WriteLine("both security and to ensure future operation.")

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine("       By default 10-296 will save files in the root Directory (C:) and")

  TextWindow.WriteLine("sub-directory Temp with an extension of .zap.  Notepad is the correct")

  TextWindow.WriteLine("application to handle a .zap file and should be given the association.")

  TextWindow.WriteLine("10-957 will handle any file extension foe a file of any length up to the")

  TextWindow.WriteLine("size of the user's hard drive.  .zap is a currently unused extension and")

  TextWindow.WriteLine("facilitates identifications of encoded files.  Existing file extensions may")

  TextWindow.WriteLine("be used to provide some level of camouflage for encoded files.")

  For i = 1 To 3

    TextWindow.WriteLine(" ")

  EndFor

  TextWindow.Write(longblot+"ENTER KEY")

  choice =textwindow.Read()

  For i = 1 To 8

    TextWindow.WriteLine(" ")

  EndFor

  TextWindow.WriteLine("                               NUMERICAL CODES")

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine("     They key to any encoded file is the IAD and a sequence of two")  

  TextWindow.WriteLine("user values.  Code Number 1 relates to file internal manipulation.  Code Number")  

  TextWindow.WriteLine(" 1 may have any value, but large numbers yield lower security.  A value of")  

  TextWindow.WriteLine("5% of the file length provides good security and good performance. File")  

  TextWindow.WriteLine("length is displayed to aid in this selection.  Lower numbers may affect")

  TextWindow.WriteLine("performance. Code Number 2 may have any value from 1 to 94.  For undisclosed")

  TextWindow.WriteLine("reasons, an odd number is preferred.  The lower the number is there is")

  textwindow.WriteLine("marginally lower performance with increased security.")

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine("     To aid the user?™s choice of numerical values, performance statistics")

  TextWindow.WriteLine("are shown for each encoding.  Additionally, The Gettysburg Address is")

  TextWindow.WriteLine("provided for personal experimentation purposes.")

  For i = 1 To 5

    TextWindow.WriteLine(" ")

  EndFor

  TextWindow.Write(longblot+"ENTER KEY")

  choice =textwindow.Read()

  For i = 1 To 6

    TextWindow.WriteLine(" ")

  EndFor

  TextWindow.WriteLine("                           KEY HANDLING CONSIDERSATIONS")

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine("     Due to the use of the IAD and the 2 numerical codes this is a dual")

  TextWindow.WriteLine("key system.  The IAD key is provided to the recipent by possession of")

  TextWindow.WriteLine("a copy of the program in the 10-296 version.  The 10-296 IAD is displayed,")

  TextWindow.WriteLine("but cannot be altered by the user.  In the 10-957 version the IAD is never")

  TextWindow.WriteLine("shown and must be known and entered by the recipient . Both keys must be")

  TextWindow.WriteLine("communicated to the recipient in some manner independent of the program.") 

  TextWindow.WriteLine("Users of the program may wish to consult Rudolf Kippenhahn's book")

  TextWindow.WriteLine(" ""Code Breaking"" for creative approaches to key delivery methods.")

  For i = 1 To 2

    TextWindow.WriteLine(" ")

  EndFor

  TextWindow.WriteLine("                           THE THIRD (OPTIONAL) KEY")

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine("     The Authentication Code is an optional level of security.  It must be")

  TextWindow.WriteLine("activated by the user using an options setting.  It is not active in this.")

  TextWindow.WriteLine("version.")

  For i = 1 To 4

    TextWindow.WriteLine(" ")

  EndFor

  TextWindow.Write(longblot+"RETURN TO MAIN MENU")

  choice =textwindow.Read()  

  Goto menu

endif

If choice = "5" then

  Goto library

endif

If choice = "9" then

  Goto getoutoftown

endif

'Wrong Main Menu Choice

insert = " "

For i = 1 to 20

  textwindow.writeline(insert+"You are an idiot who can not read")

  textwindow.write(Beep)

  insert = insert+"."

endfor

textwindow.writeline("Can you manage to hit the any key? ")

TextWindow.WriteLine(" ")

TextWindow.Write(longblot)

choice =textwindow.Read()

Goto menu

'******************************************************************************************************************

'Sub Menu Choices do START OF TEXT SELECTION SUB MENU     ************************************************

textmenu:  

For i=1 to 10

   TextWindow.WriteLine (" ")

endfor

  '  TextWindow.WriteLine("OK for choice 4")

  TextWindow.WriteLine ("                               TEXT SELECTION MENU")

  TextWindow.WriteLine (" ")

  TextWindow.WriteLine ("          1 - Continue with Encode Entered Text & Optinal Save")

  TextWindow.WriteLine (" ")

  TextWindow.WriteLine ("          2 - Demonstration - Encode The Gettysburb Address")

  TextWindow.WriteLine (" ")

  TextWindow.WriteLine ("          3 - Encode an exising .txt file - with save option")

  TextWindow.WriteLine (" ")

  TextWindow.WriteLine ("          9 - [or ENTER] Return to Main Menu")

For i=1 to 9

    TextWindow.WriteLine (" ")

endfor  

  TextWindow.Write(longblot)

  choice =textwindow.Read()

  beentheredonethat=1

For i=1 to 6

    TextWindow.WriteLine (" ")

endfor

  'Text Selection Menu Choice - 1 ' Go on with entry encoding

  If choice=1 then     'Continue with input encode with save option

    Goto encodenow 

 endif

  'Text Selection Choice - 2     'Encode the Gettysburg Address

 If choice = 2 then

    '  Force long string of Gettsburb Address

    stringin="     Four score and seven years ago our fathers brought forth on this continent a new nation, conceived in liberty, and dedicated to the proposition that all men are created equal."

    stringin=stringin+" Now we are engaged in a great civil war, testing whether that nation, or any nation so conceived and so dedicated, can long endure. We are met on a great battlefield of that war. We have come to dedicate a portion of that field, as a final resting place for those who here gave their lives that that nation might live. It is altogether fitting and proper that we should do this."

    stringin =stringin+" But, in a larger sense, we can not dedicate, we can not consecrate, we can not hallow this ground. The brave men, living and dead, who struggled here, have consecrated it, far above our poor power to add or detract. The world will little note, nor long remember what we say here, but it can never forget what they did here. It is for us the living, rather, to be dedicated here to the unfinished work which they who fought here have thus far so nobly advanced. It is rather for us to be here dedicated to the great task remaining before us-that from these honored dead we take increased devotion to that cause for which they gave the last full measure of devotion-that we here highly resolve that these dead shall not have died in vain-that this nation, under God, shall have a new birth of freedom-and that government of the people, by the people, for the people, shall not perish from the earth." 

    Goto encodego

 endif

    'Text Selection Choice - 3     'Encode an existing file

 If choice=3 then

    choseoutputfile = 1

    TextWindow.Writeline ("Enter complete input File Path: ")

    TextWindow.WriteLine ("                    Such as - C:\temp\intest.txt  - ")

    TextWindow.Write("                              ")

    FilePath =textwindow.Read()

    TextWindow.WriteLine (" ")

' The following line could be harmful and has been automatically commented.

'     ' File.ReadContents(filePath)

    ' filePath

    'The full path of the file to read. An example of a full path will be c:\temp\settings.data. 

    'Returns The entire contents of the file. 

' The following line could be harmful and has been automatically commented.

'     item =File.ReadContents(FilePath)

    stringin=item

    len=text.GetLength(stringin)

    If len < 2 then

      TextWindow.Write("INVALD FILE  Any key to continue")

      junk =textwindow.Read()

      Goto Menu

    endif

    TextWindow.WriteLine(len)

    'TextWindow.WriteLine(item)

    If showclear = 1 then

      TextWindow.WriteLine(stringin)

    endif

    'TextWindow.WriteLine("Any Key")

    'junk =textwindow.Read()

    Goto encodego    

 EndIf

If choice = "9" then

  Goto menu

endif

TextWindow.WriteLine("Try Again")

Goto menu

'END OF TEXT SELECTION SUB MENU



encodenow:

'Obtain Text and create vector and set daily code

TextWindow.WriteLine (" ")

TextWindow.Write("Enter Clear Keyboard Text - ")

TextWindow.Write(longblot)

stringin=textwindow.Read()



encodego:

len=Text.GetLength(stringin)

'TextWindow.WriteLine("Text is :"+stringin)

'Set rotate delta

loop5:

TextWindow.WriteLine (" ")

TextWindow.WriteLine("Select Rotate Code - Number 1 ")

TextWindow.WriteLine("Odd number suggested")

TextWindow.WriteLine("Around 5% or less of the text length suggested")

TextWindow.WriteLine("Current Lenght = "+len)

TextWindow.Write(longblot)

rotatedelta =TextWindow.Read()

'TextWindow.WriteLine("Roger that - "+rotatedelta)

loop6:

TextWindow.WriteLine (" ")

TextWindow.WriteLine("Select Shift Code - Number 2")

TextWindow.WriteLine("Small number = high security but lower performance - ")

TextWindow.WriteLine("Must be less than - 95")

TextWindow.Write(longblot)

rotatestep =TextWindow.Read()

If rotatestep > 94 then

  Goto loop6

endif

'TextWindow.WriteLine("Roger that - "+rotatestep)

len=text.GetLength(stringin)

'TextWindow.WriteLine("Daily code is set to - A  J  B  G  "+rotatedelta+"  "+rotatestep)

'TextWindow.WriteLine("Alpha code is your unique program identifier")

TextWindow.WriteLine("******************************************************")

TextWindow.WriteLine("**                                                  **")

TextWindow.WriteLine("**           Remember the numeric values            **")

TextWindow.WriteLine("**   or you will NEVER be able to decode the file   **")

TextWindow.WriteLine("** File will ONLY decode with this specific program **")

TextWindow.WriteLine("**                                                  **")

TextWindow.WriteLine("******************************************************")

TextWindow.WriteLine("ENTER KEY to Continue")

junk =TextWindow.Read()

'get length of input string

goinginMIN=Clock.Minute

goinginM = Clock.Millisecond

goinginS = Clock.Second

len=text.GetLength(stringin)

'read each character in string

TextWindow.Writeline("Vectoring in 500 byte blocks")

For i=1 To len

  Vtext[i]=text.GetSubText(stringin,i,1)

  vtest = Math.Remainder(i, 500)

  If vtest=0 Then

    TextWindow.Write("#")

  endif  

  'TextWindow.WriteLine("len ="+len)

EndFor

TextWindow.WriteLine (" ")

TextWindow.Writeline("Vector finished")

TextWindow.WriteLine("Working in 500 byte translations")

'Encode Vtext

encoded=""

For l=1 To len

  deltatest=Math.Remainder(l, rotatedelta)

  '  TextWindow.Write("deltatest "+deltatest)

  '  TextWindow.Writeline(" l = "+l)

  If deltatest=0 then

           'TextWindow.WriteLine("   Time to rotate Vstat")

           rotateVstat()

    'Sequence-ROTATE1-ROTATE2-Vt0W-ROTATE3-ROTATE4-WtoV-ROTATE1

    'TextWindow.Writeline(l+"-"+Flipswitch)

    If Flipswitch="ROTATE1" Then

      Flipswitch="ROTATE2"

      Goto OUT

    endif

    If Flipswitch = "ROTATE2" then

      Flipswitch ="VtoW"

        For j = 1 to 96

          Vholdvstat[k] = vstat[k]

          vstat[k] = Vwh1[k]

        endfor

      Goto OUT

    endif

    If Flipswitch="VtoW" then

      Flipswitch="ROTATE3"

      Goto out

    endif

    If Flipswitch="ROTATE3" then

      Flipswitch="ROTATE4"

      Goto out

    endif

    If Flipswitch="ROTATE4" then

      Flipswitch="WtoV"

      For k = 1 to 96

        vholdvstat[k] = vstat[k]

        vstat[k] = Vwh1[k]

        Vwh1[k] = Vholdvstat[k]

       endfor

      Goto out

    endif

    If Flipswitch="WtoV" then

      Flipswitch="ROTATE1"

    endif

OUT:   

  Endif

  i=1

  character=Vtext[l]

  'Text.GetCharacterCode(character)

  If text.GetCharacterCode(Vtext[l]) = 13 Then

    addon="Î©"

    Goto invalid

  endif

  If text.GetCharacterCode(Vtext[l]) = 10 Then

    addon="Î±"

    Goto invalid 

  endif

  Validcharacter=Array.ContainsValue(vclear, Vtext[l])

  '  TextWindow.WriteLine(validcharacter)

  If Validcharacter = "False" then

    addon="~"

    Goto Invalid

  endif

  k=0

  h=0

  While vclear[i] <> Vtext[l]

      i=i+1

  EndWhile 

  validok:

  '  TextWindow.WriteLine(i)

  '  TextWindow.WriteLine(vtext[l]+" is now "+vstat[i])

  addon = vstat[i]

  '  TextWindow.Write("addon = "+addon)

  '  TextWindow.WriteLine("vstat i = "+vstat[i])

  encoded=Text.Append(encoded, addon)

  '  TextWindow.WriteLine("encoded = "+encoded)

  Goto ifout

  invalid:

  encoded=text.Append(encoded,addon)

  '  TextWindow.WriteLine(i)

  '  TextWindow.WriteLine(vtext[l]+" is now "+"~")

  ifout:

  deltatest2=Math.Remainder(l, 500)

  If deltatest2 = 0 then

    TextWindow.Write(".")

  Endif  

EndFor

TextWindow.WriteLine(" ")

textwindow.WriteLine("Authentication Code is fixed in this program version")

'textwindow.WriteLine("Are you sure?")

textwindow.WriteLine("Not yet availabe - Under construction - use any key")

TextWindow.Write(longblot)

stringin=textwindow.Read()



'Displays text based on SHOWCLEAR and SHOWCODED



If showclear = 1 then

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine("CLEAR TEXT THAT WAS ENCODED:")

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine(stringin)

  TextWindow.WriteLine(" ")

endif

TextWindow.WriteLine(" ")

If showcoded = 1 then

  TextWindow.WriteLine("ENCODED TEXT:")

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine(encoded)

  TextWindow.WriteLine(" ")

  TextWindow.WriteLine(" ")

Endif

If showclear = 1 then

  TextWindow.WriteLine("Scroll UP for clear text ?†‘?†‘?†‘")

  TextWindow.WriteLine(" ")

Endif  

If showcoded = 1 then

  TextWindow.WriteLine("Scroll UP for encoded text ?†‘?†‘?†‘")

  TextWindow.WriteLine(" ")

ENDIF



goingoutMIN=Clock.Minute

goingoutM=Clock.Millisecond

goingoutS=Clock.Second

'looptime=goingoutM-goinginM

'TextWindow.WriteLine(stringin)

'TextWindow.WriteLine(encoded)

TextWindow.WriteLine(" ")

TextWindow.WriteLine ("Character count is - "+len)

'TextWindow.writeline("Start="+goinginS+"."+goinginM+"  Finish="+goingoutS+"."+goingoutM)

goingin= 60*(goinginMIN) +(goinginS +(goinginM/1000))

goingout=60*(goingoutmin)+(goingoutS+(goingoutM/1000))

looptime=(goingout-goingin)

TextWindow.WriteLine("Time Performance Analysis:")

TextWindow.WriteLine("Start ="+goingin+"   Finish = "+goingout+"    Lapsed Time = "+looptime+" seconds")

If looptime=0 then

  Goto SaveFile

endif

timeperbyte=looptime/len

performance=timeperbyte

perbyte=Text.GetSubText(performance, 1, 13)

TextWindow.WriteLine(performance+" seconds/byte")

mega=performance*1000

mega1=Text.GetSubText(mega, 1, 8)

TextWindow.Writeline (mega1+" seconds per kilobyte")

mega=mega*1000

mega=mega/60

mega = Text.GetSubText(mega, 1, 6)

TextWindow.Writeline (mega+" minutes per megabyte")

SaveFile:

'Save to file

'file.writecontents(C:\Users\JPH\Documents\codedata.txt, encoded)

' The following line could be harmful and has been automatically commented.

' 'File.WriteContents(filePath, contents)

beentheredonethat=0

Decide1:

TextWindow.WriteLine(" ")

TextWindow.WriteLine(" ")

TextWindow.WriteLine("Save the encoded file Y or N")

TextWindow.WriteLine(" ")

TextWindow.Write("Your Choice? "+longblot)

'Enter Subroutine

choice =TextWindow.Read()

Fileoutflag = 0

If choice = "Y" or choice = "y" then

  Fileoutflag = 1

endif

If choice = "N" or choice = "n" then

  Fileoutflag = 2

endif

'Exit Potential Subroutine

If Fileoutflag = 0 then

  TextWindow.WriteLine("Try again")

  TextWindow.WriteLine("I said.......")

  TextWindow.WriteLine(" ")

  Goto Decide1

endif

If Fileoutflag = 1 then

  TextWindow.WriteLine("Select output file")

  TextWindow.WriteLine("Such as  C:\temp\outfile.zap")

  TextWindow.WriteLine("Enter key only will use C:\temp\outfile.zap")

  TextWindow.Write    ("                    "+longblot)

  filepath =TextWindow.Read()

  If filepath = "" then

    filepath = "C:\temp\outfile.zap"

  endif

' The following line could be harmful and has been automatically commented.

'   'File.WriteContents(filePath, contents)

  'Returns if the operation was successful, this will return "SUCCESS". Otherwise, it will return "FAILED".

' The following line could be harmful and has been automatically commented.

'   checkfile = File.WriteContents(FilePath,encoded)

  TextWindow.WriteLine(checkfile+" SAVED as "+filepath)

  Goto menu

endif

If Fileoutflag = 2 then 

  Goto menu

endif



Goto menu

'******************************************************************************************************************

decode:

TextWindow.WriteLine("Entering decode:")

len=Text.GetLength(encoded)

'TextWindow.WriteLine("len -  " + len)

'TextWindow.WriteLine("encoded length = "+elen)

outstack = ""

TextWindow.WriteLine("Decode Key is set to - A  J  B  G  "+rotatedelta+"  "+rotatestep)

For i = len To 1 Step -1

  byte=Text.GetSubText(encoded, i, 1)

  'TextWindow.Write(byte)

  Stack.PushValue(outstack, byte)

endfor

'TextWindow.WriteLine("Out of stack")

For i=1 to len

  vtodecode[i]=Stack.PopValue(outstack)

  'TextWindow.WriteLine(" ")

  'TextWindow.Write(vtodecode[i])

endfor

TextWindow.WriteLine(" ")

vclear[1]=" "

For i=1 to len

  deltatest=Math.Remainder(i, rotatedelta)

  '  TextWindow.Write("deltatest "+deltatest)

  '  TextWindow.Writeline(" l = "+l)

  If deltatest=0 then

       'TextWindow.WriteLine("   Time to rotate Vstat")

rotateVstat()

    'Sequence-ROTATE1-ROTATE2-Vt0W-ROTATE3-ROTATE4-WtoV-ROTATE1

    'TextWindow.writeline("............")

    'Flipswitch="ROTATE1" on return to Main Menu

    If Flipswitch="ROTATE1" Then

      Flipswitch="ROTATE2"

      Goto OUTD

    endif

    If Flipswitch = "ROTATE2" then

      Flipswitch ="VtoW"

        For j = 1 to 96

          Vholdvstat[k] = vstat[k]

          vstat[k] = Vwh1[k]

        endfor

      Goto OUTD

    endif

    If Flipswitch="VtoW" then

      Flipswitch="ROTATE3"

      Goto outD

    endif

    If Flipswitch="ROTATE3" then

      Flipswitch="ROTATE4"

      Goto outD

    endif

    If Flipswitch="ROTATE4" then

      Flipswitch="WtoV"

      For k = 1 to 96

        vholdvstat[k] = vstat[k]

        vstat[k] = Vwh1[k]

        Vwh1[k] = Vholdvstat[k]

       endfor

      Goto outD

    endif

    If Flipswitch="WtoV" then

      Flipswitch="ROTATE1"

    endif

OUTD:      

       

  Endif

  if vtodecode[i] = "Î©" then

    'Text.GetCharacter(characterCode)

    vdecoded[i] = Text.GetCharacter(13)

    Goto jump1

  endif

  if vtodecode[i] = "Î±" then

    vdecoded[i] = Text.GetCharacter(10)

    Goto jump1

  endif

  

  l=0

  vclearlookup()

  vdecoded[i]=vclear[l]

  jump1:

  '  TextWindow.Writeline("  decode-"+vclear[l])

endfor

TextWindow.WriteLine(" ")

'TextWindow.WriteLine("len -  " + len) ]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]

'show selection check needed

TextWindow.WriteLine("DECODED:")

Cleartext = ""

For i=1 to len

  TextWindow.Write(vdecoded[i])

  Cleartext = Cleartext + vdecoded[i]

endfor

TextWindow.WriteLine(" ")

decide2:

TextWindow.WriteLine(" ")

TextWindow.WriteLine("Save the decoded text?   Y or N")

TextWindow.Write(longblot)

response =TextWindow.Read()

if response ="N" or response = "n" then

  TextWindow.WriteLine("NO SAVE")

  Goto menu

endif

If response = "Y" Or response = "y" then

  TextWindow.WriteLine("Select output file")

  TextWindow.WriteLine("Such as  C:\temp\cleartext.txt")

  TextWindow.WriteLine("Enter key only will use C:\temp\cleartext.txt")

  TextWindow.Write    ("                    "+longblot)

  filepath =TextWindow.Read()

  If filepath = "" then

    filepath = "C:\temp\cleartext.txt"

  endif

' The following line could be harmful and has been automatically commented.

'   'File.WriteContents(filePath, contents)

  'Returns if the operation was successful, this will return "SUCCESS". Otherwise, it will return "FAILED".

' The following line could be harmful and has been automatically commented.

'   checkfile = File.WriteContents(FilePath,cleartext)

  TextWindow.WriteLine(checkfile+" SAVED as "+filepath)

  Goto menu

endif



Goto decide2

'beentheredonethat=1

TextWindow.WriteLine(" ")

TextWindow.WriteLine(" ")

Goto menu

'******************************************************************************************************************

Library:

TextWindow.WriteLine("     HHECODE utilizes a Multipe Rotating Scramble Technology (MRST)")

TextWindow.WriteLine("yielding up to 10 the power of 957 data encoding combinational")

TextWindow.WriteLine("possibilities for encoding data.  That's a 1 with 957 zeros behind it.")

TextWindow.WriteLine(" ")

TextWindow.WriteLine("     It is projected that a even a Cray XT3 will have dificutly cracking")

TextWindow.WriteLine("this code in a lifetime of continuous processing.")

TextWindow.WriteLine(" ")

TextWindow.WriteLine("     Presented here are a few of the combinational possibitities for your")

TextWindow.WriteLine("edification and amusement.  They will be different ever time you look.")

TextWindow.WriteLine(" ")

TextWindow.WriteLine("     Each HHE program has an embedded unique set of scramble algorithms.")

TextWindow.WriteLine("The version you have (10-296) does not have the higest level of combinationals.")

TextWindow.WriteLine("For higher protection you need the 957 to the power of 10 version.")

TextWindow.WriteLine("All versions use a dual key system.  One of the keys is factory set and")

TextWindow.WriteLine("unique to each individual product.  Only copies of the original product")

TextWindow.WriteLine("can communicate with each other. ")

TextWindow.WriteLine(" ")

TextWindow.WriteLine("Any key time")

junk =TextWindow.Read()

TextWindow.WriteLine("A Sample  3  2  1")

Program.Delay(500)

TextWindow.WriteLine("3"+Beep)

Program.Delay(500)

TextWindow.WriteLine("2"+Beep)

Program.Delay(500)

TextWindow.WriteLine("1"+Beep)

'Use Vclear in initialized  wheel library

for num = 2 to 20

  For i = 1 To 94

    sump[i][1]=vclear[i]

    sump[i][num]=vclear[i]

  EndFor

endfor

'Math.GetRandomNumber(maxNumber)

'get non equals

For num=2 To 20

  for i = 1 To 94

    swap:

    position1=math.GetRandomNumber(94)

    position2=math.GetRandomNumber(94)

    '  TextWindow.WriteLine(position1+"  - "+position2)

    If position1=position2 Then 

      goto swap

    endif

    hold=sump[position1][num]

    sump[position1][num]=sump[position2][num]

    sump[position2][num]=hold

  endfor

endfor

TextWindow.WriteLine(" ")

textwindow.WriteLine("There are:")

textwindow.WriteLine("1.2413915592536E+296")

textwindow.WriteLine("Possible rearrangements of the 96 keyboard characters")

For i = 1 To 75

  textwindow.write(sump[i][1])

EndFor

textwindow.write("...>")

TextWindow.WriteLine(" ")

TextWindow.WriteLine(" ")

for num=2 to 17

  For i = 1 To 74

    TextWindow.Write(sump[i][num])

  endfor

  textwindow.write("...>")

  TextWindow.WriteLine(" ")

endfor

TextWindow.WriteLine(" ")

TextWindow.WriteLine("Use the ever popular any key to continue ")

junk=textwindow.Read()

For i = 1 to 20

  TextWindow.WriteLine(" ")

endfor

beentheredonethat=1

Goto menu

'******************************************************************************************************************

'Subroutines are all stored here in one place

'******************************************************************************************************************

Sub vclearlookup

  '  TextWindow.Write("to decode-"+vtodecode[i])

  While vtodecode[i] <> vstat[l]

    l=l+1

  endwhile    

endsub

'******************************************************************************************************************



'******************************************************************************************************************

Sub rotateVstat

  '  textwindow.writeline("Entering Vstat rotation")

  '  for i=1 to 48

  '  TextWindow.Write(vstat[i])

  '  endfor

  For k=1 To rotatestep+1

    Vhold[k]=vstat[k]

  endfor 

  For k=rotatestep to 95

    vstat[k-rotatestep+1] = vstat[k+1]

  endfor

  h=1

  For k=95-rotatestep+1 To 95

    vstat[k]=vhold[h]

    h=h+1

  endfor

  '  for k=1 to 48

  '    TextWindow.Write(vstat[k])

  '  endfor

  '    TextWindow.WriteLine(" ")

endsub

'******************************************************************************************************************

Sub initialize

  'Establish vectors

  'Sets  values for Vhold,  vclear,  vstat,  Vwh1,  Vholdvstat &  VholdVwh1

  'Holding vector for step

  For k =1 to 96

    Vhold[k]="~"

    Vholdvstat[k]="~"

    VholdVwh1[k]="~"

  Endfor

  

  'Clear text vector xclear 

  

  vclear[1]=" "

  vclear[2]="!"

  vclear[3]="?– "

  vclear[4]="#"

  vclear[5]="$"

  vclear[6]="%"

  vclear[7]="&"

  vclear[8]="'"

  vclear[9]="("

  vclear[10]=")"

  vclear[11]="*"

  vclear[12]="+"

  vclear[13]=","

  vclear[14]="-"

  vclear[15]="."

  vclear[16]="/"

  vclear[17]="0"

  vclear[18]="1"

  vclear[19]="2"

  vclear[20]="3"

  vclear[21]="4"

  vclear[22]="5"

  vclear[23]="6"

  vclear[24]="7"

  vclear[25]="8"

  vclear[26]="9"

  vclear[27]=":"

  vclear[28]=";"

  vclear[29]="<"

  vclear[30]="="

  vclear[31]=">"

  vclear[32]="?"

  vclear[33]="@"

  vclear[34]="A"

  vclear[35]="B"

  vclear[36]="C"

  vclear[37]="D"

  vclear[38]="E"

  vclear[39]="F"

  vclear[40]="G"

  vclear[41]="H"

  vclear[42]="I"

  vclear[43]="J"

  vclear[44]="K"

  vclear[45]="L"

  vclear[46]="M"

  vclear[47]="N"

  vclear[48]="O"

  vclear[49]="P"

  vclear[50]="Q"

  vclear[51]="R"

  vclear[52]="S"

  vclear[53]="T"

  vclear[54]="U"

  vclear[55]="V"

  vclear[56]="W"

  vclear[57]="X"

  vclear[58]="Y"

  vclear[59]="Z"

  vclear[60]="["

  vclear[61]="\"

  vclear[62]="]"

  vclear[63]="^"

  vclear[64]="_"

  vclear[65]="`"

  vclear[66]="a"

  vclear[67]="b"

  vclear[68]="c"

  vclear[69]="d"

  vclear[70]="e"

  vclear[71]="f"

  vclear[72]="g"

  vclear[73]="h"

  vclear[74]="i"

  vclear[75]="j"

  vclear[76]="k"

  vclear[77]="l"

  vclear[78]="m"

  vclear[79]="n"

  vclear[80]="o"

  vclear[81]="p"

  vclear[82]="q"

  vclear[83]="r"

  vclear[84]="s"

  vclear[85]="t"

  vclear[86]="u"

  vclear[87]="v"

  vclear[88]="w"

  vclear[89]="x"

  vclear[90]="y"

  vclear[91]="z"

  vclear[92]="{"

  vclear[93]="|"

  vclear[94]="}"

  vclear[95]="~"

  vclear[96]="??"

  'Create station vector - vstat

  vstat[1]="0"

  vstat[2]="w"

  vstat[3]="U"

  vstat[4]="T"

  vstat[5]="7"

  vstat[6]="I"

  vstat[7]="D"

  vstat[8]="/"

  vstat[9]="u"

  vstat[10]=":"

  vstat[11]="Y"

  vstat[12]="4"

  vstat[13]="c"

  vstat[14]="y"

  vstat[15]="%"

  vstat[16]="M"

  vstat[17]=")"

  vstat[18]="j"

  vstat[19]="!"

  vstat[20]="X"

  vstat[21]="#"

  vstat[22]="^"

  vstat[23]="k"

  vstat[24]="?– "

  vstat[25]="l"

  vstat[26]="1"

  vstat[27]="-"

  vstat[28]="W"

  vstat[29]="d"

  vstat[30]="C"

  vstat[31]="L"

  vstat[32]="n"

  vstat[33]="Q"

  vstat[34]="K"

  vstat[35]="|"

  vstat[36]="z"

  vstat[37]="3"

  vstat[38]="O"

  vstat[39]="&"

  vstat[40]=";"

  vstat[41]=" "

  vstat[42]="["

  vstat[43]=","

  vstat[44]="s"

  vstat[45]="{"

  vstat[46]="}"

  vstat[47]="?"

  vstat[48]="="

  vstat[49]="G"

  vstat[50]="F"

  vstat[51]="."

  vstat[52]="*"

  vstat[53]="$"

  vstat[54]="A"

  vstat[55]="v"

  vstat[56]="N"

  vstat[57]="t"

  vstat[58]="i"

  vstat[59]="P"

  vstat[60]="E"

  vstat[61]="8"

  vstat[62]="J"

  vstat[63]="m"

  vstat[64]="S"

  vstat[65]="]"

  vstat[66]="~"

  vstat[67]="'"

  vstat[68]="("

  vstat[69]="o"

  vstat[70]="6"

  vstat[71]="q"

  vstat[72]="9"

  vstat[73]="e"

  vstat[74]="@"

  vstat[75]="R"

  vstat[76]="\"

  vstat[77]="2"

  vstat[78]="5"

  vstat[79]=">"

  vstat[80]="h"

  vstat[81]="x"

  vstat[82]="H"

  vstat[83]="<"

  vstat[84]="B"

  vstat[85]="+"

  vstat[86]="`"

  vstat[87]="b"

  vstat[88]="p"

  vstat[89]="Z"

  vstat[90]="g"

  vstat[91]="a"

  vstat[92]="V"

  vstat[93]="_"

  vstat[94]="f"

  vstat[95]="r"

  vstat[96]="??"

  

  'Create vector for wheel  vwh1

Vwh1[1]="K"

Vwh1[2]="?– "

Vwh1[3]="c"

Vwh1[4]="i"

Vwh1[5]="7"

Vwh1[6]="r"

Vwh1[7]="^"

Vwh1[8]="1"

Vwh1[9]="A"

Vwh1[10]="9"

Vwh1[11]="g"

Vwh1[12]="q"

Vwh1[13]="%"

Vwh1[14]="N"

Vwh1[15]="3"

Vwh1[16]="."

Vwh1[17]="b"

Vwh1[18]="T"

Vwh1[19]="~"

Vwh1[20]="+"

Vwh1[21]="!"

Vwh1[22]="<"

Vwh1[23]="'"

Vwh1[24]=")"

Vwh1[25]="R"

Vwh1[26]="a"

Vwh1[27]="p"

Vwh1[28]="f"

Vwh1[29]="U"

Vwh1[30]="*"

Vwh1[31]="Q"

Vwh1[32]="w"

Vwh1[33]="2"

Vwh1[34]="B"

Vwh1[35]="G"

Vwh1[36]="X"

Vwh1[37]="F"

Vwh1[38]="?"

Vwh1[39]="C"

Vwh1[40]="["

Vwh1[41]="??"

Vwh1[42]="#"

Vwh1[43]="j"

Vwh1[44]="v"

Vwh1[45]="k"

Vwh1[46]="]"

Vwh1[47]="n"

Vwh1[48]=","

Vwh1[49]="d"

Vwh1[50]="x"

Vwh1[51]="l"

Vwh1[52]="`"

Vwh1[53]=":"

Vwh1[54]="L"

Vwh1[55]="s"

Vwh1[56]="o"

Vwh1[57]="H"

Vwh1[58]="/"

Vwh1[59]="Z"

Vwh1[60]="5"

Vwh1[61]="y"

Vwh1[62]=">"

Vwh1[63]="$"

Vwh1[64]="E"

Vwh1[65]="S"

Vwh1[66]="J"

Vwh1[67]="M"

Vwh1[68]="Y"

Vwh1[69]="V"

Vwh1[70]="("

Vwh1[71]="6"

Vwh1[72]="{"

Vwh1[73]="O"

Vwh1[74]="4"

Vwh1[75]="-"

Vwh1[76]="_"

Vwh1[77]="I"

Vwh1[78]="="

Vwh1[79]="m"

Vwh1[80]="W"

Vwh1[81]="\"

Vwh1[82]="0"

Vwh1[83]="}"

Vwh1[84]=";"

Vwh1[85]="t"

Vwh1[86]=" "

Vwh1[87]="u"

Vwh1[88]="e"

Vwh1[89]="D"

Vwh1[90]="h"

Vwh1[91]="@"

Vwh1[92]="|"

Vwh1[93]="&"

Vwh1[94]="P"

Vwh1[95]="z"

Vwh1[96]="8"



EndSub

'******************************************************************************************************************

Getoutoftown:

For I= 1 To 20

  TextWindow.WriteLine(" ")

EndFor

TextWindow.WriteLine("                    EEEEEEEE        OOOOOOO0          JJJJJJJJJ")

TextWindow.WriteLine("                    EEE            OO       OO            JJ")

TextWindow.WriteLine("                    EEEEEEEE      OO         OO           JJ")

TextWindow.WriteLine("                    EEEEEEEE      OO         OO           JJ")

TextWindow.WriteLine("                    EEE            OO       OO            JJ")

TextWindow.WriteLine("                    EEE             OO     OO         JJ  JJ")

TextWindow.WriteLine("                    EEEEEEEE         OOOOOOO           JJJJ")

TextWindow.WriteLine(" ")

TextWindow.WriteLine(Beep+Beep+Beep+Beep)

Program.Delay(1200)

TextWindow.WriteLine(Beep+Beep+Beep+Beep)

Program.Delay(1200)

TextWindow.WriteLine(Beep)

Program.Delay(1000)

Program.End()


