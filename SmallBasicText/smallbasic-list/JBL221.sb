ndtt=108 '----------- number of  axedots*2
GraphicsWindow.Width=750
GraphicsWindow.Height =750
GraphicsWindow.Left =10
GraphicsWindow.Top =10
GraphicsWindow.MouseMove =mwwq
LDUtilities.ShowNoShapeErrors="false
LDUtilities.ShowErrors="false
GraphicsWindow.BackgroundColor="Darkblue
args=0
ccc=ldtext.Split("#00cc00 #00bb00 #00ee00"," ")
cc1=ldtext.Split("Gold Yellow Pink"," ")
gucktheta=math.GetRadians ( 85)
th=85
guckphi=0
pi=Math.pi
T_="true
F_="false
hlf=T_
axx=F_

bw=700
bh=bw
dd=25
ee=shapes.AddEllipse ( bw,bw)
Shapes.Move (ee,dd,dd)
LDShapes .BrushColour(ee,LDColours.HSLtoRGB (180,.8,.2))
LDDialogs.AddRightClickMenu ("1=halfdome;2=fullglobe;3=AxesON;4=AxesOFF","")
LDDialogs.RightClickMenu=rmnn

mapp()
s5=15
ndt2=ndtt/2
GraphicsWindow.Title = "Wait... "
r5=10
For f=1 to 408
  iss[f]=shapes.AddEllipse  (r5,r5)
  LDShapes.BrushColour (iss[f],ccc[Math.Remainder (n,3)+1])
  LDShapes.PenWidth (iss[f],0) 
  fss[6][f]=LDFastShapes.ShapeIndex (iss[f])
  ir=math.GetRadians (wmp[f][1]/2.777)
  jr=math.GetRadians   (wmp[f][2]/4.5-85)
  
  x1[6][f]=wmp[f][1]/2.777
  y1[6][f]=wmp[f][2]/4.5-85
  LDFastShapes.Move (fss[6][f],ldcall.Function3 ("kx",1,jr,ir), ldcall.Function3 ("ky",1,jr,ir))
endfor 
LDFastShapes.Update ()

For f=0 to 5
  for n=1 to ndt2+1
    
    x1[f][n]=0
    y1[f][n]=n*s5
    ir=math.GetRadians (x1[f][n]*10)
    jr=math.GetRadians   ((y1[f][n]-100)/s5-70)
    r5=3+8*(ndt2-math.Abs(ndt2/2-n))/ndt2
    ss[f][n]=shapes.AddEllipse  (r5,r5)
    LDShapes.BrushColour (ss[f][n],cc1[Math.Remainder (n,3)+1])
    LDShapes.PenWidth (ss[f][n],0) 
    fss[f][n]=LDFastShapes.ShapeIndex (ss[f][n]) 
    
  Endfor
  GraphicsWindow.Title = "Done "+(f+1)*16.6+"%"
  
endfor
GraphicsWindow.Title = "Spin the wheel..."
LDEvents.MouseWheel =mww
While 1=1
  For mm=0 to 360 step 0.5
    For f=0 to 6
      If f=6 Then
        qq=425
      Else
        qq=ndt2*3
        
        
      endif
      For n=1 to qq
        If axx And f<6  Then
          LDFastShapes.showShape (fss[f][n])
        ElseIf f<6 then
          LDFastShapes.HideShape (fss[f][n])
          
        endif
        If f=6 Then
          ir=math.GetRadians (mm+x1[6][n])
          jr=math.GetRadians(y1[6][n])
          If hlf then
            If math.Remainder ( mm+x1[6][n],360)>90 and math.Remainder (mm+x1[6][n],360)<270 then
              ldShapes.ZIndex(iss[n],-1000-n) 
            Else
              ldShapes.ZIndex(iss[n],1000+n)
            endif
          else
            ldShapes.ZIndex(iss[n],1000+n)
          endif
        ElseIf f=4 or f=5 then
          jr=0
          ir=math.GetRadians (mm+n*5+(f-4)*180)
        else
          ir=math.GetRadians (mm+x1[f][n]/5+f*90)
          jr=math.GetRadians((y1[f][n]-100)/5-70.7)
        endif
        LDFastShapes.Move (fss[f][n],ldcall.Function3 ("kx",1,jr,ir), ldcall.Function3 ("ky",1,jr,ir)+1)
        LDFastShapes.SetOpacity (fss[f][n],20+math.Abs(100-(f*40))*0.8)
      endfor
    endfor  
    LDFastShapes.Update ()
    Program.Delay (5)
    
  endfor
endwhile

Sub rmnn
  rr= LDDialogs.LastRightClickMenuItem 
  If rr=1 Then
    hlf=T_ 
  ElseIf rr=2 Then
    hlf=F_
  ElseIf rr=3 Then
    axx=T_
  ElseIf rr=4 Then
    axx=F_
  endif
EndSub 

Sub mwwq
 ' GraphicsWindow.Title=GraphicsWindow.MouseX +" | "+GraphicsWindow.MouseY  
endsub
sub kx'(r,theta,phi)
  qr=args[1]
  theta=args[2]
  phi=args[3]
  qx=qr*math.cos(theta)*math.cos(phi)
  qy=qr*math.cos(theta)*math.sin(phi)
  qz=qr*math.sin(theta)
  qx=math.sin(guckphi)*qx+math.cos(guckphi)*qy
  RETURN= bw/2+qx*bw/2+dd
ENDsub

sub ky'(r,theta,phi)
  qr=args[1]
  theta=args[2]
  phi=args[3]  
  qx=qr*math.cos(theta)*math.cos(phi)
  qy=qr*math.cos(theta)*math.sin(phi)
  qz=qr*math.sin(theta)
  qy=math.cos(guckphi)*qx-math.sin(guckphi)*qy
  qz=math.cos(gucktheta)*qy-math.sin(gucktheta)*qz
  RETURN= bh/2-qz*bh/2+dd
ENDsub

Sub mww
  th=th+ LDEvents.LastMouseWheelDelta*3
  gucktheta=math.GetRadians ( th)
EndSub 

Sub mapp
  wmp="1=1\=59\;2\=103\;;2=1\=44\;2\=112\;;3=1\=32\;2\=124\;;4=1\=39\;2\=145\;;5=1\=35\;2\=165\;;6=1\=45\;2\=187\;;7=1\=63\;2\=199\;;8=1\=78\;2\=179\;;9=1\=91\;2\=175\;;10=1\=114\;2\=188\;;11=1\=129\;2\=206\;;12=1\=139\;2\=225\;;13=1\=152\;2\=252\;;14=1\=153\;2\=273\;;15=1\=171\;2\=299\;;16=1\=188\;2\=319\;;17=1\=206\;2\=337\;;18=1\=227\;2\=349\;;19=1\=245\;2\=357\;;20=1\=262\;2\=369\;;21=1\=277\;2\=378\;;22=1\=266\;2\=355\;;23=1\=251\;2\=343\;;24=1\=245\;2\=335\;;25=1\=231\;2\=339\;;26=1\=226\;2\=323\;;27=1\=231\;2\=307\;;28=1\=247\;2\=305\;;29=1\=259\;2\=306\;;30=1\=269\;2\=319\;;31=1\=263\;2\=331\;;32=1\=280\;2\=335\;;33=1\=291\;2\=339\;;34=1\=275\;2\=293\;;35=1\=289\;2\=277\;;36=1\=305\;2\=254\;;37=1\=327\;2\=243\;;38=1\=348\;2\=231\;;39=1\=334\;2\=212\;;40=1\=320\;2\=195\;;41=1\=307\;2\=183\;;42=1\=296\;2\=173\;;43=1\=282\;2\=164\;;44=1\=279\;2\=187\;;45=1\=274\;2\=212\;;46=1\=263\;2\=208\;;47=1\=253\;2\=199\;;48=1\=236\;2\=190\;;49=1\=228\;2\=175\;;50=1\=230\;2\=166\;;51=1\=245\;2\=154\;;52=1\=253\;2\=151\;;53=1\=273\;2\=158\;;54=1\=266\;2\=144\;;55=1\=266\;2\=136\;;56=1\=270\;2\=120\;;57=1\=276\;2\=112\;;58=1\=290\;2\=122\;;59=1\=291\;2\=133\;;60=1\=287\;2\=149\;;61=1\=301\;2\=163\;;62=1\=310\;2\=170\;;63=1\=317\;2\=159\;;64=1\=319\;2\=147\;;65=1\=312\;2\=127\;;66=1\=299\;2\=108\;;67=1\=289\;2\=98\;;68=1\=269\;2\=75\;;69=1\=251\;2\=76\;;70=1\=236\;2\=94\;;71=1\=229\;2\=101\;;72=1\=220\;2\=112\;;73=1\=210\;2\=113\;;74=1\=198\;2\=96\;;75=1\=194\;2\=90\;;76=1\=175\;2\=83\;;77=1\=151\;2\=81\;;78=1\=154\;2\=98\;;79=1\=176\;2\=111\;;80=1\=169\;2\=119\;;81=1\=150\;2\=112\;;82=1\=128\;2\=116\;;83=1\=111\;2\=120\;;84=1\=96\;2\=114\;;85=1\=78\;2\=111\;;86=1\=287\;2\=368\;;87=1\=303\;2\=361\;;88=1\=317\;2\=365\;;89=1\=333\;2\=375\;;90=1\=351\;2\=388\;;91=1\=372\;2\=402\;;92=1\=385\;2\=407\;;93=1\=394\;2\=416\;;94=1\=385\;2\=436\;;95=1\=376\;2\=458\;;96=1\=363\;2\=470\;;97=1\=345\;2\=493\;;98=1\=334\;2\=506\;;99=1\=319\;2\=526\;;100=1\=310\;2\=544\;;101=1\=308\;2\=568\;;102=1\=308\;2\=582\;;103=1\=292\;2\=571\;;104=1\=278\;2\=541\;;105=1\=284\;2\=560\;;106=1\=285\;2\=519\;;107=1\=293\;2\=496\;;108=1\=296\;2\=461\;;109=1\=296\;2\=442\;;110=1\=282\;2\=429\;;111=1\=268\;2\=410\;;112=1\=268\;2\=389\;;113=1\=0\;2\=768\;;114=1\=32\;2\=773\;;115=1\=64\;2\=752\;;116=1\=90\;2\=736\;;117=1\=124\;2\=721\;;118=1\=159\;2\=707\;;119=1\=196\;2\=725\;;120=1\=213\;2\=693\;;121=1\=245\;2\=699\;;122=1\=273\;2\=706\;;123=1\=294\;2\=710\;;124=1\=297\;2\=678\;;125=1\=313\;2\=650\;;126=1\=328\;2\=633\;;127=1\=325\;2\=675\;;128=1\=326\;2\=716\;;129=1\=352\;2\=751\;;130=1\=386\;2\=761\;;131=1\=414\;2\=744\;;132=1\=437\;2\=712\;;133=1\=459\;2\=690\;;134=1\=489\;2\=678\;;135=1\=523\;2\=682\;;136=1\=556\;2\=680\;;137=1\=574\;2\=677\;;138=1\=601\;2\=674\;;139=1\=620\;2\=659\;;140=1\=644\;2\=649\;;141=1\=679\;2\=662\;;142=1\=703\;2\=674\;;143=1\=723\;2\=660\;;144=1\=763\;2\=653\;;145=1\=786\;2\=647\;;146=1\=820\;2\=655\;;147=1\=851\;2\=648\;;148=1\=883\;2\=642\;;149=1\=909\;2\=655\;;150=1\=934\;2\=669\;;151=1\=959\;2\=686\;;152=1\=964\;2\=706\;;153=1\=948\;2\=728\;;154=1\=945\;2\=747\;;155=1\=954\;2\=759\;;156=1\=969\;2\=751\;;157=1\=992\;2\=761\;;158=1\=959\;2\=545\;;159=1\=974\;2\=532\;;160=1\=983\;2\=519\;;161=1\=996\;2\=508\;;162=1\=984\;2\=506\;;163=1\=902\;2\=528\;;164=1\=910\;2\=509\;;165=1\=917\;2\=493\;;166=1\=921\;2\=483\;;167=1\=924\;2\=468\;;168=1\=911\;2\=454\;;169=1\=904\;2\=443\;;170=1\=892\;2\=428\;;171=1\=889\;2\=442\;;172=1\=885\;2\=446\;;173=1\=880\;2\=442\;;174=1\=875\;2\=437\;;175=1\=870\;2\=433\;;176=1\=859\;2\=434\;;177=1\=851\;2\=444\;;178=1\=837\;2\=447\;;179=1\=824\;2\=452\;;180=1\=813\;2\=463\;;181=1\=814\;2\=483\;;182=1\=817\;2\=503\;;183=1\=840\;2\=496\;;184=1\=861\;2\=489\;;185=1\=875\;2\=497\;;186=1\=894\;2\=513\;;187=1\=769\;2\=367\;;188=1\=771\;2\=387\;;189=1\=779\;2\=406\;;190=1\=807\;2\=415\;;191=1\=826\;2\=419\;;192=1\=844\;2\=419\;;193=1\=783\;2\=389\;;194=1\=805\;2\=396\;;195=1\=815\;2\=405\;;196=1\=822\;2\=378\;;197=1\=811\;2\=389\;;198=1\=830\;2\=347\;;199=1\=843\;2\=366\;;200=1\=849\;2\=377\;;201=1\=856\;2\=403\;;202=1\=870\;2\=403\;;203=1\=889\;2\=413\;;204=1\=900\;2\=420\;;205=1\=917\;2\=409\;;206=1\=938\;2\=419\;;207=1\=882\;2\=403\;;208=1\=900\;2\=408\;;209=1\=857\;2\=300\;;210=1\=868\;2\=291\;;211=1\=883\;2\=282\;;212=1\=889\;2\=262\;;213=1\=895\;2\=244\;;214=1\=895\;2\=227\;;215=1\=892\;2\=218\;;216=1\=934\;2\=223\;;217=1\=930\;2\=205\;;218=1\=936\;2\=191\;;219=1\=949\;2\=175\;;220=1\=952\;2\=188\;;221=1\=945\;2\=209\;;222=1\=965\;2\=175\;;223=1\=981\;2\=170\;;224=1\=994\;2\=163\;;225=1\=995\;2\=117\;;226=1\=979\;2\=113\;;227=1\=960\;2\=117\;;228=1\=934\;2\=110\;;229=1\=917\;2\=99\;;230=1\=891\;2\=89\;;231=1\=869\;2\=104\;;232=1\=851\;2\=99\;;233=1\=831\;2\=86\;;234=1\=801\;2\=77\;;235=1\=804\;2\=57\;;236=1\=792\;2\=40\;;237=1\=759\;2\=59\;;238=1\=735\;2\=74\;;239=1\=721\;2\=85\;;240=1\=694\;2\=96\;;241=1\=681\;2\=108\;;242=1\=662\;2\=117\;;243=1\=651\;2\=103\;;244=1\=646\;2\=84\;;245=1\=665\;2\=58\;;246=1\=679\;2\=49\;;247=1\=637\;2\=124\;;248=1\=623\;2\=136\;;249=1\=600\;2\=149\;;250=1\=589\;2\=147\;;251=1\=587\;2\=133\;;252=1\=601\;2\=131\;;253=1\=603\;2\=119\;;254=1\=584\;2\=107\;;255=1\=563\;2\=103\;;256=1\=541\;2\=121\;;257=1\=530\;2\=139\;;258=1\=522\;2\=157\;;259=1\=510\;2\=172\;;260=1\=506\;2\=190\;;261=1\=526\;2\=191\;;262=1\=529\;2\=203\;;263=1\=541\;2\=200\;;264=1\=545\;2\=181\;;265=1\=545\;2\=165\;;266=1\=553\;2\=152\;;267=1\=562\;2\=148\;;268=1\=563\;2\=160\;;269=1\=559\;2\=181\;;270=1\=559\;2\=191\;;271=1\=552\;2\=208\;;272=1\=529\;2\=212\;;273=1\=513\;2\=211\;;274=1\=500\;2\=224\;;275=1\=492\;2\=218\;;276=1\=485\;2\=196\;;277=1\=478\;2\=200\;;278=1\=471\;2\=212\;;279=1\=487\;2\=210\;;280=1\=487\;2\=223\;;281=1\=490\;2\=233\;;282=1\=489\;2\=246\;;283=1\=492\;2\=257\;;284=1\=486\;2\=256\;;285=1\=469\;2\=257\;;286=1\=469\;2\=278\;;287=1\=481\;2\=284\;;288=1\=469\;2\=269\;;289=1\=482\;2\=255\;;290=1\=494\;2\=278\;;291=1\=502\;2\=262\;;292=1\=512\;2\=256\;;293=1\=519\;2\=255\;;294=1\=530\;2\=266\;;295=1\=531\;2\=267\;;296=1\=546\;2\=278\;;297=1\=556\;2\=282\;;298=1\=564\;2\=282\;;299=1\=582\;2\=290\;;300=1\=588\;2\=295\;;301=1\=575\;2\=298\;;302=1\=556\;2\=291\;;303=1\=545\;2\=292\;;304=1\=527\;2\=289\;;305=1\=523\;2\=286\;;306=1\=507\;2\=285\;;307=1\=486\;2\=292\;;308=1\=463\;2\=307\;;309=1\=453\;2\=322\;;310=1\=454\;2\=344\;;311=1\=462\;2\=362\;;312=1\=476\;2\=378\;;313=1\=496\;2\=380\;;314=1\=511\;2\=377\;;315=1\=530\;2\=397\;;316=1\=532\;2\=421\;;317=1\=537\;2\=443\;;318=1\=540\;2\=472\;;319=1\=549\;2\=494\;;320=1\=568\;2\=496\;;321=1\=587\;2\=477\;;322=1\=594\;2\=456\;;323=1\=603\;2\=440\;;324=1\=605\;2\=419\;;325=1\=605\;2\=402\;;326=1\=613\;2\=391\;;327=1\=625\;2\=383\;;328=1\=634\;2\=367\;;329=1\=617\;2\=361\;;330=1\=600\;2\=342\;;331=1\=586\;2\=315\;;332=1\=596\;2\=333\;;333=1\=627\;2\=355\;;334=1\=641\;2\=349\;;335=1\=653\;2\=338\;;336=1\=658\;2\=331\;;337=1\=645\;2\=318\;;338=1\=633\;2\=313\;;339=1\=659\;2\=323\;;340=1\=669\;2\=324\;;341=1\=700\;2\=324\;;342=1\=680\;2\=323\;;343=1\=694\;2\=335\;;344=1\=707\;2\=357\;;345=1\=703\;2\=348\;;346=1\=716\;2\=366\;;347=1\=721\;2\=353\;;348=1\=726\;2\=339\;;349=1\=736\;2\=334\;;350=1\=750\;2\=333\;;351=1\=760\;2\=346\;;352=1\=775\;2\=358\;;353=1\=784\;2\=366\;;354=1\=795\;2\=361\;;355=1\=795\;2\=347\;;356=1\=791\;2\=338\;;357=1\=797\;2\=330\;;358=1\=808\;2\=326\;;359=1\=815\;2\=326\;;360=1\=828\;2\=318\;;361=1\=830\;2\=306\;;362=1\=831\;2\=286\;;363=1\=832\;2\=272\;;364=1\=844\;2\=273\;;365=1\=851\;2\=290\;;366=1\=853\;2\=273\;;367=1\=859\;2\=263\;;368=1\=875\;2\=248\;;369=1\=885\;2\=231\;;370=1\=887\;2\=212\;;371=1\=879\;2\=204\;;372=1\=885\;2\=190\;;373=1\=905\;2\=182\;;374=1\=918\;2\=185\;;375=1\=930\;2\=172\;;376=1\=943\;2\=167\;;377=1\=317\;2\=3\;;378=1\=304\;2\=15\;;379=1\=296\;2\=36\;;380=1\=315\;2\=51\;;381=1\=334\;2\=61\;;382=1\=338\;2\=79\;;383=1\=347\;2\=109\;;384=1\=350\;2\=130\;;385=1\=351\;2\=149\;;386=1\=357\;2\=168\;;387=1\=372\;2\=184\;;388=1\=380\;2\=161\;;389=1\=393\;2\=135\;;390=1\=416\;2\=125\;;391=1\=432\;2\=114\;;392=1\=436\;2\=94\;;393=1\=433\;2\=74\;;394=1\=439\;2\=56\;;395=1\=435\;2\=38\;;396=1\=432\;2\=20\;;397=1\=439\;2\=4\;;398=1\=234\;2\=14\;;399=1\=254\;2\=21\;;400=1\=254\;2\=36\;;401=1\=253\;2\=46\;;402=1\=275\;2\=50\;;403=1\=282\;2\=30\;;404=1\=292\;2\=4\;;405=1\=250\;2\=2\;;406=1\=630\;2\=435\;;407=1\=618\;2\=442\;;408=1\=618\;2\=456\;;409=1\=622\;2\=473\;;410=1\=627\;2\=455\;;411=1\=394\;2\=582\;;412=1\=689\;2\=561\;;413=1\=430\;2\=146\;;414=1\=441\;2\=160\;;415=1\=456\;2\=150\;;416=1\=446\;2\=141\;;417=1\=884\;2\=44\;;418=1\=879\;2\=63\;;419=1\=895\;2\=64\;;420=1\=1\;2\=147\;;421=1\=12\;2\=156\;;422=1\=17\;2\=141\;;423=1\=12\;2\=128\;;424=1\=3\;2\=122\;;425=1\=504\;2\=528\;;
EndSub 
