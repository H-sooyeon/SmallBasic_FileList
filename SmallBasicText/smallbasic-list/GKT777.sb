GraphicsWindow.Title="Biblioteca"
GraphicsWindow.Height= 350
 GraphicsWindow.Width=500
'fondo de la pantalla
fondo= "C:\Users\admin\Pictures\bibliotecaaa.png"
GraphicsWindow.DrawImage(fondo,0,0)
Inicio:
'titulo
GraphicsWindow.FontSize = 20
GraphicsWindow.BrushColor = "orange"
GraphicsWindow.DrawText(120,20, "Bienvenido a la biblioteca ")
GraphicsWindow.DrawText(150,50," Ricardo Lindo")
GraphicsWindow.BrushColor= "white"
GraphicsWindow.DrawText(20,100," Selecione  la opción que desea realizar:")

'opciones
GraphicsWindow.FontSize=14
GraphicsWindow.BrushColor = "black"
ldl= Controls.AddButton("Menú historial de libros.", 20, 150)
b= Controls.AddButton("Busqueda.", 20, 200)
D= Controls.AddButton("Devolución de libro.", 20, 250)
GraphicsWindow.BrushColor="red"
salir=Controls.AddButton("Salir", 440, 300)

'Control de lo botones
Controls.ButtonClicked = botonPresionado

Sub botonPresionado
  ultimoBoton = Controls.LastClickedButton
  If ultimoBoton = ldl Then
    GraphicsWindow.Clear()
    menuldl()   
  Elseif ultimoBoton = b then 
    GraphicsWindow.Clear()  
    menub()
  elseif ultimoBoton = D then
    GraphicsWindow.Clear() 
  menuD()
  
  elseif ultimoBoton = salir then
    Program.End() 
  EndIf
EndSub

sub menuldl
   Listado_Libros:
  TextWindow.Clear()
 TextWindow.ForegroundColor="yellow"
  TextWindow.BackgroundColor="black"
  TextWindow.Clear()
  TextWindow.WriteLine("                ╔═══════════════════════════════════════════════════╗")
  TextWindow.WriteLine("                ║              LISTADO GENERAL DE LIBROS            ║")
  TextWindow.WriteLine("                ╚═══════════════════════════════════════════════════╝ ")
  TextWindow.ForegroundColor="white"
Libro1["Nombre"] = " HAMLET "
Libro1["Autor"]=     "Shakespeare"
Libro1["Editorial"]=      "SIRUELA"
Libro1["Tema general"]=      "Linguística y retórica - 800 / 820 - Teatro"
Libro1["Total de ejemplares"]=     4
Libro1["Ejemplares prestados"]= 1
For b=1 To Array.GetItemCount(Reserva_Libro)
  If Reserva_Libro[b]= "A" Then
    Libro1["Ejemplares prestados"]= Libro1["Ejemplares prestados"] + 1
  EndIf
EndFor
Libro1["Ejemplares disponibles"]= Libro1["Total de ejemplares"] - Libro1["Ejemplares prestados"]
If Libro1["Ejemplares disponibles"]= 0 Then
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("----------------------------------------------------")
  TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
  TextWindow.WriteLine("----------------------------------------------------")
EndIf 
Libro1["Ubicación"]= "Estante 3, fila 4"
TextWindow.WriteLine(" ")
Emplist= Array.GetAllIndices(Libro1)
For i=1 To Array.GetItemCount(Libro1)
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine(Emplist[i] + ": " + Libro1[Emplist[i]])
EndFor
TextWindow.WriteLine(" ")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="white"
Libro2["Nombre"]= "ENSAYOS"
Libro2["Autor"]= "Alberto Masferrer"
Libro2["Editorial"]= "Colección pensamiento"
Libro2["Tema general"]= "Lingüística y retórica - 800 / 870 - Ensayos"
Libro2["Total de ejemplares"]= 10
Libro2["Ejemplares prestados"]= 2
For b=1 To Array.GetItemCount(Reserva_Libro)
  If Reserva_Libro[b]= "B" Then
    Libro2["Ejemplares prestados"]= Libro2["Ejemplares prestados"] + 1
  EndIf
EndFor
Libro2["Ejemplares disponibles"]= Libro2["Total de ejemplares"] - Libro2["Ejemplares prestados"]
If Libro2["Ejemplares disponibles"]= 0 Then
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("----------------------------------------------------")
  TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
  TextWindow.WriteLine("----------------------------------------------------")
EndIf  
Libro2["Ubicación"]= "Estante 5, fila 16"
Emplist= Array.GetAllIndices(Libro2)
For i=1 To Array.GetItemCount(Libro2)
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine(Emplist[i] + ": " + Libro2[Emplist[i]])
EndFor
TextWindow.WriteLine(" ")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="white"
Libro3["Nombre"]= "EL CONTRATO SOCIAL"
Libro3["Autor"]= "Jean-Jaques Rousseau"
Libro3["Editorial"]= "Catedra"
Libro3["Tema general"]= "Filosofía - 100 - Ensayo social"
Libro3["Total de ejemplares"]= 8
Libro3["Ejemplares prestados"]= 1
For b=1 To Array.GetItemCount(Reserva_Libro)
  If Reserva_Libro[b]= "C" Then
    Libro3["Ejemplares prestados"]= Libro3["Ejemplares prestados"] + 1
  EndIf
EndFor
Libro3["Ejemplares disponibles"]= Libro3["Total de ejemplares"] - Libro3["Ejemplares prestados"]
If Libro3["Ejemplares disponibles"]= 0 Then
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("----------------------------------------------------")
  TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
  TextWindow.WriteLine("----------------------------------------------------")
EndIf
Libro3["Ubicación"]= "Estante 5, fila 16"
Emplist= Array.GetAllIndices(Libro3)
For i=1 To Array.GetItemCount(Libro3)
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine(Emplist[i] + ": " + Libro3[Emplist[i]])
EndFor
TextWindow.WriteLine(" ")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="white"
Libro4["Nombre"]= "PADRE RICO, PADRE POBRE"
Libro4["Autor"]= "Robert T. Kiyosaki"
Libro4["Editorial"]= "Punto lectura"
Libro4["Tema general"]= "Ciencias Sociales/Economía - 300 / 330"
Libro4["Total de ejemplares"]= 5
Libro4["Ejemplares prestados"]= 3
For b=1 To Array.GetItemCount(Reserva_Libro)
  If Reserva_Libro[b]= "D" Then
    Libro4["Ejemplares prestados"]= Libro4["Ejemplares prestados"] + 1
  EndIf
EndFor
Libro4["Ejemplares disponibles"]= Libro4["Total de ejemplares"] - Libro4["Ejemplares prestados"]
If Libro4["Ejemplares disponibles"]= 0 Then
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("----------------------------------------------------")
  TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
  TextWindow.WriteLine("----------------------------------------------------")
EndIf
Libro4["Ubicación"]= "Estante 2, fila 20"
Emplist= Array.GetAllIndices(Libro4)
For i=1 To Array.GetItemCount(Libro4)
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine(Emplist[i] + ": " + Libro4[Emplist[i]])
EndFor
TextWindow.WriteLine(" ")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="white"
Libro5["Nombre"]= "LA VERDAD SOBRE EL CASO HARRY QUEBERT"
Libro5["Autor"]= "Joël Dicker"
Libro5["Editorial"]= "Alfaguara"
Libro5["Tema general"]= "Literatura y retórica/Literatura francesa - 800 / 850"
Libro5["Total de ejemplares"]= 3
Libro5["Ejemplares prestados"]= 1
For b=1 To Array.GetItemCount(Reserva_Libro)
  If Reserva_Libro[b]= "E" Then
    Libro5["Ejemplares prestados"]= Libro5["Ejemplares prestados"] + 1
  EndIf
EndFor
Libro5["Ejemplares disponibles"]= Libro5["Total de ejemplares"] - Libro5["Ejemplares prestados"]
If Libro5["Ejemplares disponibles"]= 0 Then
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("----------------------------------------------------")
  TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
  TextWindow.WriteLine("----------------------------------------------------")
EndIf
Libro5["Ubicación"]= "Estante 1, fila 22"
Emplist= Array.GetAllIndices(Libro5)
For i=1 To Array.GetItemCount(Libro5)
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine(Emplist[i] + ": " + Libro5[Emplist[i]])
EndFor
TextWindow.WriteLine(" ")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="white"
Libro6["Nombre"]= "ORGULLO Y PREJUICIO"
Libro6["Autor"]= "Jane Austen"
Libro6["Editorial"]= "Punto lectura"
Libro6["Tema general"]= "Literatura y retórica/Literatura inglesa - 800 / 820"
Libro6["Total de ejemplares"]= 9
Libro6["Ejemplares prestados"]= 0
For b=1 To Array.GetItemCount(Reserva_Libro)
  If Reserva_Libro[b]= "F" Then
    Libro6["Ejemplares prestados"]= Libro6["Ejemplares prestados"] + 1
  EndIf
EndFor
Libro6["Ejemplares disponibles"]= Libro6["Total de ejemplares"] - Libro6["Ejemplares prestados"]
If Libro6["Ejemplares disponibles"]= 0 Then
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("----------------------------------------------------")
  TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
  TextWindow.WriteLine("----------------------------------------------------")
EndIf
Libro6["Ubicación"]= "Estante 3, fila 1"
Emplist= Array.GetAllIndices(Libro6)
For i=1 To Array.GetItemCount(Libro6)
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine(Emplist[i] + ": " + Libro6[Emplist[i]])
EndFor
TextWindow.WriteLine(" ")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="white"
Libro7["Nombre"]= "IT"
Libro7["Autor"]= "Stephen King"
Libro7["Editorial"]= "Debolsillo"
Libro7["Tema general"]= "Literatura y retórica/Literatura norteamericana - 800 / 810"
Libro7["Total de ejemplares"]= 3
Libro7["Ejemplares prestados"]= 3
For b=1 To Array.GetItemCount(Reserva_Libro)
  If Reserva_Libro[b]= "G" Then
    Libro7["Ejemplares prestados"]= Libro7["Ejemplares prestados"] + 1
    If Libro7["Ejemplares disponibles"] = 0 Then
      TextWindow.ForegroundColor="red"
      TextWindow.WriteLine("----------------------------------------------------")
      TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
      TextWindow.WriteLine("----------------------------------------------------")
    EndIf 
  EndIf
EndFor
Libro7["Ejemplares disponibles"]= Libro7["Total de ejemplares"] - Libro7["Ejemplares prestados"]
If Libro7["Ejemplares disponibles"]= 0 Then
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("----------------------------------------------------")
  TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
  TextWindow.WriteLine("----------------------------------------------------")
EndIf
Libro7["Ubicación"]= "Estante 3, fila 4"
Emplist= Array.GetAllIndices(Libro7)
For i=1 To Array.GetItemCount(Libro7)
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine(Emplist[i] + ": " + Libro7[Emplist[i]])
EndFor
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
Libro8["Nombre"]= "HACIA RUTAS SALVAJES"
Libro8["Autor"]= "Jon Krakaur"
Libro8["Editorial"]= "Zeta ediciones"
Libro8["Tema general"]= "Geografía e historia/Biografía - 900 / 920"
Libro8["Total de ejemplares"]= 7
Libro8["Ejemplares prestados"]= 1
For b=1 To Array.GetItemCount(Reserva_Libro)
  If Reserva_Libro[b]= "H" Then
    Libro8["Ejemplares prestados"]= Libro8["Ejemplares prestados"] + 1
  EndIf
EndFor
Libro8["Ejemplares disponibles"]= Libro8["Total de ejemplares"] - Libro8["Ejemplares prestados"]
If Libro8["Ejemplares disponibles"]= 0 Then
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("----------------------------------------------------")
  TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
  TextWindow.WriteLine("----------------------------------------------------")
EndIf
Libro8["Ubicación"]= "Estante 7, fila 15"
Emplist= Array.GetAllIndices(Libro8)
For i=1 To Array.GetItemCount(Libro8)
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine(Emplist[i] + ": " + Libro8[Emplist[i]])
EndFor
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
Libro9["Nombre"]= "EXPRESIÓN ORAL Y ESCRITA"
Libro9["Autor"]= "Ernesto Serrano"
Libro9["Editorial"]= "Zamora"
Libro9["Tema general"]= "Lengua/Lingüística - 400 / 410"
Libro9["Total de ejemplares"]= 10
Libro9["Ejemplares prestados"]= 2
For b=1 To Array.GetItemCount(Reserva_Libro)
  If Reserva_Libro[b]= "I" Then
    Libro9["Ejemplares prestados"]= Libro9["Ejemplares prestados"] + 1
  EndIf
EndFor
Libro9["Ejemplares disponibles"]= Libro9["Total de ejemplares"] - Libro9["Ejemplares prestados"]
If Libro8["Ejemplares disponibles"]= 0 Then
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("----------------------------------------------------")
  TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
  TextWindow.WriteLine("----------------------------------------------------")
EndIf
Libro9["Ubicación"]= "Estante 1, fila 5"
Emplist= Array.GetAllIndices(Libro9)
For i=1 To Array.GetItemCount(Libro9)
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine(Emplist[i] + ": " + Libro9[Emplist[i]])
EndFor
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="green"
TextWindow.WriteLine("------------------------------------- M E N Ú ---------------------------------- ")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine(" ")
TextWindow.WriteLine("Ingrese el literal de la opción que desea realizar: ")
TextWindow.WriteLine("   a. Reservar un libro")
TextWindow.WriteLine("   b. Ver historial de prestamos")
TextWindow.WriteLine("   C. Regresar a menú principal")
TextWindow.WriteLine(" ")
TextWindow.WriteLine("---------------------------------------------------")
Reserva= Text.ConvertToLowerCase(TextWindow.Read())
If Reserva= "a" Then
  TextWindow.Clear()
  Goto Menu_Reserva
ElseIf Reserva= "b" Then
  TextWindow.Clear()
  Goto Menu_HistorialPrestamos
Elseif Reserva= "c" Then
  Goto Inicio
Else
  TextWindow.WriteLine("Opción inválida")
  TextWindow.WriteLine("¿Desea intentar de nuevo?")
  Respuesta= text.ConvertToUpperCase(TextWindow.Read())
  If Respuesta= "SI" Then
    Goto Listado_Libros 
  ElseIf Respuesta= "NO" then
    Goto Inicio
  Else
    TextWindow.Clear()
    Program.End()
  EndIf
EndIf

Menu_HistorialPrestamos:
  TextWindow.ForegroundColor="green"
  TextWindow.BackgroundColor="black"
  TextWindow.Clear()
  TextWindow.WriteLine("                ╔═══════════════════════════════════════════════════╗")
  TextWindow.WriteLine("                ║           HISTORIAL DE PRESTAMOS DE LIBROS        ║")
  TextWindow.WriteLine("                ╚═══════════════════════════════════════════════════╝ ")
  TextWindow.ForegroundColor="white"
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
TextWindow.WriteLine("                                      HAMLET")
TextWindow.WriteLine("                               William Shakespeare")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Nombre: Edwin Geovany Rodríguez Álvarez")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMOS")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 25/05/2017")
TextWindow.WriteLine("Periodo de préstamo: 15 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
For y= (Numero_Reservas_Libros + 1) To Cantidad_final_Libros
If Reserva_Libro[y]= "A" Then
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("DATOS PERSONALES")
  TextWindow.ForegroundColor="white"
  For a=1 To Array.GetItemCount(Reserva_UsuarioN)
    TextWindow.WriteLine("Nombre: " + Reserva_UsuarioN[a] )
    TextWindow.ForegroundColor="yellow"
    TextWindow.WriteLine("DATOS DE PRESTAMO")
    TextWindow.ForegroundColor="white"
    TextWindow.WriteLine("Fecha de préstamo: " + Today)
    TextWindow.WriteLine("Tú fecha límite de devolución es: " + Day + "/" +Mesdev+ "/" + Year)
    TextWindow.WriteLine("Período de préstamo: " + Reserva_FechaD[a] + " días")
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(" ")
  EndFor
EndIf
EndFor
TextWindow.WriteLine("                                      ENSAYOS")
TextWindow.WriteLine("                                 Alberto Masferrer")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Nombre: Lucas Mateo Juárez Solorsano")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMO")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 05/06/2017")
TextWindow.WriteLine("Periodo de préstamo: 7 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Nombre: Erick Alejandro Barkovicht")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMO")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 06/06/2017")
TextWindow.WriteLine("Periodo de préstamo: 20 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
For y= (Numero_Reservas_Libros + 1) To Cantidad_final_Libros
If Reserva_Libro[y]= "B" Then
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("DATOS PERSONALES")
  TextWindow.ForegroundColor="white"
  For a=1 To Array.GetItemCount(Reserva_UsuarioN)
    TextWindow.WriteLine("Nombre: " + Reserva_UsuarioN[a] )
    TextWindow.ForegroundColor="yellow"
    TextWindow.WriteLine("DATOS DE PRESTAMO")
    TextWindow.ForegroundColor="white"
    TextWindow.WriteLine("Fecha de préstamo: " + Today)
    TextWindow.WriteLine("Tú fecha límite de devolución es: " + Day + "/" +Mesdev+ "/" + Year)
    TextWindow.WriteLine("Período de préstamo: " + Reserva_FechaD[a] + " días")
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(" ")
  EndFor
EndIf
EndFor
TextWindow.WriteLine("                                  EL CONTRARO SOCIAL")
TextWindow.WriteLine("                                Jean-Jacques Rousseau")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Nombre: Cindy Gisella Contreras Reyes")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMOS")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 30/05/2017")
TextWindow.WriteLine("Periodo de préstamo: 30 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
For y= (Numero_Reservas_Libros + 1) To Cantidad_final_Libros
If Reserva_Libro[y]= "C" Then
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("DATOS PERSONALES")
  TextWindow.ForegroundColor="white"
  For a=1 To Array.GetItemCount(Reserva_UsuarioN)
    TextWindow.WriteLine("Nombre: " + Reserva_UsuarioN[a] )
    TextWindow.ForegroundColor="yellow"
    TextWindow.WriteLine("DATOS DE PRESTAMO")
    TextWindow.ForegroundColor="white"
    TextWindow.WriteLine("Fecha de préstamo: " + Today)
    TextWindow.WriteLine("Tú fecha límite de devolución es: " + Day + "/" +Mesdev+ "/" + Year)
    TextWindow.WriteLine("Período de préstamo: " + Reserva_FechaD[a] + " días")
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(" ")
  EndFor
EndIf
EndFor
TextWindow.WriteLine("                                PADRE RICO, PADRE POBRE")
TextWindow.WriteLine("                                  Robert T. Kiyosaki")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Usuario: William Alejandro Deras Sosa")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMOS")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 03/06/2017")
TextWindow.WriteLine("Periodo de préstamo: 5 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Nombre: Raymundo Alexander Garraty")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMOS")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 29/05/2017")
TextWindow.WriteLine("Periodo de préstamo: 18 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Nombre: Mauricio Ernesto Stebbins Mata")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMOS")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 31/05/2017")
TextWindow.WriteLine("Periodo de préstamo: 10 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
For y= (Numero_Reservas_Libros + 1) To Cantidad_final_Libros
If Reserva_Libro[y]= "D" Then
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("DATOS PERSONALES")
  TextWindow.ForegroundColor="white"
  For a=1 To Array.GetItemCount(Reserva_UsuarioN)
    TextWindow.WriteLine("Nombre: " + Reserva_UsuarioN[a] )
    TextWindow.ForegroundColor="yellow"
    TextWindow.WriteLine("DATOS DE PRESTAMO")
    TextWindow.ForegroundColor="white"
    TextWindow.WriteLine("Fecha de préstamo: " + Today)
    TextWindow.WriteLine("Tú fecha límite de devolución es: " + Day + "/" +Mesdev+ "/" + Year)
    TextWindow.WriteLine("Período de préstamo: " + Reserva_FechaD[a] + " días")
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(" ")
  EndFor
EndIf
EndFor
TextWindow.WriteLine("                         LA VERDAD SOBRE EL CASO HARRY QUEBERT")
TextWindow.WriteLine("                                    Joël Dicker")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Nombre: Andrea Vanessa Aguirre Montana")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMOS")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 04/06/2017")
TextWindow.WriteLine("Periodo de préstamo: 30 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
For y= (Numero_Reservas_Libros + 1) To Cantidad_final_Libros
If Reserva_Libro[y]= "E" Then
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("DATOS PERSONALES")
  TextWindow.ForegroundColor="white"
  For a=1 To Array.GetItemCount(Reserva_UsuarioN)
    TextWindow.WriteLine("Nombre: " + Reserva_UsuarioN[a] )
    TextWindow.ForegroundColor="yellow"
    TextWindow.WriteLine("DATOS DE PRESTAMO")
    TextWindow.ForegroundColor="white"
    TextWindow.WriteLine("Fecha de préstamo: " + Today)
    TextWindow.WriteLine("Tú fecha límite de devolución es: " + Day + "/" +Mesdev+ "/" + Year)
    TextWindow.WriteLine("Período de préstamo: " + Reserva_FechaD[a] + " días")
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(" ")
  EndFor
EndIf
EndFor
TextWindow.WriteLine("                                      ORGULLO Y PREJUICIO")
TextWindow.WriteLine("                                          Jane Austen")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
For y= (Numero_Reservas_Libros + 1) To Cantidad_final_Libros
If Reserva_Libro[y]= "F" Then
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("DATOS PERSONALES")
  TextWindow.ForegroundColor="white"
  For a=1 To Array.GetItemCount(Reserva_UsuarioN)
    TextWindow.WriteLine("Nombre: " + Reserva_UsuarioN[a] )
    TextWindow.ForegroundColor="yellow"
    TextWindow.WriteLine("DATOS DE PRESTAMO")
    TextWindow.ForegroundColor="white"
    TextWindow.WriteLine("Fecha de préstamo: " + Today)
    TextWindow.WriteLine("Tú fecha límite de devolución es: " + Day + "/" +Mesdev+ "/" + Year)
    TextWindow.WriteLine("Período de préstamo: " + Reserva_FechaD[a] + " días")
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(" ")
  EndFor
EndIf
EndFor
TextWindow.WriteLine("                                          IT")
TextWindow.WriteLine("                                     Stephen King")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Nombre: Liliana Stephanie Ángel Guardado")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMOS")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 31/05/2017")
TextWindow.WriteLine("Periodo de préstamo: 9 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Nombre: Tess Alexandra Moghanan")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMOS")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 05/06/2017")
TextWindow.WriteLine("Periodo de préstamo: 25 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Nombre: Louisa Tamara Jímenez Gonzalez")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMOS")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 06/06/2017")
TextWindow.WriteLine("Periodo de préstamo: 10 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
For y= (Numero_Reservas_Libros + 1) To Cantidad_final_Libros
If Reserva_Libro[y]= "G" Then
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("DATOS PERSONALES")
  TextWindow.ForegroundColor="white"
  For a=1 To Array.GetItemCount(Reserva_UsuarioN)
    TextWindow.WriteLine("Nombre: " + Reserva_UsuarioN[a] )
    TextWindow.ForegroundColor="yellow"
    TextWindow.WriteLine("DATOS DE PRESTAMO")
    TextWindow.ForegroundColor="white"
    TextWindow.WriteLine("Fecha de préstamo: " + Today)
    TextWindow.WriteLine("Tú fecha límite de devolución es: " + Day + "/" +Mesdev+ "/" + Year)
    TextWindow.WriteLine("Período de préstamo: " + Reserva_FechaD[a] + " días")
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(" ")
  EndFor
EndIf
EndFor
TextWindow.WriteLine("                                HACIA RUTAS SALVAJES")
TextWindow.WriteLine("                                    Jon Krakaur")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Usuario: Mara Samantha Guerra Martínez")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMOS")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 15/05/2017")
TextWindow.WriteLine("Periodo de préstamo: 28 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
For y= (Numero_Reservas_Libros + 1) To Cantidad_final_Libros
If Reserva_Libro[y]= "H" Then
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("DATOS PERSONALES")
  TextWindow.ForegroundColor="white"
  For a=1 To Array.GetItemCount(Reserva_UsuarioN)
    TextWindow.WriteLine("Nombre: " + Reserva_UsuarioN[a] )
    TextWindow.ForegroundColor="yellow"
    TextWindow.WriteLine("DATOS DE PRESTAMO")
    TextWindow.ForegroundColor="white"
    TextWindow.WriteLine("Fecha de préstamo: " + Today)
    TextWindow.WriteLine("Tú fecha límite de devolución es: " + Day + "/" +Mesdev+ "/" + Year)
    TextWindow.WriteLine("Período de préstamo: " + Reserva_FechaD[a] + " días")
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(" ")
  EndFor
EndIf
EndFor
TextWindow.WriteLine("                                EXPRESIÓN ORAL Y ESCRITA")
TextWindow.WriteLine("                                    Ernesto Serrano")
TextWindow.WriteLine("--------------------------------------------------------------------------------")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Nombre: Samuel Enrique Huezo Castro")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMOS")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 24/05/2017")
TextWindow.WriteLine("Periodo de préstamo: 24 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
textWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Usuario: Myriam Marina Martínez")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS DE PRESTAMOS")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Fecha de préstamo: 30/05/2017")
TextWindow.WriteLine("Periodo de préstamo: 13 días")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
For y= (Numero_Reservas_Libros + 1) To Cantidad_final_Libros
If Reserva_Libro[y]= "I" Then
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("DATOS PERSONALES")
  TextWindow.ForegroundColor="white"
  For a=1 To Array.GetItemCount(Reserva_UsuarioN)
    TextWindow.WriteLine("Nombre: " + Reserva_UsuarioN[a] )
    TextWindow.ForegroundColor="yellow"
    TextWindow.WriteLine("DATOS DE PRESTAMO")
    TextWindow.ForegroundColor="white"
    TextWindow.WriteLine("Fecha de préstamo: " + Today)
    TextWindow.WriteLine("Tú fecha límite de devolución es: " + Day + "/" +Mesdev+ "/" + Year)
    TextWindow.WriteLine("Período de préstamo: " + Reserva_FechaD[a] + " días")
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(" ")
  EndFor
EndIf
EndFor
TextWindow.WriteLine(" ")
TextWindow.WriteLine("--------------------------------")
TextWindow.WriteLine("¿Desea volver al menú principal?")
TextWindow.WriteLine("--------------------------------")
Salida= Text.ConvertToUpperCase(TextWindow.Read())
If Salida= "SI" Then
  Goto Inicio
Else 
  Program.End()
EndIf

Menu_Reserva:
TextWindow.ForegroundColor="green"
TextWindow.WriteLine("                                  RESERVA DE LIBRO")
TextWindow.WriteLine("________________________________________________________________________________")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("A. HAMLET")
TextWindow.WriteLine("B. ENSAYOS")
TextWindow.WriteLine("C. EL CONTRARIO SOCIAL")
TextWindow.WriteLine("D. PADRE RICO, PADRE POBRE")
TextWindow.WriteLine("E. LA VERDAD SOBRE EL CASO HARRY QUEBERT")
TextWindow.WriteLine("F. ORGULLO Y PREJUICIO")
TextWindow.WriteLine("G. IT")
TextWindow.WriteLine("H. HACIA RUTAS SALVAJES")
TextWindow.WriteLine("I. EXPRESIÓN ORAL Y ESCRITA")
A= "HAMLET"
B= "ENSAYOS"
C= "EL CONTRATO SOCIAL"
D= "PADRE RICO, PADRE POBRE"
E= "LA VERDAD SOBRE EL CASO HARRY QUEBERT"
F= "ORGULLO Y PREJUICIO"
G= "IT"
H= "HACIA RUTAS SALVAJES"
I= "EXPRESIÓN ORAL Y ESCRITA"
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
TextWindow.WriteLine("Ingresa el literal del libro que deseas: ")
Numero_Reservas_Libros=  Array.GetItemCount(Reserva_Libro)
Cantidad_final_Libros= Numero_Reservas_Libros + 1
For y= (Numero_Reservas_Libros + 1) To Cantidad_final_Libros
  Reserva_Libro[y]= Text.ConvertToUpperCase(TextWindow.Read())
  If Reserva_Libro[y]= "A" Then
    Text.ConvertToUpperCase(TextWindow.Read())
  ElseIf Reserva_Libro[y]= "B" Then
    Text.ConvertToUpperCase(TextWindow.Read())
  ElseIf Reserva_Libro[y]= "C" Then
    Text.ConvertToUpperCase(TextWindow.Read())
  ElseIf Reserva_Libro[y]= "D" Then
    Text.ConvertToUpperCase(TextWindow.Read())
  ElseIf Reserva_Libro[y]= "E" Then
    Text.ConvertToUpperCase(TextWindow.Read())
  ElseIf Reserva_Libro[y]= "F" Then
    Text.ConvertToUpperCase(TextWindow.Read())
  ElseIf Reserva_Libro[y]= "G" Then
    Text.ConvertToUpperCase(TextWindow.Read())
  ElseIf Reserva_Libro[y]= "H" Then
    Text.ConvertToUpperCase(TextWindow.Read())
  ElseIf Reserva_Libro[y]= "I" Then
    Text.ConvertToUpperCase(TextWindow.Read())
  Else 
    TextWindow.ForegroundColor="red"
    TextWindow.WriteLine("No contamos con el libro que solicitas")
    TextWindow.ForegroundColor="White"
    TextWindow.WriteLine("¿Desea intentar de nuevo?")
    Respuesta= text.ConvertToUpperCase(TextWindow.Read())
    If Respuesta= "SI" Then
      TextWindow.Clear()
      Goto Menu_Reserva  
    ElseIf Respuesta= "NO" then
      Goto Inicio
    Else 
      Program.End()    
      
    EndIf
  EndIf
EndFor
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine("DATOS PERSONALES")
TextWindow.ForegroundColor="white"
Numero_Reservas=  Array.GetItemCount(Reserva_UsuarioN)
Cantidad_final= Numero_Reservas + 1
For x= (Numero_Reservas + 1) To Cantidad_final
  TextWindow.WriteLine("Nombre")
  Reserva_UsuarioN[x]= Text.ConvertToUpperCase(TextWindow.Read())
  TextWindow.WriteLine("Correo electrónico: ")
  Reserva_UsuarioC[x]= Text.ConvertToLowerCase(TextWindow.Read())
  TextWindow.WriteLine("Teléfono: ")
  Reserva_UsuarioT[x]= Text.ConvertToUpperCase(TextWindow.Read())
  TextWindow.WriteLine("Dirección: ")
  Reserva_UsuarioD[x]= Text.ConvertToUpperCase(TextWindow.Read())
  TextWindow.WriteLine("Tipo de documento")
  Reserva_UsuarioDoc[x]= Text.ConvertToUpperCase(TextWindow.Read())
  TextWindow.WriteLine("Ingrese el número o código del documento")
  Reserva_UsuarioND[x]= Text.ConvertToUpperCase(TextWindow.Read())
  TextWindow.WriteLine("Periodo de prestamo: ")
  Reserva_FechaD[x]= Text.ConvertToUpperCase(TextWindow.Read())
EndFor
If Reserva_FechaD <= 30 Then
  Text.ConvertToUpperCase(TextWindow.Read())
Else
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("El periodo máximo para préstar un libro es de 30 días")
  TextWindow.ForegroundColor="white"
  TextWindow.WriteLine("¿Desea intentar de nuevo?")
  Answer= Text.ConvertToUpperCase(TextWindow.Read())
  If Answer= "SI" Then
    TextWindow.Clear()
    Goto Menu_Reserva
  ElseIf Answer= "NO" then
    Goto Inicio
  Else
    TextWindow.Pause()
    Program.End()
  EndIf
EndIf

Carta_Reserva:
Today= Clock.Date
Day= Clock.Day
Month= Clock.Month
Year= Clock.Year
Mesdev= Month + 1
TextWindow.BackgroundColor="black"
  TextWindow.ForegroundColor="orange"
  TextWindow.Clear()
  TextWindow.WriteLine("                ╔═══════════════════════════════════════════════════╗")
  TextWindow.WriteLine("                ║                 CARTA DE RESERVA                  ║")
  TextWindow.WriteLine("                ╚═══════════════════════════════════════════════════╝ ")
  TextWindow.WriteLine(" ")
  TextWindow.ForegroundColor="white"
For y= (Numero_Reservas_Libros + 1) To Cantidad_final_Libros
If Reserva_Libro[y] = "A" Then
  TextWindow.WriteLine("Libro: " + A)
ElseIf Reserva_Libro[y] = "B" Then
  TextWindow.WriteLine("Libro: " + B)
ElseIf Reserva_Libro[y] = "C" Then
  TextWindow.WriteLine("Libro: " + C)
ElseIf Reserva_Libro[y] = "D" Then
  TextWindow.WriteLine("Libro: " + D)
ElseIf Reserva_Libro[y] = "E" Then
  TextWindow.WriteLine("Libro: " + E)
ElseIf Reserva_Libro[y] = "F" Then
  TextWindow.WriteLine("Libro: " + F)
ElseIf Reserva_Libro[y] = "G" Then
  TextWindow.WriteLine("Libro: " + G)
ElseIf Reserva_Libro[y] = "H" Then
  TextWindow.WriteLine("Libro: " + H)
ElseIf Reserva_Libro[y] = "I" Then
  TextWindow.WriteLine("Libro: " + I)
EndIf
EndFor
TextWindow.WriteLine(" ")
TextWindow.WriteLine("Fecha de préstamo: " + Today)
TextWindow.WriteLine(" ")
TextWindow.WriteLine("Tú fecha límite de devolución es: " + Day + "/" +Mesdev+ "/" + Year)
TextWindow.WriteLine(" ")
For x= (Numero_Reservas + 1) To Cantidad_final
  TextWindow.WriteLine("Período de préstamo: " + Reserva_FechaD[x] + " días")
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("Nombre: " + Reserva_UsuarioN[x] )
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("Correo: " + Reserva_UsuarioC[x])
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("Código de documento: " + Reserva_UsuarioND[x])
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("Tipo de documento: " + Reserva_UsuarioDoc[x])
EndFor
TextWindow.WriteLine("_______________________________________________________________________________")
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="yellow"
TextWindow.WriteLine(" ")
TextWindow.WriteLine("                             Condiciones de préstamo")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine(" * No dañar los libros. Si usted encuentra el libro en malas condiciones por favor notificarlo al encargarlo antes de salir de la Biblioteca")
TextWindow.WriteLine(" * Si el libro no es devuelto en el periodo estimado, se hará cobro de una penalización por entrega tardía, la cual equivale a $1.00 USD por cada día de retraso")
TextWindow.WriteLine(" * Si usted entrega el libro antes del período límite, por favor registrarlo en 'ENTREGA DE LIBRO' dentro de este mismo programa")
TextWindow.WriteLine(" * En caso que extravíe, dañe o tache cualquier libro, deberá reintegrar a la Biblioteca un nuevo ejemplar en buenas condiciones")
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="green"
TextWindow.WriteLine("                             GRACIAS POR SU PREFERENCIA ")
TextWindow.WriteLine(" ")
TextWindow.ForegroundColor="white"
TextWindow.WriteLine(" ")
TextWindow.WriteLine(" Ingrese 1 para confirmar su préstamo o cualquier otra tecla para cancelar")
Answer2= Text.ConvertToUpperCase(TextWindow.Read())
If Answer2= "1" Then
  Goto Menu_HistorialPrestamos
Else
  Program.End()
EndIf


EndSub
Sub menub
  busqueda:
TextWindow.Clear()
TextWindow.BackgroundColor="black"
TextWindow.Clear()
TextWindow.ForegroundColor="white"
TextWindow.WriteLine("Ingrese el nombre del libro que busca")
TextWindow.ForegroundColor= "yellow"
Libro= Text.ConvertToUpperCase(TextWindow.Read())
If Libro="HAMLET" Then
  TextWindow.Clear()
  TextWindow.ForegroundColor="White"
  TextWindow.BackgroundColor="Black"
  TextWindow.Clear()
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.WriteLine(" ")
  TextWindow.ForegroundColor="white"

  Libro1["Nombre"] = " HAMLET "
  Libro1["Autor"]=     "Shakespeare"
  Libro1["Editorial"]=      "SIRUELA"
  Libro1["Tema general"]=      "Linguística y retórica - 800 / 820 - Teatro"
  Libro1["Total de ejemplares"]=     4
  Libro1["Ejemplares prestados"]= 2
  Libro1["Ejemplares disponibles"]= Libro1["Total de ejemplares"] - Libro1["Ejemplares prestados"]
  If Libro1["Ejemplares disponibles"]= 0 Then
    TextWindow.ForegroundColor="red"
    TextWindow.WriteLine("----------------------------------------------------")
    TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
    TextWindow.WriteLine("----------------------------------------------------")
  EndIf 
  Libro1["Ubicación"]= "Estante 3, fila 4"
  TextWindow.WriteLine(" ")
  Emplist= Array.GetAllIndices(Libro1)
  For i=1 To Array.GetItemCount(Libro1)
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(Emplist[i] + ": " + Libro1[Emplist[i]] )
    
  EndFor
  TextWindow.WriteLine("")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("¿Desea ir al menu reserva?")
  TextWindow.ForegroundColor="white"
  R=text.ConvertToUpperCase(TextWindow.Read())
  If R= "SI" Then
    TextWindow.Clear()
    Goto Menu_Reserva
  ElseIf R= "NO" then
    Goto Inicio
     Else
    Program.End()
  EndIf

  ElseIf Libro="ENSAYOS" then
  TextWindow.Clear()
  TextWindow.ForegroundColor="White"
  TextWindow.BackgroundColor="Black"
  TextWindow.Clear()
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.WriteLine(" ")
  TextWindow.ForegroundColor="white"
  Libro2["Nombre"]= "Ensayos"
  Libro2["Autor"]= "Alberto Masferrer"
  Libro2["Editorial"]= "Colección pensamiento"
  Libro2["Tema general"]= "Lingüística y retórica - 800 / 870 - Ensayos"
  Libro2["Total de ejemplares"]= 10
  Libro2["Ejemplares prestados"]= 2
  Libro2["Ejemplares disponibles"]= Libro2["Total de ejemplares"] - Libro2["Ejemplares prestados"]
  If Libro2["Ejemplares disponibles"]= 0 Then
    TextWindow.ForegroundColor="red"
    TextWindow.WriteLine("----------------------------------------------------")
    TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
    TextWindow.WriteLine("----------------------------------------------------")
  EndIf  
  Libro2["Ubicación"]= "Estante 5, fila 16"
  
 
  Emplist= Array.GetAllIndices(Libro2)
  For i=1 To Array.GetItemCount(Libro2)
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(Emplist[i] + ": " + Libro2[Emplist[i]])
  EndFor 
   TextWindow.WriteLine("")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("¿Desea ir al menu reserva?")
  TextWindow.ForegroundColor="white"
  R=text.ConvertToUpperCase(TextWindow.Read())
  If R= "SI" Then
    TextWindow.Clear()
    Goto Menu_Reserva
  ElseIf R= "NO" then
    Goto Inicio
     Else
    Program.End()
  EndIf
 Elseif Libro="EL CONTRATO SOCIAL" Then
  TextWindow.Clear()
  TextWindow.ForegroundColor="White"
  TextWindow.BackgroundColor="Black"
  TextWindow.Clear()
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.WriteLine(" ")
  TextWindow.ForegroundColor="white"
  Libro3["Nombre"]= "EL CONTRATO SOCIAL"
  Libro3["Autor"]= "Jean-Jaques Rousseau"
  Libro3["Editorial"]= "Catedra"
  Libro3["Tema general"]= "Filosofía - 100 - Ensayo social"
  Libro3["Total de ejemplares"]= 8
  Libro3["Ejemplares prestados"]= 7
  Libro3["Ejemplares disponibles"]= Libro3["Total de ejemplares"] - Libro3["Ejemplares prestados"]
  If Libro3["Ejemplares disponibles"]= 0 Then
    TextWindow.ForegroundColor="red"
    TextWindow.WriteLine("----------------------------------------------------")
    TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
    TextWindow.WriteLine("----------------------------------------------------")
  EndIf
  Libro3["Ubicación"]= "Estante 5, fila 16"
  TextWindow.Pause()

     
 
  Emplist= Array.GetAllIndices(Libro3)
  For i=1 To Array.GetItemCount(Libro3)
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(Emplist[i] + ": " + Libro3[Emplist[i]])
  EndFor
   TextWindow.WriteLine("")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("¿Desea ir al menu reserva?")
  TextWindow.ForegroundColor="white"
  R=text.ConvertToUpperCase(TextWindow.Read())
  If R= "SI" Then
    TextWindow.Clear()
    Goto Menu_Reserva
  ElseIf R= "NO" then
    Goto Inicio
     Else
    Program.End()
  EndIf
Elseif Libro="PADRE RICO, PADRE POBRE" Then
  TextWindow.Clear()
  TextWindow.ForegroundColor="White"
  TextWindow.BackgroundColor="Black"
  TextWindow.Clear()
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.WriteLine(" ")
  TextWindow.ForegroundColor="white"
  Libro4["Nombre"]= "PADRE RICO, PADRE POBRE"
  Libro4["Autor"]= "Robert T. Kiyosaki"
  Libro4["Editorial"]= "Punto lectura"
  Libro4["Tema general"]= "Ciencias Sociales/Economía - 300 / 330"
  Libro4["Total de ejemplares"]= 5
  Libro4["Ejemplares prestados"]= 2
  Libro4["Ejemplares disponibles"]= Libro4["Total de ejemplares"] - Libro4["Ejemplares prestados"]
  If Libro4["Ejemplares disponibles"]= 0 Then
    TextWindow.ForegroundColor="red"
    TextWindow.WriteLine("----------------------------------------------------")
    TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
    TextWindow.WriteLine("----------------------------------------------------")
  EndIf
  Libro4["Ubicación"]= "Estante 2, fila 20"
  
  Emplist= Array.GetAllIndices(Libro4)
  For i=1 To Array.GetItemCount(Libro4)
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(Emplist[i] + ": " + Libro4[Emplist[i]])
  EndFor
  TextWindow.WriteLine("")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("¿Desea ir al menu reserva?")
  TextWindow.ForegroundColor="white"
  R=text.ConvertToUpperCase(TextWindow.Read())
  If R= "SI" Then
    TextWindow.Clear()
    Goto Menu_Reserva
  ElseIf R= "NO" then
    Goto Inicio
     Else
    Program.End()
  EndIf
Elseif Libro="LA VERDAD SOBRE EL CASO HARRY QUEBERT" Then
  TextWindow.Clear()
  TextWindow.ForegroundColor="White"
  TextWindow.BackgroundColor="Black"
  TextWindow.Clear()
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.WriteLine(" ")
  TextWindow.ForegroundColor="white"
  Libro5["Nombre"]= "LA VERDAD SOBRE EL CASO HARRY QUEBERT"
  Libro5["Autor"]= "Joël Dicker"
  Libro5["Editorial"]= "Alfaguara"
  Libro5["Tema general"]= "Literatura y retórica/Literatura francesa - 800 / 850"
  Libro5["Total de ejemplares"]= 3
  Libro5["Ejemplares prestados"]= 1
  Libro5["Ejemplares disponibles"]= Libro5["Total de ejemplares"] - Libro5["Ejemplares prestados"]
  If Libro5["Ejemplares disponibles"]= 0 Then
    TextWindow.ForegroundColor="red"
    TextWindow.WriteLine("----------------------------------------------------")
    TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
    TextWindow.WriteLine("----------------------------------------------------")
  EndIf
  Libro5["Ubicación"]= "Estante 1, fila 22"
 
 
  Emplist= Array.GetAllIndices(Libro5)
  For i=1 To Array.GetItemCount(Libro5)
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(Emplist[i] + ": " + Libro5[Emplist[i]])
  EndFor
  TextWindow.WriteLine("")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("¿Desea ir al menu reserva?")
  TextWindow.ForegroundColor="white"
  R=text.ConvertToUpperCase(TextWindow.Read())
  If R= "SI" Then
    TextWindow.Clear()
    Goto Menu_Reserva
  ElseIf R= "NO" then
    Goto Inicio
     Else
    Program.End()
  EndIf
  Elseif Libro="ORGULLO Y PREJUICIO" Then
  TextWindow.Clear()
  TextWindow.ForegroundColor="White"
  TextWindow.BackgroundColor="Black"
  TextWindow.Clear()
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.WriteLine(" ")
  TextWindow.ForegroundColor="white"
  Libro6["Nombre"]= "ORGULLO Y PREJUICIO"
  Libro6["Autor"]= "jJane Austen"
  Libro6["Editorial"]= "Punto lectura"
  Libro6["Tema general"]= "Literatura y retórica/Literatura inglese - 800 / 820"
  Libro6["Total de ejemplares"]= 9
  Libro6["Ejemplares prestados"]= 0
  Libro6["Ejemplares disponibles"]= Libro6["Total de ejemplares"] - Libro6["Ejemplares prestados"]
  If Libro6["Ejemplares disponibles"]= 0 Then
    TextWindow.ForegroundColor="red"
    TextWindow.WriteLine("----------------------------------------------------")
    TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
    TextWindow.WriteLine("----------------------------------------------------")
  EndIf
  Libro6["Ubicación"]= "Estante 3, fila 1"
 

  Emplist= Array.GetAllIndices(Libro6)
  For i=1 To Array.GetItemCount(Libro6)
    TextWindow.WriteLine(" ")
    TextWindow.WriteLine(Emplist[i] + ": " + Libro6[Emplist[i]])
  EndFor
  TextWindow.WriteLine("")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("¿Desea ir al menu reserva?")
  TextWindow.ForegroundColor="white"
  R=text.ConvertToUpperCase(TextWindow.Read())
  If R= "SI" Then
    TextWindow.Clear()
    Goto Menu_Reserva
  ElseIf R= "NO" then
    Goto Inicio
     Else
    Program.End()
  EndIf
  Elseif Libro="IT" Then
  TextWindow.Clear()
  TextWindow.ForegroundColor="White"
  TextWindow.BackgroundColor="Black"
  TextWindow.Clear()
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.WriteLine(" ")
  TextWindow.ForegroundColor="white"
  Libro7["Nombre"]= "IT"
Libro7["Autor"]= "Stephen King"
Libro7["Editorial"]= "Debolsillo"
Libro7["Tema general"]= "Literatura y retórica/Literatura norteamericana - 800 / 810"
Libro7["Total de ejemplares"]= 3
Libro7["Ejemplares prestados"]= 3
Libro7["Ejemplares disponibles"]= Libro7["Total de ejemplares"] - Libro7["Ejemplares prestados"]
If Libro7["Ejemplares disponibles"]= 0 Then
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("----------------------------------------------------")
  TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
  TextWindow.WriteLine("----------------------------------------------------")
EndIf
Libro7["Ubicación"]= "Estante 3, fila 4"

     
  
Emplist= Array.GetAllIndices(Libro7)
For i=1 To Array.GetItemCount(Libro7)
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine(Emplist[i] + ": " + Libro7[Emplist[i]])
EndFor
 TextWindow.WriteLine("")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("¿Desea ir al menu reserva?")
  TextWindow.ForegroundColor="white"
  R=text.ConvertToUpperCase(TextWindow.Read())
  If R= "SI" Then
    TextWindow.Clear()
    Goto Menu_Reserva
  ElseIf R= "NO" then
    Goto Inicio
     Else
    Program.End()
  EndIf
Elseif Libro="HACIA RUTAS SALVAJES" Then
  TextWindow.Clear()
  TextWindow.ForegroundColor="White"
  TextWindow.BackgroundColor="Black"
  TextWindow.Clear()
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.WriteLine(" ")
  TextWindow.ForegroundColor="white"
Libro8["Nombre"]= "HACIA RUTAS SALVAJES"
Libro8["Autor"]= "Jon Krakaur"
Libro8["Editorial"]= "Zeta ediciones"
Libro8["Tema general"]= "Geografía e historia/Biografía - 900 / 920"
Libro8["Total de ejemplares"]= 7
Libro8["Ejemplares prestados"]= 1
Libro8["Ejemplares disponibles"]= Libro8["Total de ejemplares"] - Libro8["Ejemplares prestados"]
If Libro8["Ejemplares disponibles"]= 0 Then
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("----------------------------------------------------")
  TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
  TextWindow.WriteLine("----------------------------------------------------")
EndIf
Libro8["Ubicación"]= "Estante 7, fila 15"

Emplist= Array.GetAllIndices(Libro8)
For i=1 To Array.GetItemCount(Libro8)
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine(Emplist[i] + ": " + Libro8[Emplist[i]])
EndFor
 TextWindow.WriteLine("")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("¿Desea ir al menu reserva?")
  TextWindow.ForegroundColor="white"
  R=text.ConvertToUpperCase(TextWindow.Read())
  If R= "SI" Then
    TextWindow.Clear()
    Goto Menu_Reserva
  ElseIf R= "NO" then
    Goto Inicio
     Else
    Program.End()
  EndIf
Elseif Libro="EXPRESIÓN ORAL Y ESCRITA" Then
  TextWindow.Clear()
  TextWindow.ForegroundColor="White"
  TextWindow.BackgroundColor="Black"
  TextWindow.Clear()
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.WriteLine(" ")
  TextWindow.ForegroundColor="white"
Libro9["Nombre"]= "EXPRESIÓN ORAL Y ESCRITA"
Libro9["Autor"]= "Ernesto Serrano"
Libro9["Editorial"]= "Zamora"
Libro9["Tema general"]= "Lengua/Lingüística - 400 / 410"
Libro9["Total de ejemplares"]= 10
Libro9["Ejemplares prestados"]= 3
Libro9["Ejemplares disponibles"]= Libro9["Total de ejemplares"] - Libro9["Ejemplares prestados"]
If Libro9["Ejemplares disponibles"]= 0 Then
  TextWindow.ForegroundColor="red"
  TextWindow.WriteLine("----------------------------------------------------")
  TextWindow.WriteLine("*  Por el momento no contamos con ningún ejemplar  *")
  TextWindow.WriteLine("----------------------------------------------------")
EndIf
Libro9["Ubicación"]= "Estante 1, fila 5"
Libro9["Reservar"]= "¿Desea reservar algún ejemplar?"

 
Emplist= Array.GetAllIndices(Libro9)
For i=1 To Array.GetItemCount(Libro9)
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine(Emplist[i] + ": " + Libro9[Emplist[i]])
EndFor 
 TextWindow.WriteLine("")
  TextWindow.WriteLine("--------------------------------------------------------------------------------")
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("¿Desea ir al menu reserva?")
  TextWindow.ForegroundColor="white"
  R=text.ConvertToUpperCase(TextWindow.Read())
  If R= "SI" Then
    TextWindow.Clear()
    Goto Menu_Reserva
  ElseIf R= "NO" then
    Goto Inicio
     Else
    Program.End()
  EndIf
Else
  TextWindow.ForegroundColor="White"
  TextWindow.WriteLine("Lo sentimos no contamos con ese libro, ¿desea intentar escribir de nuevo?")
  TextWindow.ForegroundColor="yellow"
  R2=text.ConvertToUpperCase(TextWindow.Read())
  If R2= "SI"Then 
    Goto Busqueda
  ElseIf R2= "NO"then
    Goto Inicio 
    EndIf
  EndIf
EndSub 
Sub menuD
 'Devolución_Libros:

Devolución_Libros:
  TextWindow.Clear()
  TextWindow.ForegroundColor="white"
  TextWindow.BackgroundColor="black"
  TextWindow.Clear()
  TextWindow.WriteLine(" ")
  TextWindow.ForegroundColor="yellow"
  TextWindow.WriteLine("                ╔═══════════════════════════════════════════════════╗")
  TextWindow.WriteLine("                ║                DEVOLUCIÓN DE LIBROS               ║")
  TextWindow.WriteLine("                ╚═════════════════════════════════════════════���═════╝ ")
  TextWindow.ForegroundColor="white"
  TextWindow.BackgroundColor="black"
  
  TextWindow.WriteLine("Nombre: ") 
  Name= TextWindow.Read()
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("Nombre de libro prestado: ")
  Name_b= TextWindow.Read()
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("Fecha de prestamo: ")
  TextWindow.Write("Año: ")
  Año= TextWindow.Read()*365
  TextWindow.Write("Mes: ")
  Mes= TextWindow.Read()*30
  TextWindow.Write("Día: ")
  Dia= TextWindow.Read()
  TextWindow.WriteLine(" ")
  TextWindow.WriteLine("Fecha de devolución: ")
  Año_D= Clock.Year
  T_año_D= Año_D*365
  TextWindow.WriteLine("Año: "+Año_D)
  Mes_D= Clock.Month
  T_mes_D= Mes_D*30
  TextWindow.WriteLine("Mes: "+Mes_D)
  Dia_D= Clock.Day
  TextWindow.WriteLine("Día: "+Dia_D)
  'Suma del prestamo
  Pres= Año+Mes+Dia
  'Suma de la devolución
  Dev= T_año_D+T_mes_D+Dia_D
  'Resta de las cantidades
  Total_D= Dev-Pres
  'CONDICIONAL
  If Total_D>30 Then
    TextWindow.ForegroundColor="RED"
    TextWindow.WriteLine("+------------------------------------------------------------------------------+")
    TextWindow.WriteLine("¦                         Se pasó de la fecha de devolución                    ¦")
    TextWindow.WriteLine("                                                                                ")
    pago= Total_D-30
    Total_pago= pago*0.25
    TextWindow.WriteLine("                              Debes un total de: $"+Total_pago)               
    TextWindow.WriteLine("¦                                                                              ¦")
    TextWindow.WriteLine("+------------------------------------------------------------------------------+")
  Else
    TextWindow.ForegroundColor="Green"
    TextWindow.WriteLine("--------------------------------------------------------------------------------")
    TextWindow.WriteLine("                       Gracias por devolver el libro a tiempo                  ")
    TextWindow.WriteLine("--------------------------------------------------------------------------------")
    
  EndIf 
  TextWindow.ForegroundColor="white"
  TextWindow.WriteLine("¿Desea reservar otro libro?")
  Ans1=text.ConvertToUpperCase(TextWindow.Read())
  If Ans1 = "SI" Then
    Goto Menu_Reserva
  ElseIf Ans1 = "NO" then
   Else
    Program.End()
  EndIf
  For b2=1 To Array.GetItemCount(Reserva_Libro)
    If Name_b= Libro1  Then
      Libro1["Ejemplares prestados"]= Libro1["Ejemplares prestados"] - 1
    EndIf
  EndFor
  For b2=1 To Array.GetItemCount(Reserva_Libro)
    If Name_b= Libro2  Then
      Libro2["Ejemplares prestados"]= Libro2["Ejemplares prestados"] - 1
    EndIf
  EndFor
  For b2=1 To Array.GetItemCount(Reserva_Libro)
    If Name_b= Libro3  Then
      Libro3["Ejemplares prestados"]= Libro3["Ejemplares prestados"] - 1
    EndIf
  EndFor
  For b2=1 To Array.GetItemCount(Reserva_Libro)
    If Name_b= Libro4  Then
      Libro4["Ejemplares prestados"]= Libro4["Ejemplares prestados"] - 1
    EndIf
  EndFor
  For b2=1 To Array.GetItemCount(Reserva_Libro)
    If Name_b= Libro5  Then
      Libro5["Ejemplares prestados"]= Libro5["Ejemplares prestados"] - 1
    EndIf 
  EndFor
  For  b2=1 To Array.GetItemCount(Reserva_Libro)
    If Name_b= Libro6  Then
      Libro6["Ejemplares prestados"]= Libro6["Ejemplares prestados"] - 1
    EndIf
  EndFor
  For b2=1 To Array.GetItemCount(Reserva_Libro)
    If Name_b= Libro7  Then
      Libro7["Ejemplares prestados"]= Libro7["Ejemplares prestados"] - 1
    EndIf
  EndFor
  For b2=1 To Array.GetItemCount(Reserva_Libro)
    If Name_b= Libro8  Then
      Libro8["Ejemplares prestados"]= Libro8["Ejemplares prestados"] - 1
    EndIf
  EndFor
  For b2=1 To Array.GetItemCount(Reserva_Libro)
    If Name_b= Libro9  Then
      Libro9["Ejemplares prestados"]= Libro9["Ejemplares prestados"] - 1
    EndIf
  EndFor
EndSub
