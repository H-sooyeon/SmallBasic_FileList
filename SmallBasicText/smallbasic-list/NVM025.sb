Sub init

  clrs=LDText.Split("blue #fe0000 magenta green cyan yellow white SaddleBrown DarkSlateGray teal tan" " ")

  clrs[0]="black

  cc[ 1]="..####.. #####  . #### . ####   .######. ###### .$#####.  ####  .#$  @#   ####   #$  @#      $#   ####   @####   ###### #######. #$      #   @#  #    #  #$  #@ .#####...#####...#$  @# .#$  @#.@#   $#.#$    #@.##### .  ##$     ####    ####    ####   ######   #### 	  ####    ####   ######     #                                                      # #     #          #      #      #      ##     ####              ############    ########    ########                                                  

  cc[ 2]=".#$  @#. #$  @# .#$  @#. #$ @#  .#$    . #$     .  $#  . #$  $# .#$  @#  #$  @#  #$  @#      $#  #$     @#   $#      #$   $#   . #$      ##  @#  ##  ##  #$ #@  .#$  @#..#$  @#..#$  @# .#$  @#  @# $#   #$  #@ #     #. # #$    #   $#  #$  @#  #@  $#  #$      #$      #@  $#  #$  ##       #    ##     #                 #                              # #   #####       #      #        #    #  #   #    #   #   #     ############    ########    ########                                        

  cc[ 3]=".#$  @#. #####  .#$    . #$  @# .##### . #####  .  $#  . #$  $# .#$  @#  #$      ######      $#   ####  @#   $#     #$    $#   . #$      #$# @#  #$##@#  ###@   .#$  @#..#$  @#..#$  @# .#$  @#   @##     #$#@  # ### #.   #$        $#   ####   #@  $#  #####   #####      ##   #$ #@#      #    # #      #     ######     #               #              # #  #  #        #      #          #  #    #       #    # #      ############    ########    ########                                    

  cc[ 4]=".######. #$  @# .#$    . #$  @# .#$    . #$     .  $#  . #$  $# .#$  @#  #$ ###  #$  @#  #@  $#      $# @# # $#    #$     $#   . #$      #@$#@#  #$  @#  #$$#   .##### ..##### ..#$  @# .#$  @#   $##      #$   # #   #.   #$     ####   #$  @#   #####      $#  #$  @#      $#  #$# @#     #    #  #       #             #####   #####                          #####     #       #          #             ##   #######    ############    ########    ########                                      

  cc[ 5]=".#$  @#. #$  @# .#$  @#. #$ @#  .#$    . #$     .  $#  . #$  $# .#$  @#  #$  @#  #$  @#  #@  $#  #$  $# @#  #$#   #$      $#   . #$      #@ $##  #$  @#  #$ $#  .#$    ..#$ @# .. #$@#  .#$##@#  $# @#     #$   # ### #.   #$    #$      #$  @#      $#  #@  $#  #$  @#  #@  $#  ##  @#    #     ######    #     ######     #               #       #              #  #   #        #          #            #       # #  ####    ####    ################    ####                                 

  cc[ 6]=".#$  @#. #####  . #### . ####   .######. #$     .$#####.  ####  . ####    ####   #$  @#   ####    ####   @####   ######   $#   . ######  #@  $#  #$  @#  #$  $# .#$    ..#$  @#..  ##   . #  #  $#   @#    #$   #     #. #####$. ######.  ####   @####    ####    ####    ####    ####     #        #     #       .         #                       #            #####   #          #        #                    #   # ####    ####    ################    ####                                          

  cc[ 7]=".................................................................................................................................................................................................................##### ..      ..      ..      ..      ..      ..      ..      ..      ..      ..      ..      ..      ..      ..      ..      ..  #   ..      ..  #   .#      ..    # ..   #  ..      ..  #   ..      .####   .####   .################   .####.      ..      ..      .                                                                                                                   #                   #      #            #        #                      #                                          

  cc[ 8]=".................................................................................................................................................................................................................                                                                                                                                                                                                       ####    ####    ################    ####                                                                

  

  cc[ 9]=".................................................................................................................................................................................................................                     

  cc[10]=" ..##.  . ###    . ##   . ###    .####  . ####   .  #   .  ##    .#  #     ###    #  #       #     ###     ##     ####   #####    #       #  #   #   #    #  #  . ###.  ..###..   #  #   .#   #  .#   #  .#   # 

  cc[11]=" .#  #  . #  #   .#  #  . #  #   .#     . #      .  #   . #  #   .#  #    #       #  #       #    #       #  #       #     #    . #       ## #   ## ##    # #   . #  #  ..#  #.   #  #   .#   #    # #     # #                  

  cc[12]=" .####  . ###    .#     . #  #   .###   . ###    .  #   . #  #   .#  #    # ##    ####       #     ##     #  #      #      #    . #       # ##   # # #    ##    . ###   ..### .   #  #   .#   #     #       #

  cc[13]=" .#  #  . #  #   .#  #  . #  #   .#     . #      .  #   . #  #   .#  #    #  #    #  #    #  #       #    # ##     #       #    . #       #  #   #   #    # #   . #     ..# # .   # #    .# # #    # #      #

  cc[14]=" .#  #  . ###    . ##   . ###    .####  . #      .  #   .  ##    . ##      ###    #  #     ##     ###      # #    ####     #    . ####    #  #   #   #    #  #  . #     ..#  #.    #     . # #    #   #     #

  oppc="blue

  GraphicsWindow.PenWidth=0

  GraphicsWindow.BackgroundColor="DarkSlateGray

  GraphicsWindow.BrushColor="darkblue

  GraphicsWindow.Width=1460

  GraphicsWindow.Height=940

  GraphicsWindow.Top=5

  GraphicsWindow.Title="ZX Editor

  LDUtilities.ShowErrors="false

  not="true=false;false=true

  ix="ABCDEFIOUGHJSQZTLNMKPRVWXY[1289563074>=+-:,`$/()^?*!@#&% "

  mcm=LDText.Split("BORDER PAPER INK CLS NEW SAVE LOAD RUN LIST LET PERT PLOT DRAW INPUT PRINT Goto DATA READ RESTORE RANDOMIZE CLEAR For NEXT If Then INKEY$ AT IMAGE " " ")

  MHH=LDText.Split("bb pp ii cl nw sv ld rn ls lt pt pl dr in pr go dd rd rs rz cr ff nx If th ik at mg" " ")

  For x=1 To Array.GetItemCount(mhh)

    mc[mhh[x]]=mcm[x]

    cmc[mhh[x]]=Text.GetCharacter(170+x)

  EndFor

  

  args=0

  shh[0]=LDText.Split("8 7 6 5 4 3 2 1" " ")

  shh[1]=LDText.Split("1 2 3 4 5 6 7 8" " ")

  shh[2]=LDText.Split("2 4 1 8 6 7 5 3" " ")

  shh[3]=LDText.Split("3 8 2 7 1 5 4 6" " ")

  shh[4]=LDText.Split("5 1 8 2 3 4 6 7" " ")

  

  bl="#

  chm=ldtext.Split("A S D F G H J K L Q W E R T Y U I O P Z X C V B N M 0 1 2 3 4 5 6 7 8 9 + = > - : , ` $ / ( ) ^ ? * ! @ # & % [" " ")

  ppc="DarkSlateGray

  chm[57]=" "

  initt="true

  mchr()

EndSub



Sub mchr

  qdd=0

  For h=1 To 57

    If h>=51 Then

      qdd=1

    EndIf

    thh=chm[h]

    If initt Then

      LDCall.Function2("gench" thh qdd)

      LDCall.Function("gencb" thh)

      If h<27 Then

        LDCall.Function("gencm" thh)

      EndIf

      jj[thh]=LDImage.Copy(ii[thh])

      

      LDImage.ReplaceColour(ii[thh] oppc "black" 5)

      LDImage.ReplaceColour(ii[thh] "red" "white" 5)

      LDImage.ReplaceColour(kk[thh] oppc ppc 5)

      LDImage.ReplaceColour(kk[thh] "red" "lime" 5)

      

    EndIf

    LDImage.ReplaceColour(jj[thh] oppc ppc 5)

    LDImage.ReplaceColour(jj[thh] "red" "black" 5)

    

    LDImage.ReplaceColour(im[thh] oppc ppc 5)

    LDImage.ReplaceColour(im[thh] "red" "black" 5)

    

  EndFor

  oppc=ppc

  initt="false

EndSub



Sub begin

  

  init()

  GraphicsWindow.KeyDown=kkk

  ss=1

  ttw="1=1;2=3;3=4

  LDCall.Function5("print2" 1 22 "[1982 SINCLAIR RESEARCH LTD " "teal" "2333322222222224444444444444444444444")

  Program.Delay(1333)

  GraphicsWindow.Clear()

  ppc="teal

EndSub



GraphicsWindow.Title="init...



bgg:

nww="false

begin()

ppc=clrs[9]

mmr[10]=cmc["pr"]+"`HELLO To ZX fans world`

'mmr[20]=cmc["lt"]+"B=2:"+cmc["lt"]+"C=3,14159"

'mmr[30]=cmc["pr"]+"A+B-C/D*a^b



LDDialogs.AddRightClickMenu(mcm "")

LDDialogs.RightClickMenu=rmmn

Sub rmmn

  cml=cml+":"+Text.GetCharacter(170+LDDialogs.LastRightClickMenuItem)

  dcln()

  kyy="true

  mode=2

EndSub

GraphicsWindow.BrushColor=ppc

GraphicsWindow.FillRectangle(0 0 1700 1100)



lll:

ql=0

Timer.Tick=tttm

Timer.Interval=150



Timer.Pause()

For qq=1 To 300

  If Text.StartsWith(mmr[qq] ":") Then

    mmr[qq]=Text.GetSubTextToEnd(mmr[qq] 2)

  EndIf

  If Array.ContainsIndex(mmr qq) Then

    cml=mmr[qq]

    

    dcln()

    clf=text.append(text.GetSubText("2222222222" 1 Text.GetLength(qq)+1) clf)

    ' TextWindow.WriteLine(clf)

    LDCall.Function5("print2" 1 ql qq+" "+cln "teal" clf)

    

    ql=ql+1

  EndIf

EndFor

kyy="false

cml=""



While "true

  LDCall.Function5("print" 1 22 "K" "teal" 1)

  Program.Delay(355)

  If kyy Then

    Goto ccf

  EndIf

  LDCall.Function5("print" 1 22 "K" "teal" 2)

  Program.Delay(355)

  If kyy Then

    Goto ccf

  EndIf

EndWhile



ccf:

cml=""

LDCall.Function5("print" 1 22 " " ppc 2)

fx=fx-1

rw=22

mode=1

'-------------------------------------------main loop-------------------------------------------------

Timer.Resume()



Sub tttm

  If kyy Then

    mmd=Text.GetSubText("KLCEG" mode 1)

    dcln()

    LDCall.Function5("print" 1 22 "                                         " ppc 2)

    fx=1

    LDCall.Function5("print" fx rw cln ppc 2)

    LDCall.Function5("print" fx rw mmd ppc 1)

    'kyy="false

  EndIf 

EndSub





While "true

  

  

  

  If brk Then

    Goto xxx

  EndIf

  If nww Then

    GraphicsWindow.Clear()

    GraphicsWindow.BrushColor="black

    GraphicsWindow.FillRectangle(50 50 1280 720)

    Program.Delay(555)

    GraphicsWindow.Clear()

    Program.Delay(555)

    Goto bgg

  EndIf

  

  If lstt Then

    lstt="false

    Goto lll

  EndIf

  

  If evv Then

    evv="false

    evlcml()

    LDCall.Function5("print" 1 22 "0 OK 0:1                              " ppc 2)

    fx=1

    dcc="true

    cml=""

    mode=1

  EndIf

  

EndWhile'---------------------------------------------------------------------------------------endmainloop



xxx:

GraphicsWindow.Clear()

brk="false

LDCall.Function5("print" 1 22 "D BREAK 0:1" ppc 2)

Program.Delay(1377)

GraphicsWindow.Clear()

LDCall.Function5("print" 1 22 "LIST" ppc 2)

LDCall.Function5("print" 6 22 "L" ppc 1)

Program.Delay(1377)

GraphicsWindow.Clear()

Goto lll



Sub kkk'--------------------------------*********************--KEYS

  ll=text.ConvertToLowerCase( GraphicsWindow.LastKey)

  'GraphicsWindow.Title=ll

  kyy="true

  If ll="right" Then

    iss=iss+1

  ElseIf ll="left" Then

    iss=iss-1

  ElseIf ll="escape" Then

    brk="true

    extt="true

    

  ElseIf TEXT.StartsWith( ll "ret" ) Then

    

    If Text.StartsWith(cml ":") Then

      cml=Text.GetSubTextToEnd(cml 2)

    EndIf

   ' TextWindow.WriteLine(">>'"+cml+"'")

    li=LDText.Split(cml ":")

    If text.GetCharacterCode( Text.GetSubText(li[1] 1 1))>=170 Then

      evv="true

      

    Else

      ln=text.GetSubTextToEnd (ldtext.Trim (li[1]) 2)

      

      lnm=LDUtilities.IsNumber(ln)

      'TextWindow.WriteLine("?>"+ln)

      If not[lnm] Then

        

        '    tl=FCDialogs.AskForTextLine("To Line:")

        '   If tl="" Then

        evv="true

       ' TextWindow.WriteLine("<<<<")

        '  Else

        '   mmr[tl]=cml

        '  cml=""

        ' lstt="true

        ' EndIf

        

      Else

        mmr[ln]=""

        For rr=2 To Array.GetItemCount(li)

          mmr[ln]=text.append(mmr[ln] ":"+li[rr])

        EndFor

        ' TextWindow.WriteLine(">:"+mmr[ln])

        lstt="true

        cml=""

      EndIf

    EndIf

    

  ElseIf ll="back" Then

    chp="" 

    

    cml=Text.GetSubText(cml 1 Text.GetLength(cml)-1)

    GraphicsWindow.Title=cml

    If Text.GetLength(cml)<=1 Then

      mode=1

    EndIf

    

  ElseIf ll="space" Then

    cml=cml+" "

    

    

  ElseIf ll="f1" Then

    mode=1

    chp=""

  ElseIf ll="f2" Then

    mode=2

    chp=""

    

  ElseIf ll="f3" Then

    chp="`

    cml=text.append(cml chp)

  ElseIf ll="f4" Then

    chp="$

    cml=text.append(cml chp)

  ElseIf ll="f5" Then

    chp="!

    cml=text.append(cml chp)

  ElseIf ll="f6" Then

    chp="^

    cml=text.append(cml chp)

  ElseIf ll="f7" Then

    chp=";

    cml=text.append(cml chp)

  ElseIf ll="f8" Then

    chp="*

    cml=text.append(cml chp)

  ElseIf ll="f9" Then

    chp="(

    cml=text.append(cml chp)

  ElseIf ll="f11" Then

    chp=")

    cml=text.append(cml chp)

  ElseIf ll="oem5" Then

    chp="?

    cml=text.append(cml chp)

  ElseIf ll="oemopenbrackets" Then

    chp="@

    cml=text.append(cml chp)

  ElseIf ll="oem6" Then

    chp="%

    cml=text.append(cml chp)

  ElseIf ll="oem1" Then

    chp="&

    cml=text.append(cml chp)

  ElseIf ll="oemquotes" Then

    chp="#

    cml=text.append(cml chp)

  ElseIf ll="oemplus" Then

    chp="=

    cml=text.append(cml chp)

    

  ElseIf Text.GetLength(ll)=2 Then

    chp=Text.GetSubTextToEnd(ll 2)

    cml=text.append(cml chp)

    

    

  Else

    

    chp=""

    If mode=1 Then

      If ll="b" Then

        '  chp="BORDER "

        cml=cml+":"+cmc["bb"]

        mode=2

      ElseIf ll="p" Then

        '  chp="PAPER "

        cml=cml+":"+cmc["pp"]

        mode=2

      ElseIf ll="z" Then

        '   chp="per.table

        cml=cml+":"+cmc["pt"]

        mode=2

      ElseIf ll="i" Then

        '   chp="INK "

        cml=cml+":"+cmc["ii"]

        mode=2

      ElseIf ll="c" Then

        '   chp="CLS"

        cml=cml+":"+cmc["cl"]

        mode=2

        ' mcm=LDText.Split("BORDER PAPER INK CLS NEW SAVE LOAD RUN LIST LET PERT PLOT DRAW INPUT PRINT Goto DATA READ RESTORE RANDOMIZE CLEAR For NEXT If Then INKEY$ AT " " ")

        '       MHH=LDText.Split("bb pp ii cl nw sv ld rn ls lt pt pl dr in pr go dd rd rs rz cr ff nx If th ik at " " ")

        

      ElseIf ll="f" Then        '    chp="For

        cml=cml+":"+cmc["ff"]

        mode=2

      ElseIf ll="n" Then        '    chp="nxt

        cml=cml+":"+cmc["nx"]

        mode=2

      ElseIf ll="y" Then        '    chp="If

        cml=cml+":"+cmc["If"]

        mode=2 

      ElseIf ll="t" Then        '    chp="Then

        cml=cml+":"+cmc["th"]

        mode=2

      ElseIf ll="g" Then        '    chp="Goto

        cml=cml+":"+cmc["go"]

        mode=2

      ElseIf ll="d" Then        '    chp="data

        cml=cml+":"+cmc["dd"]

        mode=2

      ElseIf ll="a" Then        '    chp="NEW"

        cml=cml+":"+cmc["nw"]

        mode=2

      ElseIf ll="r" Then        '   chp="RUN "

        cml=cml+":"+cmc["rn"]

        mode=2

      ElseIf ll="k" Then        '    chp="Let

        cml=cml+":"+cmc["lt"]

        mode=2

      ElseIf ll="q" Then        '    chp="input

        cml=cml+":"+cmc["in"]

        mode=2

      ElseIf ll="k" Then        '    chp="let

        cml=cml+":"+cmc["lt"]

        mode=2

      ElseIf ll="w" Then        '    chp="print

        mode=2

        cml=cml+":"+cmc["pr"]

      ElseIf ll="e" Then        '    chp="at

        cml=cml+":"+cmc["at"]

        mode=2

      ElseIf ll="l" Then        '    chp="LIST "

        cml=cml+":"+cmc["ls"]

        mode=2

      ElseIf ll="s" Then        '    chp="SAVE "

        cml=cml+":"+cmc["sv"]

        mode=2

      ElseIf ll="j" Then        '    chp="Load

        cml=cml+":"+cmc["ld"]

        mode=2

      EndIf

    Else

      

      chp=text.GetSubText( ll 1 1)

      If ll="oem1" Then

        chp=":"

        mode=1

      EndIf

      

      

      

      If Text.GetLength(ll)=1 Then

        cml=cml+chp

      EndIf

    EndIf

    

  EndIf

  ' GraphicsWindow.Title=cml

EndSub'------------------------------------------------------******





Sub dcln

  txl=LDText.Split(cml ":")

  cln=""

  clf=""

  For wt=1 To Array.GetItemCount(txl)

    cs=text.GetCharacterCode( Text.GetSubText(txl[wt] 1 1))-170

    s2=Text.GetSubTextToEnd(txl[wt] 2)

    lls=Text.GetLength(mc[mhh[cs]])

    ll1=Text.GetLength(s2)

    

    cln=cln+mc[mhh[cs]]+" "+s2+":"

    clf=text.append(clf Text.GetSubText("333333333333333333333333333333333333333333" 1 lls))

    clf=text.append(clf Text.GetSubText("22222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222" 1 ll1+2))

  EndFor

  cln=Text.GetSubText(cln 1 Text.GetLength(cln)-1)

  ' TextWindow.WriteLine(clf)

EndSub



Sub pertbl

  Timer.Pause()

  elo="hhh;hel;lll;bry;bbb;ccc;nnn;ooo;fff;neo;nam;mgs;alm;sil;ppp;sss;chn;agn;kkk;clu;scd;tin;vvv;chr;mmm;frr;cob;nck;cpp;zzz;ggg;ger;asm;sen;bmn;kry;rbd;soc;yyy;zrn;nib;moy;ttt;rnm;rrr;pad;arg;cdd;inm;stn;sbm;tlr;iii;xxx;cae;bar;lan;cer;pdy;ndy;pmh;sar;eee;gdn;ter;dys;hlm;erb;tul;yrb;lue;hfn;tan;www;rhe;osm;ird;pat;aaa;hgr;tlm;plb;bsm;pol;att;ron;fnc;rau;act;tho;pra;uuu;npt;ptu;amc;cim;bkl;cfn;eis;fum;mdl;nbl;lwc;rtf;ddd;srg;boh;hss;met;dst;rgn;cpm;nhu;fve;msc;lvm;tss;ogn

  ell=LDText.Split(elo ";")

  ss="Ac act Actin# 90 270!Ar agn Argon 510 60!Al alm Alumin# 360 60!Am amc Americ# 270 270!Ag arg Silver 300 120!As asm Arsenic 420 90!At att Astatine 480 150!Au aaa Gold 300 150!Ba bar Bar# 30 150!Bk bkl Berkel# 330 270!Br bmn Bromine 480 90!Bh boh Bohr# 180 180!B  bbb Boron 360 30!Be bry Beryll# 30 30!Bi bsm Bismuth 420 150!Cs cae Caes# 0 150!Cd cdd Cadm# 330 120!Ce cer Cer# 120 240!Cf cfn Californ# 360 270!Cl chn Chlorine 480 60!Cr chr Chrom# 150 90!Cm cim Cur# 300 270!Ca clu Calc# 30 90!Co cob Cobalt 240 90!Cn cpm Copernic# 330 180!Cu cpp Copper 300 90!C  ccc Carbon 390 30!Db ddd Dubn# 120 180!Ds dst Darmstadt# 270 180!Dy dys Dyspros# 360 240!Es eis Einstein# 390 270!Er erb Erb# 420 240!Eu eee Europ# 270 240!F  fff Fluorine 480 30!Fr fnc Franc# 0 180!Fe frr Iron 210 90!Fm fum Ferm# 420 270!Fl fve Flerov# 390 180!Ga ggg Gall# 360 90!Gd gdn Gadolin# 300 240!Ge ger German# 390 90!He hel Hel# 510 0!Hf hfn Hafn# 90 150!Hg hgr Mercury 330 150!Ho hlm Holm# 390 240!Hs hss Hass# 210 180!H  hhh Hydrogen 0 0!In inm Ind# 360 120!I  iii Iodine 480 120!Ir ird Irid# 240 150!K  kkk Potass# 0 90!Kr kry Krypton 510 90!$= ltd ltds 60 240!*= atd actds 60 270!La lan Lanthanum 90 240!Li lll Lith# 0 30!Lu lue Lutet# 510 240!Lv lvm Livermor# 450 180!Lr lwc Lawrenc# 510 270!Md mdl Mendelev# 450 270!Mt met Meitner# 240 180!Mg mgs Magnes# 30 60!Mn mmm Manganese 180 90!Mo moy Molybdenum 150 120!Mc msc Moscov# 420 180!Na nam Sod# 0 60!No nbl Nobel# 480 270!Ni nck Nickel 270 90!Nd ndy Neodym# 180 240!Ne neo Neon 510 30!Nh nhu Nihon# 360 180!Nb nib Niob# 120 120!Np npt Neptun# 210 270!N  nnn Nitrogen 420 30!Og ogn Oganesson 510 180!Os osm Osm# 210 150!O  ooo Oxygen 450 30!Pd pad Pallad# 270 120!Pt pat Platinum 270 150!Pr pdy Praseodym# 150 240!P  ppp Phosphorus 420 60!Pb plb Lead 390 150!Pm pmh Prometh# 210 240!Po pol Polon# 450 150!Pa pra Protactin# 150 270!Pu ptu Pluton# 240 270!Ra rau Rad# 30 180!Rb rbd Rubid# 0 120!Rh rrr Rhod# 240 120!Rg rgn Roentgen# 300 180!Re rhe Rhen# 180 150!Ru rnm Ruthen# 210 120!Rn ron Radon 510 150!Rf rtf Rutherford# 90 180!Sm sar Samar# 240 240!Sb sbm Antimony 420 120!Sc scd Scand# 60 90!Se sen Selen# 450 90!Si sil Silicon 390 60!Sr soc Stront# 30 120!Sg srg Seaborg# 150 180!Sn stn Tin 390 120!S  sss Sulfur 450 60!Ta tan Tantalum 120 150!Ts tss Tennessine 480 180!Tb ter Terb# 330 240!Tc ttt Technet# 180 120!Th tho Thor# 120 270!Tl tlm Thall# 360 150!Te tlr Tellur# 450 120!Ti tin Titan# 90 90!Tm tul Thul# 450 240!U  uuu Uran# 180 270!V  vvv Vanad# 120 90!W  www Tungsten 150 150!Xe xxx Xenon 510 120!Yb yrb Ytterb# 480 240!Y  yyy Yttr# 60 120!$$ lnd Lantanoides 60 150!** acd Actinoides 60 180!Zn zzz Zinc 330 90!Zr zrn Zircon# 90 120!

  ss=LDText.Replace(ss "#" "ium")

  mm=LDText.Split(ss "!")

  

  For qf=1 To 122

    lmm=LDText.Split(mm[qf] " ")

    LDCall.Function3("addb" text.GetSubText(lmm[1]+" " 1 2) lmm[4] lmm[5] )

    'LDCall.Function3("addb1" LDArray.GetIndex(ell lmm[2]) lmm[4] lmm[5]) 

  EndFor

  extt="false

  While extt="false

    If kyy Then

      kyy="false

      GraphicsWindow.Clear()

      For qf=1 To 122

        lmm=LDText.Split(mm[qf] " ")

        LDCall.Function3("addb" text.GetSubText(lmm[1]+" " 1 2) lmm[4] lmm[5] )

        'LDCall.Function3("addb1" LDArray.GetIndex(ell lmm[2]) lmm[4] lmm[5]) 

        

      EndFor

      lmm=LDText.Split(mm[iss] " ")

      LDCall.Function3("addb1" text.GetSubText(lmm[1]+" " 1 2) lmm[4] lmm[5] )

      GraphicsWindow.Title="("+lmm[1]+")"+LDArray.GetIndex(ell lmm[2])+" "+lmm[3]+" : "+lmm[2]

    EndIf

  EndWhile

  lstt="true

  Timer.Resume()

EndSub





Sub addb

  px=args[2]/30

  py=args[3]/15

  LDCall.Function5("print" px*2 py args[1] ppc math.Remainder(px 2)+1)

EndSub



Sub addb1

  px=args[2]/30

  py=args[3]/15

  LDCall.Function5("print" px*2 py args[1] ppc 3)

EndSub



Sub evlcml

  

  cx=LDText.Split(cml ":")

  For lx=1 To Array.GetItemCount(cx)

    ee=cx[lx]

    If Text.StartsWith(ee cmc["pp"]) Then

      tt=Text.GetSubText(ee 2 1)

      

      ppc=clrs[ldmath.Base2Decimal( tt 16)]

      ' GraphicsWindow.Title=ppc

      mchr()

      ElseIf Text.StartsWith(ee cmc["mg"]) Then

      LDUtilities.FixFlickr()

      il=ImageList.LoadImage(Flickr.GetRandomPicture("sky"))

      GraphicsWindow.Clear()

      LDGraphicsWindow.BackgroundImage(il)

    ElseIf Text.StartsWith(ee cmc["nw"]) Then

      nww="true

      mmr=""

      Timer.Pause()

      

    ElseIf Text.StartsWith(ee cmc["pt"]) Then

      GraphicsWindow.Clear()

      pertbl()

      

    ElseIf Text.StartsWith(ee cmc["cl"]) Then

      GraphicsWindow.Clear()

      lstt="true

      

    ElseIf Text.StartsWith(ee cmc["in"]) Then

      vv=LDText.Split(ee " ")

      'TextWindow.WriteLine(vv)

      qww=vv[2]

      If qww="" Then

        qww="supply "+text.GetSubTextToEnd( vv[1] 2)

      EndIf

      vrr[text.GetSubTextToEnd( vv[1] 2)]=FCDialogs.AskForTextLine(qww)

      

    ElseIf Text.StartsWith(ee cmc["sv"]) Then

      ff=LDDialogs.SaveFile("zx" "e:\")

' The following line could be harmful and has been automatically commented.

'       File.WriteContents(ff mmr)

      

    ElseIf Text.StartsWith(ee cmc["ld"]) Then

      ff=LDDialogs.OpenFile ("zx" "e:\")

' The following line could be harmful and has been automatically commented.

'       mmr=File.ReadContents(ff)

      lstt="true

      

    ElseIf Text.StartsWith(ee cmc["ls"]) Then

      lstt="true

    ElseIf Text.StartsWith(ee cmc["bb"]) Then

      tt=text.ConvertToLowerCase( Text.GetSubText(ee 2 1))

      '  GraphicsWindow.Title=ee

      'TextWindow.WriteLine(tt)

      tt=ldmath.Base2Decimal( tt 16)

      bc=clrs[tt]

      

      GraphicsWindow.BrushColor=bc

      GraphicsWindow.FillRectangle(0 0 1600 48)

      GraphicsWindow.FillRectangle(0 850 1600 500)

      GraphicsWindow.FillRectangle(0 0 80 1000)

      GraphicsWindow.FillRectangle(1370 0 800 1000)

    EndIf

  EndFor

  

EndSub



Sub print2

  fx=args[1]

  yy=args[2]

  tt=args[3]

  ccc=args[4]

  c1s=args[5]

  tu=tt' Text.ConvertToUpperCase(tt)

  For f=1 To Text.GetLength(tt)

    qw=text.GetSubText(tu f 1)

    c1=text.GetSubText(c1s f 1)

    If c1=2 Then

      jm=jj[qw] 

    ElseIf c1=3 Then

      jm=kk[qw] 

    ElseIf c1=4 Then

      jm=im[qw] 

    Else

      jm=ii[qw]

    EndIf

    

    GraphicsWindow.DrawImage(jm fx*32+50 50+yy*32)

    fx=fx+1

    If fx>40 Then

      fx=2

      yy=yy+1

    EndIf

  EndFor

EndSub





Sub print

  fx=args[1]

  yy=args[2]

  tt=args[3]

  ccc=args[4]

  c1=args[5]

  tu=tt' Text.ConvertToUpperCase(tt)

  For f=1 To Text.GetLength(tt)

    qw=text.GetSubText(tu f 1)

    If c1=2 Then

      jm=jj[qw] 

    ElseIf c1=3 Then

      jm=kk[qw] 

    ElseIf c1=4 Then

      jm=im[qw] 

    Else

      jm=ii[qw]

    EndIf

    

    GraphicsWindow.DrawImage(jm fx*32+50 50+yy*32)

    fx=fx+1

    If fx>40 Then

      fx=2

      yy=yy+1

    EndIf

  EndFor

EndSub



Sub gencm

  ch=args[1]

  GraphicsWindow.BrushColor="blue

  GraphicsWindow.PenWidth=0

  ss=shapes.AddRectangle (32 32)

  gg=FCDrawings.CreateGraphicsFromControl(ss)

  qw=Text.GetIndexOf(ix ch)-1

  For x=0 To 7  

    For y=0 To 7

      n=x+8*qw+1

      If Text.IsSubText (bl text.getSubText(cc[y+8] n 1)) Then

        lx=x*4

        ly=y*4

        FCDrawings.FillRectangle(gg "red" lx ly 4 4)

      EndIf

    EndFor

  EndFor

  

  im[ch]=FCDrawings.GenerateImage(gg)

  Shapes.Remove(ss)

EndSub



Sub gench

  ch=args[1]

  qd=args[2]

  GraphicsWindow.BrushColor="blue

  GraphicsWindow.PenWidth=0

  ss=shapes.AddRectangle (32 32)

  gg=FCDrawings.CreateGraphicsFromControl(ss)

  qw=Text.GetIndexOf(ix ch)-1

  

  For x=0 To 7  

    For y=0 To 7

      n=x+8*qw+1

      If Text.IsSubText (bl text.getSubText(cc[y+qd] n 1)) Then

        lx=x*4

        ly=y*4

        FCDrawings.FillRectangle(gg "red" lx ly 4 4)

      EndIf

    EndFor

  EndFor

  

  '  GraphicsWindow.Title=ch

  mg=FCDrawings.GenerateImage(gg)

  ii[ch]=mg

  

  thh=ch 

  'Shapes.AddImage(mg)

  'Program.Delay(155)

  Shapes.Remove(ss)

EndSub



Sub gencb

  ch=args[1]

  GraphicsWindow.BrushColor="blue

  GraphicsWindow.PenWidth=0

  ss=shapes.AddRectangle (32 32)

  gg=FCDrawings.CreateGraphicsFromControl(ss)

  qw=Text.GetIndexOf(ix ch)-1

  

  For x=0 To 7  

    For y=0 To 7

      n=x+8*qw+1

      If Text.IsSubText ("#$@" text.getSubText(cc[y] n 1)) Then

        lx=x*4

        ly=y*4

        FCDrawings.FillRectangle(gg "red" lx ly 4 4)

      EndIf

    EndFor

  EndFor

  

  kk[ch]=FCDrawings.GenerateImage(gg)

  thh=ch

  Shapes.Remove(ss)

EndSub










