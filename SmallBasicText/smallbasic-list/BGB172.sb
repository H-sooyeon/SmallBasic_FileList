GraphicsWindow.Width = 1288

GraphicsWindow.Height = 688

GraphicsWindow.BackgroundColor = "rosybrown"

GraphicsWindow.KeyDown=Onkeydown

shape_init() 'Â Â  Human and Tree shape data 

N=0

M=0

shapes_add() 'Â  Human shapes

N=1

For M=1 to 6

Â  shapes_add()Â  'Â  Tree shapes

endfor

'Animate shapes - eyes and mouth

dZ = 0.1

zoom = 1

ddx=4

While 0=0

Â  zoom = zoom - dZ

Â  For i = 1 To Array.GetItemCount(shape[0])

Â Â Â  If Array.ContainsValue(shape[0][i], "eye") Then

Â Â Â Â Â  Shapes.Zoom(shp[0][i], 1, zoom)

Â Â Â  ElseIf Array.ContainsValue(shape[0][i], "mouth") Then

Â Â Â Â Â  Shapes.Zoom(shp[0][i], zoom, zoom)

Â Â Â  EndIf

Â Â Â  shapes.Move(shp[0][i],shapes.GetLeft(shp[0][i])+ddx,shapes.Gettop(shp[0][i]))

Â  EndFor

Â  If zoom = 0 Or zoom = 1 Then

Â Â Â  dZ = -dZ

Â  EndIf

Â  Program.Delay(100)

EndWhile



Sub Onkeydown

Â  key= GraphicsWindow.LastKey

Â  If key="S" Then

Â  Â  ddx=4

Â  ElseIf key="A"Then

Â  Â  ddx=-4

Â  ElseIf key="Space" Then

Â  Â  ddx=0

EndIfÂ 

EndSub 



Sub shapes_add

Â  ss=s[M]Â Â Â  'Â  <--------- scaleÂ  data

Â  for i=1 To Array.GetItemCount(shape[N])Â  

Â Â Â  GraphicsWindow.PenWidth = shape[N][i]["pw"]

Â Â Â  GraphicsWindow.BrushColor = shape[N][i]["bc"] 

Â Â Â  GraphicsWindow.penColor = shape[N][i]["pc"] 

Â Â Â  If shape[N][i]["func"]="ell" Then 

Â Â Â Â Â  shp[M][i] = Shapes.AddEllipse(shape[N][i]["width"]*ss, shape[N][i]["height"]*ss) 

Â Â Â  ElseIf shape[N][i]["func"]="rect" Then 

Â Â Â Â Â  shp[M][i] = Shapes.AddRectangle(shape[N][i]["width"]*ss, shape[N][i]["height"]*ss)

Â Â Â  ElseIf shape[N][i]["func"]="tri" Then 

Â Â Â Â Â  shp[M][i] = Shapes.Addtriangle(shape[N][i]["x1"]*ss, shape[N][i]["y1"]*ss,shape[N][i]["x2"]*ss, shape[N][i]["y2"]*ss, shape[N][i]["x3"]*ss, shape[N][i]["y3"]*ss) 

Â Â Â  EndIf

Â Â Â  Shapes.Animate(shp[M][i], shape[N][i]["x"]*ss+shX[M], shape[N][i]["y"]*ss+shY[M], 500)

Â  EndFor

EndSub

Sub shape_init 

Â  ' HumanÂ Â  Data

Â  shape[0][1] = "func=ell;x=475;y=167;width=30;height=32;bc=bisque;tag=ear"'left

Â  shape[0][2] = "func=ell;x=572;y=167;width=30;height=32;bc=bisque;tag=ear"'right

Â  shape[0][3] = "func=ell;x=488;y=145;width=100;height=100;bc=darkgoldenrod;tag=face"

Â  shape[0][4] = "func=ell;x=515;y=165;width=10;height=10;bc=blue;tag=eye"'left

Â  shape[0][5] = "func=ell;x=555;y=165;width=10;height=10;bc=blue;tag=eye"'right

Â  shape[0][6] = "func=ell;x=533;y=175;width=10;height=30;bc=sienna;tag=nose"

Â  shape[0][7] = "func=ell;x=522;y=210;width=30;height=10;bc=pink;tag=mouth"

Â  shape[0][8] = "func=rect;x=515;y=240;width=50;height=100;bc=sienna;tag=body"

Â  shape[0][9] = "func=tri;x1=500;y1=150;x2=540;y2=100;x3=580;y3=150;bc=purple;angle=0;pw=0;tag=head"

Â  shape[0][10] = "func=rect;x=520;y=340;width=8;height=50;bc=yellow;Leg1"

Â  shape[0][11] = "func=rect;x=550;y=340;width=8;height=50;bc=yellow;Leg2"

Â  shape[0][12] = "func=rect;x=565;y=270;width=50;height=8;bc=green;tag=mouth"'hand2

Â  shape[0][13] = "func=rect;x=463;y=270;width=50;height=8;bc=green;tag=mouth"'hand1

Â  'Â  Tree data

Â  shape[1][1]="func=ell;X=0;Y=188;width=200;height=140;bc=Green;pc=Green;pw=2"

Â  shape[1][2]="func=ell;X=10;Y=277;width=80;height=60;bc=Green;pc=Green;pw=2

Â  shape[1][3]="func=ell;X=4;Y=255;width=80;height=70;bc=Green;pc=Green;pw=2

Â  shape[1][4]="func=ell;X=0;Y=191;width=80;height=80;bc=Green;pc=Green;pw=2

Â  shape[1][5]="func=ell;X=40;Y=177;width=80;height=80;bc=Green;pc=Green;pw=2

Â  shape[1][6]="func=ell;X=100;Y=177;width=120;height=80;bc=Green;pc=Green;pw=2

Â  shape[1][7]="func=ell;X=130;Y=240;width=100;height=80;bc=Green;pc=Green;pw=2

Â  shape[1][8]="func=ell;X=130;Y=260;width=100;height=80;bc=Green;pc=Green;pw=2

Â  shape[1][9]="func=rect;X=80;Y=322;width=60;height=100;bc=saddlebrown;pc=darkslatgray;pw=2

Â  shape[1][10]="func=tri;X1=140;Y1=262;X2=110;Y2=322;X3=140;Y3=322;bc=saddlebrown;pc=darkslatgray;pw=0

Â  shape[1][11]="func=tri;X1=140;Y1=262;X2=170;Y2=262;X3=140;Y3=322;bc=saddlebrown;pc=darkslatgray;pw=0

Â  shape[1][12]="func=tri;X1=50;Y1=262;X2=96;Y2=262;X3=80;Y3=322;bc=saddlebrown;pc=darkslatgray;pw=0

Â  shape[1][13]="func=tri;X1=96;Y1=262;X2=80;Y2=322;X3=126;Y3=322;bc=saddlebrown;pc=darkslatgray;pw=0

Â  'Â  scale andÂ Â  start XY position 

Â  s? Â? = "0=1.1;1=.8;2=.8;3=.8;4=.8;5=.8;6=.8"

Â  shX = "0=0;1=10;2=160;3=655;4=822;5=988;6=1100"

Â  shY = "0=0;1=188;2=180;3=112;4=88;5=102;6=122"

endsub


