args=0
lwq="1=1\=#        $ w    w            $ #\;2\=#               $              #\;3\=#                              #\;4\=#                              #\;5\=#                      *$  *   #\;6\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=~~~~\\\=~~~~\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;7\=#                             $#\;8\=#\\\=\\\=\\\=                           #\;9\=#           1    ### *         #\;10\=#\\\=\\\=\\\=\\\=   --------------------   #\;11\=#                            \\\=\\\=#\;12\=#                              #\;13\=#           *       ###~~~~~\\\=\\\=\\\=#\;14\=#    \\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=         EE#\;15\=#                            EE#\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=     The Central Cavern      L01\;18\=~x\;;2=1\=#                  #############\;2\=#      $                $     *#\;3\=#                              #\;4\=#                    ~~~\\\=      #\;5\=#     1                        #\;6\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=        #  #\;7\=#                    \\\=\\\=\\\=\\\=#~~#  #\;8\=#\\\=~~~~~                  #$ #  #\;9\=#                        #~~#  #\;10\=#  $     \\\=\\\=\\\=\\\=\\\=\\\=\\\=         #~~#  #\;11\=#                  ~~~~  #~~#  #\;12\=#  ----                  #~~#  #\;13\=#             \\\=\\\=\\\=\\\= $     #~~#  #\;14\=#       ~~~~                 EE#\;15\=#             2              EE#\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=      The Cold Room          L02\;18\=~1gold~2teal~\;;3=1\=#     $   w    $  j    $   w   #\;2\=#                 w            #\;3\=#                              #\;4\=#                              #\;5\=#  1                         2 #\;6\=#\\\=\\\=\\\=\\\=~~~~~~~~~~~~~~~~~~~~~~~~~~#\;7\=#                    $        $#\;8\=#\\\=\\\=\\\=\\\=\\\=\\\=                    \\\=\\\=\\\=\\\=#\;9\=#j                             #\;10\=#j    ------                   #\;11\=#j                       \\\=\\\=\\\=\\\=\\\=\\\=#\;12\=#w            \\\=\\\=\\\=\\\=\\\=          EE#\;13\=#    \\\=\\\=\\\=\\\=\\\=\\\=                  EE#\;14\=#                    \\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;15\=#    3                         #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=          The Menagerie      L03\;18\=~1magenta~2red~3lime~\;;4=1\=#$     w      ##################\;2\=#           $            $   EE#\;3\=#                            EE#\;4\=#                  \\\=\\\=\\\=\\\=\\\=\\\=      #\;5\=#                          \\\=\\\=\\\=\\\=#\;6\=#\\\=     \\\=         \\\=             #\;7\=#           \\\=\\\=  $    \\\=\\\=\\\=      $#\;8\=#~~~                           #\;9\=#      \\\=\\\=                 \\\=\\\=\\\=  #\;10\=#                 \\\=\\\=\\\=          #\;11\=#---                          \\\=#\;12\=#           \\\=\\\=\\\=       \\\=\\\=\\\=      #\;13\=#     \\\=\\\=               w    \\\=\\\=\\\=#\;14\=#                 \\\=\\\=           #\;15\=#      1     2                 #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=  Abandoned Uranium Wrkngs   L04\;18\=~1red~2lime\;;5=1\=#                   w          #\;2\=#                              #\;3\=#                              #\;4\=#              1               #\;5\=#       2               *      #\;6\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=    ~~~~\\\=\\\=\\\=\\\=\\\=\\\=   #\;7\=#         $                  \\\=\\\=#\;8\=#                    *       $ #\;9\=#      3          ----------   #\;10\=#   \\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=                 #\;11\=#                              #\;12\=#~~\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=    \\\=\\\=\\\=\\\=\\\=\\\=\\\=     \\\=#\;13\=#      $#$                     #\;14\=#\\\=\\\=     #     #EE#             #\;15\=#    *  #     #EE#######**     #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=################\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=         Eugene's Lair       L05\;18\=~1white~2gold~3black\;;6=1\=#                            EE#\;2\=#                            EE#\;3\=#                              #\;4\=#                              #\;5\=#                    w         #\;6\=#       \\\=\\\=\\\=    \\\=\\\=    \\\=\\\=\\\=\\\=\\\=     #\;7\=#  \\\=\\\=          $#$          \\\=\\\=\\\=#\;8\=#               #             $#\;9\=#                      \\\=\\\=\\\=\\\=\\\=   #\;10\=#\\\=\\\=     1           2          #\;11\=#$     \\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=     #\;12\=#            $  #w             #\;13\=#  *            #           \\\=\\\=\\\=#\;14\=#  ----               \\\=\\\=       #\;15\=#            3            4    #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=       Processing Plant      L06\;18\=~x\;;7=1\=#             ##################\;2\=#                              #\;3\=#                 2            #\;4\=#              \\\=\\\=#@@@@@@@@@@@@$#\;5\=#                #@@@@@@@@@@@@@#\;6\=#      -----  \\\=\\\=\\\=#@@@@@@@@@@*@@#\;7\=#\\\=\\\=\\\=             #@@$@@@@@@@@@@#\;8\=#                #@@@@@@@@@$@@@#\;9\=#\\\=               #@@@@@*@@@@@@@#\;10\=#     1       \\\=\\\=\\\=#@@@@@@@@@@@@@#\;11\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=     #@$@@@@@@@@*@@#\;12\=#                #@@@@@@@@@@@@$#\;13\=#             ####@@@@@*@@@@@@@#\;14\=#        \\\=\\\=\\\=  #EE              #\;15\=#             #EE 3            #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=##################\;17\=            The Vat          L07\;18\=~x\;;8=1\=# w   j   w      #j #          #\;2\=#              1 #  #          #\;3\=#            $ \\\=\\\=#           \\\=\\\=#\;4\=#                #             #\;5\=#                #             #\;6\=#\\\=\\\=\\\=     \\\=\\\=\\\=\\\=\\\=\\\=  #\\\=\\\=           #\;7\=#             $  #   \\\=\\\=\\\=\\\=     \\\=#\;8\=# \\\=\\\=\\\=            #         \\\=   #\;9\=# $     \\\=\\\=\\\=      #   2         #\;10\=#                #\\\=\\\=\\\=\\\=\\\=        #\;11\=#\\\=          \\\=\\\=\\\=  #         \\\=\\\=\\\=\\\=#\;12\=#        \\\=\\\=      #             #\;13\=#   \\\=\\\=      3    #    \\\=\\\=\\\=\\\=\\\=    #\;14\=#          ---#EE#\\\=\\\=         $ #\;15\=#    4        #EE#     *       #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=Min.Willy meets theKongBeast L08\;18\=~x\;;9=1\=#EE#                           #\;2\=#EE             $              #\;3\=#                              #\;4\=#                              #\;5\=#           5                  #\;6\=#\\\=\\\=\\\=\\\=  \\\=\\\=\\\=  \\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=  \\\=\\\=\\\=  \\\=\\\=  #\;7\=#                              #\;8\=#                            \\\=\\\=#\;9\=#  \\\=\\\=  \\\=\\\=\\\=  --------           #\;10\=#                     \\\=\\\=\\\=  \\\=\\\=  #\;11\=#\\\=\\\=                            #\;12\=#             6                #\;13\=#  \\\=\\\=1 \\\=\\\=\\\=2 \\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=3 \\\=\\\=\\\=4 \\\=\\\=  #\;14\=#                            \\\=\\\=#\;15\=#                              #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=    Wacky Amoebatrons        L09\;18\=~x\;;10=1\=#          w \\\=\\\=\\\=# w w\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;2\=#             $ #    w        $#\;3\=#\\\=\\\=\\\=\\\=\\\=\\\=         #    $     \\\=\\\=\\\=\\\=#\;4\=#  w            #              #\;5\=#               #\\\=\\\=\\\=\\\=          #\;6\=#       \\\=~~~~~~~#      \\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;7\=#\\\=\\\=\\\=\\\=       $   #   3          #\;8\=#               #\\\=\\\=\\\=\\\=\\\=\\\=\\\=~~~    #\;9\=#\\\=\\\=\\\=\\\=\\\=        1 #              #\;10\=#w       \\\=\\\=\\\=\\\=\\\=\\\=\\\=#            \\\=\\\=#\;11\=#\\\=\\\=\\\=\\\=~~         #\\\=\\\=\\\=\\\=\\\=\\\=\\\=      w#\;12\=#             2 #      w~~~    #\;13\=#       HHHHHHHHHH             #\;14\=#\\\=\\\=\\\=         EE             \\\=\\\=\\\=#\;15\=#            EE                #\;16\=HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH\;17\=    The Endorian Forest      L10\;18\=~x\;;11=1\=#######            j    $      #\;2\=#EE                *          $#\;3\=#EE                            #\;4\=#                              #\;5\=#$                 5           #\;6\=#    \\\=\\\=\\\=\\\=\\\=\\\= 22 \\\=\\\=~~~~~~~\\\=\\\=     #\;7\=#                  $    j 44 \\\=\\\=#\;8\=#                       j      #\;9\=#\\\=\\\=  --         6       j    \\\=\\\=#\;10\=#          \\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=    *      #\;11\=#           j      j        \\\=  #\;12\=#     ~~~\\\=  j      *           #\;13\=#           *        33     \\\=\\\=\\\=#\;14\=#\\\=\\\=11                  \\\=\\\=\\\=    $#\;15\=#          7                   #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=Attck of The Mutant Telephns L11\;18\=~x\;;12=1\=# w   j   w      #j  #         #\;2\=#                              #\;3\=#              ~~              #\;4\=#              $               #\;5\=#                              #\;6\=#\\\=\\\=\\\=     ~~~~~#  #~~~~~~\\\=\\\=$    #\;7\=# $           #  #            \\\=#\;8\=#     \\\=\\\=      # $#       3     #\;9\=#  \\\=          #  #       \\\=\\\=\\\=\\\=\\\=\\\=#\;10\=#         \\\=\\\=\\\=\\\=#  #             #\;11\=#     \\\=          #\\\=\\\=\\\=          #\;12\=#                #       \\\=\\\=    #\;13\=#\\\=\\\=\\\=\\\=\\\=\\\=       2  #     *    *  #\;14\=#          \\\=\\\=\\\=#EE#-----------$ #\;15\=#  1          #EE#             #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=####\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=Ret. of the Alien Kong Beast L12\;18\=~x\;;13=1\=################################\;2\=#  H                           #\;3\=#  H       2                   #\;4\=#  H   \\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\= $\\\=\\\=\\\=\\\=#\;5\=#  H                           #\;6\=#  H               3           #\;7\=#  H   \\\=\\\=  \\\=\\\=\\\=\\\=  \\\=\\\=\\\=\\\=\\\=  \\\=\\\=\\\=\\\=  \\\=#\;8\=#  H                           #\;9\=#  H       4                   #\;10\=#  H   \\\=\\\=\\\=\\\=\\\=  \\\=\\\=\\\=  $\\\=\\\=\\\=\\\=\\\= $\\\=\\\=\\\=\\\=#\;11\=#  H 1                         #\;12\=#  H                   5       #\;13\=#  H   \\\=\\\=\\\= $\\\=\\\=\\\=  \\\=\\\=\\\=\\\=  \\\=\\\=\\\=\\\=  \\\=\\\=#\;14\=#EEH                           #\;15\=#EEH                           #\;16\=#\\\=\\\=--------------------------\\\=\\\=#\;17\=          Ore Refinery       L13\;18\=~x\;;14=1\=#              EE              #\;2\=#              EE              #\;3\=#                  $           #\;4\=#                              #\;5\=#                              #\;6\=#              j\\\=              #\;7\=#  j\\\=      j\\\=      j\\\=      j\\\=  #\;8\=#      j\\\=       $      j\\\=  $   #\;9\=#  $                           #\;10\=#    j\\\=      j\\\=      j\\\=      j\\\=#\;11\=#                              #\;12\=#j\\\=      j\\\=    ------    j\\\=    #\;13\=#                              #\;14\=#      j\\\=                      #\;15\=#                              #\;16\=################################\;17\=       Skylab Landing Bay    L14\;18\=~x\;;15=1\=#     ##                      ##\;2\=#                              #\;3\=#                        $     #\;4\=#EE     ----------------\\\=\\\=\\\=\\\=\\\=  #\;5\=#EE     j                   j  #\;6\=#\\\=\\\=\\\=\\\=\\\=  *                   j  #\;7\=#           $           \\\=\\\=  j  #\;8\=#      \\\=    \\\=\\\=              j  #\;9\=#  \\\=\\\=             \\\=\\\=        j  #\;10\=#                        \\\=\\\= j  #\;11\=#\\\=\\\=         \\\=\\\=              *  #\;12\=#                 \\\=\\\=           #\;13\=#    \\\=\\\=\\\= 2     3    4  \\\=\\\=      #\;14\=#           \\\=\\\=                 #\;15\=#                     1   $    #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=              The Bank       L15\;18\=~x\;;16=1\=#$                             #\;2\=#                              #\;3\=#                             $#\;4\=#                              #\;5\=#                              #\;6\=#\\\=    \\\=    #EE#       \\\=\\\=\\\=      #\;7\=#          #EE##              1#\;8\=#   \\\=      # $###        \\\=\\\=\\\=\\\=\\\=\\\=#\;9\=#          #  ####    2        #\;10\=#~~------------------------    #\;11\=#                $             #\;12\=#      3  ##\\\=\\\=            \\\=    #\;13\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=                     #\;14\=#                   \\\=     \\\=    #\;15\=#                4     ***     #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=       The 16th Cavern       L16\;18\=~x\;;17=1\=#                            ###\;2\=#                            EE#\;3\=#                            EE#\;4\=#                              #\;5\=#     *  *   *  *     * *      #\;6\=#\\\=\\\=~~~~~~~4 ~~~~~~~  ~~~$~~  \\\=\\\=#\;7\=#~~w~~~~~~  ~~~~~~~5 ~~~~~~  ~~#\;8\=#~~~~~~~~~  ~~~$~~~  ~~~~~w  ~~#\;9\=#~~3 ~~~~~  ~~-----  ~~~~~~6 ~~#\;10\=#$~  ~~~~~  ~~~~~~~  ~~~~~~  ~~#\;11\=#~~  ~~~~~  ~~~~~~~$~~w~~~~  ~~#\;12\=#~~  ~~~~w  ~~~~~~~~~~~~~~$  ~~#\;13\=#~~  ~~~~~  ~~~~~~~~~~~~~~~  ~~#\;14\=#                              #\;15\=#     1          2         \\\=\\\=\\\=\\\=#\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=         The Warehouse       L17\;18\=~x\;;18=1\=#                           #EE#\;2\=#               $            EE#\;3\=#                              #\;4\=#                              #\;5\=#           5                  #\;6\=#  \\\=\\\=  \\\=\\\=\\\=  \\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=  \\\=\\\=\\\=  \\\=\\\=\\\=\\\=#\;7\=#                              #\;8\=#\\\=\\\=            6               #\;9\=#           \\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=  \\\=\\\=\\\=  \\\=\\\=  #\;10\=#  \\\=\\\=  \\\=\\\=\\\=                     #\;11\=#                            \\\=\\\=#\;12\=#             7                #\;13\=#  \\\=\\\=1 \\\=\\\=\\\=2 \\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=3 \\\=\\\=\\\=4 \\\=\\\=  #\;14\=#\\\=\\\=                            #\;15\=#              8               #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=     Amoebatrons Revenge     L18\;18\=~x\;;19=1\=0;20=1\=,`````,(((((     (((((.  .(((((#\;2\=,`````,(( ((     (((((:  :(((**#\;3\=,``F`,......     .+.+.:  :   **#\;4\=(,,F,........(((,,,,,,::::   (*#\;5\=( (F(........,,,################\;6\=(,,F,........'#####EE# $       #\;7\=###################EE#        $#\;8\=###################  #         #\;9\=#                            \\\=\\\=#\;10\=#                              #\;11\=#---------------------- 1 ~    #\;12\=#        *$ * $  * $ *      \\\=  #\;13\=#\\\=\\\=                            #\;14\=#    \\\=\\\=                        #\;15\=#             2                #\;16\=#\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=\\\=#\;17\=       The Final Barrier     L20\;18\=~x\;;

wll="#
lll="=
dir="E:\mmn\
ii=ImageList.LoadImage(dir+"mminc.png")
LDImage.MakeTransparent(II "BLACK")
Mmc=ii'LDImage.SplitImage(ii 16 9)
wd=1
II=ImageList.LoadImage(dir+"man_pu.png")
LDImage.MakeTransparent(ii "black")
mmp=LDImage.SplitImage(ii 1 20)

II=ImageList.LoadImage(dir+"mm_Ctiles.png")
'LDImage.MakeTransparent(ii "black")
mm=LDImage.SplitImage(ii 8 20)

chr[1][1]="9;1
chr[2][1]="6;2
chr[2][2]="7;2
chr[4][1]="4;3
chr[4][2]="5;3
chr[5][1]="9;4
chr[5][2]="9;3
chr[5][3]="13;3

For f=2 To 5
  chr[13][F]="16;6
EndFor
chr[13][1]="11;6

chr[20][1]="11;6
chr[20][2]="5;5

Sub drawbb
  cl=TextWindow.CursorLeft
  For x=1 To 16
    For d=1 To 2
      For c=1 To 32
        TextWindow.BackgroundColor="darkblue
        TextWindow.ForegroundColor="white
        cc=text.GetSubText (ln[x] c 1)
        If d=2 and (cc=lll) Then
          cc=" "
        EndIf
        If cc=wll Then
          TextWindow.ForegroundColor="blue
          TextWindow.BackgroundColor="cyan
        ElseIf  cc="$" Then
          TextWindow.ForegroundColor="red
        ElseIf cc=lll Then
          TextWindow.ForegroundColor="yellow
          
        EndIf
        
        TextWindow.Write(cc)
        TextWindow.Write(cc)
      EndFor
      TextWindow.CursorTop=TextWindow.CursorTop+1
      TextWindow.CursorLeft=cl
    EndFor
    
  EndFor
  TextWindow.CursorLeft=cl+2
  TextWindow.CursorTop=TextWindow.CursorTop-1
  TextWindow.Write(ln[17])
EndSub

rw=1
ct=0
for llw=1 to 20
  
  ln=lwq[llw]
  GraphicsWindow.Clear()
  dd=25
  id=1
  ldrw()
  Timer.Interval=100
  Timer.Tick=ttt
  wly=ldShapes.AddAnimatedImage(mmc "false" 16 9)
  LDShapes.AnimationPause(wly)
  LDShapes.AnimationSet(wly 1)
  Shapes.Move(wly 30 275)
  LDShapes.ReSize(wly 40 40)
  GraphicsWindow.KeyDown=kkk
  GraphicsWindow.KeyUp=kuu
  GraphicsWindow.FontName="ZX Spectrum"
  GraphicsWindow.FontSize=20
  GraphicsWindow.FontBold="false
  GraphicsWindow.BrushColor="gold
  GraphicsWindow.FillRectangle(20 340 640 20)
  GraphicsWindow.BrushColor="black
  GraphicsWindow.DrawText(20 340 ln[17])
  GraphicsWindow.ShowMessage(ln[17] "lvl:"+llw )
  Timer.Pause()
  
EndFor

Sub kkk
  lk=GraphicsWindow.LastKey
  If lk="Left" Then
    ann="true
    wsd=4
    wd=-1
  ElseIf lk="Right" Then
    ann="true
    wd=1
    wsd=0
  ElseIf lk="Up" and rlky Then
    rlky="false
    Shapes.Move(wly Shapes.GetLeft(wly) Shapes.GetTop(wly)-52)
    mdd="true
  EndIf
EndSub

Sub kuu
  ann="false
  rlky="true
EndSub

Sub ttt
  is=is+id
  If ann Then
    ws=ws+wd
    If ws>4 Then
      ws=1
      LDShapes.Move(wly Shapes.GetLeft(wly)+25 Shapes.GetTop(wly))
    ElseIf ws<1 Then
      ws=4
      LDShapes.Move(wly Shapes.GetLeft(wly)-25 Shapes.GetTop(wly))
    EndIf
    LDShapes.AnimationSet(wly ws+wsd)
  EndIf
  If mdd Then
    ppx= GraphicsWindow.GetPixel(Shapes.GetLeft(wly) Shapes.GetTop(wly)+47)
    
    If ppx=bcc Then
      LDShapes.Move(wly Shapes.GetLeft(wly) Shapes.GetTop(wly)+3)
    Else
      mdd="false
    EndIf
  EndIf
  
  If is>4 and id>0 Then
    is=1
    
    If gl>290 Then
      dd=-dd
      as=4-as
      id=-id
      Shapes.Move(imm Shapes.GetLeft(imm)+50 Shapes.GetTop(imm))
    EndIf
    Shapes.Move(imm Shapes.GetLeft(imm)+dd Shapes.GetTop(imm))
  ElseIf id<0 and is<1 Then
    is=4
    If gl<200 Then
      dd=-dd
      as=4-as
      id=-id
      Shapes.Move(imm Shapes.GetLeft(imm)-50 Shapes.GetTop(imm))
    EndIf
    Shapes.Move(imm Shapes.GetLeft(imm)+dd Shapes.GetTop(imm))
  EndIf
  gl=Shapes.GetLeft(imm)
  LDShapes.AnimationSet(imm lv[1]+(lv[2]-1)*16+is-1+as)
  'GraphicsWindow.Title=gl+" | "+dd
  
EndSub

Sub ldrw
  GraphicsWindow.BackgroundColor="teal
  GraphicsWindow.Width=800
  GraphicsWindow.Height=500
  GraphicsWindow.Left=5
  GraphicsWindow.Top=5
  lm=llw*1
  GraphicsWindow.DrawImage(mm[1][lm] 1 1)
  bcc=GraphicsWindow.GetPixel(2 2)
  Program.Delay(166)
  GraphicsWindow.Clear()
  GraphicsWindow.BrushColor=bcc
  GraphicsWindow.FillRectangle(20 20 640 320)
  bb=LDImage.Copy( mm[4][lm])
  'LDImage.ReplaceColour(bb "white" "gold" 20)
  bb1=LDImage.Copy( mm[2][lm])
  ' LDImage.ReplaceColour(bb1 "white" "red" 20)
  bb2=LDImage.Copy( mm[3][lm])
  ' LDImage.ReplaceColour(bb2 "white" "darkred" 20)
  bb6=LDImage.Copy( mm[8][lm])
  'LDImage.ReplaceColour(bb2 "white" "gold" 20)
  
  bb5=LDImage.Copy( mm[7][lm])
  'LDImage.ReplaceColour(bb5 "white" LDColours.HSLtoRGB(180 .8 .7) 20)
  bb3=LDImage.Copy( mm[5][lm])
  'LDImage.ReplaceColour(bb3 "white" "cyan" 20)
  
  bbx=LDImage.Copy( mm[4][15])
  bb4=LDImage.Copy( mm[6][lm])
  'LDImage.ReplaceColour(bb4 "white" "lime" 20)
  
  For y=1 To 16
    For c=1 To 32
      ch=Text.GetSubText(ln[y] c 1)
      If ch="#" Then
        GraphicsWindow.BrushColor="darkred
        GraphicsWindow.FillRectangle(c*20 y*20 20 20)
        GraphicsWindow.DrawResizedImage(bb c*20 y*20 20 20)
      ElseIf ch="=" Then
        GraphicsWindow.DrawResizedImage(bb1 c*20 y*20 20 20)
      ElseIf ch="-" Then
        GraphicsWindow.DrawResizedImage(bb3 c*20 y*20 20 20)
      ElseIf ch="~" or ch="@" Then
        GraphicsWindow.DrawResizedImage(bb2 c*20 y*20 20 20)
      ElseIf ch="w" Then
        GraphicsWindow.DrawResizedImage(bb5 c*20 y*20 20 20)
      ElseIf ch="j" or ch="H" Then
        GraphicsWindow.DrawResizedImage(bb6 c*20 y*20 20 20)
      ElseIf ch="$" Then
        GraphicsWindow.DrawResizedImage(mmp[1][lm] c*20 y*20 15 15)
      ElseIf ch="*" Then
        GraphicsWindow.DrawResizedImage(bb4 c*20 y*20 20 20)
      ElseIf ch="E" Then
        GraphicsWindow.DrawResizedImage(bbx c*20 y*20 20 20)
      ElseIf ch*1>=1 Then
        lv=LDText.Split(chr[lm][ch*1] ";")
        imm=ldShapes.AddAnimatedImage(mmc "false" 16 9)
        LDShapes.AnimationPause(imm)
        LDShapes.AnimationSet(imm lv[1]+(lv[2]-1)*16)
        
        shapes.move(imm c*20 y*20-20)
        LDShapes.ReSize(imm 40 40)
      EndIf
      
    EndFor
  EndFor
EndSub

'-----minend
Program.Delay(1)
