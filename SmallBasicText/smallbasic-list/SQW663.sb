ah100rahmen()
Spielmodus = 0
me = 0
GraphicsWindow.MouseDown = ak000MouseDown
be = 0
Controls.ButtonClicked = ak000ButtonClicked
anfang:
aa100initwerte()
aa110init1()
If hilfex = 1 then
  aa050hilfe()
  Goto anfang
endif
If Spielmodus > 3 then
  aa300init3a()
  For i = 1 To 5
    zanalyse[i] = eing[i]
    eing[i] = 0
  EndFor
  For x = 1 to aversuche + 1  'Die Analyse
    farbwahl = 0
    aa310init3()
    If neustart = 1 Then
      x = aversuche + 1
    EndIf
  EndFor
else
  aa120init1werte()
  For x = 1 to aversuche + 1  'Das eigentliche Spiel
    For i = 1 to 5
      eing[i] = 0
    EndFor
    farbwahl = 0
    aa200init2()
    If neustart = 1 Then
      x = aversuche + 1
    EndIf
  EndFor
EndIf
If neustart = 1 then 
  Goto anfang
endif


'  UNTERPROGRAMME


Sub aa100initwerte
  Titel = " Mastermind "
  GraphicsWindow.Title =Titel
  GraphicsWindow.penColor = "black"
  GraphicsWindow.BrushColor = "black"
  Col[1] = "yellow"
  Col[2] = "Violet"
  Col[3] = "Red"
  Col[4] = "Green"
  Col[5] = "Blue"
  Col[6] = "Gray"
  Col[7] = "DarkOrange"
  col[8] = "greenyellow"
  Col[9] = "Black"
  Col[10] = "Wheat" 
  Col[11] = "white"
  Modus[1] = "Manuell"
  Modus[2] = "Vorbelegung für Zeile 1 und 2"
  Modus[3] = "Vorbelegung für alle Zeilen"
  Modus[4] = "Analyse" 
  Modus[5] = "Analyse - automatik" 
  stärke[1] = "Laie"
  stärke[2] = "Anfänger"
  stärke[3] = "Fortgeschrittener"
  stärke[4] = "Geselle"
  stärke[5] = "Experte"
  stärke[6] = "Profi"
  stärke[7] = "Meister"
  stärke[8] = "Genie"
  level = 1
  afarben = 0
  aktz = 1
  aspalten = 0
  aversuche = 0
  einprü = 0
  hilfex = 0
  manuell = 0
  neustart = 0
  reihevoll = 0
  kd1 = 38   ' Kreisdurchmesser 
  kd2 = 36
  kd3 = 34
  kd4 = 25
  kd5 = 18
  
  xpm = 40  'Menükoordinaten
  ypm = 40
  
  xpmd  = xpm + 160
  
  ydm = 40
  xpende = xpm + 500
  
  xpf = xpm + 2  'Farbkoordinaten am oberen Rand
  xpfd = 50
  xpfx = xpm + 450
  ypf = ypm + 2 
  ypt = ypm + 82
  
  xped = 40   'Eingabekoordinaten im Spielfeld und Mausabfragen
  xpe1 = xpm + 3
  xpe2 = xpe1 + xped
  
  yp = ypm - 20
  yp1 = yp + 106
  yp2 = yp + 146
  yp3 = yp + 102
  yp4 = yp + 110
  
  
  winok = 0
  verl = 0
  For i = 1 To 5
    eing[i] = 0 'Eingabe der jeweiligen Zeile
    ergebnis[i] = 11 'Eingabe der Ergebnisse für die Analyse
    zwert[i] = 0 ' gesuchte Kombination
    zanalyse[i] = 0 'eingegebene Werte für die Analyse
  EndFor
  For i = 1 To 10
    fs[i] = i
  EndFor
  For i = 1 to 13
    For k = 1 To 5
      emat[i][k] = 0 'Matix der einzelnen eingegebenen Zeilen
      ergmat[i][k] = 0 'Matrix der Zeilenergebnisse
    EndFor
  EndFor 
EndSub


Sub ak000MouseDown  'Steuerprogramm für die Ausführung von Mausklicks
  If me = 0 Then
    Goto ak500end
  EndIf
  If winok = 1 Or verl = 1 Then
    Goto ak500end
  EndIf
  If me = 1 Then
    ak010MouseDown()
  EndIf
  If me = 2 Then
    ak020MouseDown()
  EndIf
  If me = 3 Then
    ak030MouseDown()
  EndIf
  ak500end:
EndSub


Sub ak000ButtonClicked  'Steuerprogramm für die Ausführung von Mausklicks
  If be = 0 Then
    Goto ak400end
  EndIf
  If be = 1 Then
    ak110ButtonClicked()
  EndIf
  If be = 2 Then
    ak300ButtonClicked()
  EndIf
  If be = 3 Then
    ak310ButtonClicked3()
  EndIf
  If be = 4 Then
    ak200ButtonClicked2()
  EndIf
  If be = 5 Then
    ak050ButtonClicked4()
  EndIf
  ak400end:
EndSub


'Hauptmenue


sub aa110init1 'Abfrage der Spielstufe
  GraphicsWindow.BrushColor = "black"
  GraphicsWindow.Clear()
  GraphicsWindow.DrawText(xpm, ypm - 20, "Wählen Sie die Spielstärke")
  ibo1 = Controls.AddButton(stärke[1],xpm,ypm + 1 * ydm)
  Controls.SetSize(ibo1,125,30)
  ibo2 = Controls.AddButton(stärke[2],xpm,ypm + 2 * ydm)
  Controls.SetSize(ibo2,125,30)
  ibo3 = Controls.AddButton(stärke[3],xpm,ypm + 3 * ydm)
  Controls.SetSize(ibo3,125,30)
  ibo4 = Controls.AddButton(stärke[4],xpm,ypm + 4 * ydm)
  Controls.SetSize(ibo4,125,30)
  ibo5 = Controls.AddButton(stärke[5],xpm,ypm + 5 * ydm)
  Controls.SetSize(ibo5,125,30)
  ibo6 = Controls.AddButton(stärke[6],xpm,ypm + 6 * ydm)
  Controls.SetSize(ibo6,125,30)
  ibo7 = Controls.AddButton(stärke[7],xpm,ypm + 7 * ydm)
  Controls.SetSize(ibo7,125,30)
  ibo8 = Controls.AddButton(stärke[8],xpm,ypm + 8 * ydm)
  Controls.SetSize(ibo8,125,30)
  mode = Controls.AddButton("Spielmodus",xpm,ypm + 10 * ydm)
  Controls.SetSize(mode,125,30)
  help = Controls.AddButton("Hilfe",xpm,ypm + 11 * ydm)
  Controls.SetSize(help,125,30)
  end1 = Controls.AddButton("Ende",xpm,ypm + 12 * ydm)
  Controls.SetSize(end1,125,30)
  GraphicsWindow.DrawText(xpmd, ypm, "              Anzahl:")
  GraphicsWindow.DrawText(xpmd, ypm + 20, "Farben  Spalten  Versuche")
  GraphicsWindow.DrawText(xpmd, ypm + 1 * ydm + 7, "       5            3            7")
  GraphicsWindow.DrawText(xpmd, ypm + 2 * ydm + 7, "       6            3            8")
  GraphicsWindow.DrawText(xpmd, ypm + 3 * ydm + 7, "       6            4            9")
  GraphicsWindow.DrawText(xpmd, ypm + 4 * ydm + 7, "       7            4           10")
  GraphicsWindow.DrawText(xpmd, ypm + 5 * ydm + 7, "       8            4           10")
  GraphicsWindow.DrawText(xpmd, ypm + 6 * ydm + 7, "       8            5           11")
  GraphicsWindow.DrawText(xpmd, ypm + 7 * ydm + 7, "       9            5           12")
  GraphicsWindow.DrawText(xpmd, ypm + 8 * ydm + 7, "     10            5           13")
  GraphicsWindow.BrushColor = "white"
  GraphicsWindow.FillRectangle(xpmd,ypm + 10 * ydm,200,50)
  GraphicsWindow.BrushColor = "black"
  If Spielmodus = 0 Then
    Spielmodus = 1
  EndIf
  GraphicsWindow.DrawText(xpmd,ypm + 10 * ydm + 8,Modus[Spielmodus])
  GraphicsWindow.DrawText(xpmd,ypm + 12 * ydm + 9,"Spiel beenden")
  bStart = ""
  be = 1  'ak110ButtonClicked
  While bStart = ""
    Program.Delay(500)
  EndWhile
EndSub


Sub ak110ButtonClicked
  oBu = Controls.LastClickedButton
  If oBu = ibo1 Then
    bStart = "True"
    afarben = 5
    aspalten = 3
    aversuche = 7
    level = 1
  ElseIf oBu = ibo2 Then
    bStart = "True"
    afarben = 6
    aspalten = 3
    aversuche = 8
    level = 2
  elseif oBu= ibo3 then
    bStart = "True"
    afarben = 6
    aspalten = 4
    aversuche = 9
    level = 3
  elseif oBu = ibo4 then
    bStart = "True"
    afarben = 7
    aspalten = 4
    aversuche = 10
    level = 4
  elseif oBu = ibo5 then
    bStart = "True"
    afarben = 8
    aspalten = 4
    aversuche = 10
    level = 5
  elseif oBu = ibo6 then
    bStart = "True"
    afarben = 8
    aspalten = 5
    aversuche = 11
    level = 6
  elseif oBu = ibo7 then
    bStart = "True"
    afarben = 9
    aspalten = 5
    aversuche = 12
    level = 7
  elseif oBu = ibo8 then
    bStart = "True"
    afarben = 10
    aspalten = 5
    aversuche = 13
    level = 8
  elseif oBu = end1 then
    Program.End()
  Elseif oBu = mode then
    Spielmodus = Spielmodus + 1
    If Spielmodus = 6 then
      Spielmodus = 1
    EndIf
    GraphicsWindow.BrushColor = "white"
    GraphicsWindow.FillRectangle(xpmd,ypm + 10 * ydm,200,50)
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.DrawText(xpmd,ypm + 10 * ydm + 7,Modus[Spielmodus])
  elseif oBu = help then
    bStart = "True"
    hilfex = 1
  Else
    bStart = ""  
  EndIf
EndSub


'Eingabe der Zieldaten für die Analyse


Sub aa300init3a
  GraphicsWindow.Clear()
  GraphicsWindow.BrushColor = "black"
  GraphicsWindow.DrawText(xpm,ypm - 30,"Die möglichen Farben für das Spiel.             Level: "+ stärke[level])
  GraphicsWindow.BrushColor = Col[1]
  GraphicsWindow.FillRectangle(xpf + 0 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpf + 0 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.BrushColor = Col[2]
  GraphicsWindow.FillRectangle(xpf + 1 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpf + 1 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.BrushColor = Col[3]
  GraphicsWindow.FillRectangle(xpf + 2 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpf + 2 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.BrushColor = Col[4]
  GraphicsWindow.FillRectangle(xpf + 3 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpf + 3 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.BrushColor = Col[5]
  GraphicsWindow.FillRectangle(xpf + 4 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpf + 4 * xpfd,ypf,kd1,kd1)
  If afarben > 5 then
    GraphicsWindow.BrushColor = Col[6]
    GraphicsWindow.FillRectangle(xpf + 5 * xpfd,ypf,kd1,kd1)
    GraphicsWindow.drawRectangle(xpf + 5 * xpfd,ypf,kd1,kd1)
  EndIf
  If afarben > 6 then
    GraphicsWindow.BrushColor = Col[7]
    GraphicsWindow.FillRectangle(xpf + 6 * xpfd,ypf,kd1,kd1)
    GraphicsWindow.drawRectangle(xpf + 6 * xpfd,ypf,kd1,kd1)
  EndIf
  If afarben > 7 then
    GraphicsWindow.BrushColor = Col[8]
    GraphicsWindow.FillRectangle(xpf + 7 * xpfd,ypf,kd1,kd1)
    GraphicsWindow.drawRectangle(xpf + 7 * xpfd,ypf,kd1,kd1)
  EndIf
  If afarben > 8 then
    GraphicsWindow.BrushColor = Col[9]
    GraphicsWindow.FillRectangle(xpf + 8 * xpfd,ypf,kd1,kd1)
    GraphicsWindow.drawRectangle(xpf + 8 * xpfd,ypf,kd1,kd1)
  EndIf
  If afarben > 9 then
    GraphicsWindow.BrushColor = Col[10]
    GraphicsWindow.FillRectangle(xpf + 9 * xpfd,ypf,kd1,kd1)
    GraphicsWindow.drawRectangle(xpf + 9 * xpfd,ypf,kd1,kd1)
  EndIf
  GraphicsWindow.BrushColor = "black"
  end1 = Controls.AddButton("Ende",xpende,ypm + 1)
  Controls.SetSize(end1, 50,40)
  Spalten()
  Zeilen()
  GraphicsWindow.BrushColor = "white"
  wx = xpf + 0 * xped
  wy = ypt + aversuche * 40
  ah100kreuz()
  wx = xpf + 1 * xped
  ah100kreuz()
  wx = xpf + 2 * xped
  ah100kreuz()
  If aspalten > 3 then
    wx = xpf + 3 * xped
    ah100kreuz()
  EndIf
  If aspalten > 4 Then
    wx = xpf + 4 * xped
    ah100kreuz()
  endif
  If aspalten = 3 Then
    okx = 6 * xped + xpm + 30 
  Elseif aspalten = 4 then
    okx = 8 * xped + xpm + 30 
  Else
    okx = 10 * xped + xpm + 30
  EndIf 
  oky = wy
  GraphicsWindow.BrushColor = "black"
  ok1 = Controls.AddButton("OK",okx,oky)
  Controls.SetSize(ok1,40,40)
  GraphicsWindow.DrawText(okx + 80,oky + 4,"OK: Bestätigung der Zeileneingabe") 
  bStart = ""
  me = 1 'ak010MouseDown
  be = 2 ' ak300ButtonClicked    
  While bStart = ""
    Program.Delay(500)
  EndWhile
EndSub


Sub ak010MouseDown
  xmaus = GraphicsWindow.MouseX
  ymaus = GraphicsWindow.MouseY 
  If xmaus > xpe1 + 0 * xped And xmaus < xpe2 + 0 * xped  And ymaus >  yp1 + aversuche * 40 And ymaus < yp2 + aversuche * 40 Then
    If farbwahl <> 0 then
      eing[1] = farbwahl
      manuell = 0
      farbebotton1e()
    endif
  EndIf 
  If xmaus > xpe1 + 1 * xped And xmaus < xpe2 + 1 * xped And ymaus >  yp1 + aversuche * 40 And ymaus < yp2 + aversuche * 40 Then
    If farbwahl <> 0 then
      eing[2] = farbwahl
      manuell = 0
      farbebotton2e()
    endif
  EndIf 
  If xmaus > xpe1 + 2 * xped And xmaus < xpe2 + 2 * xped And ymaus >  yp1 + aversuche * 40 And ymaus < yp2 + aversuche * 40 Then
    If farbwahl <> 0 then
      eing[3] = farbwahl
      manuell = 0
      farbebotton3e()
    endif
  EndIf 
  If aspalten > 3 then 
    If xmaus > xpe1 + 3 * xped And xmaus < xpe2 + 3 * xped And ymaus > yp1 + aversuche * 40 And ymaus < yp2 + aversuche * 40 Then
      If farbwahl <> 0 then
        eing[4] = farbwahl
        manuell = 0
        farbebotton4e()
      endif
    EndIf 
  EndIf 
  If aspalten > 4 then
    If xmaus > xpe1 + 4 * xped And xmaus < xpe2 + 4 * xped And ymaus > yp1 + aversuche * 40 And ymaus < yp2 + aversuche * 40 Then
      If farbwahl <> 0 then
        eing[5] = farbwahl
        manuell = 0
        farbebotton5e()
      endif
    EndIf
  EndIf   
  If xmaus > xpf + 0 * xpfd And xmaus < xpf + 0 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 1
  EndIf 
  If xmaus > xpf + 1 * xpfd And xmaus < xpf + 1 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 2
  EndIf   
  If xmaus > xpf + 2 * xpfd And xmaus < xpf + 2 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 3
  EndIf
  If xmaus > xpf + 3 * xpfd And xmaus < xpf + 3 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 4
  EndIf 
  If xmaus > xpf + 4 * xpfd And xmaus < xpf + 4 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 5
  EndIf 
  If afarben > 5 then
    If xmaus > xpf + 5 * xpfd And xmaus < xpf + 5 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
      farbwahl = 6
    EndIf 
  EndIf
  If afarben > 6 then
    If xmaus > xpf + 6 * xpfd And xmaus < xpf + 6 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
      farbwahl = 7
    EndIf
  EndIf
  If afarben > 7 then
    If xmaus > xpf + 7 * xpfd And xmaus < xpf + 7 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
      farbwahl = 8
    EndIf 
  EndIf
  If afarben > 8 then
    If xmaus > xpf + 8 * xpfd And xmaus < xpf + 8 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
      farbwahl = 9
    EndIf 
  endif
  If afarben > 9 then
    If xmaus > xpf + 9 * xpfd And xmaus < xpf + 9 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
      farbwahl = 10
    EndIf 
  endif
  fz = aversuche
  aktuellefarbe()
EndSub


Sub ak300ButtonClicked
  oBu = Controls.LastClickedButton
  If oBu = end1 Then
    Program.End()
  elseIf oBu = neu1 Then
    neustart = 1
    bStart = "True"
  elseIf oBu= ok1 Then
    ab300okpr3()
  Else
    bStart = ""  
  EndIf
EndSub


Sub ab300okpr3 'prüfen ob die Eingabe vollständig, dann weiter
  If aspalten = 3 Then
    einprü = eing[1] * eing[2] * eing[3]
  EndIf
  If aspalten = 4 Then
    einprü = eing[1] * eing[2] * eing[3] * eing[4]
  EndIf
  If aspalten = 5 Then
    einprü = eing[1] * eing[2] * eing[3] * eing[4] * eing[5]
  EndIf 
  If einprü = 0 Then
    bStart = ""
  Else
    bStart = "True" 
  EndIf
EndSub


Sub farbebotton1e
  GraphicsWindow.BrushColor = col[eing[1]]
  GraphicsWindow.FillRectangle(xpf + 0 * xped,yp3 + aversuche * xped,kd2,kd2)
EndSub

Sub farbebotton2e
  GraphicsWindow.BrushColor = col[eing[2]]
  GraphicsWindow.FillRectangle(xpf + 1 * xped,yp3 + aversuche * xped,kd2,kd2)  
EndSub

Sub farbebotton3e
  GraphicsWindow.BrushColor = col[eing[3]]
  GraphicsWindow.FillRectangle(xpf + 2 * xped,yp3 + aversuche * xped,kd2,kd2)  
EndSub

Sub farbebotton4e
  GraphicsWindow.BrushColor = col[eing[4]]
  GraphicsWindow.FillRectangle(xpf + 3 * xped,yp3 + aversuche * xped,kd2,kd2)
EndSub

Sub farbebotton5e
  GraphicsWindow.BrushColor = col[eing[5]]
  GraphicsWindow.FillRectangle(xpf + 4 * xped,yp3 + aversuche * 40,kd2,kd2)
EndSub

'Analysefunktion

Sub aa310init3
  GraphicsWindow.Clear()
  GraphicsWindow.BrushColor = "black"
  GraphicsWindow.DrawText(xpm,ypm - 30,"Die möglichen Farben für das Spiel.             Level: "+ stärke[level])
  GraphicsWindow.BrushColor = Col[1]
  GraphicsWindow.FillEllipse(xpm + 0 * xpfd,ypm,kd4,kd4)
  GraphicsWindow.BrushColor = "black" 
  GraphicsWindow.DrawEllipse(xpm + 0 * xpfd,ypm,kd4,kd4)
  GraphicsWindow.BrushColor = Col[2]
  GraphicsWindow.FillEllipse(xpm + 1 * xpfd,ypm,kd4,kd4)
  GraphicsWindow.BrushColor = "black" 
  GraphicsWindow.DrawEllipse(xpm + 1 * xpfd,ypm,kd4,kd4)
  GraphicsWindow.BrushColor = Col[3]
  GraphicsWindow.FillEllipse(xpm + 2 * xpfd,ypm,kd4,kd4)
  GraphicsWindow.BrushColor = "black" 
  GraphicsWindow.DrawEllipse(xpm + 2 * xpfd,ypm,kd4,kd4)
  GraphicsWindow.BrushColor = "black" 
  GraphicsWindow.DrawEllipse(xpm + 3 * xpfd,ypm,kd4,kd4)
  GraphicsWindow.BrushColor = Col[4]
  GraphicsWindow.FillEllipse(xpm + 3 * xpfd,ypm,kd4,kd4)
  GraphicsWindow.BrushColor = "black" 
  GraphicsWindow.DrawEllipse(xpm + 4 * xpfd,ypm,kd4,kd4)
  GraphicsWindow.BrushColor = Col[5]
  GraphicsWindow.FillEllipse(xpm + 4 * xpfd,ypm,kd4,kd4)
  If afarben > 5 then
    GraphicsWindow.BrushColor = Col[6]
    GraphicsWindow.FillEllipse(xpm + 5 * xpfd,ypm,kd4,kd4)
    GraphicsWindow.BrushColor = "black" 
    GraphicsWindow.DrawEllipse(xpm + 5 * xpfd,ypm,kd4,kd4)
  EndIf
  If afarben > 6 then
    GraphicsWindow.BrushColor = Col[7]
    GraphicsWindow.FillEllipse(xpm + 6 * xpfd,ypm,kd4,kd4)
    GraphicsWindow.BrushColor = "black" 
    GraphicsWindow.DrawEllipse(xpm + 6 * xpfd,ypm,kd4,kd4)
  EndIf
  If afarben > 7 then
    GraphicsWindow.BrushColor = Col[8]
    GraphicsWindow.FillEllipse(xpm + 7 * xpfd,ypm,kd4,kd4)
    GraphicsWindow.BrushColor = "black" 
    GraphicsWindow.DrawEllipse(xpm + 7 * xpfd,ypm,kd4,kd4)
  EndIf
  If afarben > 8 then
    GraphicsWindow.BrushColor = Col[9]
    GraphicsWindow.FillEllipse(xpm + 8 * xpfd,ypm,kd4,kd4)
    GraphicsWindow.BrushColor = "black" 
    GraphicsWindow.DrawEllipse(xpm + 8 * xpfd,ypm,kd4,kd4)
  EndIf
  If afarben > 9 then
    GraphicsWindow.BrushColor = Col[10]
    GraphicsWindow.FillEllipse(xpm + 9 * xpfd,ypm,kd4,kd4)
    GraphicsWindow.BrushColor = "black" 
    GraphicsWindow.DrawEllipse(xpm + 9 * xpfd,ypm,kd4,kd4)
  EndIf
  GraphicsWindow.BrushColor = "black"
  GraphicsWindow.DrawText(xpfx + 1 * xpfd,ypm - 30,"Die möglichen Farben für das Ergebnis")
  GraphicsWindow.BrushColor = Col[9]
  GraphicsWindow.FillRectangle(xpfx + 2 + 1 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpfx + 2 + 1 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.BrushColor = Col[10]
  GraphicsWindow.FillRectangle(xpfx + 2 + 2 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpfx + 2 + 2 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.BrushColor = Col[11]
  GraphicsWindow.FillRectangle(xpfx + 2 + 3 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpfx + 2 + 3 * xpfd,ypf,kd1,kd1)
  wx = xpm + 3 + 12 * xpfd 
  wy = ypm + 3
  ah100kreuz()
  GraphicsWindow.BrushColor = "black"
  ende = Controls.AddButton("Ende",xpende + 150, ypm + 1) 
  Controls.SetSize(ende,50,40)
  Spalten()
  Zeilen()
  Zielzeile()
  ab310auswahl3()
  ab311auswahl3a()
  If winok = 0 Then
    ab312auswahl3x()
  EndIf  
  If winok = 1 Then 
    Win3()
    GraphicsWindow.BrushColor = "black"
    neu1 = Controls.AddButton("Neu",okx,oky)
    Controls.SetSize(neu1,40,40)
    GraphicsWindow.DrawText(okx + 80,oky + 10,"Neues Spiel starten")    
  Else   
    If aktz = aversuche + 1 Then
      Lost()
      zielwerte()
      GraphicsWindow.BrushColor = "black"
      neu1 = Controls.AddButton("Neu",okx,oky)
      Controls.SetSize(neu1,40,40)
      GraphicsWindow.DrawText(okx + 80,oky + 10,"Neues Spiel starten")    
    else
      If aspalten =3 Then
        e1x = xpm + 3 + aspalten * xped
        ey = ypt + 4 + (aktz - 1) * 40
        e2x = e1x + 1 * xped 
        e3x = e1x + 2 * xped
        wx = e1x - 1
        wy = ey - 4
        ah100kreuz()
        wx = e2x - 1
        ah100kreuz()
        wx = e3x - 1
        ah100kreuz()
        okx = 6 * xped + xpm + 30      
      Elseif aspalten = 4 then
        e1x = xpm + 3 + aspalten * xped
        ey = ypt + 4 + (aktz - 1) * 40
        e2x = e1x + 1 * xped
        e3x = e1x + 2 * xped
        e4x = e1x + 3 * xped
        wx = e1x - 1
        wy = ey - 4
        ah100kreuz()
        wx = e2x - 1
        ah100kreuz()
        wx = e3x - 1
        ah100kreuz()
        wx = e4x - 1
        ah100kreuz()
        okx = 8 * xped + xpm + 30
      Else
        e1x = xpm + 3 + aspalten * xped
        ey = ypt + 4 + (aktz - 1) * 40
        e2x = e1x + 1 * xped
        e3x = e1x + 2 * xped
        e4x = e1x + 3 * xped
        e5x = e1x + 4 * xped
        wx = e1x - 1
        wy = ey - 4
        ah100kreuz()
        wx = e2x - 1
        ah100kreuz()
        wx = e3x - 1
        ah100kreuz()
        wx = e4x - 1
        ah100kreuz()
        wx = e5x - 1
        ah100kreuz()
        okx = 10 * xped + xpm + 30
      EndIf  
      oky = wy   
      GraphicsWindow.BrushColor = "black"
      ok1 = Controls.AddButton("OK",okx,oky)
      Controls.SetSize(ok1,40,40)
      GraphicsWindow.DrawText(okx + 80,oky + 4,"OK: Bestätigung der Zeileneingabe")
    EndIf
  EndIf 
  bStart = ""
  me = 2 'ak020MouseDown
  be = 3 ' ak310ButtonClicked3 
  If Spielmodus = 5 And winok = 0 Then
    ap300prüfen()
  EndIf
  While bStart = ""
    Program.Delay(500)
  EndWhile
EndSub


Sub ap300prüfen 'ermittelt das Ergebnis für den Automaik-Modus 
  k = 0 
  For i = 1 To aspalten 'laden Hilfsfelder
    hein[i] = emat[aktz][i]
    hziel[i] = zanalyse[i]
    herg[i] = 11
  EndFor
  For i = 1 To aspalten 'richtig an gleicher Stelle
    If hein[i] = hziel[i] then
      k = k + 1
      herg[k] = 9 'richtige Position
      hein[i] = 98
      hziel[i] = 99
    EndIf
  EndFor
  For i = 1 To aspalten 'richtig an anderer Stelle
    For l = 1 To aspalten
      If hein[i] = hziel[l] then
        k = k + 1
        herg[k] = 10
        hein[i] = 98
        hziel[l] = 99
      EndIf
    EndFor
  EndFor
  For i = 1 To aspalten
    ergebnis[i] = herg[i]
  endfor   
  farbebotton1x()
  farbebotton2x()
  farbebotton3x()
  If aspalten > 3 Then
    farbebotton4x()
  EndIf
  If aspalten > 4 Then
    farbebotton5x()
  EndIf
EndSub


Sub ab310auswahl3
  q = aktz  - 1
  If q <> 0 then
    For i = 1 To q
      For k = 1 to aspalten
        GraphicsWindow.BrushColor = Col[emat[i][k]]
        GraphicsWindow.FillEllipse(xpm -30 + xped * k,yp1 + (i - 1) * xped,kd4,kd4)
        GraphicsWindow.BrushColor ="black"
        GraphicsWindow.DrawEllipse(xpm -30 + xped * k,yp1 + (i - 1) * xped,kd4,kd4)
      EndFor
    EndFor
  Else
  endif
EndSub


Sub ab311auswahl3a
  q = aktz - 1
  If q <> 0 then
    For i = 1 To q
      For k = 1 to aspalten
        If ergmat[i][k] <> 1 then
          If ergmat[i][k] < 11 then
            GraphicsWindow.BrushColor = Col[ergmat[i][k]]
            GraphicsWindow.FillEllipse(xpm - 27 + xped * k + xped * aspalten,yp4 + (i - 1) * xped,kd5,kd5)
            GraphicsWindow.BrushColor ="black"
            GraphicsWindow.DrawEllipse(xpm - 27 + xped * k + xped * aspalten,yp4 + (i - 1) * xped,kd5,kd5)
          EndIf
        Endif
      EndFor
    EndFor
  Else
  endif
EndSub


Sub ab312auswahl3x
  ac312aupr3()
  For i = 1 To 5
    emat[aktz][i] = eing[i]
    eing[i] = 0
  EndFor
  q = aktz
  If q <> 0 then
    For i = 1 To q
      For k = 1 to aspalten
        GraphicsWindow.BrushColor = Col[emat[i][k]]
        GraphicsWindow.FillEllipse(xpm -30 + xped  *k,yp1 + (i - 1) * xped,kd4,kd4)
        GraphicsWindow.BrushColor ="black"
        GraphicsWindow.DrawEllipse(xpm -30 + xped * k,yp1 + (i - 1) * xped,kd4,kd4)
      EndFor
    EndFor
  Else
  endif
EndSub


Sub ac312aupr3 'setzen der Farben für die Analyse
  If aktz = 1 Then
    farbsuche1()
  EndIf
  If aktz = 2 Then
    If reihevoll = 1 Then 
      ad100permu13()
    Else 
      farbsuche2()
    EndIf
  EndIf
  If aktz > 2 Then 
    ad100permu13()
  EndIf
EndSub


Sub zielzeile
  GraphicsWindow.BrushColor = col[zanalyse[1]]
  GraphicsWindow.FillEllipse(xpm + 6 + 0 * xped,yp1 + aversuche * xped,kd4,kd4)
  GraphicsWindow.BrushColor = "black"
  GraphicsWindow.DrawEllipse(xpm + 6 + 0 * xped,yp1 + aversuche * xped,kd4,kd4)
  GraphicsWindow.BrushColor = col[zanalyse[2]]
  GraphicsWindow.FillEllipse(xpm + 6 + 1 * xped,yp1 + aversuche * xped,kd4,kd4)
  GraphicsWindow.BrushColor = "black"
  GraphicsWindow.DrawEllipse(xpm + 6 + 1 * xped,yp1 + aversuche * xped,kd4,kd4)
  GraphicsWindow.BrushColor = col[zanalyse[3]]
  GraphicsWindow.FillEllipse(xpm + 6 + 2 * xped,yp1 + aversuche * xped,kd4,kd4)  
  GraphicsWindow.BrushColor = "black"
  GraphicsWindow.DrawEllipse(xpm + 6 + 2 * xped,yp1 + aversuche * xped,kd4,kd4)
  If aspalten > 3 Then
    GraphicsWindow.BrushColor = col[ zanalyse[4]]
    GraphicsWindow.FillEllipse(xpm + 6 + 3 * xped,yp1 + aversuche * xped,kd4,kd4)
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.DrawEllipse(xpm + 6 + 3 * xped,yp1 + aversuche * xped,kd4,kd4)
  EndIf
  If aspalten > 4 then   
    GraphicsWindow.BrushColor = col[ zanalyse[5]]
    GraphicsWindow.FillEllipse(xpm + 6 + 4 * xped,yp1 + aversuche * xped,kd4,kd4)
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.DrawEllipse(xpm + 6 + 4 * xped,yp1 + aversuche * xped,kd4,kd4)
  EndIf 
EndSub


Sub ak020MouseDown
  xmaus = GraphicsWindow.MouseX
  ymaus = GraphicsWindow.MouseY 
  If xmaus > xpfx + 2 + 0 * xpfd And xmaus < xpfx + 40 + 0 * xpfd And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 9
  EndIf 
  If xmaus > xpfx + 2 + 1 * xpfd And xmaus < xpfx + 40 + 1 * xpfd And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 10
  EndIf   
  If xmaus > xpfx + 2 + 2 * xpfd And xmaus < xpfx + 40 + 2 * xpfd And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 11
  EndIf
  If xmaus > e1x And xmaus < e1x + xped And ymaus > yp + ey And ymaus < yp + ey + xped Then
    If farbwahl <> 0 Then
      ergebnis[1] = farbwahl
      farbebotton1x()
    EndIf
  endif
  If xmaus > e2x And xmaus < e2x + xped And ymaus > yp + ey And ymaus < yp + ey + xped Then
    If farbwahl <> 0 Then
      ergebnis[2] = farbwahl
      farbebotton2x()
    EndIf
  EndIf
  If xmaus > e3x And xmaus < e3x + xped And ymaus > yp + ey And ymaus < yp + ey + xped Then
    If farbwahl <> 0 Then
      ergebnis[3] = farbwahl
      farbebotton3x()
    EndIf
  EndIf
  If aspalten >3 Then  
    If xmaus > e4x And xmaus < e4x + xped And ymaus > yp + ey And ymaus < yp + ey + xped Then
      If farbwahl <> 0 Then
        ergebnis[4] = farbwahl
        farbebotton4x()
      EndIf
    EndIf
  EndIf
  If aspalten >4 Then
    If xmaus > e5x And xmaus < e5x + xped And ymaus > yp + ey And ymaus < yp + ey + xped Then
      If farbwahl <> 0 Then
        ergebnis[5] = farbwahl
        farbebotton5x()
      EndIf
    EndIf
  EndIf
  fz = aktz -1
  aktuellefarbe()
EndSub


Sub ak310ButtonClicked3
  oBu = Controls.LastClickedButton
  If oBu = ende Then
    Program.End()
  elseIf oBu = neu1 Then
    neustart = 1
    bStart = "True"
  elseIf oBu= ok1 Then
    al310okpr1()
  Else
    bStart = ""  
  EndIf
EndSub


Sub al310okpr1 'prüfen ob die Eingabe vollständig, dann weiter
  einprü = 1
  winok = 0
  For i = 1 To 4
    If ergebnis[i] > ergebnis [i + 1] Then
      einprü = 0
      i = 4
    EndIf
  EndFor
  If einprü = 0 Then
    bStart = ""
  Else
    If aspalten = 3 Then
      mm = ergebnis[1] + ergebnis[2] + ergebnis[3]
      If ergebnis[3] < 11 then
        reihevoll = 1
      EndIf
      If mm = 27 Then
        winok = 1
      EndIf
    EndIf
    If aspalten = 4 Then
      mm = ergebnis[1] + ergebnis[2] + ergebnis[3] + ergebnis[4]
      If ergebnis[4] < 11 then
        reihevoll = 1
      EndIf
      If mm = 36 Then
        winok = 1
      EndIf
    EndIf  
    If aspalten = 5 Then
      mm = ergebnis[1] + ergebnis[2] + ergebnis[3] + ergebnis[4] + ergebnis[5]
      If ergebnis[5] < 11 then
        reihevoll = 1
      EndIf
      If mm = 45 Then
        winok = 1
      EndIf
    EndIf   
    For i = 1 To 5
      ergmat[aktz][i] = ergebnis[i]
      ergebnis[i] = 11 
    EndFor   
    aktz = aktz + 1
    bStart = "True" 
  EndIf
EndSub


Sub farbebotton1x
  GraphicsWindow.BrushColor = col[ ergebnis[1]]
  GraphicsWindow.FillRectangle(e1x,ey -3,kd3,kd3)
  If ergebnis[1] = 11 then
    wx = e1x - 1
    wy = ey - 4
    ah100kreuz()
  Else
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.drawRectangle(e1x,ey - 3,kd3,kd3)
  EndIf
EndSub

Sub farbebotton2x
  GraphicsWindow.BrushColor = col[ ergebnis[2]]
  GraphicsWindow.FillRectangle(e2x,ey - 3,kd3,kd3)
  If ergebnis[2] = 11 then
    wx = e2x - 1
    wy = ey - 4
    ah100kreuz()
  Else 
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.drawRectangle(e2x,ey - 3,kd3,kd3)
  EndIf
EndSub

Sub farbebotton3x
  GraphicsWindow.BrushColor = col[ ergebnis[3]]
  GraphicsWindow.FillRectangle(e3x,ey - 3,kd3,kd3)
  If ergebnis[3] = 11 then
    wx = e3x - 1
    wy = ey - 4
    ah100kreuz()
  Else
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.drawRectangle(e3x,ey - 3,kd3,kd3)
  EndIf
EndSub

Sub farbebotton4x
  GraphicsWindow.BrushColor = col[ ergebnis[4]]
  GraphicsWindow.FillRectangle(e4x,ey - 3,kd3,kd3)
  If ergebnis[4] = 11 then
    wx = e4x - 1
    wy = ey - 4
    ah100kreuz()
  Else
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.drawRectangle(e4x,ey - 3,kd3,kd3)
  EndIf
EndSub

Sub farbebotton5x
  GraphicsWindow.BrushColor = col[ ergebnis[5]]
  GraphicsWindow.FillRectangle(e5x,ey - 3,kd3,kd3)
  If ergebnis[5] = 11 then
    wx = e5x - 1
    wy = ey - 4
    ah100kreuz()
  Else
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.drawRectangle(e5x,ey - 3,kd3,kd3)
  EndIf
EndSub


'Ermitteln der Zieldaten für die manuelle und hablautomatische Spielweise


Sub aa120init1werte  'Zielvektor über Zufallszahlen ermitteln
  If aversuche = 7 Then
    zwert[1] = Math.GetRandomNumber(5)
    zwert[2] = Math.GetRandomNumber(5)
    zwert[3] = Math.GetRandomNumber(5)
  EndIf
  If aversuche = 8 Then
    zwert[1] = Math.GetRandomNumber(6)
    zwert[2] = Math.GetRandomNumber(6)
    zwert[3] = Math.GetRandomNumber(6)
  EndIf 
  If aversuche = 9 Then
    zwert[1] = Math.GetRandomNumber(6)
    zwert[2] = Math.GetRandomNumber(6)
    zwert[3] = Math.GetRandomNumber(6)
    zwert[4] = Math.GetRandomNumber(6)
  EndIf
  If aversuche = 10 Then
    zwert[1] = Math.GetRandomNumber(7)
    zwert[2] = Math.GetRandomNumber(7)
    zwert[3] = Math.GetRandomNumber(7)
    zwert[4] = Math.GetRandomNumber(7)
  EndIf
  If aversuche = 11 Then
    zwert[1] = Math.GetRandomNumber(8)
    zwert[2] = Math.GetRandomNumber(8)
    zwert[3] = Math.GetRandomNumber(8)
    zwert[4] = Math.GetRandomNumber(8)
    zwert[5] = Math.GetRandomNumber(8)
  EndIf
  If aversuche = 12 Then
    zwert[1] = Math.GetRandomNumber(9)
    zwert[2] = Math.GetRandomNumber(9)
    zwert[3] = Math.GetRandomNumber(9)
    zwert[4] = Math.GetRandomNumber(9)
    zwert[5] = Math.GetRandomNumber(9)
  EndIf 
  If aversuche = 13 Then
    zwert[1] = Math.GetRandomNumber(10)
    zwert[2] = Math.GetRandomNumber(10)
    zwert[3] = Math.GetRandomNumber(10)
    zwert[4] = Math.GetRandomNumber(10)
    zwert[5] = Math.GetRandomNumber(10)
  EndIf 
  'Testdaten 
  '  zwert[1] = 2
  '  zwert[2] = 3
  '  zwert[3] = 3
  '  zwert[4] = 4
  '  zwert[5] = 4  
EndSub


'Spiel durchführen


Sub aa200init2
  GraphicsWindow.Clear()
  GraphicsWindow.BrushColor = "black"
  GraphicsWindow.DrawText(xpm,ypm - 30,"Die möglichen Farben für das Spiel.             Level: "+ stärke[level])
  GraphicsWindow.BrushColor = Col[1]
  GraphicsWindow.FillRectangle(xpf + 0 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpf + 0 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.BrushColor = Col[2]
  GraphicsWindow.FillRectangle(xpf + 1 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpf + 1 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.BrushColor = Col[3]
  GraphicsWindow.FillRectangle(xpf + 2 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpf + 2 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.BrushColor = Col[4]
  GraphicsWindow.FillRectangle(xpf + 3 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpf + 3 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.BrushColor = Col[5]
  GraphicsWindow.FillRectangle(xpf + 4 * xpfd,ypf,kd1,kd1)
  GraphicsWindow.drawRectangle(xpf + 4 * xpfd,ypf,kd1,kd1)
  If afarben > 5 then
    GraphicsWindow.BrushColor = Col[6]
    GraphicsWindow.FillRectangle(xpf + 5 * xpfd,ypf,kd1,kd1)
    GraphicsWindow.drawRectangle(xpf + 5 * xpfd,ypf,kd1,kd1)
  EndIf
  If afarben > 6 then
    GraphicsWindow.BrushColor = Col[7]
    GraphicsWindow.FillRectangle(xpf + 6 * xpfd,ypf,kd1,kd1)
    GraphicsWindow.drawRectangle(xpf + 6 * xpfd,ypf,kd1,kd1)
  EndIf
  If afarben > 7 then
    GraphicsWindow.BrushColor = Col[8]
    GraphicsWindow.FillRectangle(xpf + 7 * xpfd,ypf,kd1,kd1)
    GraphicsWindow.drawRectangle(xpf + 7 * xpfd,ypf,kd1,kd1)
  EndIf
  If afarben > 8 then
    GraphicsWindow.BrushColor = Col[9]
    GraphicsWindow.FillRectangle(xpf + 8 * xpfd,ypf,kd1,kd1)
    GraphicsWindow.drawRectangle(xpf + 8 * xpfd,ypf,kd1,kd1)
  EndIf 
  If afarben > 9 then
    GraphicsWindow.BrushColor = Col[10]
    GraphicsWindow.FillRectangle(xpf + 9 * xpfd,ypf,kd1,kd1)
    GraphicsWindow.drawRectangle(xpf + 9 * xpfd,ypf,kd1,kd1)
  EndIf 
  GraphicsWindow.BrushColor = "black"
  end1 = Controls.AddButton("Ende",xpende,ypm)
  Controls.SetSize(end1, 50,40)
  Spalten()
  Zeilen()
  ab200auswahl()
  If winok = 1 Then 
    Win()
    GraphicsWindow.BrushColor = "black"
    neu1 = Controls.AddButton("Neu",okx,oky)
    Controls.SetSize(neu1,40,40)
    GraphicsWindow.DrawText(okx + 80,oky + 10,"Neues Spiel starten")    
  Else   
    If aktz = aversuche + 1 Then
      Lost()
      zielwerte()
      GraphicsWindow.BrushColor = "black"
      neu1 = Controls.AddButton("Neu",okx,oky)
      Controls.SetSize(neu1,40,40)
      GraphicsWindow.DrawText(okx + 80,oky + 10,"Neues Spiel starten")    
    else    
      GraphicsWindow.BrushColor = "white"
      wx = xpf + 0 * xped
      wy = ypt +  (aktz - 1) * xped
      ah100kreuz()
      wx = xpf + 1 * xped
      ah100kreuz()
      wx = xpf + 2 * xped
      ah100kreuz()
      If aspalten > 3 then
        wx = xpf + 3 * xped
        ah100kreuz()
      EndIf
      If aspalten > 4 Then
        wx = xpf + 4 * xped
        ah100kreuz()
      endif
      If aspalten = 3 Then
        okx = 6 * xped + xpm + 30
      Elseif aspalten = 4 then
        okx = 8 * xped + xpm + 30
      Else
        okx = 10 * xped + xpm + 30
      EndIf
      oky = wy
      GraphicsWindow.BrushColor = "black"
      ok1 = Controls.AddButton("OK",okx,oky)
      Controls.SetSize(ok1,40,40)
      GraphicsWindow.DrawText(okx + 100,oky,"OK: Bestätigung der Zeileneingabe")
      If (Spielmodus = 2 And aktz < 3) Or Spielmodus = 3 then
        au1 = Controls.AddButton("AU",okx + 50,oky)
        Controls.SetSize(au1,40,40)
        GraphicsWindow.DrawText(okx + 100,oky + 20,"AU: Automatische Eingabe")
      EndIf
    endif
  EndIf  
  bStart = ""
  me = 3
  be = 4 ' ak200ButtonClicked2   
  While bStart = ""
    Program.Delay(500)
  EndWhile
EndSub


Sub ab200auswahl
  q = aktz -1
  If q <> 0 then
    For i = 1 To q
      For k = 1 to aspalten
        GraphicsWindow.BrushColor = Col[emat[i][k]]
        GraphicsWindow.FillEllipse(xpm - 30 + xped * k,yp1 + (i - 1) * xped,kd4,kd4)
        GraphicsWindow.BrushColor ="black"
        GraphicsWindow.DrawEllipse(xpm - 30 + xped * k,yp1 + (i - 1) * xped,kd4,kd4)
        If ergmat[i][k] <> 1 then
          GraphicsWindow.BrushColor = Col[ergmat[i][k]]
          GraphicsWindow.FillEllipse(xpm - 27 + xped * k + xped * aspalten,yp4 + (i - 1) * xped,kd5,kd5)
          GraphicsWindow.BrushColor ="black"
          GraphicsWindow.DrawEllipse(xpm - 27 + xped * k + xped * aspalten,yp4 + (i - 1) * xped,kd5,kd5)
        Endif
      EndFor
    EndFor
  Else
  endif
EndSub


Sub ak030MouseDown
  xmaus = GraphicsWindow.MouseX
  ymaus = GraphicsWindow.MouseY 
  If xmaus > xpe1 + 0 * xped And xmaus < xpe2 + 0 * xped And ymaus > yp1 + (aktz - 1) * 40 And ymaus < yp2 + (aktz - 1) * 40 Then
    If farbwahl <> 0 then
      eing[1] = farbwahl
      manuell = 0
      farbebotton1()
    endif
  EndIf 
  If xmaus > xpe1 + 1 * xped And xmaus < xpe2 + 1 * xped And ymaus > yp1 + (aktz - 1)*40 And ymaus < yp2 + (aktz - 1) * 40 Then
    If farbwahl <> 0 then
      eing[2] = farbwahl
      manuell = 0
      farbebotton2()
    endif
  EndIf 
  If xmaus > xpe1 + 2 * xped And xmaus < xpe2 + 2 * xped And ymaus > yp1 + (aktz - 1) * 40 And ymaus < yp2 + (aktz - 1) * 40 Then
    If farbwahl <> 0 then
      eing[3] = farbwahl
      manuell = 0
      farbebotton3()
    endif
  EndIf 
  If aspalten > 3 Then
    If xmaus > xpe1 + 3 * xped And xmaus < xpe2 + 3 * xped And ymaus > yp1 + (aktz - 1 )* 40 And ymaus < yp2 + (aktz - 1) * 40 Then
      If farbwahl <> 0 then
        eing[4] = farbwahl
        manuell = 0
        farbebotton4()
      endif
    EndIf 
  EndIf
  If aspalten > 4 then
    If xmaus > xpe1 + 4 * xped And xmaus < xpe2 + 4 * xped And ymaus > yp1 + (aktz - 1) * 40 And ymaus < yp2 + (aktz - 1) * 40 Then
      If farbwahl <> 0 then
        eing[5] = farbwahl
        manuell = 0
        farbebotton5()
      endif
    EndIf
  EndIf   
  If xmaus > xpf + 0 * xpfd And xmaus < xpf + 0 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 1
  EndIf 
  If xmaus > xpf + 1 * xpfd And xmaus < xpf + 1 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 2
  EndIf   
  If xmaus > xpf + 2 * xpfd And xmaus < xpf + 2 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 3
  EndIf
  If xmaus > xpf + 3 * xpfd And xmaus < xpf + 3 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 4
  EndIf 
  If xmaus > xpf + 4 * xpfd And xmaus < xpf + 4 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
    farbwahl = 5
  EndIf 
  If afarben > 5 then
    If xmaus > xpf + 5 * xpfd And xmaus < xpf + 5 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
      farbwahl = 6
    EndIf 
  EndIf
  If afarben > 6 then
    If xmaus > xpf + 6 * xpfd And xmaus < xpf + 6 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
      farbwahl = 7
    EndIf
  EndIf
  If afarben > 7 then
    If xmaus > xpf + 7 * xpfd And xmaus < xpf + 7 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
      farbwahl = 8
    EndIf 
  EndIf
  If afarben > 8 then
    If xmaus > xpf + 8 * xpfd And xmaus < xpf + 8 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
      farbwahl = 9
    EndIf 
  endif
  If afarben > 9 then
    If xmaus > xpf + 9 * xpfd And xmaus < xpf + 9 * xpfd + 38 And ymaus > ypf And ymaus < ypf + 38 Then
      farbwahl = 10
    EndIf 
  endif
  fz = aktz - 1
  aktuellefarbe()
EndSub


Sub ak200ButtonClicked2
  oBu = Controls.LastClickedButton
  If oBu = end1 Then
    Program.End()
  elseIf oBu = neu1 Then
    neustart = 1
    bStart = "True"
  elseIf oBu= ok1 Then
    al200okpr()
  ElseIf oBu = au1 then
    Controls.HideControl(au1)
    al200aupr()
  Else
    bStart = ""  
  EndIf
EndSub


Sub al200okpr 'prüfen ob die Eingabe vollständig, dann weiter
  If aspalten = 3 Then
    einprü = eing[1] * eing[2] * eing[3]
  EndIf
  If aspalten = 4 Then
    einprü = eing[1] * eing[2] * eing[3] * eing[4]
  EndIf
  If aspalten = 5 Then
    einprü = eing[1] * eing[2] * eing[3] * eing[4] * eing[5]
  EndIf 
  If einprü = 0 Then
    bStart = ""
  Else
    emat[aktz][1] = eing[1]
    emat[aktz][2] = eing[2]
    emat[aktz][3] = eing[3]
    emat[aktz][4] = eing[4]
    emat[aktz][5] = eing[5]
    ap200prüfen()
    aktz = aktz + 1
    bStart = "True" 
  EndIf
EndSub


Sub ap200prüfen 
  k = 0 
  For i = 1 To aspalten 'laden Hilfsfelder
    hein[i] = eing[i]
    hziel[i] = zwert[i]
    herg[i] = 1
  EndFor
  For i = 1 To aspalten 'richtig an gleicher Stelle
    If hein[i] = hziel[i] then
      k = k + 1
      herg[k] = 9 'richtige Position
      hein[i] = 98
      hziel[i] = 99
    EndIf
  EndFor
  If k = aspalten Then 'richtiges Ergebnis gefunden
    winok = 1
  EndIf
  For i = 1 To aspalten 'richtig an anderer Stelle
    For l = 1 To aspalten
      If hein[i] = hziel[l] then
        k = k + 1
        herg[k] = 10   'richtig an anderer Stelle
        hein[i] = 98
        hziel[l] = 99
      EndIf
    EndFor
  EndFor
  For i = 1 To aspalten
    ergmat[aktz][i] = herg[i]
  endfor      
EndSub


Sub al200aupr 'setzen der Farben für die Zeilen 1 und 2
  If aktz = 1 And aspalten = 3 then
    farbsuche1()
    farbebotton3a()
  EndIf
  If aktz = 1 And aspalten = 4 then
    farbsuche1()
    farbebotton3a()
    farbebotton4()
  EndIf
  If aktz = 1 And aspalten = 5 then
    farbsuche1()
    farbebotton3a()
    farbebotton4()
    farbebotton5()
  EndIf
  If aktz = 2 And aversuche = 7 then
    farbsuche2()
    farbebotton3a()
  EndIf
  If reihevoll = 1 Then
    ad100permu1()
    manuell = 1
    farbebotton3a()
    If aspalten > 3 Then 
      farbebotton4()
    EndIf
    If aspalten > 4 Then 
      farbebotton5()
    EndIf    
  Else
    If aktz = 2 And aversuche = 8 then
      farbsuche2()
      farbebotton3a()
    EndIf
    If aktz = 2 And aversuche = 9 then
      farbsuche2()
      farbebotton3a()
      farbebotton4()
    EndIf
    If aktz = 2 And aversuche = 10 then
      farbsuche2()
      farbebotton3a()
      farbebotton4()
    EndIf
    If aktz = 2 And aversuche = 11 then
      farbsuche2()
      farbebotton3a()
      farbebotton4()
      farbebotton5()
    EndIf
    If aktz = 2 And aversuche = 12 then
      farbsuche2()
      farbebotton3a()
      farbebotton4()
      farbebotton5()
    EndIf
    If aktz = 2 And aversuche = 13 then
      farbsuche2()
      farbebotton3a()
      farbebotton4()
      farbebotton5()
    EndIf
  EndIf
  If aktz > 2 then
    if manuell = 0 Then
      ad100permu1()
      manuell = 1
      farbebotton3a()
      If aspalten > 3 Then 
        farbebotton4()
      EndIf
      If aspalten > 4 Then 
        farbebotton5()
      EndIf   
    else
      ad150permu2()
      farbebotton3a()
      If aspalten > 3 Then 
        farbebotton4()
      EndIf
      If aspalten > 4 Then 
        farbebotton5()
      EndIf
    EndIf   
  EndIf
EndSub


Sub farbebotton1
  GraphicsWindow.BrushColor = col[ eing[1]]
  GraphicsWindow.FillRectangle(xpf + 0 * xped,yp3 + (aktz - 1) * xped,kd2,kd2)
EndSub

Sub farbebotton2
  GraphicsWindow.BrushColor = col[ eing[2]]
  GraphicsWindow.FillRectangle(xpf + 1 * xped,yp3 + (aktz - 1) * xped,kd2,kd2)
EndSub

Sub farbebotton3
  GraphicsWindow.BrushColor = col[ eing[3]]
  GraphicsWindow.FillRectangle(xpf + 2 * xped,yp3 + (aktz - 1) * xped,kd2,kd2) 
EndSub

Sub farbebotton3a
  farbebotton1()
  farbebotton2()
  farbebotton3()   
Endsub

Sub farbebotton4
  GraphicsWindow.BrushColor = col[ eing[4]]
  GraphicsWindow.FillRectangle(xpf + 3 * xped,yp3 + (aktz - 1) * xped,kd2,kd2)
EndSub

Sub farbebotton5
  GraphicsWindow.BrushColor = col[ eing[5]]
  GraphicsWindow.FillRectangle(xpf + 4 * xped,yp3 + (aktz - 1) * xped,kd2,kd2)
EndSub


'Allgemeine Unterprogramme


Sub farbsuche1  
  For i = 1 To aspalten
    x = Math.GetRandomNumber(afarben + 1 - i)
    eing[i] = fs[x] 
    fs[x] = fs[afarben + 1- i]
    fs[afarben + 1- i] = 0
  EndFor 
EndSub


Sub farbsuche2  
  For i = 1 To aspalten
    x = i
    If (i + aspalten) > afarben Then
      x = afarben - aspalten
    EndIf
    eing[i] = fs[x]
  EndFor 
EndSub


Sub Lost
  verl = 1
  GraphicsWindow.BrushColor = "red"
  GraphicsWindow.DrawText(xpm + 100 + xped * aspalten * 2, ypm + 45,"Sie haben die Lösung nicht gefunden") 
  GraphicsWindow.DrawText(xpm + 100 + xped * aspalten * 2, ypm + 65,"Die Lösung steht in der letzten Zeile") 
EndSub


Sub ah100rahmen
  GraphicsWindow.Left = 0
  GraphicsWindow.Top = 0
  GraphicsWindow.Width =1000
  GraphicsWindow.Height=700
  GraphicsWindow.Clear()
EndSub


Sub Spalten
  For i = 0 To aspalten*2
    If i = aspalten Then
      GraphicsWindow.PenWidth = 3 
    Else
      GraphicsWindow.PenWidth = 1
    EndIf
    GraphicsWindow.DrawLine(xpm + xped * i,yp + 100,xpm + xped * i,yp + 100 + xped * (aversuche + 1)) 
  EndFor
  GraphicsWindow.BrushColor = "black" 
  GraphicsWindow.DrawText(xpm,ypm + 45,"Eingabebereich")
  GraphicsWindow.DrawText(xpm + xped * aspalten,ypm + 45,"Ergebnisbereich")
EndSub


Sub Win
  GraphicsWindow.BrushColor = "black"
  GraphicsWindow.DrawText(xpm + 100 + xped * aspalten * 2,ypm + 45,"Sie haben das Spiel nach") 
  GraphicsWindow.DrawText(xpm + 100 + xped * aspalten * 2,ypm + 65,aktz - 1 + " Versuchen gewonnen") 
EndSub


Sub Win3
  GraphicsWindow.BrushColor = "black"
  GraphicsWindow.DrawText(xpm + 100 + xped * aspalten * 2,ypm + 45,"Die Lösung wurde nach") 
  GraphicsWindow.DrawText(xpm + 100 + xped * aspalten * 2,ypm + 65, aktz - 1 + " Versuchen gefunden") 
EndSub


Sub Zeilen 
  GraphicsWindow.BrushColor ="black"
  For i = 0 To aversuche+1
    If i = aversuche Then
      GraphicsWindow.PenWidth = 3 
    Else
      GraphicsWindow.PenWidth = 1
    EndIf
    GraphicsWindow.DrawLine(xpm,yp + 100 + xped * i,xpm + aspalten * 2 * xped,yp + 100 + xped * i)
  EndFor
  GraphicsWindow.BrushColor ="SlateGray"
  For i = 1 To aversuche
    GraphicsWindow.DrawText(xpm-25,yp + 75 + xped * i,i)
  EndFor
  GraphicsWindow.BrushColor ="black"
EndSub


Sub zielwerte
  q = aktz -1 
  For k = 1 to aspalten
    GraphicsWindow.BrushColor = Col[zwert[k]]
    GraphicsWindow.FillEllipse(xpm - 30 + xped * k,yp1 + (i - 1) * xped,kd4,kd4)
    GraphicsWindow.BrushColor ="black"
    GraphicsWindow.DrawEllipse(xpm - 30 + xped * k,yp1 + (i - 1) * xped,kd4,kd4)    
  EndFor   
EndSub


'Permutationen und Prüfungen für die automatisierten Funktionen und die Analyse


SUB ad100permu1
  IF aspalten = 3 THEN
    FOR i1 = 1 TO afarben
      eing[1] = i1
      FOR i2 = 1 TO afarben
        eing[2] = i2
        FOR i3 = 1 TO afarben
          eing[3] = i3
          ad200vergleich()
          IF kok = "j" THEN
            lia1 = i1
            lia2 = i2
            lia3 = i3
            i3 = afarben
            i2 = afarben
            i1 = afarben
          ENDIF
        EndFor
      EndFor
    EndFor
  ENDIF
  IF aspalten = 4 THEN
    FOR i1 = 1 TO afarben
      eing[1] = i1
      FOR i2 = 1 TO afarben
        eing[2] = i2
        FOR i3 = 1 TO afarben
          eing[3] = i3
          FOR i4 = 1 TO afarben
            eing[4] = i4
            ad200vergleich()
            IF kok = "j" THEN
              lia1 = i1
              lia2 = i2
              lia3 = i3
              lia4 = i4
              i4 = afarben
              i3 = afarben
              i2 = afarben
              i1 = afarben
            ENDIF
          EndFor
        EndFor
      EndFor
    EndFor
  ENDIF
  IF aspalten = 5 THEN
    FOR i1 = 1 TO afarben
      eing[1] = i1
      FOR i2 = 1 TO afarben
        eing[2] = i2
        FOR i3 = 1 TO afarben
          eing[3] = i3
          FOR i4 = 1 TO afarben
            eing[4] = i4
            FOR i5 = 1 TO afarben
              eing[5] = i5
              ad200vergleich()
              IF kok = "j" THEN
                lia1 = i1
                lia2 = i2
                lia3 = i3
                lia4 = i4
                lia5 = i5
                i5 = afarben
                i4 = afarben
                i3 = afarben
                i2 = afarben
                i1 = afarben
              ENDIF
            EndFor
          EndFor
        EndFor
      EndFor
    EndFor
  ENDIF
ENDSUB



SUB ad150permu2
  IF aspalten = 3 THEN
    li1 = lia1
    li2 = lia2
    li3 = lia3 + 1
    IF li3 > afarben THEN
      li3 = 1
      li2 = li2 + 1
      IF li2 > afarben THEN
        li2 = 1
        li1 = li1 + 1
        IF li1 > afarben THEN
          li1 = afarben
          li2 = afarben
          li3 = afarben
        ENDIF
      ENDIF
    ENDIF
  ENDIF
  IF aspalten = 4 THEN
    li1 = lia1
    li2 = lia2
    li3 = lia3
    li4 = lia4 + 1
    IF li4 > afarben THEN
      li4 = 1
      li3 = li3 + 1
      IF li3 > afarben THEN
        li3 = 1
        li2 = li2 + 1
        IF li2 > afarben THEN
          li2 = 1
          li1 = li1 + 1
          IF li1 > afarben THEN
            li1 = afarben
            li2 = afarben
            li3 = afarben
            li4 = afarben
          ENDIF
        ENDIF
      ENDIF
    ENDIF
  ENDIF
  IF aspalten = 5 THEN
    li1 = lia1
    li2 = lia2
    li3 = lia3
    li4 = lia4
    li5 = lia5 + 1
    IF li5 > afarben THEN
      li5 = 1
      li4 = li4 + 1
      IF li4 > afarben THEN
        li4 = 1
        li3 = li3 + 1
        IF li3 > afarben THEN
          li3 = 1
          li2 = li2 + 1
          IF li2 > afarben THEN
            li2 = 1
            li1 = li1 + 1
            IF li1 > afarben THEN
              li1 = afarben
              li2 = afarben
              li3 = afarben
              li4 = afarben
              li5 = afarben
            ENDIF
          ENDIF
        ENDIF
      ENDIF
    ENDIF
  ENDIF
  IF aspalten = 3 THEN
    FOR i1 = li1 TO afarben
      eing[1] = i1
      FOR i2 = li2 TO afarben
        eing[2] = i2
        FOR i3 = li3 TO afarben
          eing[3] = i3
          ad200vergleich()
          IF kok = "j" THEN
            lia1 = i1
            lia2 = i2
            lia3 = i3
            i3 = afarben
            i2 = afarben
            i1 = afarben
          ENDIF
        EndFor
        li3 = 1
      EndFor
      li2 = 1
    EndFor
  ENDIF
  IF aspalten = 4 THEN
    FOR i1 = li1 TO afarben
      eing[1] = i1
      FOR i2 = li2 TO afarben
        eing[2] = i2
        FOR i3 = li3 TO afarben
          eing[3] = i3
          FOR i4 = li4 TO afarben
            eing[4] = i4
            ad200vergleich()
            IF kok = "j" THEN
              lia1 = i1
              lia2 = i2
              lia3 = i3
              lia4 = i4
              i4 = afarben
              i3 = afarben
              i2 = afarben
              i1 = afarben
            ENDIF
          EndFor
          li4 = 1
        EndFor
        li3 = 1
      EndFor
      li2 = 1
    EndFor
  ENDIF
  IF aspalten = 5 THEN
    FOR i1 = li1 TO afarben
      eing[1] = i1
      FOR i2 = li2 TO afarben
        eing[2] = i2
        FOR i3 = li3 TO afarben
          eing[3] = i3
          FOR i4 = li4 TO afarben
            eing[4] = i4
            FOR i5 = li5 TO afarben
              eing[5] = i5
              ad200vergleich()
              IF kok = "j" THEN
                lia1 = i1
                lia2 = i2
                lia3 = i3
                lia4 = i4
                lia5 = i5
                i5 = afarben
                i4 = afarben
                i3 = afarben
                i2 = afarben
                i1 = afarben
              ENDIF
            EndFor
            li5 = 1
          EndFor
          li4 = 1
        EndFor
        li3 = 1
      EndFor
      li2 = 1
    EndFor
  ENDIF
ENDSUB


SUB ad200vergleich
  ' Vergleich von Kombination und bisherige Ergebnisse
  kok = "j"
  FOR j = 1 TO aktz - 1
    FOR i = 1 TO aspalten
      c1[i] = eing[i]
      e1[i] = emat[j][i]
      d1[i] = 1
    EndFor
    k = 1
    FOR i = 1 TO aspalten
      IF e1[i] = c1[i] THEN
        d1[k] = 9
        c1[i] = 98
        e1[i] = 99
        k = k + 1
      ENDIF
    EndFor
    FOR i = 1 TO aspalten
      FOR l = 1 TO aspalten
        IF e1[i] = c1[l] THEN
          d1[k] = 10
          c1[l] = 98
          e1[i] = 99
          k = k + 1
        ENDIF
      EndFor
    EndFor
    m = 0
    FOR i = 1 TO aspalten
      IF ergmat[j][i] = d1[i] THEN
        m = m + 1
      ENDIF
    EndFor
    IF m <> aspalten THEN
      j = aktz - 1
      kok = "n"
    ENDIF
  EndFor
ENDSUB


'Analyserechnungen


SUB ad100permu13 'Lösungssuche für die Analysefunktion
  IF aspalten = 3 THEN
    FOR i1 = 1 TO afarben
      eing[1] = i1
      FOR i2 = 1 TO afarben
        eing[2] = i2
        FOR i3 = 1 TO afarben
          eing[3] = i3
          ad200vergleich3()
          IF kok = "j" THEN
            i3 = afarben
            i2 = afarben
            i1 = afarben
          ENDIF
        EndFor
      EndFor
    EndFor
  ENDIF
  IF aspalten = 4 THEN
    FOR i1 = 1 TO afarben
      eing[1] = i1
      FOR i2 = 1 TO afarben
        eing[2] = i2
        FOR i3 = 1 TO afarben
          eing[3] = i3
          FOR i4 = 1 TO afarben
            eing[4] = i4
            ad200vergleich3()
            IF kok = "j" THEN
              i4 = afarben
              i3 = afarben
              i2 = afarben
              i1 = afarben
            ENDIF
          EndFor
        EndFor
      EndFor
    EndFor
  ENDIF
  IF aspalten = 5 THEN
    FOR i1 = 1 TO afarben
      eing[1] = i1
      FOR i2 = 1 TO afarben
        eing[2] = i2
        FOR i3 = 1 TO afarben
          eing[3] = i3
          FOR i4 = 1 TO afarben
            eing[4] = i4
            FOR i5 = 1 TO afarben
              eing[5] = i5
              ad200vergleich3()
              IF kok = "j" THEN
                i5 = afarben
                i4 = afarben
                i3 = afarben
                i2 = afarben
                i1 = afarben
              ENDIF
            EndFor
          EndFor
        EndFor
      EndFor
    EndFor
  ENDIF
ENDSUB


SUB ad200vergleich3
  ' Vergleich für die Analyse
  kok = "j"
  FOR j = 1 TO aktz - 1
    FOR i = 1 TO aspalten
      c1[i] = eing[i]
      e1[i] = emat[j][i]
      d1[i] = 11
    EndFor
    k = 1
    FOR i = 1 TO aspalten
      IF e1[i] = c1[i] THEN
        d1[k] = 9
        c1[i] = 98
        e1[i] = 99
        k = k + 1
      ENDIF
    EndFor
    FOR i = 1 TO aspalten
      FOR l = 1 TO aspalten
        IF e1[i] = c1[l] THEN
          d1[k] = 10
          c1[l] = 98
          e1[i] = 99
          k = k + 1
        ENDIF
      EndFor
    EndFor
    m = 0
    FOR i = 1 TO aspalten
      IF ergmat[j][i] = d1[i] THEN
        m = m + 1
      ENDIF
    EndFor
    IF m <> aspalten THEN
      j = aktz - 1
      kok = "n"
    ENDIF
  EndFor
ENDSUB 


Sub aa050hilfe
  GraphicsWindow.BrushColor = "black"
  GraphicsWindow.Clear()
  GraphicsWindow.DrawText(40, 20, "Wählen Sie das Hilfethema")
  hi1 = Controls.AddButton("Hauptmenue",40,80)
  hi2 = Controls.AddButton("Spielstärke   ",40,120)
  hi3 = Controls.AddButton("Spielmodus  ",40,160)
  hi4 = Controls.AddButton("Spielen          ",40,200)
  hi5 = Controls.AddButton("Analyse         ",40,240)
  hi8 = Controls.AddButton("Ende Hilfe      ",40,360)
  hi9 = Controls.AddButton("Ende               ",40,400)  
  bStart = ""
  be = 5 'ak050ButtonClicked4
  While bStart = ""
    Program.Delay(500)
  EndWhile
EndSub


Sub ak050ButtonClicked4
  oBu = Controls.LastClickedButton
  GraphicsWindow.BrushColor = "white"
  GraphicsWindow.FillRectangle(200,60,600,640) 'löschen des Textbereichs
  If oBu = hi1 Then   
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.DrawText(220,70,"Bevor Sie die Spielstärke auswählen stellen Sie bitte den Spielmodus ein.")
    GraphicsWindow.DrawText(220,110,"Wählen Sie die Spielstärke aus.")
  ElseIf oBu = hi2 Then
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.DrawText(220,70,"Durch die Auswahl der Spielstärke bestimmen Sie:")
    GraphicsWindow.DrawText(240,110,"- Wieviele Farben zur Verfügung stehen.")
    GraphicsWindow.DrawText(240,150,"- Wieviele Spalten für die Kombinationen möglich sind.")
    GraphicsWindow.DrawText(240,190,"- Wieviele Versuche maximal gespielt werden können.")
    GraphicsWindow.DrawText(220,230,"Die Auswahl der Spielstärke startet das Spiel im gewählten Spielmodus.")
  elseif oBu= hi3 then
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.DrawText(220,70,"Es stehen folgende Spielmodi zur Verfügung:")
    GraphicsWindow.DrawText(240,100,"- Manuell")
    GraphicsWindow.DrawText(260,130,"Jeder Zug muss von Ihnen eingegeben werden.")
    GraphicsWindow.DrawText(240,160,"- Vorbelegung für Zeile 1 und 2")
    GraphicsWindow.DrawText(260,190,"Für die ersten beiden Züge können Sie Vorschläge vom Programm machen lassen.")
    GraphicsWindow.DrawText(260,210,"Bevor Sie einen Vorschlag bestätigen können Sie ihn beliebig verändern.")
    GraphicsWindow.DrawText(260,240,"Die folgenden Züge müssen von Ihnen eingegeben werden.")
    GraphicsWindow.DrawText(240,270,"- Vorbelegung für alle Zeile")
    GraphicsWindow.DrawText(260,300,"Für alle Züge können Sie Vorschläge vom Programm machen lassen.")
    GraphicsWindow.DrawText(260,330,"Bevor Sie einen Vorschlag bestätigen können Sie ihn belibig verändern.")
    GraphicsWindow.DrawText(260,360,"Sie können jeden Zuge auch manuell eingeben.")
    GraphicsWindow.DrawText(240,390,"- Analyse")
    GraphicsWindow.DrawText(260,420,"Dieser Spielmodus bewirkt, dass eine von Ihnen vorgegebene Kombination")
    GraphicsWindow.DrawText(260,450,"durch das Programm ermittelt wird.")
    GraphicsWindow.DrawText(260,480,"Sie müssen dabei für jeden Zug des Programms das Ergebnis eingeben.")
    GraphicsWindow.DrawText(240,510,"- Analyse - automatik")
    GraphicsWindow.DrawText(260,540,"Dieser Spielmodus bewirkt, dass eine von Ihnen vorgegebene Kombination")
    GraphicsWindow.DrawText(260,570,"durch das Programm ermittelt wird.")
    GraphicsWindow.DrawText(260,600,"Das jeweilige Ergebnis wird durch das Programm automatisch ermittelt.")
  elseif oBu = hi4 then
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.DrawText(220,70,"Im Spielmodus wird Ihnen für jeden Zug eine leere Eingabezeile vorgegeben.")
    GraphicsWindow.DrawText(220,100,"Für die Eingabe einer Farbe in der Eingabezeilen wählen Sie zuerst die Farbe")
    GraphicsWindow.DrawText(220,130,"aus der Liste der möglichen Farben über dem Spielfeld aus.")
    GraphicsWindow.DrawText(220,160,"Die ausgewählte Farbe wird als Dreieck am rechten Rand der aktuellen Eingabezeile angezeigt.")
    GraphicsWindow.DrawText(220,190,"Danach können Sie alle Felder im Eingabebereich anklicken die mit dieser Farbe")
    GraphicsWindow.DrawText(220,220,"belegt werden sollen. Als Ergebnis wird der Hintergrund des Feldes mit dieser Farbe")
    GraphicsWindow.DrawText(220,250,"belegt. Der Inhalt eines Feldes kann beliebig veränder werden.")
    GraphicsWindow.DrawText(220,280,"Steht die Funktion AU zur Verfügung,")
    GraphicsWindow.DrawText(220,310,"können Sie damit eine mögliche Kombination vorgeben lassen.")
    GraphicsWindow.DrawText(220,340,"Wenn alle Felder einer Zeile ausgefüllt sind, bestätigen Sie die Eingabe mit OK.")
    GraphicsWindow.DrawText(220,370,"Danach wird das Ergebnis des Versuchs in der Ergebnisspalte angezeigt und eine neue")
    GraphicsWindow.DrawText(220,400,"Eingabezeile aktiviert.")
    GraphicsWindow.DrawText(220,430,"Dies geschieht solange bis Sie die richtige Kombination eingegeben haben.")
    GraphicsWindow.DrawText(220,460,"Haben Sie auch beim letzten Versuch nicht die richtige Kombination eingegeben,")
    GraphicsWindow.DrawText(220,490,"wird die vorgegebene Zahl in der untersten Zeile angezeigt.")
    GraphicsWindow.DrawText(220,520,"Das laufende Spiel wird damit beendet.")
    GraphicsWindow.DrawText(220,550,"Durch den Button Neu können Sie ein neues Spiel beginnen.")
  elseif oBu = hi5 then
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.DrawText(220,70,"Im Analysemodus geben Sie zuerst Ihre gewählte Kombination ein.")
    GraphicsWindow.DrawText(220,100,"Diese Kombination wird Ihnen während des Spiels in der letzten Zeile angezeigt.")
    GraphicsWindow.DrawText(220,130,"Nach jedem Zug durch das Programm bestätigen Sie das Ergebnis im Ergebnisbereich.")
    GraphicsWindow.DrawText(220,160,"Das Ergebnis muss lückenlos und aufsteigend eingegeben werden.")
    GraphicsWindow.DrawText(220,190,"Zuerst alle richtigen Positionen mit - Schwarz -")
    GraphicsWindow.DrawText(220,220,"Dann alle noch offenen richtige Elemente mit - Creme -")
    GraphicsWindow.DrawText(220,250,"Bereits gesetzte Felder können wieder gelöscht werden mit - Weiß -")
    GraphicsWindow.DrawText(220,280,"Sollte Ihnen bei der Antwort ein Fehler unterlaufen,")
    GraphicsWindow.DrawText(220,310,"dann wird das Programm als leztze Kombination x-mal die gleiche Farbe ausgeben.")
    GraphicsWindow.DrawText(220,340,"Sie können das Programm dann normal weiterführen, wenn Sie dieses Ergebnis")
    GraphicsWindow.DrawText(220,370,"mit x-mal - SCHWARZ - bestätigen, oder das Programm beenden")
    GraphicsWindow.DrawText(220,400,"Die Farbauswahl ist im Hilfetext - SPIELEN - beschrieben.")
  Elseif oBu = hi8 then
    bStart = "True"
  elseif oBu = hi9 then
    Program.End()
  Else
    bStart = ""  
  EndIf
EndSub


Sub ah100kreuz
  ax = wx + 3
  ay = wy + 3
  bx = ax + 30
  by = ay + 30
  GraphicsWindow.DrawLine(ax,ay,bx,by)
  GraphicsWindow.DrawLine(bx,ay,ax,by)
EndSub


Sub aktuellefarbe
  If farbwahl <> 0 then
    GraphicsWindow.BrushColor = col[farbwahl]
    GraphicsWindow.FillTriangle(xpm - 28,yp1 + fz * 40,xpm - 28,yp + 138 + fz * 40,xpm - 4,yp + 122 + fz * 40)
    GraphicsWindow.PenWidth = 2 
    GraphicsWindow.BrushColor = "black"
    GraphicsWindow.DrawTriangle(xpm - 28,yp1 + fz * 40,xpm - 28,yp + 138 + fz * 40,xpm - 4,yp + 122 + fz * 40)
    GraphicsWindow.PenWidth = 1
  Else
    GraphicsWindow.BrushColor = "white"
    GraphicsWindow.FillTriangle(xpm - 29,yp1 + fz * 40,xpm - 29,yp + 142 + fz * 40,xpm - 2,yp + 122 + fz * 40)    
  EndIf 
EndSub
