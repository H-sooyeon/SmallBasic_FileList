' ????????   ２作?

' ??な??転換

' 岡山科????術専?????????????科????

' ??定数?定義

ss=0

DEATH = 1

lc=0

st:

GraphicsWindow.Clear()

SCREEN_WIDTH = 24         ' ???????(?????)

SCREEN_HEIGHT = 18        ' ??????高さ(?????)

UNIT_SIZE = 30            ' ???????(????)

GOAL_X = 1

GOAL_Y = 1

If lc=1 then

GOAL_X = 22

GOAL_Y = 16

Endif

ENEMY_NUM = 5

SPEED = 5                 ' ?度に移動???????

ENEMY_SPEED = 10          ' Enemy Speed

DELAY = 50                ' ???毎の待機??(???)

WALL_COLOR = "#808080"    ' 壁の?

BACK_COLOR = "#000000"    ' ????

ROBO_COLOR = "#0000FF"    ' ??????

ENEMY_COLOR = "#FF0000"   ' Enemy Color



' 壁の??(???)?定義 (1:壁あ?, ??以外:壁な?)

If ss=0 then

  ENEMY_NUM = 8

WALLS [1]  = "111111111111111111111111"

WALLS [2]  = "100111111100000000001111"

WALLS [3]  = "100111000101110111111111"

WALLS [4]  = "101111010000000000111111"

WALLS [5]  = "101000000000110110111111"

WALLS [6]  = "100011010101110110111111"

WALLS [7]  = "111000000000010110111111"

WALLS [8]  = "111011010101010110001111"

WALLS [9]  = "111011000000000000101111"

WALLS [10] = "111011110101010110101111"

WALLS [11] = "111011110101010110101111"

WALLS [12] = "100000000101010000000011"

WALLS [13] = "111011111101011110101011"

WALLS [14] = "111011111100000000001011"

WALLS [15] = "111111111111011110111011"

WALLS [16] = "111111111111111111111001"

WALLS [17] = "111111111111111111111001"

WALLS [18] = "111111111111111111111111"







ex[1] = UNIT_SIZE * 3

ey[1] = UNIT_SIZE * 6

ds[1]=1

ex[2] = UNIT_SIZE * 1

ey[2] = UNIT_SIZE * 11

da[2]=1

ex[3] = UNIT_SIZE * 6

ey[3] = UNIT_SIZE * 2

dz[3]=1

ex[4] = UNIT_SIZE * 3

ey[4] = UNIT_SIZE * 13

dc[4]=1

ex[5] = UNIT_SIZE * 19

ey[5] = UNIT_SIZE * 1

  dv[5]=1

ex[6] = UNIT_SIZE * 19

ey[6] = UNIT_SIZE * 7

  db[6]=1

ex[7] = UNIT_SIZE * 17

ey[7] = UNIT_SIZE * 14

  dn[7]=4

ex[8] = UNIT_SIZE * 14

ey[8] = UNIT_SIZE * 1

  dm[8]=3

Endif





If ss=1 then

  lc=lc+1

  ss=0

  GraphicsWindow.ShowMessage("?作を??待下??", "体験?")

  Goto gameend

  If lc=2 then

  GraphicsWindow.ShowMessage("????????", "?????")

Goto gameend

Endif

  Goto st

Endif



' ??????????

GraphicsWindow.Show()                               ' 表示

GraphicsWindow.Width = SCREEN_WIDTH * UNIT_SIZE     ' 幅を??

GraphicsWindow.Height = SCREEN_HEIGHT * UNIT_SIZE   ' 高さ???

GraphicsWindow.CanResize = "False"                  ' ??????

GraphicsWindow.BackgroundColor = BACK_COLOR         ' ??????



' 壁の??

GraphicsWindow.BrushColor = WALL_COLOR              ' ????????

For iy = 1 To Array.GetItemCount(WALLS)             ' ????繰り返し(WALLS??????)

  For ix = 1 To Text.GetLength(WALLS [iy])          ' 横方??繰り返し(?字列?????)

    If Text.GetSubText(WALLS [iy], ix, 1) = "1" Then  ' ?字が"1"????

      

      GraphicsWindow.FillRectangle(UNIT_SIZE * (ix - 1), UNIT_SIZE * (iy - 1), UNIT_SIZE, UNIT_SIZE)

    EndIf

  EndFor

EndFor



' GOAL

GraphicsWindow.BrushColor = "Yellow"

GraphicsWindow.FontSize = 20

GraphicsWindow.FontBold = "True"

GraphicsWindow.DrawText(GOAL_X * UNIT_SIZE, GOAL_Y * UNIT_SIZE, "GOAL")



' ???????????

x = UNIT_SIZE * 22      ' 横位? (左か?12????)

y = UNIT_SIZE * 16      ' 縦位? (上か?10????)

xd = 0                  ' 横移??? (-1:?, 0:?, 1:?) 移動?

yd = 0                  ' ?移動?? (-1:?, 0:?, 1:?) 移動?

xk = 0                  ' 横移??? (-1:?, 0:?, 1:?) ??????付用

yk = 0                  ' ?移動?? (-1:?, 0:?, 1:?) ??????付用



If lc=1 then

x = UNIT_SIZE * 1      ' 横位? (左か?12????)

y = UNIT_SIZE * 1      ' 縦位? (上か?10????)

xd = 0                  ' 横移??? (-1:?, 0:?, 1:?) 移動?

yd = 0                  ' ?移動?? (-1:?, 0:?, 1:?) 移動?

xk = 0                  ' 横移??? (-1:?, 0:?, 1:?) ??????付用

yk = 0                  ' ?移動?? (-1:?, 0:?, 1:?) ??????付用

Endif



' ????????

GraphicsWindow.BrushColor = ROBO_COLOR    ' ????????

GraphicsWindow.PenColor = ROBO_COLOR      ' ???????

robot = Shapes.AddEllipse(UNIT_SIZE, UNIT_SIZE) ' ????????????

Shapes.Move(robot, x, y)                  ' ????????????位置?



' ????

GraphicsWindow.BrushColor = ENEMY_COLOR

GraphicsWindow.PenColor = ENEMY_COLOR

For ie = 1 To ENEMY_NUM

  enemy[ie] = Shapes.AddEllipse(UNIT_SIZE, UNIT_SIZE)

  Shapes.Move(enemy[ie], ex[ie], ey[ie])

EndFor



' ??????????の??

GraphicsWindow.KeyDown = onKeyDown        ' ????????onKeyDown?????????



While xk = 0 And yk = 0

EndWhile



starttime = Clock.ElapsedMilliseconds



' ?????? 

status = ""

While status = ""      ' 繰り返し(??件に)

  ' ???????????示を??付け?

  '   ?????縦位??横位?????????位だ???

  If Math.Remainder(x, UNIT_SIZE) = 0 And Math.Remainder(y, UNIT_SIZE) = 0 Then

    ' ???????付け???????移動??????????

    xd = xk         ' 横方?

    yd = yk         ' ???

  EndIf



  ' ????????ん???????上の位置?求め?

  '    ???????位で位置?求め?そ???????????????????上の位置?求め?

  If xd < 0 Then

    nx = x - 1

  ElseIf 0 < xd then

    nx = x + UNIT_SIZE + 1

  Else

    nx = x

  EndIf

  nxi = Math.Floor(nx / UNIT_SIZE) + 1

  If yd < 0 Then

    ny = y - 1

  ElseIf 0 < yd then

    ny = y + UNIT_SIZE + 1

  Else

    ny = y

  EndIf

  nyi = Math.Floor(ny / UNIT_SIZE) + 1  

  

  ' ???上の求め?位置?壁が???

  If Text.GetSubText(WALLS [nyi], nxi, 1) = "1" Then

    ' ????移動???0??定す?(????停止さ??)

    xk = 0

    yk = 0

    xd = 0

    yd = 0

  EndIf

  

  ' ?????移動位置?計算

  x = x + xd * SPEED

  y = y + yd * SPEED

  

  ' ??????????移動

  Shapes.Move(robot, x, y)



  ' ?????  

  If x = GOAL_X * UNIT_SIZE And y = GOAL_Y * UNIT_SIZE Then

    status = "GOAL"

    gametime = Clock.ElapsedMilliseconds - starttime

    GraphicsWindow.BrushColor = "Yellow"

    GraphicsWindow.DrawText(300,200, gametime / 100)

  EndIf



  ' ????

  For ie = 1 To ENEMY_NUM  

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      ' ??壁に????????方????

      exd[ie] = -exd[ie]

      eyd[ie] = -eyd[ie]

    EndIf

    

    '壁に???????決?????????

    If dr[ie] = 1 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf dr[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf dr[ie] = 3 Then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dr[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = -1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dr[ie] = dr[ie] + 1

    EndIf

    

    If dr[ie] = 5 Then

      dr[ie] = 1

    EndIf 

    

    '??????壁の???も?1????

    If dr[ie] = 1 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf dr[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf dr[ie] = 3 Then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dr[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = -1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dr[ie] = dr[ie] + 1

    EndIf

    

    If dr[ie] = 5 Then

      dr[ie] = 1

    EndIf 

    

    '??????壁の???も?1????

    If dr[ie] = 1 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf dr[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf dr[ie] = 3 Then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dr[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = -1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dr[ie] = dr[ie] + 1

    EndIf

    

    If dr[ie] = 5 Then

      dr[ie] = 1

    EndIf

    

    '壁に????????上???方?????

    If dl[ie] = 1 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf dl[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf dl[ie] = 3 Then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dl[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = 1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dl[ie] = dl[ie] + 1

    EndIf

    

    If dl[ie] = 5 Then

      dl[ie] = 1

    EndIf 

    

    If dl[ie] = 1 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf dl[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf dl[ie] = 3 Then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dl[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = 1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dl[ie] = dl[ie] + 1

    EndIf

    

    If dl[ie] = 5 Then

      dl[ie] = 1

    EndIf

    

    If ds[ie] = 1 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf ds[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf ds[ie] = 3 Then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf ds[ie] = 4 then

          exd[ie] = -1

          eyd[ie] = 0

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      ds[ie] = ds[ie] + 1

    EndIf

    

    If ds[ie] = 5 Then

      ds[ie] = 1

    EndIf 

    

    If ds[ie] = 1 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf ds[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf ds[ie] = 3 Then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf ds[ie] = 4 then

          exd[ie] = -1

          eyd[ie] = 0

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      ds[ie] = ds[ie] + 1

    EndIf

    

    If ds[ie] = 5 Then

      ds[ie] = 1

    EndIf

    

    If da[ie] = 1 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf da[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf da[ie] = 3 Then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf da[ie] = 4 then

          exd[ie] = -1

          eyd[ie] = 0

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      da[ie] = da[ie] + 1

    EndIf

    

    If da[ie] = 5 Then

      da[ie] = 1

    EndIf 

    

    If da[ie] = 1 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf da[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf da[ie] = 3 Then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf da[ie] = 4 then

          exd[ie] = -1

          eyd[ie] = 0

      EndIf

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      da[ie] = da[ie] + 1

    EndIf

    

    If da[ie] = 5 Then

      da[ie] = 1

    EndIf

    

    If dz[ie] = 1 then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf dz[ie] = 2 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf dz[ie] = 3 Then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dz[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = -1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dz[ie] = dz[ie] + 1

    EndIf

    

    If dz[ie] = 5 Then

      dz[ie] = 1

    EndIf 

    

    If dz[ie] = 1 then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf dz[ie] = 2 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf dz[ie] = 3 Then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dz[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = -1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dz[ie] = dz[ie] + 1

    EndIf

    

    If dz[ie] = 5 Then

      dz[ie] = 1

    EndIf

    

    If dc[ie] = 1 then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf dc[ie] = 2 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf dc[ie] = 3 Then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dc[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = 1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dc[ie] = dc[ie] + 1

    EndIf

    

    If dc[ie] = 5 Then

      dc[ie] = 1

    EndIf 

    

    If dc[ie] = 1 then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf dc[ie] = 2 then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf dc[ie] = 3 Then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dc[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = 1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dc[ie] = dc[ie] + 1

    EndIf

    

    If dc[ie] = 5 Then

      dc[ie] = 1

    EndIf

    

    If dv[ie] = 1 then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dv[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf dv[ie] = 3 Then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf dv[ie] = 4 then

          exd[ie] = 1

          eyd[ie] = 0

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '???????????行???１を＋す?

      dv[ie] = dv[ie] + 1

    EndIf

    

    If dv[ie] = 5 Then

      dv[ie] = 1

    EndIf

    

    If dv[ie] = 1 then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dv[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf dv[ie] = 3 Then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf dv[ie] = 4 then

          exd[ie] = 1

          eyd[ie] = 0

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dv[ie] = dv[ie] + 1

    EndIf

    

    If dv[ie] = 5 Then

      dv[ie] = 1

    EndIf

    

    If db[ie] = 1 then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf db[ie] = 2 then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf db[ie] = 3 Then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf db[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = -1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      db[ie] = db[ie] + 1

    EndIf

    

    If db[ie] = 5 Then

      db[ie] = 1

    EndIf

    

    If db[ie] = 1 then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf db[ie] = 2 then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf db[ie] = 3 Then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf db[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = -1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      db[ie] = db[ie] + 1

    EndIf

    

    If db[ie] = 5 Then

      db[ie] = 1

    EndIf

    

    If dn[ie] = 1 then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf dn[ie] = 2 then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dn[ie] = 3 Then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf dn[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = 1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dn[ie] = dn[ie] + 1

    EndIf

    

    If dn[ie] = 5 Then

      dn[ie] = 1

    EndIf

    

    If dn[ie] = 1 then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf dn[ie] = 2 then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dn[ie] = 3 Then

          exd[ie] = 1

          eyd[ie] = 0

        ElseIf dn[ie] = 4 then

          exd[ie] = 0

          eyd[ie] = 1

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dn[ie] = dn[ie] + 1

    EndIf

    

    If dn[ie] = 5 Then

      dn[ie] = 1

    EndIf

    

    If dm[ie] = 1 then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dm[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf dm[ie] = 3 Then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf dm[ie] = 4 then

          exd[ie] = 1

          eyd[ie] = 0

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dm[ie] = dm[ie] + 1

    EndIf

    

    If dm[ie] = 5 Then

      dm[ie] = 1

    EndIf

    

    If dm[ie] = 1 then

          exd[ie] = -1

          eyd[ie] = 0

        ElseIf dm[ie] = 2 then

          exd[ie] = 0

          eyd[ie] = -1

        ElseIf dm[ie] = 3 Then

          exd[ie] = 0

          eyd[ie] = 1

        ElseIf dm[ie] = 4 then

          exd[ie] = 1

          eyd[ie] = 0

      EndIf 

    

    If exd[ie] < 0 Then

      enx = ex[ie] - 1

    ElseIf 0 < exd[ie] then

      enx = ex[ie] + UNIT_SIZE + 1

    Else

      enx = ex[ie]

    EndIf

    enxi = Math.Floor(enx / UNIT_SIZE) + 1

    If eyd[ie] < 0 Then

      eny = ey[ie] - 1

    ElseIf 0 < eyd[ie] then

      eny = ey[ie] + UNIT_SIZE + 1

    Else

      eny = ey[ie]

    EndIf

    enyi = Math.Floor(eny / UNIT_SIZE) + 1  

    

    If Text.GetSubText(WALLS [enyi], enxi, 1) = "1" Then

      '壁に?????????行???１を＋す?

      dm[ie] = dm[ie] + 1

    EndIf

    

    If dm[ie] = 5 Then

      dm[ie] = 1

    EndIf

    

    ex[ie] = ex[ie] + exd[ie] * ENEMY_SPEED

    ey[ie] = ey[ie] + eyd[ie] * ENEMY_SPEED

    Shapes.Move(enemy[ie], ex[ie], ey[ie])

    

    If (x - ex[ie]) * (x - ex[ie]) + (y - ey[ie]) * (y - ey[ie]) < UNIT_SIZE * UNIT_SIZE Then

      status = "GAME OVER"

      GraphicsWindow.BrushColor = "Yellow"

      GraphicsWindow.PenColor = "Yellow"

      GraphicsWindow.FillEllipse(x - 135, y - 135, 300, 300)

      Program.Delay(DELAY)

      GraphicsWindow.BrushColor = BACK_COLOR

      GraphicsWindow.PenColor = BACK_COLOR

      GraphicsWindow.FillEllipse(x - 135, y - 135, 300, 300) 

      GraphicsWindow.ShowMessage("?????!!", "OUT")

      DEATH=DEATH-1

      GraphicsWindow.ShowMessage("残り残機"+DEATH+"??", "OUT")

      If DEATH = 0 then

      GraphicsWindow.ShowMessage("????????", "OUT")

      Goto gameend 

    Endif

      Goto st

    EndIf

  EndFor 

 

  ' ?度調整????待機

  Program.Delay(DELAY)

EndWhile



If status = "GOAL" then

  GraphicsWindow.ShowMessage("次の?????", "???")

  ss=ss+1

  goto st

EndIf



gameend:

Program.End()



' ?????? (??????????????)

Sub onKeyDown

  KeyName = GraphicsWindow.LastKey    ' ??後に?作さ??????????

  If KeyName = "Left" Then            ' ????(?)??????

    xk = -1                             ' 横移?????(-1)?

    yk = 0                              ' ?移動????(0)?

  ElseIf KeyName = "Right" Then       ' ????(?)??????

    xk = 1                              ' 横移?????(1)?

    yk = 0                              ' ?移動????(0)?

  ElseIf KeyName = "Up" Then          ' ????(?)??????

    xk = 0                              ' 横移?????(0)?

    yk = -1                             ' ?移動????(-1)?

  ElseIf KeyName = "Down" Then        ' ????(?)??????

    xk = 0                              ' 横移?????(0)?

    yk = 1                              ' ?移動????(1)?

  EndIf

EndSub




