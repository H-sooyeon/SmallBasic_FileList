P = 1
rm = 0
ang = 0
anm = 0
zm = 0
opc = 0
rm = ""
GraphicsWindow.Title = "To help learners Small Basic(В помощь изучающим Small Basic) Akiva Toronto 22/XI/2015 " 
GraphicsWindow.BackgroundColor = GraphicsWindow.GetColorFromRGB(0,155,255)
gw = 1465
gh = 855
GraphicsWindow.Width = gw
GraphicsWindow.Height = gh
LDScrollBars.Add(gw+0, gh+0)
GraphicsWindow.Top = 100
GraphicsWindow.Left = 300
GraphicsWindow.CanResize = "true"
GraphicsWindow.BrushColor = "Black"
GraphicsWindow.FontSize = 13
t1 = Controls.AddTextBox(441,835)
Controls.SetSize(t1,80,25)
LDDialogs.ToolTip(t1,"t1 ")
t2 = Controls.AddTextBox(523,835)
Controls.SetSize(t2,80,25)
LDDialogs.ToolTip(t2,"t2 ")
t3 = Controls.AddTextBox(605,835)
Controls.SetSize(t3,80,25)
LDDialogs.ToolTip(t3,"t3 ")
t4 = Controls.AddTextBox(687,835)
Controls.SetSize(t4,80,25)
LDDialogs.ToolTip(t4,"t4 ")
t5 = Controls.AddTextBox(30,835)
Controls.SetSize(t5,409,25)
LDDialogs.ToolTip(t5,"t5")
t6 = Controls.AddTextBox(769,835)
Controls.SetSize(t6,80,25)
LDDialogs.ToolTip(t6,"t6")
t7 = Controls.AddTextBox(851,835)
Controls.SetSize(t7,80,25)
LDDialogs.ToolTip(t7,"t7")
t11 = Controls.AddTextBox(1000,2)
Controls.SetSize(t11,80,25)
LDDialogs.ToolTip(t11,"t11( X = ?")
t12 = Controls.AddTextBox(1082,2)
Controls.SetSize(t12,80,25)
LDDialogs.ToolTip(t12,"t12( Y = ?")
t14 = Controls.AddTextBox(1300,2)
Controls.SetSize(t14,80,25)
t15 = Controls.AddTextBox(1382,2)
Controls.SetSize(t15,80,25)
GraphicsWindow.BrushColor = "Blue"
t17 = LDControls.AddRichTextBox(462,730)
Controls.Move(t17,1000,28)
LDDialogs.ToolTip(t17,"t17()Корректируем, копируем и выводим в редактор SB")
GraphicsWindow.BrushColor = "Red"
ts2 = Controls.AddTextBox(655,765)
Controls.SetSize(ts2,45,25)
GraphicsWindow.BrushColor = "Green"
ts3 = Controls.AddTextBox(855,765)
Controls.SetSize(ts3,45,25)
GraphicsWindow.BrushColor = "Blue"
ts4 = Controls.AddTextBox(1055,765)
Controls.SetSize(ts4,45,25)
GraphicsWindow.BrushColor = "Black"
ts5 = Controls.AddTextBox(30,800)
Controls.SetSize(ts5,45,25)
ts6 = Controls.AddTextBox(235,800)
Controls.SetSize(ts6,45,25)
ts7 = Controls.AddTextBox(435,800)
Controls.SetSize(ts7,45,25)
ts8 = Controls.AddTextBox(633,800)
Controls.SetSize(ts8,45,25)
ts9 = Controls.AddTextBox(835,800)
Controls.SetSize(ts9,45,25)
ts10 = Controls.AddTextBox(1037,800)
Controls.SetSize(ts10,45,25)
ts12 = Controls.AddTextBox(1255,765)
Controls.SetSize(ts12,45,25)
ts11 = Controls.AddTextBox(1235,800)
Controls.SetSize(ts11,45,25)
GraphicsWindow.FontSize = 12
b1a = Controls.AddButton("Help",30 ,765)
Controls.SetSize(b1a,80,25)
b2 = Controls.AddButton("Flickr",112 ,765)
Controls.SetSize(b2,80,25)
b3 = Controls.AddButton("Clear ",194 ,765)
Controls.SetSize(b3,80,25)
b4 = Controls.AddButton("GradientFm",276 ,765)
Controls.SetSize(b4,80,25)
LDDialogs.ToolTip(b4,"in t1 - H or V or DD or DU")
b5 = Controls.AddButton("Grid",357,765)
Controls.SetSize(b5,80,25)
b7 = Controls.AddButton("Animate",30 ,738)
Controls.SetSize(b7,80,25)
b8 = Controls.AddButton("Rotate",112 ,738)
Controls.SetSize(b8,80,25)
b9 = Controls.AddButton("Opacity",194 ,738)
Controls.SetSize(b9,80,25)
b10 = Controls.AddButton("Zoom",276 ,738)
Controls.SetSize(b10,80,25)
b11 = Controls.AddButton("TurtleUp",358 ,738)
Controls.SetSize(b11 ,80,25)
b12 = Controls.AddButton("TurtleDown",440 ,738)
Controls.SetSize(b12 ,80,25)
b13 = Controls.AddButton("TurtleAngle    ",522 ,738)
Controls.SetSize(b13 ,80,25)
b14 = Controls.AddButton("API-LitDev ",440 ,765)
Controls.SetSize(b14 ,80,25)
b15 = Controls.AddButton("Remote",522 ,765)
Controls.SetSize(b15 ,80,25)
b6 = Controls.AddButton("ClearCode?",1186,2)
Controls.SetSize(b6,80,25)
LDDialogs.ToolTip(b6,"Очистить?!")
GraphicsWindow.FontSize = 14
sl2 = LDControls.AddSlider(150, 35, "H")
LDControls.SliderValue(sl2, 0)
Shapes.Move(sl2, 700, 765)
sl3 = LDControls.AddSlider(150, 35, "H")
Shapes.Move(sl3, 900, 765)
LDControls.SliderValue(sl3, 0)
sl4 = LDControls.AddSlider(150, 35, "H")
Shapes.Move(sl4, 1100, 765)
LDControls.SliderValue(sl4, 1)
sl5 = LDControls.AddSlider(150, 35, "H")
Shapes.Move(sl5, 76, 800)
LDControls.SliderValue(sl5, 0)
sl6 = LDControls.AddSlider(150, 35, "H")
Shapes.Move(sl6, 280, 800)
LDControls.SliderValue(sl6, 0)
sl7 = LDControls.AddSlider(150, 35, "H")
Shapes.Move(sl7, 481, 800)
LDControls.SliderValue(sl7, 0)
sl8 = LDControls.AddSlider(150, 35, "H")
Shapes.Move(sl8, 679, 800)
LDControls.SliderValue(sl8, 0)
sl9 = LDControls.AddSlider(150, 35, "H")
Shapes.Move(sl9, 880, 800)
LDControls.SliderValue(sl9, 0)
sl10 = LDControls.AddSlider(150, 35, "H")
Shapes.Move(sl10, 1082, 800)
LDControls.SliderValue(sl10, 0)
sl11 = LDControls.AddSlider(150, 35, "H")
Shapes.Move(sl11, 1280, 800)
LDControls.SliderValue(sl11, 0)
sl12 = LDControls.AddSlider(150, 35, "H")
Shapes.Move(sl12, 1300, 765)
LDControls.SliderValue(sl12, 0)

GraphicsWindow.BrushColor = "Black"
GraphicsWindow.FontSize = 13
cb[1] = "GraphicsWindow()"
cb[2] = "Controls.AddButton "
cb[3] = "Shapes.AddImage "
cb[4] = "Controls.AddTextBox"
cb[5] = "Controls.AddMultiLineTextBox"
cb[6] = "LDControls.AddRadioButton"
cb[7] = "LDControls.AddCheckBox"
cb[8] = "LDControls.AddSlider"
cb[9] = "LDControls.AddBrowser"
cb[10] = "Grid()"
cb[11] = "LDControls.AddListBox"
cb[12] = "LDControls.AddProgressBar"
cb[13] = "Shapes.AddText"
cb[14] = "Flickr.GetRandomPicture()"
cb[15] = "Turtle.Show()"
cb[16] = "Turtle.Up()"
cb[17] = "Turtle.Down()"
cb[18] = "Turtle.Angle() "
cb[19] = "Shapes.remove"
cb[20] = "Turtle.Hide()"
cb[21] = "Sub Click()"
cb[22] = "Sub Gradient Forms()"
cb[23] = "For/EndFor"
cb[24] = "While/EndWhile"
cb[25] = "Controls.GetTextBoxText()"
cb[26] = "Controls.SetTextBoxText( , )"
cb[27] = "OnSlider()"
cb[28] = "OnMouseMove()"
cb[29] = "OnMouseDown()"
cb[30] = "ArrayButtons()"
cb[31] = "ArrayAddTextBox()"
cb[32] = "ColorAndPen()"
cb[33] = "OnListBox()"
cb[34] = "GraphicsWindow.ShowMessage"
cb[35] = "GraphicsWindow.DrawResizedImage"
cb[36] = "Shapes.Animate"
cb[37] = "Shapes.Zoom"
cb[38] = "Shapes.Rotate"
cb[39] = "Shapes.Opacity"
cb[40] = "LDControls.Star"
cb[41] = "Shapes.AddEllipse"
cb[42] = "Shapes.AddRectangle"
cb[43] = "LDShapes.AddPolygon"
cb[44] = "LDShapes.AddRegularPolygon"
cb[45] = "Shapes.AddLine"
cb[46] = "Sub Down()"
cb[47] = "Sub OnMouseMove()"
cb[48] = "GraphicsWindow.DrawRectangle"
cb[49] = "GraphicsWindow.Ellipse"
cb[50] = "LDControls.AddComboBox"  
cb[51] = "OnComboBox"
cb[52] = "LDControls.AddPasswordBox"
cb[53] = "LDControls.AddMenu"
cb[54] = "GraphicsWindow.DrawLine"
CobB = LDSort.ByValue(cb)
ComboBox = LDControls.AddComboBox(CobB,310,700)
Shapes.Move(ComboBox,680,2)
LDDialogs.ToolTip(ComboBox,"Instruments,Turtle")
OnComboBox()


Controls.ButtonClicked = Click
Sub Click
  
  If (Controls.LastClickedButton = b1a) Then           'Help
    GraphicsWindow.BrushColor = "White"
    GraphicsWindow.FontSize = 13
    tt[1] = "The sequence of execution of the program:(Последовательность выполнении программы:)"    
    tt[2] = "1)<t5>;<t2>;<Width=>;<Height=>;<Left=>;<Top=>;<Colour(RGB)>;<<GraphicsWindow()>>"
    tt[3] = "2)<MouseDowm(x/y)>;<t5>;<Width=>;<Height=>;<PenWidth=>;<<Controls.AddButton>>"
    tt[4] = "3)<MouseDowm(x/y)>;<t5= 'D:/izo3/s110.gif'>;<t1= Gif>;<<Shapes.AddImage>>"
    tt[5] = "4)<MouseDowm(x/y)>;<Width=>;<Height=>;<Colour(RGB)>;<PenWidth=>;<<Controls.AddTextBox>>"
    tt[6] = "5)<MouseDowm(x/y)>;<Width=>;<Height=>;<Colour(RGB)>;<PenWidth=>;<<Controls.AddMultiLineTextBox>>"
    tt[7] = "6)<MouseDowm(x/y)>;<Colour(RGB)>;<PenWidth=>;<t1>;<t2>;<t3>;<<LDControls.AddRadioButton>>"
    tt[8] = "7)<MouseDowm(x/y)>;<t1>;<Colour(RGB)>;<PenWidth=>;<<LDControls.AddCheckBox>>
    tt[9] = "8)<MouseDowm(x/y)>;<t1>;<t2>;<Width=>;<lf>;<<LDControls.AddSlider>>"
    tt[10] = "9)<MouseDowm(x/y)>;<t5>;<Width=>;<Height=>;<<LDControls.AddBrowser>>"
    tt[11] = "10)<gr= 2>;<<Grid>>;<gr= 16>;<<Grid>>"
    tt[12] = "11)<MouseDowm(x/y)>;<Width=>;<Height=>;<Colour(RGB)>;<PenWidth=>;<<LDControls.AddListBox>>"
    tt[13] = "12)<MouseDowm(x/y)>;<Width=>;<lf=>;<Colour(RGB)>;<t1>;<t2>;<<LDControls.AddProgressBar>>"
    tt[14] = "13)<MouseDowm(x/y)>;<Colour(RGB)>;<PenWidth=>;<t5>;<<Shapes.AddText>>"
    tt[15] = "14)<MouseDowm(x/y)>;<t5>;<Width=>;<Height=>;<<Flickr>>"
    tt[16] = "15)<MouseDowm(x/y)>;<<TurtleUp>>"
    tt[17] = "16)<MouseDowm(x/y)>;<Colour(RGB)>;<PenWidth=>;<<TurtleDown>>"
    tt[18] = "17)<MouseDowm(x/y)>;<Colour(RGB)>;<PenWidth=>;<t1(angle)>;<t2(distance)>;<<TurtleAngle>>"
    tt[19] = "18)<Clear>;<<Shapes.Remove>>'(Last set object)"
    tt[20] = "19)<MouseDowm(x/y)>;<t1>;<t2>;<t3>;<Colour(RGB)>;<PenWidth=>;<Width=>;<Height=>;<<ArrayButtons()>>"
    tt[21] = "20)<MouseDowm(x/y)>;<Colour(RGB)>;<PenWidth=>;<Width=>;<Height=>;<<ArrayAddTextBox()>>"
    tt[22] = "21)<t5>;<t1>;<<GraphicsWindow.ShowMessage>>"
    tt[23] = "22)<MouseDowm(x/y)>;<Width=>;<Height=>;<t1'(Gif or..)>,<<.DrawResisedImage>>
    tt[24] = "23)<MouseDowm(x/y)>;<t2'(mSec)>;<<Animate>>" 
    tt[25] = "24)<t2(Widhtd(0.5-20))>;<t3(Height(0.5-20))>;<<Zoom>>"
    tt[26] = "25)<t2(angle(10-360))>;<<Rotate>>"
    tt[27] = "26)<t2(0-100))>;<<Opacity>>"
    tt[28] = "27)<MouseDowm(x/y)>;<Width=>;<Height>;<t1='H or V>;<t2='6>;<<LDControls.Star>>,<Colour>"
    tt[29] = "28)<MouseDowm(x/y)>;<Width=>;<t1= H>;<<Shapes.AddEllipse>>;<Colour>"
    tt[30] = "29)<MouseDowm(x/y)>;<Width=>;<t1= H>;<<Shapes.AddRectangle>>;<Colour>"
    tt[31] = "30)<MouseDowm(x/y-array=5)>;<t1= H>;<<LDShapes.AddPolygon>>;<Colour>"
    tt[32] = "31)<MouseDowm(x/y)>;<Width=>;<t2= '6>;<<LDShapes.AddRegularPolygon>>;<Colour>"
    tt[33] = "32)<MouseDowm(x/y)>;<PenWidth=>;<Colour(RGB)>;<<Shapes.AddLine>>"
    tt[34] = "33)<MouseDowm(x/y)>;<PenWidth=>;<Colour(RGB)>;<<GraphicsWindow.DrawRectangle>>"
    tt[35] = "34)<MouseDowm(x/y)>;<PenWidth=>;<Colour(RGB)>;<<GraphicsWindow.DrawEllipse>>"
    tt[36] = "35)<MouseDowm(x/y)>;<Width=>;<Height=>;<t1>;<<LDControls.AddPasswordBox>>"
    tt[37] = "36)<MouseDowm(x/y)2>;<PenWidth=>;<Colour(RGB)>;<<GraphicsWindow.DrawLine>>"
    tt[38] = "      "
    tt[39] = "Good luck and prosperity(Удачи Вам и благополучие)  Akiva   7/15/2016"
    For i = 1 To Array.GetItemCount(tt)
      GraphicsWindow.DrawBoundText(10,15*i,980,tt[i])
    EndFor
  ElseIf (Controls.LastClickedButton = b2) Then                                          'Flickr
    pic = Flickr.GetRandomPicture(Controls.GetTextBoxText(t5))
    GraphicsWindow.DrawResizedImage(pic,X1,Y1,w,h)
    rm = pic
    aa = 0
  ElseIf (Controls.LastClickedButton = b3) Then                                          'Reset  
    GraphicsWindow.BrushColor = GraphicsWindow.GetColorFromRGB(0,155,255)
    GraphicsWindow.FillRectangle(0,0,995,725)
    Controls.SetTextBoxText(t1," ")
    Controls.SetTextBoxText(t2," ")
    Controls.SetTextBoxText(t3," ")
    Controls.SetTextBoxText(t4," ")
    Controls.SetTextBoxText(t5," ")
    Controls.SetTextBoxText(t6," ")
    Controls.SetTextBoxText(t7," ")
    Controls.SetTextBoxText(t11," ")
    Controls.SetTextBoxText(t12," ")
    GraphicsWindow.PenWidth = 0
  ElseIf (Controls.LastClickedButton = b4) Then
    gr11[1] = GraphicsWindow.GetRandomColor()                                                                                                                                                 
    gr11[2] = GraphicsWindow.GetRandomColor()                    ' для формы                                                                           
    gr11[3] = GraphicsWindow.GetRandomColor()                                                                                                                                      
    For i = 1 To 3 
      g = Controls.GetTextBoxText(t1)      
      brush = LDShapes.BrushGradient(gr11,g)
      LDShapes.BrushGradientBackground(Brush)  
    EndFor 
  ElseIf (Controls.LastClickedButton = b5) Then                         'Grid
    Grid()
  ElseIf (Controls.LastClickedButton = b6) Then                         'Clear info
    LDControls.RichTextBoxClear(t17)
  ElseIf (Controls.LastClickedButton = b7) Then                         'Animate
    Shapes.Animate(anm,x1,y1,Controls.GetTextBoxText(t2))
    aa = 0
  ElseIf (Controls.LastClickedButton = b8) Then                         'Rotate
    Shapes.Rotate(ang,Controls.GetTextBoxText(t2))
  ElseIf (Controls.LastClickedButton = b9) Then                         'Opacity
    Shapes.SetOpacity(opc,Controls.GetTextBoxText(t2))
  ElseIf (Controls.LastClickedButton = b10) Then                         'Zoom 
    Shapes.Zoom(zm,Controls.GetTextBoxText(t2),Controls.GetTextBoxText(t3))
  ElseIf (Controls.LastClickedButton = b11) Then                         'Turtle.Up
    Turtle.Speed = 9
    Turtle.PenUp()
    Turtle.MoveTo(X1,Y1)
    aa = 0
  ElseIf (Controls.LastClickedButton = b12) Then                         'Turtle.Down
    Turtle.Speed = 9
    ColorAndPen() 
    Turtle.PenDown()
    Turtle.MoveTo(X1,Y1)
    aa = 0
  ElseIf (Controls.LastClickedButton = b13) Then                         'Turtle.Angle
    ColorAndPen()
    Turtle.Speed = 9
    Turtle.X = 500
    Turtle.Y = 360    
    Turtle.PenDown()
    ang = Controls.GetTextBoxText(t1) 
    Turtle.Angle = ang
    mt = Controls.GetTextBoxText(t2)    
    Turtle.Move(mt)
    aa = 0
  ElseIf (Controls.LastClickedButton = b14) Then                         'API  LitDev
    bw1 = LDControls.AddBrowser(975,700,"http://smallbasic.com/")    'LitDev_LDMath.html")
    Shapes.Move(bw1, 10, 25)
    rm = bw1
  ElseIf (Controls.LastClickedButton = b15) Then                          'Remote
    Shapes.Remove(rm) 
  EndIf
  
  GraphicsWindow.PenWidth = 0
EndSub

GraphicsWindow.MouseMove = OnMouseMove
Sub OnMouseMove
  Controls.SetTextBoxText(t11, "X=" + Math.Ceiling(GraphicsWindow.MouseX))
  Controls.SetTextBoxText(t12, "Y=" + Math.Ceiling(GraphicsWindow.Mousey))
EndSub 
GraphicsWindow.MouseDown =  OnDown1 
Sub OnDown1
  x = GraphicsWindow.MouseX
  y  = Graphicswindow.MouseY
  aa = aa + 1 
  GraphicsWindow.FillRectangle(x, y, 2, 2)
  If aa = 1 Then
    xa = GraphicsWindow.MouseX
    X1 = Math.Ceiling(xa)
    Controls.SetTextBoxText(t14,"X1= "+ X1)
    ya = Graphicswindow.MouseY
    Y1 = Math.Ceiling(ya)
    Controls.SetTextBoxText(t15,"Y1= "+ Y1)
    aa = 0
  EndIf
  Controls.SetTextBoxText(p,"")
EndSub
LDControls.SliderChanged = OnSlider
Sub OnSlider
  sv2 = LDControls.SliderGetValue(sl2) 
  R = Math.Ceiling(sv2 * 2.55)
  GraphicsWindow.BrushColor = GraphicsWindow.GetColorFromRGB(R,G,B)
  GraphicsWindow.FillEllipse(637,730,80,30)
  LDDialogs.ToolTip(ts2,"Red color")
  Controls.SetTextBoxText(ts2, R)   
  sv3 = LDControls.SliderGetValue(sl3)
  G = Math.Ceiling(sv3 * 2.55) 
  Controls.SetTextBoxText(ts3, G)
  LDDialogs.ToolTip(ts3,"Green color")
  sv4 = LDControls.SliderGetValue(sl4)
  B = Math.Ceiling(sv4 * 2.55)
  LDDialogs.ToolTip(ts4,"Blue color")
  Controls.SetTextBoxText(ts4, B)
  sv5 = LDControls.SliderGetValue(sl5)
  w = Math.Ceiling(sv5 * 10)
  LDDialogs.ToolTip(ts5,"Width")  
  Controls.SetTextBoxText(ts5, w)
  sv6 = LDControls.SliderGetValue(sl6)
  h = Math.Ceiling(sv6 * 10)
  LDDialogs.ToolTip(ts6,"Height")  
  Controls.SetTextBoxText(ts6, h)
  sv7 = LDControls.SliderGetValue(sl7)
  lf = Math.Ceiling(sv7 * 5.5)
  LDDialogs.ToolTip(ts7,"lf (Left)")  
  Controls.SetTextBoxText(ts7, lf)
  sv8 = LDControls.SliderGetValue(sl8)
  tp = Math.Ceiling(sv8 * 5.5)
  LDDialogs.ToolTip(ts8,"tp(Top)")  
  Controls.SetTextBoxText(ts8, tp)
  sv9 = LDControls.SliderGetValue(sl9)
  n = Math.Ceiling(sv9 * 3.6)
  LDDialogs.ToolTip(ts9, " ")  
  Controls.SetTextBoxText(ts9, n)
  sv10 = LDControls.SliderGetValue(sl10)
  mm = Math.Ceiling(sv10 * 3.6)
  LDDialogs.ToolTip(ts10," ")  
  Controls.SetTextBoxText(ts10, mm)
  sv11 = LDControls.SliderGetValue(sl11)
  ng = Math.Ceiling(sv11 * 0.5)
  LDDialogs.ToolTip(ts11,"(gr)Grid")  
  Controls.SetTextBoxText(ts11, ng ) 
  sv12 = LDControls.SliderGetValue(sl12)
  p = Math.Ceiling(sv12 * 1)
  LDDialogs.ToolTip(ts12,"PenWidth")  
  Controls.SetTextBoxText(ts12, p ) 
EndSub

GraphicsWindow.CanResize = 12
GraphicsWindow.BrushColor = "Blue"
LDControls.ComboBoxItemChanged = OnComboBox
Sub OnComboBox  
  
  If CobB[LDControls.LastComboBoxIndex] = cb[1] Then     'GraphicsWindow 
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.Title = "+Controls.GetTextBoxText(t5)+"","true")   
    LDControls.RichTextBoxSetText(t17,"cw = GraphicsWindow.GetColorFromRGB("+R+","+G+","+B+")","true")   
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.BackgroundColor = cw","true")
    LDControls.RichTextBoxSetText(t17,"GW = "+w+"","True")
    LDControls.RichTextBoxSetText(t17,"GH = "+h+"","True")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.Width = GW","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.Height = GH","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.Top = "+(tp)+"","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.Left = "+(lf)+"","true")
    LDControls.RichTextBoxSetText(t17,"LDScrollBars.Add(gw+0, gh+0)","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.CanResize = "+Controls.GetTextBoxText(t2)+"","true")  
    ColorAndPen()
    GraphicsWindow.DrawRectangle(0,0,w,h)
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[2] Then                       'Button
    ColorAndPen()
    c = Controls.GetTextBoxText(t5)
    b1 = Controls.AddButton(c,x1,y1)
    Controls.SetSize(b1,w,h)
    LDControls.RichTextBoxSetText(t17,"b1 = Controls.AddButton("+c+","+X1+","+Y1+")","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetSize(b1,"+w+","+h+")","true")
    aa = 0
    rm = b1
    anm = b1
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[3] Then                      'Image
    imm = Controls.GetTextBoxText(t1)
    a = LDDialogs.OpenFile(imm,Controls.GetTextBoxText(t5))
    im = Shapes.AddImage(a)
    Shapes.Move(im, X1,Y1)
    aa = 0
    LDControls.RichTextBoxSetText(t17,"a = LDDialogs.OpenFile("+imm+","+Controls.GetTextBoxText(t5)+")","true")
    LDControls.RichTextBoxSetText(t17,"im = Shapes.AddImage(a))","true")
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(im,"+X1+","+Y1+")","true") 
    rm = im
    ang = im
    anm = im
    zm = im
    opc = im
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[4] Then                     '.AddTextBox
    ColorAndPen()  
    t1 = Controls.AddTextBox(X1,Y1)
    Controls.SetSize(t1,w,h)
    aa = 0
    LDControls.RichTextBoxSetText(t17," t1 = Controls.AddTextBox("+X1+","+Y1+")","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetSize(t1,"+w+","+h+")","true")
    rm = t1
    anm = t1
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[5] Then                     '.AddMultiLineTextBox
    ColorAndPen()  
    t2 = Controls.AddMultiLineTextBox(X1,Y1)
    Controls.SetSize(t2,w,h)
       aa = 0
    LDControls.RichTextBoxSetText(t17,"ColorAndPen()","true") 
    LDControls.RichTextBoxSetText(t17," t2 = Controls.AddMultilineTextBox("+X1+","+Y1+")","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetSize(t2,"+w+","+h+")","true")
    rm = t2
    anm = t2
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[6] Then                      '.AddRadioButton
    lrb = LDControls.LastRadioButton  
    ColorAndPen() 
    cr6[1] = LDControls.AddRadioButton(Controls.GetTextBoxText(t1),"c6")
    cr6[2] = LDControls.AddRadioButton(Controls.GetTextBoxText(t2),"c6")
    cr6[3] = LDControls.AddRadioButton(Controls.GetTextBoxText(t3),"c6")
    For i = 1 To 3
      Shapes.Move(cr6[i],X1,Y1 + (21 * (i)))
    EndFor
    LDControls.RadioButtonSet(cr6[3])
    aa = 0
    anm = cr6
    LDControls.RichTextBoxSetText(t17,"ColorAndPen()","true") 
    LDControls.RichTextBoxSetText(t17,"lrb = LDControls.LastRadioButton ","true")
    LDControls.RichTextBoxSetText(t17,"cr6[1] = LDControls.AddRadioButton(Controls.GetTextBoxText(t1),'c6')","true")
    LDControls.RichTextBoxSetText(t17,"cr6[2] = LDControls.AddRadioButton(Controls.GetTextBoxText(t2),'c6')","true")
    LDControls.RichTextBoxSetText(t17,"cr6[3] = LDControls.AddRadioButton(Controls.GetTextBoxText(t3),'c6')","true")
    LDControls.RichTextBoxSetText(t17,"   For i = 1 To 3","true")
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(cr6[i],"+X1+","+Y1+" + (21 * (i)))","true")
    LDControls.RichTextBoxSetText(t17,"   EndFor","true")
    LDControls.RichTextBoxSetText(t17,"LDControls.RadioButtonSet(cr6[3])","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[7] Then                   'LDControls.AddCheckBox
    ColorAndPen()
    ch = LDControls.AddCheckBox(Controls.GetTextBoxText(t5))
    Controls.Move(ch,X1,Y1)
    aa = 0
    LDControls.RichTextBoxSetText(t17,"ch = LDControls.AddCheckBox("+Controls.GetTextBoxText(t5)+")","true")
    LDControls.RichTextBoxSetText(t17,"Controls.Move(ch,"+X1+","+Y1+")","true")
    rm = ch
    anm = ch
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[8] Then                      '.AddSlider
    a = Controls.GetTextBoxText(t1)
    b = Controls.GetTextBoxText(t2)
    sl1a = LDControls.AddSlider(w,lf,a)                  
    Shapes.Move(sl1a,X1,Y1)
    LDControls.SliderValue(sl1a,b)
    OnSlider()
    aa = 0
    LDControls.RichTextBoxSetText(t17,"a = Controls.GetTextBoxText(t1)","true")
    LDControls.RichTextBoxSetText(t17,"b = Controls.GetTextBoxText(t2)","true")
    LDControls.RichTextBoxSetText(t17,"LDControls.SliderValue(sl1a,"+b+")","true") 
    LDControls.RichTextBoxSetText(t17,"sl1a = LDControls.AddSlider("+w+","+lf+","+a+")","true")
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(sl1a,"+X1+","+Y1+")","true")
    LDControls.RichTextBoxSetText(t17,"OnSlider()","true")
    rm = sl1a   
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[9] Then                      '.LDControls.AddBrowser 
    bw = LDControls.AddBrowser(w,h,Controls.GetTextBoxText(t5))
    Shapes.Move(bw, x1, y1)
    aa = 0
    LDControls.RichTextBoxSetText(t17,"bw = LDControls.AddBrowser("+w+","+h+","+Controls.GetTextBoxText(t5)+")","true")
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(bw,"+X1+","+Y1+")","true")
    rm = bw
    anm = bw
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[10] Then                     'Grid(Сетка)
    LDControls.RichTextBoxSetText(t17,"Sub Grid","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.PenWidth = 0.1","true")                                                                        
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.PenColor = 'White' ","true")
    LDControls.RichTextBoxSetText(t17,"For gg = 1 To 245 Step ng","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.DrawLine(4 * gg,4,4 * gg,725)","true")                 
    LDControls.RichTextBoxSetText(t17,"EndFor","true")
    LDControls.RichTextBoxSetText(t17,"For vv = 1 To 180 Step ng","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.DrawLine(4,4 * vv,960,4 * vv)","true")                   
    LDControls.RichTextBoxSetText(t17,"EndFor","true")  
    LDControls.RichTextBoxSetText(t17,"EndSub","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[11] Then                     ' LDControls.AddListBox
    ColorAndPen()
    ls[1] = "H"
    ls[2] = "V"
    ls[3] = "DD"
    list = LDSort.ByValue(ls)
    listBox = LDControls.AddListBox(list,w,h)
    Shapes.Move(listBox,X1,Y1)
    OnListBox()
    aa = 0
    rm = listBox
    anm = listBox
    LDControls.RichTextBoxSetText(t17,"ColorAndPen()","True")
    LDControls.RichTextBoxSetText(t17,"ls[1] = 'H'","True")
    LDControls.RichTextBoxSetText(t17,"ls[2] = 'V'","True")
    LDControls.RichTextBoxSetText(t17,"ls[3] = 'DD' ","True")
    LDControls.RichTextBoxSetText(t17,"list = LDSort.ByValue(ls1)","True")
    LDControls.RichTextBoxSetText(t17,"listBox = LDControls.AddListBox(list,"+w+","+lf+")","True")
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(listBox,"+x1+","+y1+")","True")
    LDControls.RichTextBoxSetText(t17,"OnListBox()","True")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[12] Then                 'LDControls.AddProgressBar 
    ColorAndPen()
    pgb = LDControls.AddProgressBar(w, lf, Controls.GetTextBoxText(t1) )
    LDControls.ProgressBarValue(pgb,Controls.GetTextBoxText(t2))
    Shapes.Move(pgb,X1,Y1)
    aa = 0
    LDControls.RichTextBoxSetText(t17,"pgb = LDControls.AddProgressBar("+w+","+lf+","+Controls.GetTextBoxText(t1)+")","true")
    LDControls.RichTextBoxSetText(t17,"LDControls.ProgressBarValue(pgb,"+Controls.GetTextBoxText(t2)+")","true")
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(pgb,"+X1+","+Y1+")","true")
    rm = pgb
    anm = pgb
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[13] Then                     'Shapes.AddText
    ColorAndPen()
    l1 = Shapes.AddText(Controls.GetTextBoxText(t5))
    Shapes.Move(l1,X1,Y1)
    rm = l1
    anm = l1
    ang = l1
    opc = l1
    zm = l1
    aa = 0
    LDControls.RichTextBoxSetText(t17,"l1 = Shapes.AddText("+Controls.GetTextBoxText(t5)+")","true")
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(l1,"+X1+","+Y1+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[14] Then                     'Flickr.GetRandomPicture 
    pic = Flickr.GetRandomPicture(Controls.GetTextBoxText(t5))
    GraphicsWindow.DrawResizedImage(pic,X1,Y1,w,h)
    rm = pic
    anm = pic
    opc = pic
    zm = pic
    aa = 0
    LDControls.RichTextBoxSetText(t17,"pic = Flickr.GetRandomPicture("+Controls.GetTextBoxText(t5)+")","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.DrawResizedImage(pic,"+X1+","+Y1+","+w+","+h+")","true") 
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[15] Then                         'Turtle.Show
    Turtle.X = x1
    Turtle.Y = y1
    Turtle.Show()
    LDControls.RichTextBoxSetText(t17,"Turtle.X = x1","true")
    LDControls.RichTextBoxSetText(t17,"Turtle.Y = y1","true")
    LDControls.RichTextBoxSetText(t17,"Turtle.Show() ","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[16] Then                          'Turtle.Up
    LDControls.RichTextBoxSetText(t17,"Turtle.Speed = 9","true")
    LDControls.RichTextBoxSetText(t17,"Turtle.PenUp()","true")
    LDControls.RichTextBoxSetText(t17,"Turtle.MoveTo("+X1+","+Y1+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[17] Then                           'Turtle.Down
    LDControls.RichTextBoxSetText(t17,"Turtle.Speed = 9","true")
    LDControls.RichTextBoxSetText(t17,"ColorAndPen()","true")
    LDControls.RichTextBoxSetText(t17,"Turtle.PenDown()","true")
    LDControls.RichTextBoxSetText(t17,"Turtle.MoveTo("+X1+","+y1+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[18] Then                            'Turtle.Angle  
    LDControls.RichTextBoxSetText(t17,"ColorAndPen()","true")
    LDControls.RichTextBoxSetText(t17,"Turtle.X = x1","true")
    LDControls.RichTextBoxSetText(t17,"Turtle.Y = y1 ","true")   
    LDControls.RichTextBoxSetText(t17,"Turtle.Speed = ","true")
    LDControls.RichTextBoxSetText(t17,"Turtle.PenDown("+P+")","true")
    LDControls.RichTextBoxSetText(t17,"ang = Controls.GetTextBoxText(t1)","true")
    LDControls.RichTextBoxSetText(t17,"Turtle.Angle = "+ang+"","true")
    LDControls.RichTextBoxSetText(t17,"mt = Controls.GetTextBoxText(t2)","true")
    LDControls.RichTextBoxSetText(t17,"Turtle.Move("+mt+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[19] Then                            'Shapes.Remove
    Shapes.Remove(rm)
    LDControls.RichTextBoxSetText(t17,"Shapes.Remove(rm)","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[20] Then                           'Turtle.Hide()
    Turtle.Hide()
    LDControls.RichTextBoxSetText(t17,"Turtle.Hide()","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[21] Then                            'Sub Click()
    LDControls.RichTextBoxSetText(t17,"Controls.ButtonClicked = Click","true")
    LDControls.RichTextBoxSetText(t17,"Sub Click","true")
    LDControls.RichTextBoxSetText(t17,"If (Controls.LastClickedButton = b1) Then","true")
    LDControls.RichTextBoxSetText(t17,"'If (Controls.LastClickedButton = b[1]) Then","true")
    LDControls.RichTextBoxSetText(t17,"ElseIf (Controls.LastClickedButton = b2) Then","true")
    LDControls.RichTextBoxSetText(t17,"Else","true")
    LDControls.RichTextBoxSetText(t17,"EndIf","true")
    LDControls.RichTextBoxSetText(t17,"EndSub","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[22] Then                        'Gradient Forms
    LDControls.RichTextBoxSetText(t17,"Sub GradientForms","true")
    LDControls.RichTextBoxSetText(t17,"gr1[1] = LDDialogs.Colour()","true")                                                                                                                                                    
    LDControls.RichTextBoxSetText(t17,"gr1[2] = LDDialogs.Colour()","true")                                                                                            
    LDControls.RichTextBoxSetText(t17,"gr1[3] = LDDialogs.Colour()","true")                                                                                                                                    
    LDControls.RichTextBoxSetText(t17,"For i = 1 To 3","true")        
    LDControls.RichTextBoxSetText(t17,"brush = LDShapes.BrushGradient(gr1,Controls.GetTextBoxText(t1))","true")
    LDControls.RichTextBoxSetText(t17,"LDShapes.BrushGradientBackground(brush)","true")
    LDControls.RichTextBoxSetText(t17,"EndFor","true")  
    LDControls.RichTextBoxSetText(t17,"EndIf","true")
    LDControls.RichTextBoxSetText(t17,"EndSub","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[23] Then                          ' For/EndFor
    LDControls.RichTextBoxSetText(t17,"For i =    To    Step","true")
    LDControls.RichTextBoxSetText(t17,"EndFor","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[24] Then                            'While/EndWhile
    LDControls.RichTextBoxSetText(t17,"While '(X <= X2)","true")
    LDControls.RichTextBoxSetText(t17,"EndWhile","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[25] Then
    LDControls.RichTextBoxSetText(t17," = Controls.GetTextBoxText()","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[26] Then 
    LDControls.RichTextBoxSetText(t17,"Controls.SetTextBoxText( , )","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[27] Then                             'OnSlider()
    LDControls.RichTextBoxSetText(t17,"LDControls.SliderChanged = OnSlider","true")
    LDControls.RichTextBoxSetText(t17,"Sub OnSlider","true")
    LDControls.RichTextBoxSetText(t17,"sv1 = LDControls.SliderGetValue(sl1)","true")
    LDControls.RichTextBoxSetText(t17,"Rr = Math.Ceiling(sv1 * 2.55)","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetTextBoxText(t1,Rr)","true")
    LDControls.RichTextBoxSetText(t17,"EndSub","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[28] Then                          'OnMouseMove()
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.MouseMove = OnMouseMove","true")
    LDControls.RichTextBoxSetText(t17,"Sub OnMouseMove","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetTextBoxText(t11, X= + Math.Ceiling(GraphicsWindow.MouseX))","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetTextBoxText(t12, Y= + Math.Ceiling(GraphicsWindow.Mousey))","true")
    LDControls.RichTextBoxSetText(t17,"EndSub","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[29] Then                            'OnDown()
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.MouseDown =  OnDown","true") 
    LDControls.RichTextBoxSetText(t17,"Sub OnDown","true")                                                                         
    LDControls.RichTextBoxSetText(t17,"x = GraphicsWindow.MouseX","true")
    LDControls.RichTextBoxSetText(t17,"y  = Graphicswindow.MouseY","true")
    LDControls.RichTextBoxSetText(t17,"aa = aa + 1","true") 
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.FillRectangle(x, y, 3, 3)","true")
    LDControls.RichTextBoxSetText(t17,"If aa = 1 Then","true")
    LDControls.RichTextBoxSetText(t17," xa = GraphicsWindow.MouseX","true")
    LDControls.RichTextBoxSetText(t17," X1 = Math.Ceiling(xa)","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetTextBoxText(t14,'X1= '+ X1)","true")
    LDControls.RichTextBoxSetText(t17,"ya = Graphicswindow.MouseY","true")
    LDControls.RichTextBoxSetText(t17,"Y1 = Math.Ceiling(ya)","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetTextBoxText(t15,'Y1= '+ Y1)","true")
    LDControls.RichTextBoxSetText(t17,"aa = 0","true")
    LDControls.RichTextBoxSetText(t17,"EndIf","true")
    LDControls.RichTextBoxSetText(t17,"EndSub","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[30] Then                            'ArrayButtons()
    ColorAndPen()
    b[1] = Controls.GetTextBoxText(t1)
    b[2] = Controls.GetTextBoxText(t2)
    b[3] = Controls.GetTextBoxText(t3)
    nButton = Array.GetItemCount(b)
    For i = 1 To nButton
      b1[i] = Controls.AddButton(b[i],x1,((h+2)*(i))-(h+2)+y1)
      Controls.SetSize(b1[i],w,h)
    EndFor
    rm = nButton 
    anm = nButton
    aa = 0
    LDControls.RichTextBoxSetText(t17,"ColorAndPen()","true")
    LDControls.RichTextBoxSetText(t17,"b[1] = "+Controls.GetTextBoxText(t1)+"","true")
    LDControls.RichTextBoxSetText(t17,"b[2] = "+Controls.GetTextBoxText(t2)+"","true")
    LDControls.RichTextBoxSetText(t17,"b[3] = "+Controls.GetTextBoxText(t3)+"","true")
    LDControls.RichTextBoxSetText(t17,"nButton = Array.GetItemCount(b)","true")
    LDControls.RichTextBoxSetText(t17,"For i = 1 To nButton","true")
    LDControls.RichTextBoxSetText(t17,"b1[i] = Controls.AddButton(b[i],"+x1+",(("+(h+1)+")*(i))-"+h+"+"+y1+")","True")
    LDControls.RichTextBoxSetText(t17,"Controls.SetSize(b1[i],"+w+","+h+")","true")
    LDControls.RichTextBoxSetText(t17,"EndFor","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[31] Then                            'ArrayAddTextBox() 
    ColorAndPen()
    tx = Controls.GetTextBoxText(t1)
    For i = 1 To tx
      t1[i] = Controls.AddTextBox(x1,(h+2)*(i)+y1-(h+2))
      Controls.SetSize(t1[i],w,h)
      rm = t1[i]
    EndFor
    aa = 0  
    LDControls.RichTextBoxSetText(t17,"ColorAndPen()","true")
    LDControls.RichTextBoxSetText(t17,"tx = Controls.GetTextBoxText(t1)","true")
    LDControls.RichTextBoxSetText(t17,"For i = 1 To "+ tx+" ","true")    
    LDControls.RichTextBoxSetText(t17,"t1[i] = Controls.AddTextBox("+X1+","+"("+(h+2)+"*(i)+"+Y1+"-"+(h+2)+"))","true")     
    LDControls.RichTextBoxSetText(t17,"Controls.SetSize(t1[i],"+w+","+h+")","true") 
    LDControls.RichTextBoxSetText(t17,"EndFor","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[32] Then                                'ColorAndPen
    LDControls.RichTextBoxSetText(t17,"Sub ColorAndPen","true") 
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.PenColor = GraphicsWindow.GetColorFromRGB(R,G,B)","true")                
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.PenWidth = P","true") 
    LDControls.RichTextBoxSetText(t17,"EndSub","true") 
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[33] Then                                 '  OnListBox   
    LDControls.RichTextBoxSetText(t17,"LDControls.ListBoxItemChanged = OnListBox","true") 
    LDControls.RichTextBoxSetText(t17,"Sub OnListBox","true") 
    LDControls.RichTextBoxSetText(t17,"If list[LDControls.LastListBoxIndex] = ls[1] Then","true") 
    LDControls.RichTextBoxSetText(t17,"ElseIf list[LDControls.LastListBoxIndex] = ls[2] Then","true") 
    LDControls.RichTextBoxSetText(t17,"EndIf","true") 
    LDControls.RichTextBoxSetText(t17,"EndSub","true") 
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[34] Then                                    'ShowMessagw
    txt = Controls.GetTextBoxText(t5)
    ogl = Controls.GetTextBoxText(t1)  
    GraphicsWindow.ShowMessage(txt,ogl)
    LDControls.RichTextBoxSetText(t17,"txt = Controls.GetTextBoxText(t5)","true") 
    LDControls.RichTextBoxSetText(t17,"ogl = Controls.GetTextBoxText(t1)","true")   
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.ShowMessage(txt,ogl)","true") 
    LDControls.RichTextBoxSetText(t17,"EndIf","true")
    LDControls.RichTextBoxSetText(t17,"EndSub","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[35] Then                              'DrawResisedImage  
    ar = LDDialogs.OpenFile(Controls.GetTextBoxText(t1),Controls.GetTextBoxText(t5)) 
    GraphicsWindow.DrawResizedImage(ar,x1,y1,w,h)
    aa = 0
    LDControls.RichTextBoxSetText(t17,"ar = LDDialogs.OpenFile('Gif',Controls.GetTextBoxText(t5))","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.DrawResizedImage(ar,"+x1+","+y1+","+w+","+h+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[36] Then                              'Animate
    LDControls.RichTextBoxSetText(t17,"anm = 0)","true")
    LDControls.RichTextBoxSetText(t17,"Shapes.Animate(anm"+","+x1+","+y1+","+Controls.GetTextBoxText(t2)+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[37] Then                            'Zoom 
    LDControls.RichTextBoxSetText(t17,"zm = 0","true")
    LDControls.RichTextBoxSetText(t17,"Shapes.Zoom(zm,"+Controls.GetTextBoxText(t2)+","+Controls.GetTextBoxText(t3)+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[38] Then                             'Rotate
    LDControls.RichTextBoxSetText(t17,"rt = 0)","true")
    LDControls.RichTextBoxSetText(t17,"Shapes.Rotate(rtm,"+Controls.GetTextBoxText(t2)+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[39] Then                             'Opacity
    LDControls.RichTextBoxSetText(t17,"op = 0)","true")
    LDControls.RichTextBoxSetText(t17,"Shapes.SetOpacity(opc,"+Controls.GetTextBoxText(t2)+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[40] Then                               'Star 
    Grad()
    OnDown()
    g = Controls.GetTextBoxText(t1)
    For i = 1 To 1
      st = LDShapes.AddStar(Controls.GetTextBoxText(t2), w, h)
      Shapes.Move(st, x1, y1)
      LDShapes.BrushGradientShape(st, LDShapes.BrushGradient(gr2, g))
    EndFor
    rm = st
    anm = st
    ang = st
    opc = st
    zm = st
    aa = 0
    LDControls.RichTextBoxSetText(t17,"g = Controls.GetTextBoxText(t1)","true")  
    LDControls.RichTextBoxSetText(t17,"For i = 1 To 1","true")     
    LDControls.RichTextBoxSetText(t17,"st = LDShapes.AddStar("+Controls.GetTextBoxText(t2)+","+w+","+h+")","true") 
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(st,"+x1+","+y1+")","true")
    LDControls.RichTextBoxSetText(t17,"LDShapes.BrushGradientShape(st, LDShapes.BrushGradient(gr2,"+g+"))","true") 
    LDControls.RichTextBoxSetText(t17,"EndFor","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[41] Then                             'AddEllipse
    Grad()
    OnDown()
    g = Controls.GetTextBoxText(t1)
    For i = 1 To 1
      el = Shapes.AddEllipse(w,h)
      Shapes.Move(el,X1,Y1)
      LDShapes.BrushGradientShape(el, LDShapes.BrushGradient(gr2,g))
    EndFor
    rm = el
    anm = el
    ang = el
    zm = el
    opc = el
    aa = 0   
    LDControls.RichTextBoxSetText(t17,"LDShapes.BrushGradientShape(st, LDShapes.BrushGradient(gr2,"+g+"))","true") 
    LDControls.RichTextBoxSetText(t17,"For i = 1 To 1","true") 
    LDControls.RichTextBoxSetText(t17,"el = Shapes.AddEllipse("+w+","+h+")","true") 
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(el,"+x1+","+y1+")","true") 
    LDControls.RichTextBoxSetText(t17,"EndFor","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[42] Then                             'AddRectangle
    Grad()
    OnDown()
    g = Controls.GetTextBoxText(t1)
    For i = 1 To 1
      rc = Shapes.AddRectangle(w,h)
      Shapes.Move(rc, X1,Y1)
      LDShapes.BrushGradientShape(rc, LDShapes.BrushGradient(gr2,g))
    EndFor
    rm = rc
    anm = rc
    ang = rc
    zm = rc
    opc = rc
    aa = 0   
    LDControls.RichTextBoxSetText(t17,"LDShapes.BrushGradientShape(st, LDShapes.BrushGradient(gr2,"+g+"))","true") 
    LDControls.RichTextBoxSetText(t17,"For i = 1 To 1","true") 
    LDControls.RichTextBoxSetText(t17,"rc = Shapes.AddRectangle("+w+","+h+")","true") 
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(rc,"+x1+","+y1+")","true") 
    LDControls.RichTextBoxSetText(t17,"EndFor","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[43] Then                            'AddPolygon
    Grad()
    OnDown()
    g = Controls.GetTextBoxText(t1)
    For i = 1 To 1
      pl = LDShapes.AddPolygon(plg)         
      LDShapes.BrushGradientShape(pl, LDShapes.BrushGradient(gr2, g))
    EndFor
    rm = pl
    anm = pl
    ang = pl
    zm = pl
    opc = pl
    aa = 0 
    LDControls.RichTextBoxSetText(t17,"g = Controls.GetTextBoxText(t1)","true")
    LDControls.RichTextBoxSetText(t17,"For i = 1 To 1","true")
    LDControls.RichTextBoxSetText(t17,"pl = LDShapes.AddPolygon(plg)","true")         
    LDControls.RichTextBoxSetText(t17,"LDShapes.BrushGradientShape(pl, LDShapes.BrushGradient(gr2,"+g+"))","true")
    LDControls.RichTextBoxSetText(t17,"EndFor","true")  
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[44] Then                            'AddRegularPolygon
    Grad()
    OnDown()
    g = Controls.GetTextBoxText(t1)
    For i = 1 To 1
      rp = LDShapes.AddRegularPolygon(Controls.GetTextBoxText(t2), w)
      Shapes.Move(rp, X1, Y1)
      LDShapes.BrushGradientShape(rp, LDShapes.BrushGradient(gr2, g))
    EndFor
    rm = rp
    opc = rp
    anm = rp
    ang = rp
    zm = rp  
    aa = 0 
    LDControls.RichTextBoxSetText(t17,"g = Controls.GetTextBoxText(t1)","true")
    LDControls.RichTextBoxSetText(t17,"For i = 1 To 1","true")
    LDControls.RichTextBoxSetText(t17,"rp = LDShapes.AddRegularPolygon("+Controls.GetTextBoxText(t2)+","+w+")","true")
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(rp,"+X1+","+Y1+")","true")
    LDControls.RichTextBoxSetText(t17,"LDShapes.BrushGradientShape(rp, LDShapes.BrushGradient(gr2,"+g+"))","true")
    LDControls.RichTextBoxSetText(t17,"EndFor","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[45] Then                            'AddLine
    ColorAndPen()
    OnDown()
    ln = Shapes.addLine(X1,Y1,X2,Y2)
    rm = ln
    opc = ln
    anm = ln
    ang = ln
    zm = ln
    GraphicsWindow.PenWidth = 0
    aa = 0
    LDControls.RichTextBoxSetText(t17,"ColorAndPen()","true")
    LDControls.RichTextBoxSetText(t17,"ln = Shapes.addLine("+X1+","+Y1+","+X2+","+Y2+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[46] Then                            'Sub Down()
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.MouseDown =  Down","true") 
    LDControls.RichTextBoxSetText(t17,"Sub Down","true")           
    LDControls.RichTextBoxSetText(t17,"x = GraphicsWindow.MouseX","true") 
    LDControls.RichTextBoxSetText(t17,"y = Graphicswindow.MouseY","true") 
    LDControls.RichTextBoxSetText(t17,"aa = aa + 1","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.FillRectangle(x, y, 2, 2)","true")
    LDControls.RichTextBoxSetText(t17,"If aa = 1 Then","true")
    LDControls.RichTextBoxSetText(t17,"X1 = x","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetTextBoxText(t14,X)","true")
    LDControls.RichTextBoxSetText(t17,"Y1 = y","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetTextBoxText(t15,Y)","true")
    LDControls.RichTextBoxSetText(t17,"plg[0][' X '] = x","true") 
    LDControls.RichTextBoxSetText(t17,"plg[0][' Y '] = y","true") 
    LDControls.RichTextBoxSetText(t17,"ElseIf aa = 2 Then","true")
    LDControls.RichTextBoxSetText(t17,"X2 = x","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetTextBoxText(t14,X)","true")
    LDControls.RichTextBoxSetText(t17,"Y2 = y","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetTextBoxText(t15,Y)","true")
    LDControls.RichTextBoxSetText(t17,"plg[1][' X '] = x","true") 
    LDControls.RichTextBoxSetText(t17,"plg[1][' Y '] = y","true") 
    LDControls.RichTextBoxSetText(t17,"aa = 0","true")
    LDControls.RichTextBoxSetText(t17,"EndIf","true")
    LDControls.RichTextBoxSetText(t17,"EndSub","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[47] Then                            'Sub OnMouseMove
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.MouseMove = OnMouseMove","true")
    LDControls.RichTextBoxSetText(t17,"Sub OnMouseMove","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetTextBoxText(t11, 'X=" + Math.Ceiling(GraphicsWindow.MouseX)+")","true")
    LDControls.RichTextBoxSetText(t17,"Controls.SetTextBoxText(t12, 'Y=" + Math.Ceiling(GraphicsWindow.Mousey)+")","true")
    LDControls.RichTextBoxSetText(t17,"EndSub","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[48] Then                           'GraphicsWindow.DrawRectangle
    ColorAndPen()
    OnDown()
    GraphicsWindow.DrawRectangle(x1,y1,w,h)
    aa = 0
    LDControls.RichTextBoxSetText(t17,"ColorAndPen()","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.Rectangle("+x1+","+y1+","+w+","+h+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[49] Then                          'GraphicsWindow.DrawEllips
    ColorAndPen()
    OnDown()
    GraphicsWindow.DrawEllipse(x1,y1,w,h)
    aa = 0
    LDControls.RichTextBoxSetText(t17,"ColorAndPen()","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.DrawEllipse("+x1+","+y1+","+w+","+h+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[50] Then                           'ComboBox       
    LDControls.RichTextBoxSetText(t17,"ColorAndPen()","True")
    LDControls.RichTextBoxSetText(t17,"cb[1] = 'H'","True")
    LDControls.RichTextBoxSetText(t17,"cb[2] = 'V'","True")
    LDControls.RichTextBoxSetText(t17,"cb[3] = 'DD' ","True")
    LDControls.RichTextBoxSetText(t17,"cb1 = LDSort.ByValue(cb)","True")
    LDControls.RichTextBoxSetText(t17,"CBox = LDControls.AddComboBox(cb1,"+w+","+lf+")","True")
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(CBox,"+x1+","+y1+")","True")
    LDControls.RichTextBoxSetText(t17,"OnCoboBox()","True")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[51] Then                            'OnComboBox    
    LDControls.RichTextBoxSetText(t17,"LDControls.ComboBoxItemChanged = OnComboBox","true") 
    LDControls.RichTextBoxSetText(t17,"Sub OnComboBox","true") 
    LDControls.RichTextBoxSetText(t17,"If CBox[LDControls.LastComboBoxIndex] = cb[1]   Then","true") 
    LDControls.RichTextBoxSetText(t17,"ElseIf CBox[LDControls.LastComboBoxIndex] = cb[2] Then","true") 
    LDControls.RichTextBoxSetText(t17,"EndIf","true") 
    LDControls.RichTextBoxSetText(t17,"EndSub","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[52] Then                          'LDPasswordBox
    OnDown()
    pss = LDControls.AddPasswordBox(w,h,Controls.GetTextBoxText(t1))  
    Shapes.Move(pss,X1,Y1) 
    rm = pss
    aa = 0
    LDControls.RichTextBoxSetText(t17,"pss = LDControls.AddPasswordBox("+w+","+h+","+Controls.GetTextBoxText(t1)+")","true")
    LDControls.RichTextBoxSetText(t17,"Shapes.Move(pss,"+X1+","+Y1+")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[53] Then                          'LDControlsaddMenu
    ml["File"] = "Main"
    ml["Open"] = "File"
    ml["Save"] = "File"
    ml["Exit"] = "file" 
    ml["Show Help"] = "Main"
    ml["Help"] = "Show Help"
    LDControls.AddMenu(w,h,ml,"","false")
    LDControls.RichTextBoxSetText(t17,"ml['File'] = 'Main'","true")
    LDControls.RichTextBoxSetText(t17,"ml['Open'] = 'File'","true")
    LDControls.RichTextBoxSetText(t17,"ml['Save'] = 'File'","true")
    LDControls.RichTextBoxSetText(t17," ml['Exit'] = 'file'","true")
    LDControls.RichTextBoxSetText(t17,"ml['Show Help'] = 'Main","true")
    LDControls.RichTextBoxSetText(t17,"ml['Help'] = 'Show Help","true")
    LDControls.RichTextBoxSetText(t17,"LDControls.AddMenu(w,h,ml,'false', "")","true")
  ElseIf CobB[LDControls.LastComboBoxIndex] = cb[54] Then                        ' GraphicsWindow.DrawLine
    OnDown()
    ColorAndPen()
    GraphicsWindow.DrawLine(X1,Y1,X2,Y2)
    aa = 0
    LDControls.RichTextBoxSetText(t17,"ColorAndPen()","true")
    LDControls.RichTextBoxSetText(t17,"GraphicsWindow.DrawLine("+X1+","+Y1+","+X2+","+Y2+")","true")
  EndIf
  GraphicsWindow.PenWidth = 0
EndSub

Sub ColorAndPen
  GraphicsWindow.PenColor = GraphicsWindow.GetColorFromRGB(R,G,B)                  ' Для контура фигур
  GraphicsWindow.FontSize = P
  GraphicsWindow.PenWidth = P
EndSub
Sub Grid
  GraphicsWindow.PenWidth = 0.1                                                                        
  GraphicsWindow.PenColor = "White"
  For gg = 1 To 245 Step ng
    GraphicsWindow.DrawLine(4 * gg,4,4 * gg,725)                                        'gorizontal
  EndFor
  For vv = 1 To 180 Step ng
    GraphicsWindow.DrawLine(4,4 * vv,960,4 * vv)                                        'vertical
  EndFor    
EndSub  
LDControls.ListBoxItemChanged = OnListBox
Sub OnListBox
  If list[LDControls.LastListBoxIndex] = ls[1] Then
  ElseIf list[LDControls.LastListBoxIndex] = ls[2] Then
  EndIf
EndSub
Sub Grad
  gr2[1] = LDDialogs.Colour() 
  gr2[2] = LDDialogs.Colour() 
  gr2[3] = LDDialogs.Colour() 
EndSub
GraphicsWindow.MouseDown =  OnDown 
Sub OnDown   
  x = GraphicsWindow.MouseX 
  y = Graphicswindow.MouseY 
  aa = aa + 1
  GraphicsWindow.FillRectangle(x, y, 2, 2)
  If aa = 1 Then
    X1 = x
    Controls.SetTextBoxText(t14,X)
    Y1 = y
    Controls.SetTextBoxText(t15,Y)
    plg[0][" X "] = x 
    plg[0][" Y "] = y 
  ElseIf aa = 2 Then
    X2 = x
    Controls.SetTextBoxText(t14,X)
    Y2 = y
    Controls.SetTextBoxText(t15,Y)
    plg[1][" X "] = x 
    plg[1][" Y "] = y 
  ElseIf aa = 3 Then
    plg[2][" X "] = x 
    Controls.SetTextBoxText(t14,X)
    plg[2][" Y "] = y
    Controls.SetTextBoxText(t15,Y)
  ElseIf aa = 4 Then
    plg[3][" X "] = x 
    Controls.SetTextBoxText(t14,X)
    plg[3][" Y "] = y
    Controls.SetTextBoxText(t15,Y)
  ElseIf aa = 5 Then
    plg[4][" X "] = x 
    Controls.SetTextBoxText(t11,X) 
    plg[4][" Y "] = y
    Controls.SetTextBoxText(t12,Y)
    aa = 0
  EndIf
EndSub

