svg="<svg width='1380' height='890'>|  <polyline points='686,35 621,38 561,51 486,73 408,95 338,125 271,161 235,209 212,274 213,316 231,363 266,415 331,450 393,484 446,503 457,522 462,544 452,569 418,586 377,600 318,632 307,667 319,714 363,753 412,779 476,798 518,810 558,816 635,825 689,825'|  style='fill:none;stroke:#000000;stroke-width:2' />|</svg>
GraphicsWindow.BrushColor ="white
buf=svg
GraphicsWindow.Title = "Eurovision 2017 KYIV
Not = "False=True;True=False
CR = Text.GetCharacter(13)
LF = Text.GetCharacter(10)
LT = Text.GetCharacter(60)
gw = 1400
gh = 750
GraphicsWindow.Left=10
GraphicsWindow.Top=1
pi=1
zmm=1
GraphicsWindow.Width = gw
GraphicsWindow.Height = gh
GraphicsWindow.BackgroundColor = "Darkblue
fw = 1380
fh = 750
x0 = (gw - fw) / 2
y0 = (gh - fh) / 2 + 32
x1 = x0 + fw - 1
y1 = y0 + fh - 1


nPos = 0
pw = 2
pc = "#000000
GraphicsWindow.PenWidth = pw
GraphicsWindow.PenColor = pc
GraphicsWindow.BrushColor = pc


tutput = Controls.AddMultiLineTextBox(gw / 2 - 180, 10)
Controls.SetSize(tutput, fw / 2 + 180, 64)
InitSVG()
Controls.HideControl (tutput)

Open()
lyr[1]="The secret of my life ;Is never givin' up ;Now I'm close to you ;Walking through the stars ;Brings me to the start ;When I won with you ;;I was waiting way too much ;For something good to come ;And I'm a bit fragile ;Was waiting way too much ;It's like an hourglass ;And you like trouble ;;Breaking me to pieces ;I wanted you to know that ;Every piece broke from you ;Breaking me to pieces ;'Coz every time ;You come around ;I feel alive ;Now I'm trying ;I'm trying ;I feel alive! ;I feel alive! ;;The years I've been alone ;Far away from home ;Reminded me of you ;My job is almost done ;Baby I can now ;Escape away with you ;;I was waiting way too much ;For something good to come ;And I'm a bit fragile ;Was waiting way too much ;It's like an hourglass ;And you like trouble ;;Breaking me to pieces ;I wanted you to know that ;Every piece broke from you ;Breaking me to pieces ;'Coz every time ;You come around ;I feel alive ;Now I'm trying ;I'm trying ;I feel alive! ;;So alive ;;Alive, alive, alive ;;Breaking me to pieces ;I wanted you to know that ;Every piece broke from you ;Breaking me to pieces ;'Coz every time ;You come around ;I feel alive
lyr[2]="Like a bullet from a smoking gun ;They try to tell us that we don’t belong ;Creeping round at the depth of night ;Just two shadows in love we were ghosts ;Two hearts we’re invincible ;;When we’re together we’re untouchable ;Haunted by if it’s wrong or right ;Shadows in love we were ghosts ;Fire, like a burning desire, ;Taking me higher, ;Walk in a wire, ;We will never come down ;;It’s like a flashlight burning in our eyes ;You call the dogs off, I got them hypnotized ;You never catch us, take us by suprise ;Running faster at the speed of light ;Falling deeper got you in the sight ;Bringing down your eyes in the sky ;;Like two animals on the run ;Not afraid to fly into the sun ;Invisible we don’t leave a trace ;We’re shadows in love we were ghosts ;Fire, like a burning desire, ;Taking me higher, ;Walk in a wire, ;We will never come down ;;It’s like s flashlight burning in our eyes ;You call the dogs off, I got them hypnotized ;You never catch us, take us by suprise ;Running faster at the speed of light ;Falling deeper got you in a sight ;Bringing down your eyes in the sky
lyr[3]="How many days, how many love dates ;New images and towns ;The chain of events is falling behind us ;We keep it in our hearts and walk on ;;The story of my life ;Will shine even brighter ;The sun will sparkle in our blood ;And all the beauty of your eyes ;;I'll seek you out wherever you may be ;We'll discover the bright moments quicker ;Today will give birth ;To new desires and better ideas ;;The story of my life ;Will shine even brighter ;The sun will sparkle in our blood ;And all the beauty of your eyes
lyr[4]="It’s been a long time running, ;’Cause I had some things to see ;I had to meet some people ;Who were there to believe in me ;;I’m taking all that struggle, ;Reminds me what I’m fighting for ;I’m living it up, ;I ain’t gonna stop ;’Till I make that final score ;;And I’ll keep running ;As fast as I can ;I’ll keep running ;I won’t stop, I won’t stop, no, no ;;Hey now! ;If you push me down, I’ll get up again ;Hey now! ;If you let me drown, I’ll swim like a champion ;I’m sure, ;There’ll be good times, there’ll be bad times, ;But I don't care, ;’Cause I’m running on air ;;Running, running, ;yeah… ;;Give me a million reasons, ;But my answer stays the same ;You can try to put me in a box, ;But I’m doing it my own damn way ;;See, I can't stand them talkers ;All pretending that their live’s a mess, ;’Cause whatever you want, ;Whatever you need, ;You gotta get off your … ;;And I’ll keep running ;As fast as I can ;I’ll keep running ;I won’t stop, I won’t stop ;;Hey now! ;If you push me down, I’ll get up again ;Hey now! ;If you let me drown, I’ll swim like a champion ;I’m sure, ;There’ll be good times, there’ll be bad times ;But I don't care ;’Cause I’m running on air ;;Hey, I’m running on air ;Running, running on air ;Running, running ;Now I don’t care ;;Hey now, ;If you push me down, I’ll get up again ;Hey now, hey now… ;;Yeah ;You can push me, push me down! ;Hey now, but I’ll get up again ;I’m sure, ;There’ll be good times, there’ll be bad times, ;But I don't care ;’Cause I’m running on air
lyr[6]="Cry no more, cry no more;;Though the hallway catches light;it won’t reach the corner where you strongly fight;;(Here in the shadow);;At this place they know the game;outside the world will turn and feel the same;;(There in the sunlight);;But you are so much more to me;than the one who carries all the burden;I can only hope, once you fly, you’ll be free;;you should never;;Cry, no more, feeling all alone and insecure;you have been going through these stages;now it’s time to turn the pages;;We’re gonna stand in line;and not give up but walk that road;that everybody goes;through lights and shadows;;Every time the candle glows;it lightens up the space but no one knows;;(Will there be a dark side?);;Every battle’s victory;is a double feeling when you cannot be;;(Here in the spotlight);;Cause you are so much more to me;than the one who lifts us on your shoulders;I can only hope, once you fly, you’ll be free;;you should never;;Cry, no more, feeling all alone and insecure;you have been going through these stages;now it’s time to turn the pages;;We’re gonna stand in line;and not give up but walk that road;that everybody goes;through lights and shadows;;On a scale of one to ten;you got the biggest score you’re heaven sent;no one will doubt that you’re an angel;;So what went wrong this time;hurt nobody, did no crime;what’s with the universe, why you?;;Cry, no more, feeling all alone and insecure;you have been going through these stages;now it’s time to turn the pages;;We’re gonna stand in line;and not give up but walk that road;that everybody goes;through lights and shadows
lyr[9]="Essere o dover essere, Il dubbio amletico;Contemporaneo come l’uomo del neolitico;L’intelligenza è démodé;Risposte facili, dilemmi inutili…;AAA cercasi (cerca sì) Storie dal gran finale;Sperasi (spera sì) Comunque vada panta rei;And singing in the rain;;Lezioni di Nirvana;C’è il Buddha in fila indiana;Per tutti un’ora d’aria, di gloria, Alè;La folla grida un mantra;L’evoluzione inciampa;La scimmia nuda balla;Occidentali’s Karma [Ock];;Aaaa cercasi (cerca sì) ;Umanità virtuale;Sex appeal (sex appeal);Comunque vada panta rei;And singing in the rain;;Lezioni di Nirvana;C’è il Buddha in fila indiana;Per tutti un’ora d’aria, di gloria;La folla grida un mantra,;L’evoluzione inciampa;La scimmia nuda balla (OcK);;Quando la vita si distrae;Cadono gli uomini (OcK) ;La scimmia si rialza, Namasté Alé;;Lezioni di Nirvana;C’è il Buddha in fila indiana;Per tutti un’ora d’aria, di gloria;La folla grida un mantra;L’evoluzione inciampa, ;La scimmia nuda balla ;(OcK) Ommm
lyr[13]="There's a miracle my friend ;And it happens every day. ;Hold out your hand, ;Don't let it slip away! ;;Io so che esiste, ;Guarda meglio su, ;Ritorna ogni giorno, ;Promettendo sempre più. ;;After the rain, ;Nasce il sole! ;;I pray you'll see the light and find your way. ;La forza del destino che è in te. ;;Do your best, take a chance! ;Dare to dream and make it real! ;Segui la verità ;Via della libertà! ;;My friend, ;My friend. ;;Don't let go, ;Let it flow! ;Credi nel miracolo! ;;For the miracle ;That I'm talking of ;Is the life that we're given. ;;La vita vincerà!;
ctt=LDText.Split ("Israel;Poland;Belarus;Austria;Armenia;The Netherlands;Moldova;Hungary;Italy;Denmark;Portugal;Azerbaijan;Croatia;Australia;Greece;Spain;Norway;United Kingdom;Cyprus;Romania;Germany;Ukraine;Belgium;Sweden;Bulgaria;France" ";")
exx=LDText.Split ("1;IZ;I Feel Alive;IMRI|2;PO;Flashlight;Kasia Mos|3;BR;Story of My Life;Naviband|4;A;Running On Air;Nathan Trent|5;AR;Fly With Me;Artsvik|6;NL;Lights and Shadows;OG3NE|7;MO;Hey Mamma;Sunstroke Project|8;H;Origo;Joci Pápai|9;I;Occidentali's Karma;Francesco Gabbani|10;DK;Where I Am;Anja|11;P;Amar Pelos Dois;Salvador Sobral|12;AZ;Skeletons;Dihaj|13;HR;My Friend;Jacques Houdek|14;AU;Don't Come Easy;Isaiah|15;GR;This is Love;Demy|16;E;Do It For Your Lover;Manel Navarro|17;N;Grab The Moment;JOWST|18;UK;Never Give Up On You;Lucie Jones|19;CY;Gravity;Hovig|20;RO;Yodel It!;Ilinca ft. Alex Florea|21;D;Perfect Life;Levina|22;U;Time;O.Torvald|23;B;City Lights;Blanche|24;S;I Can't Go On;Robin Bengtsson|25;BG;Beautiful Mess;Kristian Kostov|26;F;Requiem;Alma" "|")
clr=LDText.Split("cwc dwr rrg rwr rbo rwb byr rwg gwr rwr grr crg rwb rbb cwc ryr rkr brb wwy byr kry dby byr byb wgr bwr" " ")

cli=ldtext.Split("darkblue red green orange yellow white black cyan blue" " ")
cor="drgoywkcb
scc=shapes.AddText ("$")
LDShapes.Font (scc "SEGOE ui" 33 "FALSE" "true")
LDShapes.PenColour (scc "yellow")
LDShapes.ZIndex (scc 111)
r1=shapes.AddRectangle (340,200)
shapes.Move(r1 0 600)
LDShapes.PenWidth (r1 0)
LDShapes.BrushColour (r1 "darkblue")
LDShapes.ZIndex (r1 115)
r11=shapes.AddRectangle (1000,200)
shapes.Move(r11 1050 600)
LDShapes.ZIndex (r11 115)
LDShapes.PenWidth (r11 0)
LDShapes.BrushColour (r11 "darkblue")
GraphicsWindow.KeyDown =kkk

Sub kkk
  If GraphicsWindow.LastKey ="Space" then
    skpp="true
  endif
EndSub 

While "True"'-----------------------------------------------------main---------------------
  For i=1 To 26
    Shapes.SetText (TT i+". "+ctt[i])
    Program.Delay (15)
    nm=ldtext.Split (exx[i] ";")
    LDShapes.Centre (TT 700 250)
    
    Shapes.SetText (TT1 nm[3])
    Program.Delay (15)
    LDShapes.Centre (TT1 700 350)
    
    Shapes.SetText (TTx nm[4])
    Program.Delay (25)
    LDShapes.centre  (TTx 700 450)
    Program.Delay (25)
    For r=1 to 3
      in=text.GetIndexOf (cor text.GetSubText (clr[i] r 1))
      
      LDShapes.BrushColour (shh[r] cli[in])
    endfor
    tpp=ldtext.Split (lyr[i] ";")
    
    For rw=1 to Array.GetItemCount (tpp)
      Shapes.SetText (scc tpp[rw]) 
      shapes.Move(scc 1200 650)
      Shapes.Animate (scc, 200-LDShapes.Width(scc) 650 3000)
      Program.Delay(3050)
      ttw=ttw+tpp[rw]+text.GetCharacter (13)
      GraphicsWindow.BrushColor="darkblue
      GraphicsWindow.FillRectangle (0 0 300 999)
      GraphicsWindow.BrushColor="cyan
      GraphicsWindow.DrawBoundText (10 10 300 ttw)
      If skpp then
        Goto xxx
      endif
    EndFor 
    Program.Delay(2000)
    xxx:
    ttw=""
    skpp="false
  EndFor   
EndWhile'-------------------------------------------------------------------mainloop end

Sub AddPos
  
  pln[pi][1]= pos["x"]
  pln[pi][2]= pos["y"]+50
  pi=pi+1
  
  body = body + pos["x"] + "," + pos["y"]
EndSub

Sub ClearPoints
  For i = 1 To nPos
    Shapes.Remove(shape[i])
  EndFor
  shape = ""
  pln=""
  pi=1
  Controls.SetTextBoxText(tutput, "")
  nPos = 0
  polyline = ""
  body = ""
EndSub

Sub Open
  
  ParseSVG()
  
  aa=array.GetItemCount (pln)
  
  For x=aa to 1 step -1
    pln[aa+1][1]=1400-pln[x][1]
    pln[aa+1][2]=pln[x][2]
    aa=aa+1
  endfor
  cll=ldtext.Split ("red lightgray blue #000077" " ")
  zz=1
  For r=1 To 4 
    shh[r]=LDShapes.AddPolygon (pln)
    LDShapes.PenWidth (shh[r] 0)
    LDShapes.BrushColour (shh[r] cll[r])
    Shapes.Zoom(shh[r] zz zz)
    Shapes.Move (shh[r] r*3 r*5-80)
    LDShapes.ZIndex (shh[r] r*2)
    zz=zz-.05
  endfor
  mm=Shapes.AddRectangle (900 300)
  LDShapes.BrushColour (mm "darkblue")
  Shapes.Move(mm 300 545)
  LDShapes.PenWidth (mm 0)
  LDShapes.ZIndex (mm 5)
  TT=shapes.AddText ("CR")
  LDShapes.Font (TT "SEGOE ui" 66 "FALSE" "false")
  LDShapes.PenColour (TT "white") 
  ldShapes.ZIndex (TT 22) 
  
  TT1=shapes.AddText ("Be")
  LDShapes.Font (TT1 "SEGOE ui" 33 "FALSE" "true")
  LDShapes.PenColour (TT1 "white") 
  ldShapes.ZIndex (TT1 22) 
  
  TTx=shapes.AddText ("Ja")
  LDShapes.Font (TTx "SEGOE ui" 33 "FALSE" "true")
  LDShapes.PenColour (TTx "Cyan") 
  ldShapes.ZIndex (TTx 22)
  Program.Delay (155) 
EndSub

Sub InitSVG  ' param pc - pen color   ' param pw - pen width
  header = LT + "svg width='" + fw + "' height='" + fh + "'>" + CR + LF
  header = header + "  " + LT + "polyline points='"
  body = ""
  footer = "'" + CR + LF
  footer = footer + "  style='fill:none;stroke:" + Text.ConvertToLowerCase(pc) + ";stroke-width:" + pw + "' />" + CR + LF
  footer = footer + LT + "/svg>"
EndSub

Sub ParseSVG  ' param buf - SVG buffer
  ' return polyline[]
  p = 1
  param = "tag=polyline;"
  FindTag()
  GetAttrAndText()
  'DumpAttr()
  SetStyle()
  polyline = ""
  InitSVG()
  nPos = 0
  p = 1
  lPoints = Text.GetLength(attr["points"])
  GraphicsWindow.PenWidth = pw
  GraphicsWindow.PenColor = pc
  GraphicsWindow.BrushColor = pc
  While p <= lPoints
    pComma = Text.GetIndexOf(Text.GetSubTextToEnd(attr["points"], p), ",")
    pos["x"] = Text.GetSubText(attr["points"], p, pComma - 1)
    p = p + pComma
    pSpace = Text.GetIndexOf(Text.GetSubTextToEnd(attr["points"], p), " ")
    If pSpace = 0 Then
      pSpace = lPoints - p + 2
    EndIf
    pos["y"] = Text.GetSubText(attr["points"], p, pSpace - 1)
    nPos = nPos + 1
    polyline[nPos] = pos
    dx = pos["x"] + x0
    dy = pos["y"] + y0
    AddPos()
    p = p + pSpace
  EndWhile
  Controls.SetTextBoxText(tutput, header + body + footer)
EndSub

Sub SetStyle
  p = 1
  kw = "stroke"
  GetStyleAttr()
  pc = value
  kw = "stroke-width"
  GetStyleAttr()
  pw = value
EndSub

Sub GetStyleAttr  ' param kw - keyword
  ' param attr["style"] - style attribute   ' param p - pointer to search in style attribute
  ' return value - value
  pKw = Text.GetIndexOf(Text.GetSubTextToEnd(attr["style"], p), kw)
  If pKw = 0 Then
    value = ""
  Else
    pValue = p + pKw + Text.GetLength(kw)
    pColon = Text.GetIndexOf(Text.GetSubTextToEnd(attr["style"], pValue), ";")
    If pColon = 0 Then
      pColon = Text.GetLength(kw) + 1
    EndIf
    value = Text.GetSubText(attr["style"], pValue, pColon - 1)
  EndIf
EndSub

Sub FindTag  ' find tag from html buffer
  
  pSave = p
  tag = ""
  findNext = "True"
  While findNext
    findNext = "False"        ' tag may be not found
    pTag = Text.GetIndexOf(Text.GetSubTextToEnd(buf, p), LT + param["tag"])
    If 0 < pTag Then
      lTag = Text.GetLength(param["tag"]) + 1
      pTag = p + pTag - 1
      len = Text.GetIndexOf(Text.GetSubTextToEnd(buf, pTag), "/" + param["tag"] + ">")
      If len = 0 Then
        lTag = 1
        len = Text.GetIndexOf(Text.GetSubTextToEnd(buf, pTag), "/>")
      EndIf
      If param["class"] = "" Then
        len = len + lTag
        tag = Text.GetSubText(buf, pTag, len)
        findNext = "False"    ' found the tag
      ElseIf 0 < len Then
        findNext = "True"     ' tag may have different class
        len = len + lTag
        attr = "class=" + "'" + param["class"] + "'"
        pAttr = pTag + lTag + 1
        lAttr = Text.GetLength(attr)
        If Text.GetSubText(buf, pAttr, lAttr) = attr Then
          tag = Text.GetSubText(buf, pTag, len)
          findNext = "False"  ' found the tag
        EndIf
      EndIf
      p = pTag + len
    EndIf
  EndWhile
  If tag = "" Then
    p = pSave
  EndIf
EndSub

Sub GetAttrAndText  ' get attributes and text from given tag
  ' param tag - given tag   ' return attr[] - array of attributes in the tag   ' return txt - text in the tag
  pTag = Text.GetIndexOf(tag, " ") + 1
  pEnd = Text.GetIndexOf(tag, ">")
  attr = ""
  While pTag <= pEnd
    SkipSpace()
    pEq = Text.GetIndexOf(Text.GetSubTextToEnd(tag, pTag), "=")
    If 0 < pEq Then
      pEq = pTag + pEq - 1
      If Text.GetSubText(tag, pEq + 1, 1) = "'" Then
        pQ = Text.GetIndexOf(Text.GetSubTextToEnd(tag, pEq + 2), "'")
        If 0 < pQ Then
          pQ = pEq + 2 + pQ - 1
          attr[Text.GetSubText(tag, pTag, pEq - pTag)] = Text.GetSubText(tag, pEq + 2, pQ - pEq - 2)
          pTag = pQ + 2
        EndIf
      EndIf
    Else
      pTag = pEnd + 1
    EndIf
  EndWhile
  If pEnd + 1 < pTag Then
    pTag = pEnd + 1
  EndIf
  len = Text.GetLength(tag)
  txt = ""
  While pTag <= len
    pL = Text.GetIndexOf(Text.GetSubTextToEnd(tag, pTag), LT)
    If pL = 0 Then
      txt = Text.Append(txt, Text.GetSubTextToEnd(tag, pTag))
      pTag = len + 1
    Else
      pL = pTag + pL - 1
      txt = Text.Append(txt, Text.GetSubText(tag, pTag, pL - pTag))
      pR = Text.GetIndexOf(Text.GetSubTextToEnd(tag, pTag), ">")
      If 0 < pR Then
        pTag = pTag + pR
      Else
        pTag = len + 1
      EndIf
    EndIf  
  EndWhile
EndSub

Sub SkipSpace  ' param pTag - point to tag
  ' param tag - tag  ' return pTag - updated point to tag
  isSpace = "True"
  While isSpace
    char = Text.GetSubText(tag, pTag, 1)
    If Text.IsSubText(" " + CR + LF, char) Then
      pTag = pTag + 1
    Else
      isSpace = "False"
    EndIf
  EndWhile
EndSub
