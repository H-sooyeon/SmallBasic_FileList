'Creating polygon shapes using Small Basic
'------------KEYS-------------------
'W - Connects to the first x1, y1 (for completing the shape)
'T - Get the code or updates the code
'-----------------------------------
'Video - 
'ID - CKH484-0
GraphicsWindow.Title = "Polygons"
codeBox = Controls.AddMultiLineTextBox(650,120)
Controls.SetSize(codeBox,100,100)
GraphicsWindow.MouseDown = OnMD
GraphicsWindow.KeyDown = OnKD
bool = "False"
nextLine = Text.GetCharacter(10)
code = "'Generated By Polygon Tool" + nextLine
x1 = 0
y1 = 0
x2 = 0
y2 = 0
firstX = 0
firstY = 0
lastX = 0
lastY = 0
index = 0
Sub OnKD
  
  If Text.ConvertToLowerCase(GraphicsWindow.LastKey) = "w" Then
    Shapes.AddLine(firstX, firstY, lastX ,lastY)
    code = code + "Shapes.AddLine(" + firstX + "," + firstY + "," + lastX + "," + lastY + ")" + nextLine
    bool = "False"
    x1 = 0
    y1 = 0
    x2 = 0
    y2 = 0
    firstX = 0
    firstY = 0
    lastX = 0
    lastY = 0
    index = 0
    
  ElseIf Text.ConvertToLowerCase(GraphicsWindow.LastKey) = "t" Then
    Controls.SetTextBoxText(codeBox, code)
  EndIf
  
EndSub
Sub OnMD
  
  If bool = "False" Then
    x1 = GraphicsWindow.MouseX
    y1 = GraphicsWindow.MouseY
    bool = "True"
    index = index + 1
    If index = 1 Then
      firstX = x1
      firstY = y1
    Else
      Shapes.AddLine(lastX, lastY, x1 ,y1)
      code = code + "Shapes.AddLine(" + lastX + "," + lastY + "," + x1 + "," + y1 + ")" + nextLine
    EndIf
    lastX = x1
    lastY = y1
    
  Else
    bool = "False"
    x2 = GraphicsWindow.MouseX
    y2 = GraphicsWindow.MouseY
    lastX = x2
    lastY = y2
    Shapes.AddLine(x1, y1, x2 ,y2)
    code = code + "Shapes.AddLine(" + x1 + "," + y1 + "," + x2 + "," + y2 + ")" + nextLine
  EndIf
  
EndSub
