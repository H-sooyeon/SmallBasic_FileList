'WinDOS, version 1.2



programdir = Program.Directory

configfile = programdir + "system.config"

spawnfile = programdir + "spawn.config"



backgroundcolor = "DarkBlue"

foregroundcolor = "White"



BIOS()





Sub BIOS

  TextWindow.BackgroundColor = "White"

  TextWindow.ForegroundColor = "Black"

  

  TextWindow.CursorLeft = 67

  TextWindow.Write("             ")

  TextWindow.CursorLeft = 67

  TextWindow.Write("     ?ñí?ñí?ñí?ñí?ñí?ñí?ñí ")

  TextWindow.CursorLeft = 67

  TextWindow.Write("     ?ñí     ?ñí ")

  TextWindow.CursorLeft = 67

  TextWindow.Write("     ?ñí     ?ñí ")

  TextWindow.CursorLeft = 67

  TextWindow.Write(" ?ñà?ñà?ñà?ñà?ñà?ñà?ñà   ?ñí ")

  TextWindow.CursorLeft = 67

  TextWindow.Write(" ?ñà   ?ñí ?ñà   ?ñí ")

  TextWindow.CursorLeft = 67

  TextWindow.Write(" ?ñà   ?ñí?ñí?ñà?ñí?ñí?ñí?ñí ")

  TextWindow.CursorLeft = 67

  TextWindow.Write(" ?ñà     ?ñà     ")

  TextWindow.CursorLeft = 67

  TextWindow.Write(" ?ñà     ?ñà     ")

  TextWindow.CursorLeft = 67

  TextWindow.Write(" ?ñà?ñà?ñà?ñà?ñà?ñà?ñà     ")

  TextWindow.CursorLeft = 67

  TextWindow.Write("             ")

  

  TextWindow.CursorTop = 0

  TextWindow.BackgroundColor = "Black"

  TextWindow.ForegroundColor = "White"

  TextWindow.WriteLine("BIOS version 1.00")

  TextWindow.WriteLine("")

  TextWindow.WriteLine("")

  Program.Delay(1000)

' The following line could be harmful and has been automatically commented.

'   If File.ReadLine(configfile, 1) = "WinDOS v1.1" Then

    TextWindow.WriteLine("Configuration file present.")

' The following line could be harmful and has been automatically commented.

'   ElseIf File.ReadContents(configfile) <> "" Then 'Checks WHOLE FILE instead of ln01 -- INTENTIONAL. Data may be present even if ID is not.

    TextWindow.ForegroundColor = "Yellow"

    TextWindow.WriteLine("Configuration file format mismatch.")

    TextWindow.ForegroundColor = "White"

    TextWindow.WriteLine("The configuration file begins with:")

' The following line could be harmful and has been automatically commented.

'     TextWindow.WriteLine(File.ReadLine(configfile, 1))

    TextWindow.WriteLine("instead of:")

' The following line could be harmful and has been automatically commented.

'     TextWindow.WriteLine(File.ReadLine(configspawnfile, 1))

    configattempt()

  Else

    TextWindow.ForegroundColor = "Gray"

    TextWindow.WriteLine("Configuration file is missing.")

' The following line could be harmful and has been automatically commented.

'     File.CopyFile(configspawnfile, configdir)

    TextWindow.ForegroundColor = "White"

    TextWindow.WriteLine("New configuration file created.")

  EndIf

  TextWindow.WriteLine("")

  TextWindow.WriteLine("")

  Program.Delay(1000)

  

  TextWindow.ForegroundColor = "Gray"

  TextWindow.WriteLine("Starting WinDOS v1.1...")

  Program.Delay(2000)

  TextWindow.Clear()

  osbootscreen()

EndSub



Sub configattempt

  TextWindow.Write("Attempt to continue using this configuration file? (y/n) ")

  attemptprompt = TextWindow.Read()

  If attemptprompt = "y" Then

    TextWindow.WriteLine("Attempting.")

  ElseIf attemptprompt = "n" Then

    configreplace()

  Else

    configattempt()

  EndIf

EndSub



Sub configreplace

  TextWindow.Write("Replace configuration file? (y/n) ")

  replaceprompt = TextWindow.Read()

  If replaceprompt = "y" Then

' The following line could be harmful and has been automatically commented.

'     File.DeleteFile(configfile)

' The following line could be harmful and has been automatically commented.

'     File.CopyFile(configspawnfile, configdir)

    TextWindow.WriteLine("Done.")

  ElseIf replaceprompt = "n" Then

    TextWindow.ForegroundColor = "Yellow"

    TextWindow.WriteLine("")

    TextWindow.WriteLine("")

    TextWindow.WriteLine("This program cannot continue. Check the configuration file and try again.")

    TextWindow.WriteLine("The program will now close.")

    Program.Delay(5000)

    Program.End()

  Else

    configreplace()

  EndIf

EndSub



Sub osbootscreen 'sets background() with delay

  TextWindow.BackgroundColor = "DarkBlue"

  TextWindow.ForegroundColor = "White"

  For i = 1 To 1189

    WinSpace()

  EndFor

  WinDShade()

  For i = 1 To 9

    WinFill()

  EndFor

  For i = 1 To 68

    WinSpace()

  EndFor

  WinLShade()

  WinMShade()

  WinSpace()

  WinFill()

  WinSpace()

  WinSpace()

  WinSpace()

  WinFill()

  WinSpace()

  WinSpace()

  WinSpace()

  WinFill()

  For i = 1 To 71

    WinSpace()

  EndFor

  WinFill()

  WinSpace()

  WinSpace()

  WinSpace()

  WinFill()

  WinSpace()

  WinSpace()

  WinSpace()

  WinFill()

  For i = 1 To 71

    WinSpace()

  EndFor

  WinFill()

  WinSpace()

  WinSpace()

  WinSpace()

  WinFill()

  WinSpace()

  WinSpace()

  WinSpace()

  WinFill()

  For i = 1 To 70

    WinSpace()

  EndFor

  WinDShade()

  For i = 1 To 9

    WinFill()

  EndFor

  For i = 1 To 68

    WinSpace()

  EndFor

  WinLShade()

  WinMShade()

  WinSpace()

  WinFill()

  WinSpace()

  WinSpace()

  WinSpace()

  WinFill()

  WinSpace()

  WinSpace()

  WinSpace()

  WinFill()

  For i = 1 To 71

    WinSpace()

  EndFor

  WinFill()

  WinSpace()

  WinSpace()

  WinSpace()

  WinFill()

  WinSpace()

  WinSpace()

  WinSpace()

  WinFill()

  For i = 1 To 71

    WinSpace()

  EndFor

  WinFill()

  WinSpace()

  WinSpace()

  WinSpace()

  WinFill()

  WinSpace()

  WinSpace()

  WinSpace()

  WinFill()

  For i = 1 To 70

    WinSpace()

  EndFor

  WinDShade()

  For i = 1 To 9

    WinFill()

  EndFor

  For i = 1 To 68

    WinSpace()

  EndFor

  WinLShade()

  WinMShade()

  For i = 1 To 91

    WinSpace()

  EndFor  

  

  'If any user present Then

    'show loginbox

  'Else

    'show newuserbox

  'EndIf

  

' The following line could be harmful and has been automatically commented.

'   If File.ReadLine(configfile, 3) <> "" Or File.ReadLine(configfile, 9) <> "" Or File.ReadLine(configfile, 15) <> "" Or File.ReadLine(configfile, 21) <> "" Then

    loginbox()

  Else

    newuserbox()

  EndIf

EndSub



Sub newuserbox

  background() 'required -- newuserbox() may be invoked after login, hence the screen needs to be overwritten

  'TextWindow.Write("newuserbox")

  

  TextWindow.CursorTop = 8

  TextWindow.CursorLeft = 21

  TextWindow.WriteLine("?îå?????????????????????????????????????????????????????????????????????????îê")

  TextWindow.CursorLeft = 21

  TextWindow.WriteLine("?îÇ            WinDOS v1.1             ?îÇ")

  TextWindow.CursorLeft = 21

  TextWindow.WriteLine("?îú?????????????????????????????????????????????????????????????????????????î§")

  TextWindow.CursorLeft = 21

  TextWindow.WriteLine("?îÇ                                    ?îÇ") 'situation identifier

  TextWindow.CursorLeft = 21

  TextWindow.WriteLine("?îÇ                                    ?îÇ")

  TextWindow.CursorLeft = 21

  TextWindow.WriteLine("?îÇ                                    ?îÇ") 'username field

  TextWindow.CursorLeft = 21

  TextWindow.WriteLine("?îÇ                                    ?îÇ") 'password field

  TextWindow.CursorLeft = 21

  TextWindow.WriteLine("?îî?????????????????????????????????????????????????????????????????????????îò")

  

  

  'If no users are present Then

    'Say "There are no accounts yet."

  'ElseIf one to three users are present Then

    'Say "New user account setup"

  'Else it is implied that there are four users

    'Say "Account limit reached!"

  'EndIf

  'proglist()

  

' The following line could be harmful and has been automatically commented.

'   If File.ReadLine(configfile, 3) = "" And File.ReadLine(configfile, 9) = "" And File.ReadLine(configfile, 15) = "" And File.ReadLine(configfile, 21) = "" Then

    TextWindow.CursorTop = 11

    TextWindow.CursorLeft = 27

    TextWindow.Write("There are no accounts yet.")

    TextWindow.CursorTop = 13

    TextWindow.CursorLeft = 22

    TextWindow.WriteLine("Enter new username:")

    TextWindow.CursorLeft = 22

    TextWindow.ForegroundColor = "DarkGray"

    TextWindow.WriteLine("Enter new password:")

    TextWindow.ForegroundColor = "White"

    TextWindow.CursorTop = 13

    TextWindow.CursorLeft = 42

    newusername = TextWindow.Read()

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, 3, newusername) 'the config file is fully empty, hence ln03

    ln = 4

    TextWindow.ForegroundColor = "DarkGray"

    TextWindow.CursorTop = 13

    TextWindow.CursorLeft = 22

    TextWindow.WriteLine("Enter new username: " + newusername)

    TextWindow.ForegroundColor = "White"

    TextWindow.CursorLeft = 22

    TextWindow.Write("Enter new password: ")

    newpassword = TextWindow.Read()

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, ln, newpassword)

    TextWindow.CursorTop = 14

    TextWindow.CursorLeft = 22

    TextWindow.ForegroundColor = "DarkGray"

    TextWindow.Write("Enter new password: " + newpassword)

    

    ln = ln + 1

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, ln, "DarkBlue")

    ln = ln + 1

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, ln, "White")

    ln = ln - 2

    

    TextWindow.CursorTop = 11

    TextWindow.CursorLeft = 22

    TextWindow.ForegroundColor = "Green"

    TextWindow.WriteLine("              Success!              ")

    TextWindow.CursorLeft = 22

    TextWindow.Write("       You are now logged in.")

    Program.Delay(2000)

    background()

    proglist()

' The following line could be harmful and has been automatically commented.

'   ElseIf File.ReadLine(configfile, 3) = "" Or File.ReadLine(configfile, 9) = "" Or File.ReadLine(configfile, 15) = "" Or File.ReadLine(configfile, 21) = "" Then

    TextWindow.CursorTop = 11

    TextWindow.CursorLeft = 29

    TextWindow.Write("New user account setup")

    TextWindow.CursorTop = 13

    TextWindow.CursorLeft = 22

    TextWindow.WriteLine("Enter new username:")

    TextWindow.CursorLeft = 22

    TextWindow.WriteLine("Enter new password:")

    TextWindow.CursorTop = 13

    TextWindow.CursorLeft = 42

    newusername = TextWindow.Read()

    

    'check for empty userpass slot

' The following line could be harmful and has been automatically commented.

'     If File.ReadLine(configfile, 3) = "" Then

' The following line could be harmful and has been automatically commented.

'       File.WriteLine(configfile, 3, newusername)

      ln = 4

' The following line could be harmful and has been automatically commented.

'     ElseIf File.ReadLine(configfile, 9) = "" Then

' The following line could be harmful and has been automatically commented.

'       File.WriteLine(configfile, 9, newusername)

      ln = 10

' The following line could be harmful and has been automatically commented.

'     ElseIf File.ReadLine(configfile, 15) = "" Then

' The following line could be harmful and has been automatically commented.

'       File.WriteLine(configfile, 15, newusername)

      ln = 16

    Else

' The following line could be harmful and has been automatically commented.

'       File.WriteLine(configfile, 21, newusername)

      ln = 22

    EndIf

    TextWindow.CursorLeft = 42

    newpassword = TextWindow.Read()

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, ln, newpassword)

    

    ln = ln + 1

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, ln, "DarkBlue")

    ln = ln + 1

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, ln, "White")

    ln = ln - 2

    

    TextWindow.CursorTop = 11

    TextWindow.CursorLeft = 22

    TextWindow.Write("              Success!             ")

    Program.Delay(2000)

    background()

    prompt()

  Else

    TextWindow.CursorTop = 11

    TextWindow.CursorLeft = 29

    TextWindow.Write("Account limit reached!")

    TextWindow.CursorTop = 13

    TextWindow.CursorLeft = 24

    TextWindow.WriteLine("Only four accounts are allowed.")

    TextWindow.CursorLeft = 27

    TextWindow.Write("Press ENTER to continue...")

    TextWindow.Read()

    background()

    prompt()

  EndIf

EndSub



Sub loginbox

  'reset colour config

  backgroundcolor = "DarkBlue"

  foregroundcolor = "White"

  

  background() 'required -- loginbox() may be invoked through user logout

  'TextWindow.Write("loginbox")

  

  TextWindow.CursorTop = 9

  TextWindow.CursorLeft = 26

  TextWindow.WriteLine("?îå?????????????????????????????????????????????????????îê")

  TextWindow.CursorLeft = 26

  TextWindow.WriteLine("?îÇ       WinDOS v1.1        ?îÇ")

  TextWindow.CursorLeft = 26

  TextWindow.WriteLine("?îú?????????????????????????????????????????????????????î§")

  TextWindow.CursorLeft = 26

  TextWindow.WriteLine("?îÇ                          ?îÇ")

  TextWindow.CursorLeft = 26

  TextWindow.WriteLine("?îÇ                          ?îÇ")

  TextWindow.CursorLeft = 26

  TextWindow.WriteLine("?îî?????????????????????????????????????????????????????îò")

  TextWindow.CursorTop = 12

  TextWindow.CursorLeft = 27

  TextWindow.WriteLine("Username:")

  TextWindow.CursorLeft = 27

  TextWindow.ForegroundColor = "DarkGray"

  TextWindow.WriteLine("Password:")

  TextWindow.ForegroundColor = "White"

  TextWindow.CursorTop = 12

  TextWindow.CursorLeft = 37

  usernameprompt = TextWindow.Read()

  TextWindow.CursorTop = 12

  TextWindow.CursorLeft = 27

  TextWindow.ForegroundColor = "DarkGray"

  TextWindow.WriteLine("Username: " + usernameprompt)

' The following line could be harmful and has been automatically commented.

'   If File.ReadLine(configfile, 3) <> usernameprompt And File.ReadLine(configfile, 9) <> usernameprompt And File.ReadLine(configfile, 15) <> usernameprompt And File.ReadLine(configfile, 21) <> usernameprompt Then

    TextWindow.CursorTop = 15

    TextWindow.CursorLeft = 32

    TextWindow.ForegroundColor = "Yellow"

    TextWindow.Write("No such username")

    Program.Delay(1000)

    TextWindow.CursorLeft = "32"

    TextWindow.Write("                ") 'blank out the message

    loginbox()

    

  Else

    'match username to password

' The following line could be harmful and has been automatically commented.

'     If File.ReadLine(configfile, 3) = usernameprompt Then

      ln = 4

' The following line could be harmful and has been automatically commented.

'     ElseIf File.ReadLine(configfile, 9) = usernameprompt Then

      ln = 10

' The following line could be harmful and has been automatically commented.

'     ElseIf File.ReadLine(configfile, 15) = usernameprompt Then

      ln = 16

    Else 'it is assumed that the username is in ln21 (slot 4)

      ln = 22

    EndIf

  

    TextWindow.ForegroundColor = "White"

    TextWindow.CursorLeft = 27

    TextWindow.Write("Password: ")

    passwordprompt = TextWindow.Read()

    TextWindow.CursorTop = 13

    TextWindow.CursorLeft = 27

    TextWindow.ForegroundColor = "DarkGray"

    TextWindow.Write("Password: " + passwordprompt)

' The following line could be harmful and has been automatically commented.

'     If File.ReadLine(configfile, ln) <> passwordprompt Then

      TextWindow.CursorTop = 15

      TextWindow.CursorLeft = 31

      TextWindow.ForegroundColor = "Yellow"

      TextWindow.Write("Incorrect password")

      Program.Delay(1000)

      TextWindow.CursorLeft = "31"

      TextWindow.Write("                  ") 'blank out the message

      loginbox()

    Else

      TextWindow.CursorTop = 15

      TextWindow.CursorLeft = 32

      TextWindow.ForegroundColor = "Green"

      TextWindow.Write("Login successful")

      Program.Delay(1000)

      ln = ln + 1

' The following line could be harmful and has been automatically commented.

'       If File.ReadLine(configfile, ln) = "Black" Or File.ReadLine(configfile, ln) = "Blue" Or File.ReadLine(configfile, ln) = "Cyan" Or File.ReadLine(configfile, ln) = "Gray" Or File.ReadLine(configfile, ln) = "Green" Or File.ReadLine(configfile, ln) = "Magenta" Or File.ReadLine(configfile, ln) = "Red" Or File.ReadLine(configfile, ln) = "White" Or File.ReadLine(configfile, ln) = "Yellow" Or File.ReadLine(configfile, ln) = "DarkBlue" Or File.ReadLine(configfile, ln) = "DarkCyan" Or File.ReadLine(configfile, ln) = "DarkGray" Or File.ReadLine(configfile, ln) = "DarkGreen" Or File.ReadLine(configfile, ln) = "DarkMagenta" Or File.ReadLine(configfile, ln) = "DarkRed" Or File.ReadLine(configfile, ln) = "DarkYellow" Then

' The following line could be harmful and has been automatically commented.

'         backgroundcolor = File.ReadLine(configfile, ln)

        TextWindow.BackgroundColor = backgroundcolor

      Else

        configformaterr()

      EndIf

      ln = ln + 1

' The following line could be harmful and has been automatically commented.

'       If File.ReadLine(configfile, ln) = "Black" Or File.ReadLine(configfile, ln) = "Blue" Or File.ReadLine(configfile, ln) = "Cyan" Or File.ReadLine(configfile, ln) = "Gray" Or File.ReadLine(configfile, ln) = "Green" Or File.ReadLine(configfile, ln) = "Magenta" Or File.ReadLine(configfile, ln) = "Red" Or File.ReadLine(configfile, ln) = "White" Or File.ReadLine(configfile, ln) = "Yellow" Or File.ReadLine(configfile, ln) = "DarkBlue" Or File.ReadLine(configfile, ln) = "DarkCyan" Or File.ReadLine(configfile, ln) = "DarkGray" Or File.ReadLine(configfile, ln) = "DarkGreen" Or File.ReadLine(configfile, ln) = "DarkMagenta" Or File.ReadLine(configfile, ln) = "DarkRed" Or File.ReadLine(configfile, ln) = "DarkYellow" Then

' The following line could be harmful and has been automatically commented.

'         foregroundcolor = File.ReadLine(configfile, ln)

        TextWindow.ForegroundColor = foregroundcolor

      Else

        configformaterr()

      EndIf

      

      ln = ln - 2

      background()

      proglist()

    EndIf

  EndIf

EndSub



Sub configformaterr

  backgroundcolor = "DarkRed"

  foregroundcolor = "White"

  background()

  TextWindow.CursorTop = 8

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îå???????????????????????????????????????????????????????????????????????????îê")

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îÇ  Configuration file format error!   ?îÇ")

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îú???????????????????????????????????????????????????????????????????????????î§")

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îÇ                                     ?îÇ") 'background/foreground?

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îÇ                                     ?îÇ") 'reset notification

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îÇ                                     ?îÇ")

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îÇ                                     ?îÇ") 'prompt

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îî???????????????????????????????????????????????????????????????????????????îò")

  TextWindow.CursorTop = 11

  TextWindow.CursorLeft = 21

  If ln = 5 Or ln = 11 Or ln = 17 Or ln = 23 Then

    TextWindow.WriteLine("The set background colour is invalid.")

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, ln, "DarkBlue")

    ln = ln + 1

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, ln, "White")

    ln = ln - 1

  Else

    TextWindow.WriteLine("The set foreground colour is invalid.")

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, ln, "White")

    ln = ln - 1

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, ln, "DarkBlue")

    ln = ln + 1

  EndIf

  TextWindow.CursorLeft = 23

  TextWindow.Write("The colour scheme will be reset.")

  TextWindow.CursorTop = 14

  TextWindow.CursorLeft = 26

  TextWindow.Write("Press ENTER to continue...")

  TextWindow.Read()

  backgroundcolor = "DarkBlue"

  foregroundcolor = "White"

EndSub



Sub proglist

  TextWindow.Write("Programs available:                     Commands available:                     ")

  Program.Delay(50)

  TextWindow.Write("TimeDate                                about                                   ")

  Program.Delay(50)

  TextWindow.Write("Calculator                              colorsetup                              ")

  Program.Delay(50)

  TextWindow.Write("GoodMornAftEve                          logout                                  ")

  Program.Delay(50)

  TextWindow.Write("DecToBin                                newuser                                 ")

  Program.Delay(50)

  TextWindow.Write("                                                                                ")

  Program.Delay(50)

  TextWindow.Write("Programs and commands are case-sensitive.                                       ")

  Program.Delay(50)

  TextWindow.Write("                                                                                ")

  Program.Delay(50)

  TextWindow.Write("To display this list again, type in 'list'.                                     ")

  Program.Delay(50)

  TextWindow.Write("                                                                                ")

  Program.Delay(50)

  prompt()

EndSub



Sub prompt

  TextWindow.Write("C:\>")

  promptinput = TextWindow.Read()

  If promptinput = "TimeDate" Then

    TimeDate()

  ElseIf promptinput = "Calculator" Then

    Calculator()

  ElseIf promptinput = "GoodMornAftEve" Then

    GoodMornAftEve()

  ElseIf promptinput = "DecToBin" Then

    DecToBin()

  ElseIf promptinput = "about" Then

    about()

  ElseIf promptinput = "colorsetup" Then

    colorsetup()

  ElseIf promptinput = "logout" Then

    loginbox()

  ElseIf promptinput = "newuser" Then

    newuserbox()

  ElseIf promptinput = "list" Then

    background()

    proglist()

  Else

    TextWindow.BackgroundColor = foregroundcolor

    TextWindow.ForegroundColor = backgroundcolor

    TextWindow.WriteLine("No such program or command.")

    TextWindow.BackgroundColor = backgroundcolor

    TextWindow.ForegroundColor = foregroundcolor

    prompt()

  EndIf

EndSub



Sub TimeDate

  TextWindow.WriteLine("Today's date is " + Clock.Date)

  TextWindow.WriteLine("The time now is " + Clock.Time)

  prompt()

EndSub



Sub Calculator

  background()

  TextWindow.BackgroundColor = foregroundcolor

  TextWindow.ForegroundColor = backgroundcolor

  TextWindow.Write("+-√ó√∑                            Basic calculator                            +-√ó√∑")

  TextWindow.BackgroundColor = backgroundcolor

  TextWindow.ForegroundColor = foregroundcolor

  TextWindow.WriteLine("")

  TextWindow.WriteLine("How to use this program:")

  TextWindow.WriteLine("1. Type in 'add', 'subtract', 'multiply' or 'divide'. Press ENTER.")

  TextWindow.WriteLine("2. Type in the first number. Press ENTER.")

  TextWindow.WriteLine("3. Type in the second number. Press ENTER for the answer.")

  TextWindow.WriteLine("")

  TextWindow.WriteLine("When you are done, type in 'exit'.")

  TextWindow.WriteLine("")

  calculatoroperation()

EndSub



Sub GoodMornAftEve

  TopLeft()

  If (Clock.Hour < 12) Then

    TextWindow.BackgroundColor = "DarkBlue"

    TextWindow.ForegroundColor = "White"

    TextWindow.Write(" ?ñà?ñà?ñà?ñà                                                                 *         ")

    TextWindow.Write(" ?ñà?ñà?ñà?ñà                                  *                                        ")

    TextWindow.Write(" ?ñà?ñà?ñà?ñà          *                                                                ")

    TextWindow.Write("                                                                                ")

    TextWindow.Write("                              *                    *                            ") 'ln05

    TextWindow.Write("                                                                                ")

    TextWindow.Write("          *                                                                     ")

    TextWindow.Write("                                         *                                      ")

    TextWindow.Write("                                                                                ")

    TextWindow.Write("                                                                                ") 'ln10

    TextWindow.Write("     *                                                             *            ")

    TextWindow.Write("                               *                                                ")

    TextWindow.Write("                                      ?îå?????????îê                                    ")

    TextWindow.Write("                                      ?îÇ?ñ† ?ñ† ?îÇ                                    ")

    TextWindow.Write("         ?îå???????????îê  ?îå???????????îê             ?îÇ  ?ñ†?ñ†?îÇ                                    ") 'ln15

    TextWindow.Write("         ?îÇ?ñ†?ñ† ?ñ† ?îÇ  ?îÇ ?ñ†  ?ñ†?îÇ             ?îÇ ?ñ† ?ñ†?îÇ?îå?????????îê ?îå?????????îê                       ")

    TextWindow.Write("?????????îê    ?îÇ ?ñ† ?ñ† ?îÇ  ?îÇ?ñ†?ñ†?ñ†  ?îÇ             ?îÇ?ñ†?ñ†?ñ† ?îÇ?îÇ?ñ†?ñ†  ?îÇ ?îÇ  ?ñ† ?îÇ             ?îå???????????????îê ")

    TextWindow.Write("?ñ†  ?ñ†?îÇ    ?îÇ?ñ†  ?ñ†?ñ†?îÇ  ?îÇ?ñ† ?ñ†?ñ† ?îÇ             ?îÇ  ?ñ† ?îÇ?îÇ ?ñ† ?ñ†?îÇ ?îÇ ?ñ†?ñ†?ñ†?îÇ             ?îÇ ?ñ† ?ñ†?ñ†  ?îÇ ")

    TextWindow.Write("?ñ† ?ñ† ?îÇ    ?îÇ?ñ†    ?îÇ  ?îÇ ?ñ†  ?ñ†?îÇ             ?îÇ ?ñ†  ?îÇ?îÇ?ñ†   ?îÇ ?îÇ?ñ†  ?ñ†?îÇ             ?îÇ?ñ†   ?ñ†  ?îÇ ")

    TextWindow.Write(" ?ñ†  ?îÇ    ?îÇ ?ñ†   ?îÇ  ?îÇ ?ñ†   ?îÇ             ?îÇ ?ñ†?ñ† ?îÇ?îÇ?ñ†?ñ†?ñ† ?îÇ ?îÇ ?ñ†  ?îÇ             ?îÇ      ?ñ†?îÇ ") 'ln20

    TextWindow.Write("?????????î¥?????????î¥???????????î¥?????î¥???????????î¥???????????????????????????î¥?????????î¥?î¥?????????î¥???î¥?????????î¥???????????????????????????î¥???????????????î¥??")

    TextWindow.Write("                                ?îå???????????????????????????îê                                 ")

    TextWindow.Write("                                ?îÇGood morning!?îÇ                                 ")

    TextWindow.Write("                                ?îî???????????????????????????îò                                 ")

    TextWindow.Write("                                                                                ") 'ln25

  ElseIf (Clock.Hour >= 12 And Clock.Hour < 18) Then

    TextWindow.BackgroundColor = "DarkYellow"

    TextWindow.ForegroundColor = "White"

    TextWindow.Write(" ?ñà?ñà?ñà?ñà                                                                           ")

    TextWindow.Write(" ?ñà?ñà?ñà?ñà                                                                           ")

    TextWindow.Write(" ?ñà?ñà?ñà?ñà         ?ñí?ñí?ñí?ñí?ñí                    ?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí                                ")

    TextWindow.Write("          ?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí             ?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí                        ")

    TextWindow.Write("            ?ñí?ñí?ñí?ñí?ñí?ñí?ñí                 ?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí                        ") 'ln05

    TextWindow.Write("                                          ?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí                           ")

    TextWindow.Write("                                                                                ")

    TextWindow.Write("                                                                                ")

    TextWindow.Write("                                                                                ")

    TextWindow.Write("                                                                                ") 'ln10

    TextWindow.Write("                                                                                ")

    TextWindow.Write("                                                                                ")

    TextWindow.Write("                                      ?îå?????????îê                                    ")

    TextWindow.Write("                                      ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ                                    ")

    TextWindow.Write("         ?îå???????????îê  ?îå???????????îê             ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ                                    ") 'ln15

    TextWindow.Write("         ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ  ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ?îå?????????îê ?îå?????????îê                       ")

    TextWindow.Write("?????????îê    ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ  ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ             ?îå???????????????îê ")

    TextWindow.Write("?ñ†?ñ†?ñ†?ñ†?îÇ    ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ  ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ ")

    TextWindow.Write("?ñ†?ñ†?ñ†?ñ†?îÇ    ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ  ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ ")

    TextWindow.Write("?ñ†?ñ†?ñ†?ñ†?îÇ    ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ  ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ ") 'ln20

    TextWindow.Write("?????????î¥?????????î¥???????????î¥?????î¥???????????î¥???????????????????????????î¥?????????î¥?î¥?????????î¥???î¥?????????î¥???????????????????????????î¥???????????????î¥??")

    TextWindow.Write("                               ?îå???????????????????????????????îê                                ")

    TextWindow.Write("                               ?îÇGood afternoon!?îÇ                                ")

    TextWindow.Write("                               ?îî???????????????????????????????îò                                ")

    TextWindow.Write("                                                                                ") 'ln25

  Else

    TextWindow.BackgroundColor = "DarkRed"

    TextWindow.ForegroundColor = "White"

    TextWindow.Write("                                                                      *         ")

    TextWindow.Write("                                           ?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí                           ")

    TextWindow.Write("                                     ?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí                        ")

    TextWindow.Write("                                       ?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí?ñí                               ")

    TextWindow.Write("                              *                                                 ") 'ln05

    TextWindow.Write("                                                                                ")

    TextWindow.Write("                                                                                ")

    TextWindow.Write("                                                                                ")

    TextWindow.Write("          *                                                                     ")

    TextWindow.Write("                                                                                ") 'ln10

    TextWindow.Write("                                                                   *            ")

    TextWindow.Write("                                                                                ")

    TextWindow.Write("                                      ?îå?????????îê                                    ")

    TextWindow.Write("                                      ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ                                    ")

    TextWindow.Write("         ?îå???????????îê  ?îå???????????îê             ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ                                    ") 'ln15

    TextWindow.Write("         ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ  ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ?îå?????????îê ?îå?????????îê                       ")

    TextWindow.Write("?????????îê    ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ  ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ             ?îå???????????????îê ")

    TextWindow.Write("?ñ†?ñ†?ñ†?ñ†?îÇ    ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ  ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ ")

    TextWindow.Write("?ñ†?ñ†?ñ†?ñ†?îÇ    ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ  ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ ")

    TextWindow.Write("?ñ†?ñ†?ñ†?ñ†?îÇ    ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ  ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ       ?ñà?ñà?ñà?ñà  ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ ?îÇ?ñ†?ñ†?ñ†?ñ†?îÇ             ?îÇ?ñ†?ñ†?ñ†?ñ†?ñ†?ñ†?ñ†?îÇ ") 'ln20

    TextWindow.Write("?????????î¥?????????î¥???????????î¥?????î¥???????????î¥???????????????????????????î¥?????????î¥?î¥?????????î¥???î¥?????????î¥???????????????????????????î¥???????????????î¥??")

    TextWindow.Write("                                ?îå???????????????????????????îê                                 ")

    TextWindow.Write("                                ?îÇGood evening!?îÇ                                 ")

    TextWindow.Write("                                ?îî???????????????????????????îò                                 ")

    TextWindow.Write("                                                                                ") 'ln25

  EndIf

  TopLeft() 'necessary to prevent scrolling off

  TextWindow.CursorTop = 24

  TextWindow.CursorLeft = 27

  TextWindow.Write("Press ENTER to continue...")

  TextWindow.Read()

  TextWindow.BackgroundColor = backgroundcolor

  TextWindow.ForegroundColor = foregroundcolor

  background()

  prompt()

EndSub



Sub DecToBin

  background()

  TextWindow.BackgroundColor = foregroundcolor

  TextWindow.ForegroundColor = backgroundcolor

  TextWindow.Write("01001101                  Decimal-to-binary converter                   10100111")

  TextWindow.BackgroundColor = backgroundcolor

  TextWindow.ForegroundColor = foregroundcolor

  TextWindow.WriteLine("")

  TextWindow.WriteLine("When you are done, type in 'exit'.")

  TextWindow.WriteLine("")

  dectobinprompt()

EndSub



Sub about

  TopLeft()

  TextWindow.Write("?îå?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????îê")

  TextWindow.Write("?îÇ                                 About WinDOS                                 ?îÇ")

  TextWindow.Write("?îú?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????î§")

  TextWindow.Write("?îÇ   ?ñì?ñà?ñà?ñà?ñà?ñà??à‚ñà?ñà?ñà   WinDOS, version 1.1                                           ?îÇ")

  TextWindow.Write("?îÇ ?ñë?ñí ?ñà   ?ñà   ?ñà                                                                 ?îÇ") 'ln05

  TextWindow.Write("?îÇ    ?ñà   ?ñà   ?ñà   This program is a simulation of a multi-user OS environment.  ?îÇ")

  TextWindow.Write("?îÇ    ?ñà   ?ñà   ?ñà                                                                 ?îÇ")

  TextWindow.Write("?îÇ   ?ñì?ñà?ñà?ñà?ñà?ñà?ñà?ñà?ñà?ñà   Changes made in this version:                                 ?îÇ")

  TextWindow.Write("?îÇ ?ñë?ñí ?ñà   ?ñà   ?ñà    - User information is stored in a separate file.             ?îÇ")

  TextWindow.Write("?îÇ    ?ñà   ?ñà   ?ñà    - Four users can be set up with custom username and password.?îÇ") 'ln10

  TextWindow.Write("?îÇ    ?ñà   ?ñà   ?ñà    - More CLI graphics!                                         ?îÇ")

  TextWindow.Write("?îÇ   ?ñì?ñà?ñà?ñà?ñà?ñà?ñà?ñà?ñà?ñà    - Users can change colours, which will be saved to the file. ?îÇ")

  TextWindow.Write("?îÇ ?ñë?ñí                                                                           ?îÇ")

  TextWindow.Write("?îÇ                Known issues:                                                 ?îÇ")

  TextWindow.Write("?îÇ                 - Users can log in with a blank username and password.       ?îÇ") 'ln15

  TextWindow.Write("?îÇ                 - Users with identical usernames are accepted.               ?îÇ")

  TextWindow.Write("?îÇ                 - The four-user cap.                                         ?îÇ")

  TextWindow.Write("?îÇ                                                                              ?îÇ")

  TextWindow.Write("?îÇ                                                                              ?îÇ")

  TextWindow.Write("?îÇ                Made by Eduard Popov, using Microsoft Small Basic.            ?îÇ") 'ln20

  TextWindow.Write("?îÇ                Twitter: @0x64hacker117                                       ?îÇ")

  TextWindow.Write("?îÇ                Tumblr: theotherosproject.tumblr.com                          ?îÇ")

  TextWindow.Write("?îÇ                                                                              ?îÇ")

  TextWindow.Write("?îÇ                        This isn't even my final form.                        ?îÇ")

  TextWindow.Write("?îî?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????îò") 'ln25

  TopLeft()

  TextWindow.CursorTop = 23

  TextWindow.CursorLeft = 55

  TextWindow.Read()

  background()

  prompt()

EndSub



Sub colorsetup

  background()

  TextWindow.WriteLine("Available colours:")

  TextWindow.Write("White    Gray      Red      Green      Blue      Yellow      Cyan      Magenta  ")

  TextWindow.Write("Black  DarkGray  DarkRed  DarkGreen  DarkBlue  DarkYellow  DarkCyan  DarkMagenta")

  TextWindow.CursorTop = 8

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îå?????????????????????????????????????????????????????????????????????????????îê")

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îÇ             Colour setup             ?îÇ")

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îú?????????????????????????????????????????????????????????????????????????????î§")

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îÇ                                      ?îÇ") 'current bgcolor

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îÇ                                      ?îÇ") 'current fgcolor

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îÇ                                      ?îÇ")

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îÇ                                      ?îÇ") 'new bgcolor

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îÇ                                      ?îÇ") 'newfgcolor

  TextWindow.CursorLeft = 20

  TextWindow.WriteLine("?îî?????????????????????????????????????????????????????????????????????????????îò")

  TextWindow.CursorTop = 11

  TextWindow.CursorLeft = 21

  TextWindow.WriteLine("Current background colour: " + backgroundcolor)

  TextWindow.CursorLeft = 21

  TextWindow.Write("Current foreground colour: " + foregroundcolor)

  TextWindow.CursorTop = 14

  TextWindow.CursorLeft = 21

  TextWindow.WriteLine("New background colour:")

  TextWindow.CursorLeft = 21

  TextWindow.Write("New foreground colour:")

  TextWindow.CursorTop = 14

  TextWindow.CursorLeft = 44

  newbackgroundcolor = TextWindow.Read()

  If newbackgroundcolor = "Black" Or newbackgroundcolor = "Blue" Or newbackgroundcolor = "Cyan" Or newbackgroundcolor = "Gray" Or newbackgroundcolor = "Green" Or newbackgroundcolor = "Magenta" Or newbackgroundcolor = "Red" Or newbackgroundcolor = "White" Or newbackgroundcolor = "Yellow" Or newbackgroundcolor = "DarkBlue" Or newbackgroundcolor = "DarkCyan" Or newbackgroundcolor = "DarkGray" Or newbackgroundcolor = "DarkGreen" Or newbackgroundcolor = "DarkMagenta" Or newbackgroundcolor = "DarkRed" Or newbackgroundcolor = "DarkYellow" Then

    TextWindow.CursorLeft = 44

    newforegroundcolor = TextWindow.Read()

  Else

    TextWindow.CursorTop = 17

    TextWindow.CursorLeft = 33

    TextWindow.Write("Invalid colour")

    Program.Delay(1000)

    colorsetup()

  EndIf

  If newforegroundcolor = "Black" Or newforegroundcolor = "Blue" Or newforegroundcolor = "Cyan" Or newforegroundcolor = "Gray" Or newforegroundcolor = "Green" Or newforegroundcolor = "Magenta" Or newforegroundcolor = "Red" Or newforegroundcolor = "White" Or newforegroundcolor = "Yellow" Or newforegroundcolor = "DarkBlue" Or newforegroundcolor = "DarkCyan" Or newforegroundcolor = "DarkGray" Or newforegroundcolor = "DarkGreen" Or newforegroundcolor = "DarkMagenta" Or newforegroundcolor = "DarkRed" Or newforegroundcolor = "DarkYellow" Then

    ln = ln + 1

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, ln, newbackgroundcolor)

    backgroundcolor = newbackgroundcolor

    ln = ln + 1

' The following line could be harmful and has been automatically commented.

'     File.WriteLine(configfile, ln, newforegroundcolor)

    foregroundcolor = newforegroundcolor

    ln = ln - 2

    

    background()

    prompt()

  Else

    TextWindow.CursorTop = 17

    TextWindow.CursorLeft = 33

    TextWindow.Write("Invalid colour")

    Program.Delay(1000)

    colorsetup()

  EndIf

EndSub



'!! This subroutine has problems.

'Sub colorapply

'  If newcolorapply = "" Then

'    oldbackgroundcolor = backgroundcolor

'    oldforegroundcolor = foregroundcolor

'    

'    backgroundcolor = newbackgroundcolor

'    foregroundcolor = newforegroundcolor

'  EndIf

'  

'  background()

'  TextWindow.CursorTop = 8

'  TextWindow.CursorLeft = 20

'  TextWindow.WriteLine("?îå?????????????????????????????????????????????????????????????????????????????îê")

'  TextWindow.CursorLeft = 20

'  TextWindow.WriteLine("?îÇ             Colour setup             ?îÇ")

'  TextWindow.CursorLeft = 20

'  TextWindow.WriteLine("?îú?????????????????????????????????????????????????????????????????????????????î§")

'  TextWindow.CursorLeft = 20

'  TextWindow.WriteLine("?îÇ                                      ?îÇ") 'current bgcolor

'  TextWindow.CursorLeft = 20

'  TextWindow.WriteLine("?îÇ                                      ?îÇ") 'current fgcolor

'  TextWindow.CursorLeft = 20

'  TextWindow.WriteLine("?îÇ                                      ?îÇ") ' "Apply? (y/n) _"

'  TextWindow.CursorLeft = 20

'  TextWindow.WriteLine("?îÇ                                      ?îÇ") 'new bgcolor

'  TextWindow.CursorLeft = 20

'  TextWindow.WriteLine("?îÇ                                      ?îÇ") 'newfgcolor

'  TextWindow.CursorLeft = 20

'  TextWindow.WriteLine("?îî?????????????????????????????????????????????????????????????????????????????îò")

'  TextWindow.CursorTop = 13

'  TextWindow.CursorLeft = 33

'  TextWindow.Write("Apply? (y/n) ")

'  newcolorapply = TextWindow.Read()

'  If newcolorapply = "y" Then

'    ln = ln + 1

' The following line could be harmful and has been automatically commented.

' '    File.WriteLine(configfile, ln, backgroundcolor)

'    ln = ln + 1

' The following line could be harmful and has been automatically commented.

' '    File.WriteLine(configfile, ln, foregroundcolor)

'    ln = ln - 2

'    

'    background()

'    prompt()

'  ElseIf newcolorapply = "n" Then

'    backgroundcolor = oldbackgroundcolor

'    foregroundcolor = oldforegroundcolor

'    colorsetup()

'  Else

'    colorapply()

'  EndIf

'EndSub





'This draws the background -- essentially an osbootscreen() without delays

Sub background

  TopLeft()

  TextWindow.BackgroundColor = backgroundcolor

  TextWindow.ForegroundColor = foregroundcolor

  TextWindow.Write("                                                                                ")

  TextWindow.Write("                                                                                ")

  TextWindow.Write("                                                                                ")

  TextWindow.Write("                                                                                ")

  TextWindow.Write("                                                                                ")  'ln05

  TextWindow.Write("                                                                                ")

  TextWindow.Write("                                                                                ")

  TextWindow.Write("                                                                                ")

  TextWindow.Write("                                                                                ")

  TextWindow.Write("                                                                                ")  'ln10

  TextWindow.Write("                                                                                ")

  TextWindow.Write("                                                                                ")

  TextWindow.Write("                                                                                ")

  TextWindow.Write("                                                                                ")

  TextWindow.Write("                                                                     ?ñì?ñà?ñà?ñà?ñà?ñà?ñà?ñà?ñà?ñà ")  'ln15

  TextWindow.Write("                                                                   ?ñë?ñí ?ñà   ?ñà   ?ñà ")

  TextWindow.Write("                                                                      ?ñà   ?ñà   ?ñà ")

  TextWindow.Write("                                                                      ?ñà   ?ñà   ?ñà ")

  TextWindow.Write("                                                                     ?ñì?ñà?ñà?ñà?ñà?ñà?ñà?ñà?ñà?ñà ")

  TextWindow.Write("                                                                   ?ñë?ñí ?ñà   ?ñà   ?ñà ")  'ln20

  TextWindow.Write("                                                                      ?ñà   ?ñà   ?ñà ")

  TextWindow.Write("                                                                      ?ñà   ?ñà   ?ñà ")

  TextWindow.Write("                                                                     ?ñì?ñà?ñà?ñà?ñà?ñà?ñà?ñà?ñà?ñà ")

  TextWindow.Write("                                                                   ?ñë?ñí           ")

  TextWindow.Write("                                                                                ")  'ln25

  TopLeft()

EndSub





'These function as coordinates.

Sub TopLeft

  TextWindow.CursorTop = 0

  TextWindow.CursorLeft = 0

EndSub





'These subroutines are used for loginscreen().

Sub WinSpace

  Program.Delay(1)

  TextWindow.Write(" ")

EndSub



Sub WinLShade

  Program.Delay(1)

  TextWindow.Write("?ñë")

EndSub



Sub WinMShade

  Program.Delay(1)

  TextWindow.Write("?ñí")

EndSub



Sub WinDShade

  Program.Delay(1)

  TextWindow.Write("?ñì")

EndSub



Sub WinFill

  Program.Delay(1)

  TextWindow.Write("?ñà")

EndSub





'These subroutines are used for Calculator()

Sub calculatoroperation

  operation = TextWindow.Read()

  If operation = "add" Then

    calculatoradd()

  ElseIf operation = "subtract" Then

    calculatorsubtract()

  ElseIf operation = "multiply" Then

    calculatormultiply()

  ElseIf operation = "divide" Then

    calculatordivide()

  ElseIf operation = "exit" Then

    background()

    prompt()

  Else

    TextWindow.WriteLine("Invalid input.")

    calculatoroperation()

  EndIf

EndSub



Sub calculatoradd

  num1 = TextWindow.ReadNumber()

  num2 = TextWindow.ReadNumber()

  ans = num1 + num2

  TextWindow.WriteLine("The answer is " + ans)

  calculatoroperation()

EndSub



Sub calculatorsubtract

  num1 = TextWindow.ReadNumber()

  num2 = TextWindow.ReadNumber()

  ans = num1 - num2

  TextWindow.WriteLine("The answer is " + ans)

  calculatoroperation()

EndSub



Sub calculatormultiply

  num1 = TextWindow.ReadNumber()

  num2 = TextWindow.ReadNumber()

  ans = num1 * num2

  TextWindow.WriteLine("The answer is " + ans)

  calculatoroperation()

EndSub



Sub calculatordivide

  num1 = TextWindow.ReadNumber()

  num2 = TextWindow.ReadNumber()

  If num2 = 0 Then

    TextWindow.WriteLine("Error: Division by zero.")

  Else

    ans = num1 / num2

    TextWindow.WriteLine("The answer is " + ans)

  EndIf

  calculatoroperation()

EndSub





'These subroutines are used for DecToBin()

Sub dectobinprompt

  TextWindow.Write("Enter number in decimal: ")

  decimal = TextWindow.Read()

  If decimal = "exit" Then

    background()

    prompt()

  ElseIf decimal > 255 Or decimal < 0 Then

    TextWindow.WriteLine("Please enter a value between 0 and 255, both inclusive.")

    dectobinprompt()

  Else

    dectobinconvert()

    dectobinprompt()

  EndIf

EndSub



Sub dectobinconvert

  bitvalue = 128

  TextWindow.Write(decimal + " in binary is ")

  For i = 1 To 8

    If decimal >= bitvalue Then

      TextWindow.Write("1")

      decimal = decimal - bitvalue

    Else

      TextWindow.Write("0")

    EndIf

    bitvalue = bitvalue / 2

  EndFor

  TextWindow.WriteLine("")

EndSub


