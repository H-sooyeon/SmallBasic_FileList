'Tron game
'Daniel Stokes

'Initiates Game
Init()
StartMenu()
'Events
GraphicsWindow.KeyDown = Change_Key
Controls.ButtonClicked = Start_Game
GraphicsWindow.MouseUp = Change_Speed
'Plays the game continuously
While Game_Stop = "False"
While Play_Game = "True" 
Play()
EndWhile
Program.Delay(10)
EndWhile
Program.End()
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Init 

  'Variable reset
  Speed = 100                       'Speed of game
  Player_Crashed = "False"          'Check if player is crashed
  Computer_Crashed = "False"        'Check if Computer is Crashed
  Play_Game = "False"               'Used in game loop
  Game_Stop = "False"               'Used in game loop
  First_Go = "True"                 'Used when moving the player
  Score_Comp = 0                    'Stores the computer's score
  Score_Player = 0                  'Stores the player's score
  Last_Input = "None"               'Used when moving the player
  Direction = "Left"                'Used when moving the player
  Direction_Comp = 1                'Used when moving the computer
  Move_No = 0                       'Contains info on how many times the player has moved
  Player_X = 800                    'Contains Player's X co-ordinate
  Player_Y = 375                    'Contains Player's Y co-ordinate
  Computer_X = 200                  'Contains Computer's X co-ordinate
  Computer_Y = 375                  'Contains Computer's Y co-ordinate
  GW_Height = 745                   'Conatins the size of the GW
  GW_Width = 1000                   'Conatins the size of the GW
  Settings = "False"                'Used for changing the speed
  Slow_Opacity = 0                  'Used for changing the speed
  Medium_Opacity = 0                'Used for changing the speed
  Fast_Opacity = 0                  'Used for changing the speed
  Extreme_Opacity = 0               'Used for changing the speed
  Turbo = "False"                   'Used for controlling the Turbo
  Turbo_No = 3                      'Used for controlling the Turbo
  Turbo_Timer = 10                  'Used for controlling the Turbo
  Turbo_Run = 1                     'Used for controlling the Turbo
  Written = "False"                 'Used for writing high scores
  Difficulty_Bonus = 20             'Stores the bonus multiplier for different speeds
  Score = 0                         'Stores the player's high score value
  Pause = "False"                   'Used for Pausing game
  High_Score_File = "P:/High Scores.docx"                      'File Path to save folder
  Logo_Path = "P:/Small Basic Programs/Tron/Tron Logo.png"     'File Path to logo image
  
  'Graphics window config
  GraphicsWindow.BackgroundColor = "Black"
  GraphicsWindow.Width = GW_Width
  GraphicsWindow.Height = GW_Height  
  GraphicsWindow.Top = 150
  GraphicsWindow.Left = 450
  GraphicsWindow.Title = "Tron Game"
  GraphicsWindow.CanResize = "False"
  
  'Outer Wall
  GraphicsWindow.PenWidth = 10
  GraphicsWindow.PenColor = "PaleTurquoise"
  GraphicsWindow.DrawRectangle(5, 40,  GW_Width, GW_Height - 35)
  
  'Score
  GraphicsWindow.BrushColor = "Yellow"
  GraphicsWindow.FontSize = 20
  cScore_Display = Shapes.AddText("Computer : " + Score_Comp)
  Shapes.Move(cScore_Display, 10, 5)
  GraphicsWindow.BrushColor = "Cyan"
  pScore_Display = Shapes.AddText("You : " + Score_Player)
  Shapes.Move(pScore_Display, GW_Width - 90, 5)
  
  'Turbo
  GraphicsWindow.FontSize = 20
  GraphicsWindow.DrawBoundText(GW_Width / 2 - 190, 10, 120, "Turbos ")
  Turbo_1 = Shapes.AddText("I")
  Turbo_2 = Shapes.AddText("I")
  Turbo_3 = Shapes.AddText("I")
  Shapes.Move(Turbo_1, GW_Width / 2 - 110, 10)
  Shapes.Move(Turbo_2, GW_Width / 2 - 100, 10)
  Shapes.Move(Turbo_3, GW_Width / 2 - 90, 10)
  GraphicsWindow.FontSize = 20
  
  'Speed
  GraphicsWindow.DrawBoundText(GW_Width / 2 + 20, 10, 120, "Speed : ")
  Speed_Slow = Shapes.AddText("Slow")
  Speed_Medium = Shapes.AddText("Medium")
  Speed_Fast = Shapes.AddText("Fast")
  Speed_Extreme = Shapes.AddText("Extreme")
  Shapes.Move(Speed_Slow, GW_Width / 2 + 100, 10)
  Shapes.Move(Speed_Medium, GW_Width / 2 + 100, 10)
  Shapes.Move(Speed_Fast, GW_Width / 2 + 100, 10)
  Shapes.Move(Speed_Extreme, GW_Width / 2 + 100, 10)
  Shapes.HideShape(Speed_Slow)
  Shapes.HideShape(Speed_Fast)
  Shapes.HideShape(Speed_Extreme)
  
  'Show Loading Screen
  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.PenColor = "Black"
  Loading_Background = Shapes.AddRectangle(GW_Width + 10, GW_Height + 10)
  GraphicsWindow.BrushColor = "Yellow" 
  Loading_Text = Shapes.AddText("Loading...")
  Shapes.Move(Loading_Text, GW_Width / 2 - 20, GW_Height / 2)
  Tron_Logo = Shapes.AddImage(Logo_Path)
  Shapes.Zoom(Tron_Logo, 0.5, 0.5)
  Shapes.Move(Tron_Logo, -100, -150)
  
 
 
  'Draw grid
  GraphicsWindow.PenColor = "DimGray"
  GraphicsWindow.PenWidth = 1/6
  For t = 45 To GW_Height - 10 Step 10
   For i = 10 To GW_Width - 10 Step 10
     GraphicsWindow.DrawRectangle(i, t, 10, 10)
     Array.SetValue("Grid", i + ", " + t, "Empty")
   EndFor
  EndFor
  
  'Set Player Location
  GraphicsWindow.BrushColor = "Cyan"
  GraphicsWindow.FillRectangle(800, 375, 10, 10)
  Array.SetValue("Grid", "800, 375", "Wall")
  'Set Computer's location
  GraphicsWindow.BrushColor = "Yellow"
  GraphicsWindow.FillRectangle(200, 375, 10, 10)
  Array.SetValue("Grid", "200, 375", "Wall")
  
  'Hide Loading Screen
  Shapes.Remove(Loading_Background)
  Shapes.Remove(Loading_Text)
  Shapes.Remove(Tron_Logo)
EndSub
'/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub StartMenu
  'Opens title screen
  GraphicsWindow.BrushColor = "Black"
  Title_Background = Shapes.AddRectangle(GW_Width + 100, GW_Height + 100)
  Tron_Logo = Shapes.AddImage(Logo_Path)
  Shapes.Zoom(Tron_Logo, 0.5, 0.5)
  Shapes.Move(Tron_Logo, -100, -150)
  
  Start_Game_Button1 = Controls.AddButton("Start Game", GW_Width/2 - 50, GW_Height/2)
  High_Scores_Button = Controls.AddButton("High Scores", GW_Width/2 - 50, GW_Height/2 + 50)
  How_to_Play_Button = Controls.AddButton("How to Play", GW_Width/2 - 50, GW_Height/2 + 100)
  Quit_Game_Button = Controls.AddButton("Quit Game", 20, GW_Height-40)
EndSub
'///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Settings
  'Brings up the settings menu
  Settings = "True"
  Slow_Opacity = 0
  Medium_Opacity = 100
  Fast_Opacity = 0
  Extreme_Opacity = 0
  Difficulty_Bonus = 20
  Main_Menu_Button_2 = Controls.AddButton("Back", 10, 10)
  GraphicsWindow.BrushColor = "Yellow"
  Speed_Text = Shapes.AddText("Speed:")
  Shapes.Move(Speed_Text, GW_Width / 2 - 80, GW_Height / 2)
  Slower_Arrow = Shapes.AddText("<")
  Shapes.Move(Slower_Arrow, GW_Width / 2, GW_Height / 2)
  Faster_Arrow = Shapes.AddText(">")
  Shapes.Move(Faster_Arrow, GW_Width / 2 + 140, GW_Height / 2)
  Slow_Speed_Text = Shapes.AddText("Slow")
  Shapes.Move(Slow_Speed_Text, GW_Width / 2 + 55 , GW_Height / 2)
  Shapes.SetOpacity(Slow_Speed_Text, Slow_Opacity)
  Medium_Speed_Text = Shapes.AddText("Medium")
  Shapes.Move(Medium_Speed_Text, GW_Width / 2 + 35, GW_Height / 2)
  Shapes.SetOpacity(Medium_Speed_Text, Medium_Opacity)
  Fast_Speed_Text = Shapes.AddText("Fast")
  Shapes.Move(Fast_Speed_Text, GW_Width / 2 + 55, GW_Height / 2)
  Shapes.SetOpacity(Fast_Speed_Text, Fast_Opacity)
  Extreme_Speed_Text = Shapes.AddText("Extreme")
  Shapes.Move(Extreme_Speed_Text, GW_Width / 2 + 35, GW_Height / 2)
  Shapes.SetOpacity(Extreme_Speed_Text, Extreme_Opacity)
  GraphicsWindow.BrushColor = "Black"
  Tron_Logo = Shapes.AddImage(Logo_Path)
  Shapes.Zoom(Tron_Logo, 0.5, 0.5)
  Shapes.Move(Tron_Logo, -100, -150)
  Start_Game_Button2 = Controls.AddButton("Start Game", GW_Width/2 - 50, GW_Height/2 + 60)
EndSub
'///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Start_Game
  'Button click detects
  'Start game from Settings
  If Controls.LastClickedButton = Start_Game_Button2 Then
    Play_Game = "True"
    Shapes.Remove(Title_Background)
    Shapes.Remove(Speed_Text)
    Shapes.Remove(Slow_Speed_Text)
    Shapes.Remove(Medium_Speed_Text)
    Shapes.Remove(Fast_Speed_Text)
    Shapes.Remove(Extreme_Speed_Text)
    Shapes.Remove(Slower_Arrow)
    Shapes.Remove(Faster_Arrow)
    Shapes.Remove(Tron_Logo)
    Controls.Remove(Start_Game_Button2)
    Controls.Remove(Main_Menu_Button_2)
    Sound.PlayBellRing()
  'Goes to settings from Main Menu
  ElseIf Controls.LastClickedButton = Start_Game_Button1 Then
    Shapes.Remove(Tron_Logo)
    Controls.Remove(Start_Game_Button1)
    Controls.Remove(High_Scores_Button)
    Controls.Remove(How_to_Play_Button)
    Controls.Remove(Quit_Game_Button)
    Settings()
  'Restart from game over menu
  ElseIf Controls.LastClickedButton = Restart_Button Then
    Shapes.Remove(Restart_Box)
    Shapes.Remove(Game_Over_Text)
    Controls.Remove(Restart_Button)
    Controls.Remove(Main_Menu_Button)
    Controls.Remove(Quit_Game_Button)
    GraphicsWindow.Clear()
    Restart()
   'Continue from pause menu
   ElseIf Controls.LastClickedButton = Continue_Button Then
    Shapes.Remove(Restart_Box)
    Shapes.Remove(Game_Over_Text)
    Controls.Remove(Continue_Button)
    Controls.Remove(Main_Menu_Button)
    Controls.Remove(Quit_Game_Button)
    Play_Game = "True"
    Sound.PlayBellRing()
  'Quit Game
  ElseIf Controls.LastClickedButton = Quit_Game_Button Then
    Program.End()
  'Main menu from pause and game over menus
  ElseIf Controls.LastClickedButton = Main_Menu_Button Then
    Shapes.Remove(Restart_Box)
    Shapes.Remove(Game_Over_Text)
    Controls.Remove(Restart_Button)
    Controls.Remove(Main_Menu_Button)
    Controls.Remove(Quit_Game_Button)
    GraphicsWindow.Clear()
    Medium_Opacity = 100
    Slow_Opacity = 0
    Fast_Opacity = 0
    Extreme_Opacity = 0
    Difficulty_Bonus = 20
    Restart()
    Play_Game = "False"
    StartMenu()
  'Main Menu from Settings and How To Play Screens
  ElseIf Controls.LastClickedButton = Main_Menu_Button_2 Then
    If Settings <> "True" Then
    Shapes.Remove(How_to_Play_Title)
    Shapes.Remove(How_to_Play_Text["Moving"])
    Shapes.Remove(How_to_Play_Text["Turbo"])
    Shapes.Remove(How_to_Play_Text["Objective1"])
    Shapes.Remove(How_to_Play_Text["Objective2"])
    Shapes.Remove(How_to_Play_Text["Objective3"])
    Shapes.Remove(Tron_Logo)
    Shapes.Remove(Title_Background)
    Controls.Remove(Start_Game_Button3)
    Controls.Remove(Main_Menu_Button_2)
    Else
    Shapes.Remove(Speed_Text)
    Shapes.Remove(Slow_Speed_Text)
    Shapes.Remove(Medium_Speed_Text)
    Shapes.Remove(Fast_Speed_Text)
    Shapes.Remove(Extreme_Speed_Text)
    Shapes.Remove(Slower_Arrow)
    Shapes.Remove(Faster_Arrow)
    Shapes.Remove(Tron_Logo)
    Shapes.Remove(Title_Background)
    Controls.Remove(Start_Game_Button2)
    Controls.Remove(Main_Menu_Button_2)
    EndIf
    StartMenu()
  'Go to settings  from How To Play screen
  ElseIf Controls.LastClickedButton = Start_Game_Button3 Then
    Shapes.Remove(How_to_Play_Title)
    Shapes.Remove(How_to_Play_Text["Moving"])
    Shapes.Remove(How_to_Play_Text["Turbo"])
    Shapes.Remove(How_to_Play_Text["Objective1"])
    Shapes.Remove(How_to_Play_Text["Objective2"])
    Shapes.Remove(How_to_Play_Text["Objective3"])
    Controls.Remove(Start_Game_Button3)
    Controls.Remove(Main_Menu_Button_2)
    Settings()
  'Go to Menu from High Scores Screen
  ElseIf Controls.LastClickedButton = High_Scores_Text["Back"] Then
    Shapes.ShowShape(cScore_Display)
    Shapes.ShowShape(pScore_Display)
    Shapes.Remove(High_Scores_Text["Title"])
    Shapes.Remove(High_Scores_Text["Score"])
    For i = 1 To 10
      Shapes.Remove(High_Scores_Text[i])
    EndFor
    Controls.Remove(High_Scores_Text["Reset"])    
    Controls.Remove(High_Scores_Text["Submit"]) 
    Controls.Remove(High_Scores_Text["Back"])
    Shapes.Remove(Title_Background)
    StartMenu() 
  'Opens how to play screen    
  ElseIf Controls.LastClickedButton = How_to_Play_Button Then
    Shapes.Remove(Tron_Logo)
    Controls.Remove(Start_Game_Button1)
    Controls.Remove(High_Scores_Button)
    Controls.Remove(How_to_Play_Button)
    Controls.Remove(Quit_Game_Button)
    How_To_Play()
  'Opens High Scores Menu
  ElseIf Controls.LastClickedButton = High_Scores_Button Then
    Shapes.Remove(Tron_Logo)
    Controls.Remove(Start_Game_Button1)
    Controls.Remove(High_Scores_Button)
    Controls.Remove(How_to_Play_Button)
    Controls.Remove(Quit_Game_Button)
    High_Scores()
  'Run High Scores Reset
  ElseIf Controls.LastClickedButton = High_Scores_Text["Reset"] Then
    For i = 1 To 10
      Shapes.Remove(High_Scores_Text[i])
    EndFor
    Reset_Scores()
  'Run Submit Score
  ElseIf Controls.LastClickedButton = High_Scores_Text["Submit"] Then
    Submit_Score_Window()
  'Submits Score
  ElseIf Controls.LastClickedButton = Submit_Score Then
    High_Score_Update()
    Score_Player = 0
    Score_Comp = 0
    Score = 0
    Shapes.Remove(Submit_Popup)
    Shapes.Remove(Submit_Text["Name"])
    Shapes.Remove(Submit_Text["Warning1"])
    Shapes.Remove(Submit_Text["Warning2"])
    Shapes.Remove(cScore_Display)
    Shapes.Remove(pScore_Display)
    Controls.Remove(Name)
    Controls.Remove(Submit_Score)
    Controls.Remove(Cancel_Submit_Score)
    Shapes.Remove(High_Scores_Text["Score"])
    GraphicsWindow.BrushColor = "Yellow"
    High_Scores_Text["Score"] = Shapes.AddText("Your Score: " + Score)
    Shapes.Move(High_Scores_Text["Score"], GW_Width / 2 - 140, GW_Height - 40)
    GraphicsWindow.FontSize = 20
    cScore_Display = Shapes.AddText("Computer : " + Score_Comp)
    Shapes.Move(cScore_Display, 10, 5)
    GraphicsWindow.BrushColor = "Cyan"
    pScore_Display = Shapes.AddText("You : " + Score_Player)
    Shapes.Move(pScore_Display, GW_Width - 90, 5)
    Shapes.HideShape(cScore_Display)
    Shapes.HideShape(pScore_Display)
    For i = 1 To 10
      Shapes.Remove(High_Scores_Text[i])
    EndFor
    GraphicsWindow.BrushColor = "Yellow"
    For s = 1 To 10
' The following line could be harmful and has been automatically commented.
'       High_Scores_Text[s] = Shapes.AddText(s + ". " + (File.ReadLine(High_Score_File, s)))
      Shapes.Zoom(High_Scores_Text[s], 1.5, 1.5)
      Shapes.Move(High_Scores_Text[s], GW_Width / 2 - 200, 150 + s * 50)
    EndFor
  'Cancels Submit Score
  ElseIf Controls.LastClickedButton = Cancel_Submit_Score Then
    Shapes.Remove(Submit_Popup)
    Shapes.Remove(Submit_Text["Name"])
    Shapes.Remove(Submit_Text["Warning1"])
    Shapes.Remove(Submit_Text["Warning2"])
    Shapes.Remove(cScore_Display)
    Shapes.Remove(pScore_Display)
    Controls.Remove(Name)
    Controls.Remove(Submit_Score)
    Controls.Remove(Cancel_Submit_Score)
  EndIf
EndSub
'/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Change_Key
  'Buttons clicks
  'Forces the player to go left until they press a key at start of round
  If GraphicsWindow.LastKey = "Left" Or GraphicsWindow.LastKey = "Right" Or GraphicsWindow.LastKey = "Up" Or GraphicsWindow.LastKey = "Down" Then
    First_Go = "False"
  'Pauses and unpauses the game when p is pressed
ElseIf GraphicsWindow.LastKey = "P" And Play_Game = "True" And Pause = "False" Then
    Pause = "True"
    Pause_Menu()
  ElseIf GraphicsWindow.LastKey = "P" And Play_Game = "False" And Pause = "True" Then
    Shapes.Remove(Restart_Box)
    Shapes.Remove(Game_Over_Text)
    Controls.Remove(Continue_Button)
    Controls.Remove(Main_Menu_Button)
    Controls.Remove(Quit_Game_Button)
    Play_Game = "True"
  'Activates Turbo Boost
  ElseIf GraphicsWindow.LastKey = "Space" And Turbo_No > 0 And Turbo = "False" Then
    Turbo = "True"
    If Turbo_No = 3 Then
      Shapes.Remove(Turbo_3)
    ElseIf Turbo_No = 2 Then
      Shapes.Remove(Turbo_2)
    ElseIf Turbo_No = 1 Then
      Shapes.Remove(Turbo_1)
    EndIf
  'Quits Game is you press Esc
  ElseIf GraphicsWindow.LastKey = "Escape" Then
    Program.End()
  EndIf
EndSub
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Change_Speed
  'This section changes the game speed in the settings
  If Slow_Opacity = 100 Then
    If GraphicsWindow.MouseX > GW_Width / 2 + 140 And GraphicsWindow.MouseX < GW_Width / 2 + 160 And GraphicsWindow.MouseY > GW_Height / 2 And GraphicsWindow.MouseY < GW_Height / 2 + 20 And Settings = "True" Then
      Slow_Opacity = 0
      Medium_Opacity = 100
      Speed = 100
      Difficulty_Bonus = 20
      Shapes.SetOpacity(Slow_Speed_Text, 0)
      Shapes.SetOpacity(Medium_Speed_Text, 100)
      Shapes.HideShape(Speed_Slow)
      Shapes.ShowShape(Speed_Medium)
    EndIf    
  ElseIf Medium_Opacity = 100 Then
    If GraphicsWindow.MouseX > GW_Width / 2 + 140 And GraphicsWindow.MouseX < GW_Width / 2 + 160 And GraphicsWindow.MouseY > GW_Height / 2 And GraphicsWindow.MouseY < GW_Height / 2 + 20 And Settings = "True" Then
      Medium_Opacity = 0
      Fast_Opacity = 100
      Speed = 50
      Difficulty_Bonus = 50
      Shapes.SetOpacity(Medium_Speed_Text, 0)
      Shapes.SetOpacity(Fast_Speed_Text, 100)
      Shapes.ShowShape(Speed_Fast)
      Shapes.HideShape(Speed_Medium)
    ElseIf GraphicsWindow.MouseX > GW_Width / 2 And GraphicsWindow.MouseX < GW_Width / 2 + 20 And GraphicsWindow.MouseY > GW_Height / 2 And GraphicsWindow.MouseY < GW_Height / 2 + 20 And Settings = "True" Then
      Medium_Opacity = 0
      Slow_Opacity = 100
      Speed = 150
      Difficulty_Bonus = 10
      Shapes.SetOpacity(Medium_Speed_Text, 0) 
      Shapes.SetOpacity(Slow_Speed_Text, 100)
      Shapes.HideShape(Speed_Medium)
      Shapes.ShowShape(Speed_Slow) 
    EndIf
  ElseIf Fast_Opacity = 100 Then
    If GraphicsWindow.MouseX > GW_Width / 2 + 140 And GraphicsWindow.MouseX < GW_Width / 2 + 160 And GraphicsWindow.MouseY > GW_Height / 2 And GraphicsWindow.MouseY < GW_Height / 2 + 20 And Settings = "True" Then
      Fast_Opacity = 0
      Extreme_Opacity = 100
      Speed = 25
      Difficulty_Bonus = 100
      Shapes.SetOpacity(Fast_Speed_Text, 0)
      Shapes.SetOpacity(Extreme_Speed_Text, 100)
      Shapes.HideShape(Speed_Fast)
      Shapes.ShowShape(Speed_Extreme)  
    ElseIf GraphicsWindow.MouseX > GW_Width / 2 And GraphicsWindow.MouseX < GW_Width / 2 + 20 And GraphicsWindow.MouseY > GW_Height / 2 And GraphicsWindow.MouseY < GW_Height / 2 + 20 And Settings = "True" Then
      Fast_Opacity = 0
      Medium_Opacity = 100
      Speed = 100
      Difficulty_Bonus = 20
      Shapes.SetOpacity(Fast_Speed_Text, 0)
      Shapes.SetOpacity(Medium_Speed_Text, 100)
      Shapes.ShowShape(Speed_Medium)
      Shapes.HideShape(Speed_Fast)     
    EndIf
  ElseIf Extreme_Opacity = 100 Then
    If GraphicsWindow.MouseX > GW_Width / 2 And GraphicsWindow.MouseX < GW_Width / 2 + 20 And GraphicsWindow.MouseY > GW_Height / 2 And GraphicsWindow.MouseY < GW_Height / 2 + 20 And Settings = "True" Then
      Extreme_Opacity = 0
      Fast_Opacity = 100
      Speed = 50
      Difficulty_Bonus = 50
      Shapes.SetOpacity(Extreme_Speed_Text, 0)
      Shapes.SetOpacity(Fast_Speed_Text, 100)
      Shapes.HideShape(Speed_Extreme)
      Shapes.ShowShape(Speed_Fast)  
  EndIf
  EndIf  
EndSub
'/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub How_To_Play
  'Writes the instructions for how to play
  GraphicsWindow.BrushColor = "Yellow"
  How_to_Play_Title = Shapes.AddText("How To Play")
  Shapes.Zoom(How_to_Play_Title, 4, 4)
  Shapes.Move(How_to_Play_Title, GW_Width / 2 - 50, 50)
  How_to_Play_Text["Moving"] = Shapes.AddText("Move your character (blue player) using the arrow keys.")
  How_to_Play_Text["Turbo"] = Shapes.AddText("Press space bar to use Turbo Boost.")
  How_to_Play_Text["Objective1"] = Shapes.AddText("The objective of the game is to move around the grid without crashing into the walls generated ")
  How_to_Play_Text["Objective2"] = Shapes.AddText("by you or your opponent. To win you must out last and out manoeuvre your opponent, causing ")
  How_to_Play_Text["Objective3"] = Shapes.AddText("them to crash, without crashing yourself.")
  Shapes.Move(How_to_Play_Text["Objective1"], 20, 150)
  Shapes.Move(How_to_Play_Text["Objective2"], 20, 180)
  Shapes.Move(How_to_Play_Text["Objective3"], 20, 210)
  Shapes.Move(How_to_Play_Text["Moving"], 20, 270)
  Shapes.Move(How_to_Play_Text["Turbo"], 20, 330)
  GraphicsWindow.BrushColor = "Black"
  Main_Menu_Button_2 = Controls.AddButton("Back", 10, 10)
  Start_Game_Button3 = Controls.AddButton("Start Game", GW_Width / 2 - 20, GW_Height - 50) 
EndSub
'/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub High_Scores
  'Shows the High Scores Menu
  GraphicsWindow.BrushColor = "Yellow"
  High_Scores_Text["Title"] = Shapes.AddText("High Scores")
  Shapes.Zoom(High_Scores_Text["Title"], 4, 4)
  Shapes.Move(High_Scores_Text["Title"], 450, 75)
  High_Scores_Text["Score"] = Shapes.AddText("Your Score: " + Score)
  Shapes.Move(High_Scores_Text["Score"], GW_Width / 2 - 140, GW_Height - 40)
  For s = 1 To 10
' The following line could be harmful and has been automatically commented.
'     High_Scores_Text[s] = Shapes.AddText(s + ". " + (File.ReadLine(High_Score_File, s)))
    Shapes.Zoom(High_Scores_Text[s], 1.5, 1.5)
    Shapes.Move(High_Scores_Text[s], GW_Width / 2 - 200, 150 + s * 50)
  EndFor
  GraphicsWindow.BrushColor = "Black"
  High_Scores_Text["Reset"] = Controls.AddButton("Reset Scores", GW_Width - 150, 10)
  High_Scores_Text["Back"] = Controls.AddButton("Back", 10, 10)
  High_Scores_Text["Submit"] = Controls.AddButton("Submit Score", GW_Width / 2 + 40, GW_Height - 50)
EndSub
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Reset_Scores
  'This resets the high scores if you push the high score button
  For i = 1 To 10
' The following line could be harmful and has been automatically commented.
'     File.WriteLine(High_Score_File, i, "Computer .... " + (1100 - i * 100))
' The following line could be harmful and has been automatically commented.
'     File.WriteLine(High_Score_File, i + 10, 1100 - i * 100)
  EndFor
  GraphicsWindow.BrushColor = "Yellow"
  For s = 1 To 10
' The following line could be harmful and has been automatically commented.
'     High_Scores_Text[s] = Shapes.AddText(s + ". " + (File.ReadLine(High_Score_File, s)))
    Shapes.Zoom(High_Scores_Text[s], 1.5, 1.5)
    Shapes.Move(High_Scores_Text[s], GW_Width / 2 - 200, 150 + s * 50)
  EndFor
EndSub
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Submit_Score_Window
  'This opens the high score popup when you push submit
  GraphicsWindow.BrushColor = "Black"
  Submit_Popup = Shapes.AddRectangle(250, 300)
  Shapes.Move(Submit_Popup, GW_Width / 2 - 125, GW_Height /2 - 100)
  Name = Controls.AddTextBox(GW_Width / 2 - 85, GW_Height / 2 - 50)
  GraphicsWindow.BrushColor = "Yellow"
  Submit_Text["Name"] = Shapes.AddText("Name")
  Shapes.Move(Submit_Text["Name"], GW_Width / 2 - 40, GW_Height / 2 - 80)
  Submit_Text["Warning1"] = Shapes.AddText("If you continue your")
  Shapes.Move(Submit_Text["Warning1"], GW_Width / 2 - 110, GW_Height / 2)
  Submit_Text["Warning2"] = Shapes.AddText("score will be reset")
  Shapes.Move(Submit_Text["Warning2"], GW_Width / 2 - 100, GW_Height / 2 + 30)
  GraphicsWindow.BrushColor = "Black"
  Submit_Score =  Controls.AddButton("     OK     ", GW_Width / 2, GW_Height / 2 + 140)
  Cancel_Submit_Score =  Controls.AddButton("  Cancel  ", GW_Width / 2 - 110, GW_Height / 2 + 140)  
EndSub
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub High_Score_Update
  'Upadtes High Score File
  For i = 1 To 10
' The following line could be harmful and has been automatically commented.
'     If File.ReadLine(High_Score_File, i + 10) < Score And Written = "False" Then
      If i < 10 Then
        For t = 9 To i Step -1
' The following line could be harmful and has been automatically commented.
'           Move_Score = File.ReadLine(High_Score_File, t)
' The following line could be harmful and has been automatically commented.
'           File.WriteLine(High_Score_File, t + 1, Move_Score)
' The following line could be harmful and has been automatically commented.
'           Move_Score = File.ReadLine(High_Score_File, t + 10)
' The following line could be harmful and has been automatically commented.
'           File.WriteLine(High_Score_File, t + 11, Move_Score)
        EndFor
      EndIf
' The following line could be harmful and has been automatically commented.
'       File.WriteLine(High_Score_File, i, Controls.GetTextBoxText(Name) + " .... " + Score)
' The following line could be harmful and has been automatically commented.
'       File.WriteLine(High_Score_File, i + 10, Score)
      Written = "True"
    EndIf
  EndFor
  Written = "False"
EndSub
'/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Play
  'Determines if and for how long Turbo should run for
  If Turbo = "True" And Turbo_Timer > 0 Then
    Turbo_Timer = Turbo_Timer - 1
    Turbo_Run = 2
  ElseIf Turbo = "True" And Turbo_Timer = 0 Then
    Turbo = "False"
    Turbo_Timer = 10
    Turbo_No = Turbo_No - 1
  Else
    Turbo = "False"
    Turbo_Run = 1
  EndIf
  'Get Player's Input
  If First_Go = "False" Then
  Key = GraphicsWindow.LastKey
  If (Key = "Up" Or Key = "Down" Or Key = "Left" Or Key = "Right") Then
    Direction = Key
  EndIf
EndIf
'While loop runs the code twice if turbo is active
While Turbo_Run > 0
  'Move Player
  Move_No = Move_No + 1
  If (Direction = "Up") Then
    If (Last_Input <> "Down") Then
       GraphicsWindow.BrushColor = "Cyan"
       Player_Y = Player_Y - 10
       Crash_Detect()
       GraphicsWindow.FillRectangle(Player_X, Player_Y, 10, 10)
       Array.SetValue("Grid", Player_X + ", " + Player_Y, "Wall")
       Last_Input = "Up"
     Else 
       GraphicsWindow.BrushColor = "Cyan"
       Player_Y = Player_Y + 10
       GraphicsWindow.FillRectangle(Player_X, Player_Y, 10, 10)
       Crash_Detect()
       Array.SetValue("Grid", Player_X + ", " + Player_Y, "Wall")
    EndIf
  ElseIf (Direction = "Down") Then
      If (Last_Input <> "Up") Then
        GraphicsWindow.BrushColor = "Cyan"
        Player_Y = Player_Y + 10
        Crash_Detect()
        GraphicsWindow.FillRectangle(Player_X, Player_Y, 10, 10)
        Array.SetValue("Grid", Player_X + ", " + Player_Y, "Wall")
        Last_Input = "Down"
      Else
        GraphicsWindow.BrushColor = "Cyan"
        Player_Y = Player_Y - 10
        Crash_Detect()
       GraphicsWindow.FillRectangle(Player_X, Player_Y, 10, 10)
       Array.SetValue("Grid", Player_X + ", " + Player_Y, "Wall")
     EndIf
   ElseIf (Direction = "Right") Then
     If (Last_Input <> "Left") Then
        GraphicsWindow.BrushColor = "Cyan"
        Player_X = Player_X + 10
        Crash_Detect()
        GraphicsWindow.FillRectangle(Player_X, Player_Y, 10, 10)
        Array.SetValue("Grid", Player_X + ", " + Player_Y, "Wall")
        Last_Input = "Right"
      Else
        GraphicsWindow.BrushColor = "Cyan"
        Player_X = Player_X - 10
        Crash_Detect()
        GraphicsWindow.FillRectangle(Player_X, Player_Y, 10, 10)
        Array.SetValue("Grid", Player_X + ", " + Player_Y, "Wall")
     EndIf
    ElseIf (Direction = "Left") Then
     If (Last_Input <> "Right") Then
        GraphicsWindow.BrushColor = "Cyan"
        Player_X = Player_X - 10
        Crash_Detect()
        GraphicsWindow.FillRectangle(Player_X, Player_Y, 10, 10)
        Array.SetValue("Grid", Player_X + ", " + Player_Y, "Wall")
        Last_Input = "Left"
      Else
        GraphicsWindow.BrushColor = "Cyan"
        Player_X = Player_X + 10
        Crash_Detect()
       GraphicsWindow.FillRectangle(Player_X, Player_Y, 10, 10)
       Array.SetValue("Grid", Player_X + ", " + Player_Y, "Wall")
     EndIf
   EndIf
     Turbo_Run = Turbo_Run - 1   
  EndWhile 
  Computer()
 
    
  Program.Delay(Speed)
EndSub
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Crash_Detect
  'Detects if the player has crashed
  If Array.GetValue("Grid", Player_X + ", " + Player_Y) <> "Empty" Then
    Player_Crashed = "True"
    Game_Over()
  
  EndIf 
EndSub
'//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Pause_Menu
  'Pauses game and opens pause menu
  Play_Game = "False"
  GraphicsWindow.BrushColor = "Black"
  Restart_Box = Shapes.AddRectangle(200, 250)
  Shapes.Move(Restart_Box, GW_Width/2 - 100, GW_Height/2 - 150)
  GraphicsWindow.BrushColor = "White"
  Game_Over_Text = Shapes.AddText("Game Paused")
  Shapes.Zoom(Game_Over_Text, 1.3, 1.3)
  Shapes.Move(Game_Over_Text, GW_Width/2 - 65, GW_Height/2 - 145)
  GraphicsWindow.BrushColor = "Black"
  Continue_Button = Controls.AddButton(" Continue  ", GW_Width/2 - 60, GW_Height/2 - 80)
  Quit_Game_Button = Controls.AddButton("Quit  Game", GW_Width/2 - 60, GW_Height/2 + 20)
  Main_Menu_Button = Controls.AddButton("Main Menu", GW_Width/2 - 60, GW_Height/2 - 30)
  GraphicsWindow.BrushColor = "Red"  
EndSub
 
 Sub Game_Over
   'Adjusts Score
   If Player_Crashed = "True" Then
     Score_Comp = Score_Comp + 1
     Score = Score - 1 * Difficulty_Bonus
     Player_Crashed = "False
   ElseIf Computer_Crashed = "True" Then
     Score_Player = Score_Player + 1
     Score = Score + 1 * Difficulty_Bonus
     Computer_Crashed = "False"
   EndIf
  'Updates Score
  GraphicsWindow.BrushColor = "Yellow"
  GraphicsWindow.FontSize = 20
  Shapes.Remove(cScore_Display)
  cScore_Display = Shapes.AddText("Computer : " + Score_Comp)
  Shapes.Move(cScore_Display, 10, 5)
  GraphicsWindow.BrushColor = "Cyan"
  Shapes.Remove(pScore_Display)
  pScore_Display = Shapes.AddText("You : " + Score_Player)
  Shapes.Move(pScore_Display, GW_Width - 90, 5)
  
  'Opens game over menu
  Play_Game = "False"
  GraphicsWindow.BrushColor = "Black"
  Restart_Box = Shapes.AddRectangle(200, 250)
  Shapes.Move(Restart_Box, GW_Width/2 - 100, GW_Height/2 - 150)
  GraphicsWindow.BrushColor = "White"
  Game_Over_Text = Shapes.AddText("Game Over")
  Shapes.Zoom(Game_Over_Text, 1.5, 1.5)
  Shapes.Move(Game_Over_Text, GW_Width/2 - 55, GW_Height/2 - 145)
  GraphicsWindow.BrushColor = "Black"
  Restart_Button = Controls.AddButton("Play Again", GW_Width/2 - 60, GW_Height/2 - 80)
  Quit_Game_Button = Controls.AddButton("Quit Game", GW_Width/2 - 60, GW_Height/2 + 20)
  Main_Menu_Button = Controls.AddButton("Main Menu", GW_Width/2 - 60, GW_Height/2 - 30)
  GraphicsWindow.BrushColor = "Red"
EndSub 
'///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Restart
  'Restarts Game
  'Redeclares relevant variables
  First_Go = "True"
  Last_Input = "None"
  Direction = "Left"
  Player_X = 800
  Player_Y = 375
  Computer_X = 200
  Computer_Y = 375
  Turbo = "False"
  Turbo_No = 3
  Turbo_Timer = 10
  Turbo_Run = 1  
  Pause = "False"
  
  'Outer Wall
  GraphicsWindow.PenWidth = 10
  GraphicsWindow.PenColor = "PaleTurquoise"
  GraphicsWindow.DrawRectangle(5, 40,  GW_Width, GW_Height-35)
  
  ' Score update
  GraphicsWindow.BrushColor = "Yellow"
  GraphicsWindow.FontSize = 20
  cScore_Display = Shapes.AddText("Computer : " + Score_Comp)
  Shapes.Move(cScore_Display, 10, 5)
  GraphicsWindow.BrushColor = "Cyan"
  pScore_Display = Shapes.AddText("You : " + Score_Player)
  Shapes.Move(pScore_Display, GW_Width - 90, 5)
  
  ' Turbo Reset
  GraphicsWindow.FontSize = 20
  GraphicsWindow.DrawBoundText(GW_Width / 2 - 190, 10, 120, "Turbos ")
  Turbo_1 = Shapes.AddText("I")
  Turbo_2 = Shapes.AddText("I")
  Turbo_3 = Shapes.AddText("I")
  Shapes.Move(Turbo_1, GW_Width / 2 - 110, 10)
  Shapes.Move(Turbo_2, GW_Width / 2 -100, 10)
  Shapes.Move(Turbo_3, GW_Width / 2 - 90, 10)
  GraphicsWindow.FontSize = 20
  
  'Speed
  GraphicsWindow.DrawBoundText(GW_Width / 2 + 20, 10, 120, "Speed : ")
  Speed_Slow = Shapes.AddText("Slow")
  Speed_Medium = Shapes.AddText("Medium")
  Speed_Fast = Shapes.AddText("Fast")
  Speed_Extreme = Shapes.AddText("Extreme")
  Shapes.Move(Speed_Slow, GW_Width / 2 + 100, 10)
  Shapes.Move(Speed_Medium, GW_Width / 2 + 100, 10)
  Shapes.Move(Speed_Fast, GW_Width / 2 + 100, 10)
  Shapes.Move(Speed_Extreme, GW_Width / 2 + 100, 10)
  Shapes.HideShape(Speed_Medium)
  Shapes.HideShape(Speed_Slow)
  Shapes.HideShape(Speed_Fast)
  Shapes.HideShape(Speed_Extreme)
  If Slow_Opacity = 100 Then 
    Shapes.ShowShape(Speed_Slow)
    Speed = 150
  ElseIf Medium_Opacity = 100 Then
    Shapes.ShowShape(Speed_Medium) 
    Speed = 100
  ElseIf Fast_Opacity = 100 Then
    Shapes.ShowShape(Speed_Fast)
    Speed = 50
  Else
    Shapes.ShowShape(Speed_Extreme)
    Speed = 25   
  EndIf
  
  'Show Loading Screen
  GraphicsWindow.BrushColor = "Black"
  GraphicsWindow.PenColor = "Black"
  Loading_Background = Shapes.AddRectangle(GW_Width + 10, GW_Height + 10)
  GraphicsWindow.BrushColor = "Yellow" 
  Loading_Text = Shapes.AddText("Loading...")
  Shapes.Move(Loading_Text, GW_Width / 2 - 20, GW_Height / 2)
  Tron_Logo = Shapes.AddImage(Logo_Path)
  Shapes.Zoom(Tron_Logo, 0.5, 0.5)
  Shapes.Move(Tron_Logo, -100, -150)
  
  'Draw grid
  GraphicsWindow.PenColor = "DimGray"
  GraphicsWindow.PenWidth = 1/6
  For t = 45 To GW_Height - 10 Step 10
   For i = 10 To GW_Width - 10 Step 10
     GraphicsWindow.DrawRectangle(i, t, 10, 10)
     Array.SetValue("Grid", i + ", " + t, "Empty")
   EndFor   
  EndFor
  
  'Set Player Location
  GraphicsWindow.BrushColor = "Cyan"
  GraphicsWindow.FillRectangle(800, 375, 10, 10)
  Array.SetValue("Grid", "800, 375", "Wall")
  'Set Computer's location
  GraphicsWindow.BrushColor = "Yellow"
  GraphicsWindow.FillRectangle(200, 375, 10, 10)
  Array.SetValue("Grid", "200, 375", "Wall")
  
  'Hide Loading Screen
  Shapes.Remove(Loading_Background)
  Shapes.Remove(Loading_Text)
  Shapes.Remove(Tron_Logo)
  
  Play_Game = "True"
  Sound.PlayBellRing()
EndSub
'////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Computer
  'Steers computer
  Up_Free = Array.GetValue("Grid", Computer_X + ", " + (Computer_Y - 10))
  Down_Free = Array.GetValue("Grid", Computer_X + ", " + (Computer_Y + 10))
  Left_Free = Array.GetValue("Grid", (Computer_X - 10) + ", " + Computer_Y)
  Right_Free = Array.GetValue("Grid", (Computer_X + 10) + ", " + Computer_Y)
  'Obtains the tan value of the computers position relevant to player
  angle = Math.Abs(Player_Y - Computer_Y)/Math.Abs(Player_X - Computer_X) 
  'TextWindow.WriteLine(angle)
    If angle > 0.57 And angle < 1.76 And Computer_X < Player_X And Computer_Y < Player_Y Then
      GraphicsWindow.BrushColor = "Yellow"
      If Right_Free = "Empty" Then
        Computer_X = Computer_X + 10
      ElseIf Down_Free = "Empty" Then
        Computer_Y = Computer_Y + 10
      ElseIf Left_Free = "Empty" Then
        Computer_X = Computer_X - 10
      Else
        Computer_Y = Computer_Y - 10
      EndIf
       Crash_Detect_Comp()
       GraphicsWindow.FillRectangle(Computer_X, Computer_Y, 10, 10)
       Array.SetValue("Grid", Computer_X + ", " + Computer_Y, "Wall")
     ElseIf angle > 0.57 And angle < 1.76 And Computer_X > Player_X And Computer_Y < Player_Y Then
       GraphicsWindow.BrushColor = "Yellow"
       If Left_Free = "Empty" Then
         Computer_X = Computer_X - 10
       ElseIf Down_Free = "Empty" Then
         Computer_Y = Computer_Y + 10
       ElseIf Up_Free = "Empty" Then
         Computer_Y = Computer_Y - 10
       Else
         Computer_X = Computer_X + 10
       EndIf
       Crash_Detect_Comp()
       GraphicsWindow.FillRectangle(Computer_X, Computer_Y, 10, 10)
       Array.SetValue("Grid", Computer_X + ", " + Computer_Y, "Wall")
     ElseIf angle > 0.57 And angle < 1.76 And Computer_X > Player_X And Computer_Y > Player_Y Then
       GraphicsWindow.BrushColor = "Yellow"
       If Left_Free = "Empty" Then
         Computer_X = Computer_X - 10
       ElseIf Up_Free = "Empty" Then
         Computer_Y = Computer_Y - 10
       ElseIf Down_Free = "Empty" Then
         Computer_Y = Computer_Y + 10
       Else
         Computer_X = Computer_X + 10
       EndIf
       Crash_Detect_Comp()
       GraphicsWindow.FillRectangle(Computer_X, Computer_Y, 10, 10)
       Array.SetValue("Grid", Computer_X + ", " + Computer_Y, "Wall")
     ElseIf angle > 0.57 And angle < 1.76 And Computer_X < Player_X And Computer_Y < Player_Y Then
       GraphicsWindow.BrushColor = "Yellow"
        If Right_Free = "Empty" Then
         Computer_X = Computer_X + 10
       ElseIf Up_Free = "Empty" Then
         Computer_Y = Computer_Y - 10
       ElseIf Down_Free = "Empty" Then
         Computer_Y = Computer_Y + 10
       Else
         Computer_X = Computer_X - 10
       EndIf
       Crash_Detect_Comp()
       GraphicsWindow.FillRectangle(Computer_X, Computer_Y, 10, 10)
       Array.SetValue("Grid", Computer_X + ", " + Computer_Y, "Wall")
     ElseIf (angle > 0.57 Or angle < 1.76)  And Computer_X < Player_X And Computer_Y > Player_Y Then
       GraphicsWindow.BrushColor = "Yellow"
       If Right_Free = "Empty" Then
         Computer_X = Computer_X + 10
       ElseIf Up_Free = "Empty" Then
         Computer_Y = Computer_Y - 10
       ElseIf Down_Free = "Empty" Then
         Computer_Y = Computer_Y + 10
       Else
         Computer_X = Computer_X - 10
       EndIf
       Crash_Detect_Comp()
       GraphicsWindow.FillRectangle(Computer_X, Computer_Y, 10, 10)
       Array.SetValue("Grid", Computer_X + ", " + Computer_Y, "Wall")
     ElseIf (angle > 0.57 Or angle < 1.76)  And Computer_X > Player_X And Computer_Y > Player_Y Then
       GraphicsWindow.BrushColor = "Yellow"
       If Left_Free = "Empty" Then
         Computer_X = Computer_X - 10
       ElseIf Up_Free = "Empty" Then
         Computer_Y = Computer_Y - 10
       ElseIf Down_Free = "Empty" Then
         Computer_Y = Computer_Y + 10
       Else
         Computer_X = Computer_X + 10
       EndIf
       Crash_Detect_Comp()
       GraphicsWindow.FillRectangle(Computer_X, Computer_Y, 10, 10)
       Array.SetValue("Grid", Computer_X + ", " + Computer_Y, "Wall")
       ElseIf (angle > 0.57 Or angle < 1.76)  And Computer_X < Player_X And Computer_Y < Player_Y Then
       GraphicsWindow.BrushColor = "Yellow"
       If Right_Free = "Empty" Then
         Computer_X = Computer_X + 10
       ElseIf Down_Free = "Empty" Then
         Computer_Y = Computer_Y + 10
       ElseIf Up_Free = "Empty" Then
         Computer_Y = Computer_Y - 10
       Else
         Computer_X = Computer_X - 10
       EndIf
       Crash_Detect_Comp()
       GraphicsWindow.FillRectangle(Computer_X, Computer_Y, 10, 10)
       Array.SetValue("Grid", Computer_X + ", " + Computer_Y, "Wall")
     ElseIf (angle > 0.57 Or angle < 1.76)  And Computer_X > Player_X And Computer_Y < Player_Y Then
       GraphicsWindow.BrushColor = "Yellow"
       If Left_Free = "Empty" Then
         Computer_X = Computer_X - 10
       ElseIf Down_Free = "Empty" Then
         Computer_Y = Computer_Y + 10
       ElseIf Up_Free = "Empty" Then
         Computer_Y = Computer_Y - 10
       Else
         Computer_X = Computer_X + 10
       EndIf
       Crash_Detect_Comp()
       GraphicsWindow.FillRectangle(Computer_X, Computer_Y, 10, 10)
       Array.SetValue("Grid", Computer_X + ", " + Computer_Y, "Wall")
     Else
       GraphicsWindow.BrushColor = "Yellow"
       If Right_Free = "Empty" Then
         Computer_X = Computer_X + 10
       ElseIf Up_Free = "Empty" Then
         Computer_Y = Computer_Y - 10
       ElseIf Down_Free = "Empty" Then
         Computer_Y = Computer_Y + 10
       Else
         Computer_X = Computer_X - 10
       EndIf
       Crash_Detect_Comp()
       GraphicsWindow.FillRectangle(Computer_X, Computer_Y, 10, 10)
       Array.SetValue("Grid", Computer_X + ", " + Computer_Y, "Wall")
     EndIf 
EndSub
'///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Sub Crash_Detect_Comp
  'Detects computer crash
  If Array.GetValue("Grid", Computer_X  + ", " + Computer_Y) <> "Empty" Then
    Computer_Crashed = "True"
    Game_Over()
   EndIf 
EndSub













'  
   'Move Computer   
 '  Up_Free = Array.GetValue("Grid", Computer_X + ", " + (Computer_Y - 10))
 '  Down_Free = Array.GetValue("Grid", Computer_X + ", " + (Computer_Y + 10)) 
 '  Left_Free = Array.GetValue("Grid", (Computer_X - 10) + ", " + Computer_Y)
 '  Right_Free = Array.GetValue("Grid", (Computer_X + 10) + ", " + Computer_Y)
 '  If Up_Free <> "Empty" Then
 '    Up_Free = "False"
 '  Else
 '    Up_Free = "True"     
 '  EndIf
 '  If Down_Free <> "Empty" Then
 '    Down_Free = "False"
 '  Else
 '    Down_Free = "True"     
 '  EndIf 
 '  If Left_Free <> "Empty" Then
 '    Left_Free = "False"
 '  Else
 '    Left_Free = "True"     
 '  EndIf
 '  If Right_Free <> "Empty" Then
 '    Right_Free = "False"
 '  Else
 '    Right_Free = "True"     
 '  EndIf
   
    

 '  Computer_Move() 
'Sub Computer_Move
'  GraphicsWindow.BrushColor = "Yellow"
'  Computer_X = Computer_X + Move_X
'  Computer_Y = Computer_Y + Move_Y
'  GraphicsWindow.FillRectangle(Computer_X, Computer_Y, 10, 10)
'  Array.SetValue("Grid", Computer_X + ", " + Computer_Y, "Wall") 
'EndSub  




'Sub zComputer_init
'  
'  dist[computer_X + ", " + computer_Y] = 0
'  prev[computer_X + ", " + computer_Y] = "undefined"
  
'  For t = 45 to GW_Height - 10 Step 10
'    For i = 10 to GW_Height - 10 Step 10
'      If Array.GetValue("Grid", i + ", " + t) = "Empty" Or (Player_X = i And Player_Y = t)Then
'        dist[i + ", " + t] = "Infinity"
'        prev[i + ", " + t] = "undefined"
'      
'        map[i + ", " + t] = "unvisited"
'        TextWindow.WriteLine(map[i + ", " + t])
'        TextWindow.WriteLine(dist[i + ", " + t])
'        TextWindow.WriteLine(prev[i + ", " + t])
'      EndIf
'    EndFor
'  EndFor
'  
'  While Array.GetItemCount(map) > 0
'    For z = 0 To 10000 Step 1
'      While Array.ContainsValue(dist, z)
'        
'        For t = 45 to GW_Height - 10 Step 10
'          For i = 10 to GW_Height - 10 Step 10
'            If dist[i + ", " + t] = z And Array.ContainsIndex(map, i + ", " + t) Then
'              Array.RemoveValue(map, i + ", " + t)
'              For y = 1 To 4 Step 1
'                up = t -  10
'                right = i + 10
'                down = t + 10
'                left = i - 10
'                If y = 1 And Array.ContainsIndex(map, i + ", " + up) Then
'                  alt = dist[i + ", " + t] + 1
'                  If alt > dist[i + ", " + up] Then
'                    dist[i + ", " + up] = alt
'                    prev[i + ", " + up] = i + ", " + t
'                  EndIf
'                  
'                 ElseIf y = 2  Then       
'                  
'                 ElseIf y = 3 And Array.ContainsIndex(map, i + ", " + down) Then 
'                    alt = dist[i + ", " + t] + 1
'                    If alt > dist[i + ", " + down] Then
'                      dist[i + ", " + down] = alt
'                      prev[i + ", " + down] = i + ", " + t
'                   EndIf
'                  ElseIf y = 4 Then 
'                  EndIf
'                    
'                    TextWindow.WriteLine(dist[i + ", " + t])
'                    TextWindow.WriteLine(prev[i + ", " + t])
'              EndFor
'            EndIf
'          EndFor
'        EndFor     
'      EndWhile
'    EndFor      
'  EndWhile
'  TextWindow.WriteLine("Done")
'EndSub


